System.bundles={"bundles/devjournal/index.css!":["devjournal@0.0.0#styles.less!steal-less@1.3.4#less","devjournal@0.0.0#markdown-editor/markdown-editor.less!steal-less@1.3.4#less","devjournal@0.0.0#components/html-preview/html-preview.less!steal-less@1.3.4#less","devjournal@0.0.0#components/login-button/login-button.less!steal-less@1.3.4#less","devjournal@0.0.0#components/view-logs/view-logs.less!steal-less@1.3.4#less"],"bundles/can-debug/can-debug":["can-debug@1.3.0#src/proxy-namespace","can-debug@1.3.0#src/temporarily-bind","can-debug@1.3.0#src/graph/graph","can-debug@1.3.0#src/get-graph/make-node","can-debug@1.3.0#src/get-graph/get-graph","can-debug@1.3.0#src/draw-graph/format-graph","can-debug@1.3.0#src/draw-graph/draw-graph","can-debug@1.3.0#src/log-data/log-data","can-debug@1.3.0#src/label-cycles/label-cycles","can-debug@1.3.0#src/get-data/get-data","can-debug@1.3.0#src/what-i-change/what-i-change","can-debug@1.3.0#src/what-changes-me/what-changes-me","can-debug@1.3.0#src/get-what-i-change/get-what-i-change","can-debug@1.3.0#src/get-what-changes-me/get-what-changes-me","can-diff@1.4.2#merge-deep/merge-deep","can-debug@1.3.0#can-debug"]},define("npm-utils",function(e,t,n){!function(e,t,n,r){function i(e){var t=String(e).replace(/^\s+|\s+$/g,"").match(/^([^:\/?#]+:)?(\/\/(?:[^:@\/]*(?::[^:@\/]*)?@)?(([^:\/?#]*)(?::(\d*))?))?([^?#]*)(\?[^#]*)?(#[\s\S]*)?/);return t?{href:t[0]||"",protocol:t[1]||"",authority:t[2]||"",host:t[3]||"",hostname:t[4]||"",port:t[5]||"",pathname:t[6]||"",search:t[7]||"",hash:t[8]||""}:null}var o=Array.prototype.slice,a=/.+@.+\..+\..+#.+/,s=/#\{[^\}]+\}|#\?.+$/,u=/(git|http(s?)):\/\//,c="function"==typeof Set,l={extend:function(e,t,n,r){var i,a=r;if(n)if(a||(a=c?new Set:[]),c){if(a.has(t))return t;a.add(t)}else{if(-1!==a.indexOf(t))return t;a.push(t)}for(var s in t)i=t[s],n?l.isArray(i)?e[s]=o.call(i):l.isPlainObject(i)?e[s]=l.extend({},i,n,a):e[s]=t[s]:e[s]=t[s];return e},map:function(e,t){for(var n=0,r=e.length,i=[];n<r;n++)i.push(t.call(e,e[n]));return i},filter:function(e,t){for(var n=0,r=e.length,i=[];n<r;n++)t.call(e,e[n])&&i.push(e[n]);return i},forEach:function(e,t){for(var n=0,r=e.length;n<r;n++)t.call(e,e[n],n)},flow:function(e){return function(){for(var t=e[0].apply(this,arguments),n=1;n<e.length;n++)t=e[n].call(this,t);return t}},isObject:function(e){return"object"==typeof e},isPlainObject:function(e){return l.isObject(e)&&(!e||e.__proto__===Object.prototype)},isArray:Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},isEnv:function(e){return this.isEnv?this.isEnv(e):this.env===e},isGitUrl:function(e){return u.test(e)},warnOnce:function(e){var t=this._warnings=this._warnings||{};t[e]||(t[e]=!0,this.warn(e))},warn:function(e){"undefined"!=typeof steal&&"undefined"!=typeof console&&console.warn&&steal.done().then(function(){steal.dev&&steal.dev.warn||(console.warn?console.warn("steal.js WARNING: "+e):console.log(e))})},relativeURI:function(e,t){return"undefined"!=typeof steal?steal.relativeURI(e,t):t},moduleName:{create:function(e,t){if(t)return e.moduleName;if("@empty"===e)return e;var n;e.modulePath&&(n="./"===e.modulePath.substr(0,2)?e.modulePath.substr(2):e.modulePath);var r=e.version;return r&&"^"!==r[0]&&(r=encodeURIComponent(decodeURIComponent(r))),e.packageName+(r?"@"+r:"")+(n?"#"+n:"")+(e.plugin?e.plugin:"")},isNpm:function(e){return a.test(e)},isConditional:function(e){return s.test(e)},isFullyConvertedNpm:function(e){return!!(e.packageName&&e.version&&e.modulePath)},isScoped:function(e){return"@"===e[0]},parse:function(e,t,n,r){var i=e.split("!"),o=i[0].split("#"),a=o[0].split("@");o[1]||a[0]||(a=["@"+a[1]]),3===a.length&&l.moduleName.isScoped(e)&&(a.splice(0,1),a[0]="@"+a[0]);var s,u;if(t&&l.path.isRelative(e))s=t,u=a[0];else if(t&&l.path.isInHomeDir(e,r))s=t,u=a[0].split("/").slice(1).join("/");else if(o[1])s=a[0],u=o[1];else{var c=a[0].split("/");s=c.length&&"@"===c[0][0]?c.splice(0,2).join("/"):c.shift(),u=c.join("/")}return u=l.path.removeJS(u),{plugin:2===i.length?"!"+i[1]:void 0,version:a[1],modulePath:u,packageName:s,moduleName:e,isGlobal:n}},parseFromPackage:function(e,t,n,r){var i=l.pkg.name(t),o=l.moduleName.parse(n,i,void 0,{loader:e}),a=l.path.isRelative(o.modulePath);if(a&&!r)throw new Error("Cannot resolve a relative module identifier with no parent module:",n);if(a){var s=l.moduleName.parse(r,i);if(s.packageName===o.packageName&&s.modulePath){var u=!0;if("../"===n||"./"===n||".."===n){var c=l.path.relativeTo(s.modulePath,n);l.path.isPackageRootDir(c)?(o.modulePath=l.pkg.main(t),u=!1):o.modulePath=n+(l.path.endsWithSlash(n)?"":"/")+"index"}u&&(o.modulePath=l.path.makeRelative(l.path.joinURIs(s.modulePath,o.modulePath)))}}var h,p=l.moduleName.create(o),f=l.pkg.config(t);!(t.browser&&"string"!=typeof t.browser&&p in t.browser)||f&&f.ignoreBrowser||(h=!1===t.browser[p]?"@empty":t.browser[p]);var d=e&&e.globalBrowser&&e.globalBrowser[p];return d&&(h=!1===d.moduleName?"@empty":d.moduleName),h?l.moduleName.parse(h,i,!!d):o},nameAndVersion:function(e){return e.packageName+"@"+e.version},isBareIdentifier:function(e){return e&&"."!==e[0]&&"@"!==e[0]}},pkg:{name:function(e){var t=l.pkg.config(e);return t&&t.name||e.name},main:function(e){var t,n=l.pkg.config(e);return t=n&&n.main?n.main:"string"==typeof e.browser?l.path.endsWithSlash(e.browser)?e.browser+"index":e.browser:"object"==typeof e.jam&&e.jam.main?e.jam.main:e.main?e.main:"index",l.path.removeJS(l.path.removeDotSlash(t))},rootDir:function(e,t){var n=t?l.path.removePackage(e.fileUrl):l.path.pkgDir(e.fileUrl),r=l.pkg.directoriesLib(e);return r&&(n=l.path.joinURIs(l.path.addEndingSlash(n),r)),n},isRoot:function(e,t){var n=l.pkg.getDefault(e);return t&&t.name===n.name&&t.version===n.version},homeAlias:function(e){return e&&e.loader&&e.loader.homeAlias||"~"},getDefault:function(e){return e.npmPaths.__default},findByModuleNameOrAddress:function(e,t,n){if(e.npm){if(t){var r=l.moduleName.parse(t);if(r.version&&r.packageName){var i=r.packageName+"@"+r.version;if(i in e.npm)return e.npm[i]}}if(n){var o=l.relativeURI(e.baseURL,n),a=l.pkg.folderAddress(o);return a?e.npmPaths[a]:l.pkg.getDefault(e)}return l.pkg.getDefault(e)}},folderAddress:function(e){var t=e.lastIndexOf("/node_modules/"),n=e.indexOf("/",t+"/node_modules/".length);if(t>=0)return n>=0?e.substr(0,n):e},findDep:function(e,t,n){if(e.npm&&t&&!l.path.startsWithDotSlash(n)){var r=n+"@"+t.resolutions[n];return e.npm[r]}},findDepWalking:function(e,t,n){if(e.npm&&t&&!l.path.startsWithDotSlash(n))for(var r=l.path.depPackageDir(t.fileUrl,n);r;){var i=e.npmPaths[r];if(i)return i;var o=l.path.parentNodeModuleAddress(r);if(!o)return;r=o+"/"+n}},findByName:function(e,t){if(e.npm&&!l.path.startsWithDotSlash(t))return e.npm[t]},findByNameAndVersion:function(e,t,n){if(e.npm&&!l.path.startsWithDotSlash(t)){var r=t+"@"+n;return e.npm[r]}},findByUrl:function(e,t){if(e.npm){var n=l.pkg.folderAddress(t);return e.npmPaths[n]}},directoriesLib:function(e){var t,n=l.pkg.config(e),r=n&&n.directories&&n.directories.lib,i=[".","/"];if(r){for(;t=i.shift();)r[0]===t&&(r=r.substr(1));return r}},hasDirectoriesLib:function(e){var t=l.pkg.config(e);return t&&t.directories&&!!t.directories.lib},findPackageInfo:function(e,t){var n=e.pkgInfo;if(n){var r;return l.forEach(n,function(e){t.name===e.name&&t.version===e.version&&(r=e)}),r}},saveResolution:function(e,t,n){l.pkg.findPackageInfo(e,t).resolutions[n.name]=t.resolutions[n.name]=n.version},config:function(e){return e.steal||e.system}},path:{makeRelative:function(e){return l.path.isRelative(e)&&"/"!==e.substr(0,1)?e:"./"+e},removeJS:function(e){return e.replace(/\.js(!|$)/,function(e,t){return t})},removePackage:function(e){return e.replace(/\/package\.json.*/,"")},addJS:function(e){return/\.js(on)?$/.test(e)?e:e+".js"},isRelative:function(e){return"."===e.substr(0,1)},isInHomeDir:function(e,t){return e.substr(0,2)===l.pkg.homeAlias(t)+"/"},joinURIs:function(e,t){var n=i(t||""),r=i(e||"");return n&&r?(n.protocol||r.protocol)+(n.protocol||n.authority?n.authority:r.authority)+function(e){var t=[];return e.replace(/^(\.\.?(\/|$))+/,"").replace(/\/(\.(\/|$))+/g,"/").replace(/\/\.\.$/,"/../").replace(/\/?[^\/]*/g,function(e){"/.."===e?t.pop():t.push(e)}),t.join("").replace(/^\//,"/"===e.charAt(0)?"/":"")}(n.protocol||n.authority||"/"===n.pathname.charAt(0)?n.pathname:n.pathname?(r.authority&&!r.pathname?"/":"")+r.pathname.slice(0,r.pathname.lastIndexOf("/")+1)+n.pathname:r.pathname)+(n.protocol||n.authority||n.pathname?n.search:n.search||r.search)+n.hash:null},startsWithDotSlash:function(e){return"./"===e.substr(0,2)},removeDotSlash:function(e){return l.path.startsWithDotSlash(e)?e.substr(2):e},endsWithSlash:function(e){return"/"===e[e.length-1]},addEndingSlash:function(e){return l.path.endsWithSlash(e)?e:e+"/"},depPackage:function(e,t){var n=e.replace(/\/package\.json.*/,"");return(n?n+"/":"")+"node_modules/"+t+"/package.json"},peerPackage:function(e,t){var n=e.replace(/\/package\.json.*/,"");return n.substr(0,n.lastIndexOf("/"))+"/"+t+"/package.json"},depPackageDir:function(e,t){return l.path.depPackage(e,t).replace(/\/package\.json.*/,"")},peerNodeModuleAddress:function(e){var t=e.lastIndexOf("/node_modules/");if(t>=0)return e.substr(0,t+"/node_modules/".length-1)},parentNodeModuleAddress:function(e){var t=e.lastIndexOf("/node_modules/"),n=e.lastIndexOf("/node_modules/",t-1);if(n>=0)return e.substr(0,n+"/node_modules/".length-1)},pkgDir:function(e){var t=e.lastIndexOf("/node_modules/"),n=e.indexOf("/",t+"/node_modules/".length);if("@"===e[t+"/node_modules/".length]&&(n=e.indexOf("/",n+1)),t>=0)return n>=0?e.substr(0,n):e},basename:function(e){var t=e.split("/");return t[t.length-1]},relativeTo:function(e,t){for(var n=e.split("/"),r=1;"."===t[r];)n.pop(),r++;return n.join("/")},isPackageRootDir:function(e){return-1===e.indexOf("/")}},json:{transform:function(e,t,n){n.steal=l.pkg.config(n);var r=e.jsonOptions&&e.jsonOptions.transform;return r?r.call(e,t,n):n}},includeInBuild:!0};r.exports=l}(0,0,0,n)}),define("npm-extension",["require","exports","module","@steal","./npm-utils"],function(e,t,n){!function(e,t,n,r){"format cjs";var i=t("@steal"),o=t("./npm-utils");n.includeInBuild=!0;var a="object"==typeof process&&"[object process]"==={}.toString.call(process),s="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,u="undefined"!=typeof window&&!a&&!s;n.addExtension=function(e){function t(e,t){var n=this,r="function"==typeof t.name?t.name(n,e):e.name+t.name,i=o.extend({},e);return i.name=r,i.metadata={dryRun:!0},Promise.resolve(n.locate(i)).then(function(e){return i.address=e,n.fetch(i)}).then(function(t){e.metadata.address=i.address,n.npmParentMap[e.name]=i.name;var r=n.npmContext&&n.npmContext.npmLoad;return r&&(r.saveLoadIfNeeded(n.npmContext),a||o.warnOnce("Some 404s were encountered while loading. Don't panic! These will only happen in dev and are harmless.")),t})}e._extensions&&e._extensions.push(n.addExtension);var r=e.normalize;e.normalize=function(e,t,n,i){function a(e){v.version=e.version,v.modulePath||(v.modulePath=o.pkg.main(e));var t=r.call(I,o.moduleName.create(v),u,n,i);return h&&t.then(function(e){w&&w.forwardSlashMap&&(w.forwardSlashMap[e]=!0)}),t}var s=e,u=t;u&&this.npmParentMap&&this.npmParentMap[u]&&(u=this.npmParentMap[u]);var c=o.path.isRelative(s),l=o.moduleName.isNpm(u),h=o.path.endsWithSlash(s);if(u&&c&&!l)return r.call(this,s,u,n,i);if(o.moduleName.isConditional(s))return r.call(this,s,u,n,i);if("object"==typeof this.map[u]&&this.map[u][s])return r.call(this,s,u,n,i);var p=o.pkg.findByModuleNameOrAddress(this,u,n);if(!p)return r.call(this,s,u,n,i);var f="../"===s||"./"===s;if(l&&f){var d=o.moduleName.parse(u).modulePath||"",m=o.path.relativeTo(d,s);o.path.isPackageRootDir(m)?s=p.name+"#"+o.path.removeJS(p.main):s+="index"}var g,y,v=o.moduleName.parseFromPackage(this,p,s,u),b=o.pkg.isRoot(this,p),_=v.packageName===p.name;l&&c&&_&&(g=p);var w=this.npmContext,k=w&&w.crawl,E=!!k;if(!g)if(k){if((N=c?null:k.matchedVersion(w,p.name,p.version))&&(y=(D=k.getFullDependencyMap(this,N,b))[v.packageName])){var T=p.resolutions&&p.resolutions[y.name]||y.version,S=k.matchedVersion(this.npmContext,y.name,T);S&&(g=o.pkg.findByUrl(this,S.fileUrl))}}else g=b?o.pkg.findDepWalking(this,p,v.packageName):o.pkg.findDep(this,p,v.packageName);if(_&&(g=o.pkg.findByNameAndVersion(this,v.packageName,p.version)),v.isGlobal,g||(g=o.pkg.findByName(this,v.packageName)),E&&g&&y&&!k.pkgSatisfies(g,y.version)?g=void 0:E&&g&&o.pkg.saveResolution(w,p,g),!g){var C=this.globalBrowser[v.packageName];C&&(v.packageName=C.moduleName,g=o.pkg.findByName(this,v.packageName))}if(!g&&b&&s===p.main&&o.pkg.hasDirectoriesLib(p))return v.version=p.version,v.packageName=p.name,v.modulePath=o.pkg.main(p),r.call(this,o.moduleName.create(v),u,n,i);var I=this;if(g)return a(g);if(k){var N=k.matchedVersion(this.npmContext,p.name,p.version);if(N){var D=k.getFullDependencyMap(this,N,b);if(!(g=D[v.packageName])){var A=k.findPackageAndParents(this.npmContext,v.packageName);A&&(g=A.package)}}}if(!g){if(p.browser&&p.browser[s])return r.call(this,p.browser[s],u,n,i);var x=o.pkg.config(p);if(x&&x.map&&"string"==typeof x.map[s]){var O=x.map[s],P=x.envs&&x.envs[I.env];return P&&P.map&&"string"==typeof P.map[s]&&(O=P.map[s]),I.normalize(O,u,n,i)}return r.call(this,s,u,n,i)}return k.dep(this.npmContext,N,p,g,b).then(a)};var s=e.locate;e.locate=function(t){var n=o.moduleName.parse(t.name),r=this,a=t.metadata.parsedModuleName=n;if(t.metadata.npmPackage=o.pkg.findByNameAndVersion(this,a.packageName,a.version),n.version&&this.npm&&!r.paths[t.name]){var c=this.npm[o.moduleName.nameAndVersion(n)];if(c)return s.call(this,t).then(function(a){var s=a,l=o.path.joinURIs(e.baseURL,t.name);if(u&&(l=l.replace(/#/g,"%23")),s!==l+".js"&&s!==l)return s;var h=o.pkg.rootDir(c,o.pkg.isRoot(r,c));if(n.modulePath){var p=o.path.joinURIs(o.path.addEndingSlash(h),n.plugin?n.modulePath:o.path.addJS(n.modulePath));s=void 0!==i?o.path.joinURIs(r.baseURL,p):p}return s})}return s.call(this,t)};var c=e.fetch;e.fetch=function(e){if(e.metadata.dryRun)return c.apply(this,arguments);var n=this,r=(n.npmContext,Promise.resolve(c.apply(this,arguments)));return o.moduleName.isNpm(e.name)&&(r=r.then(null,function(r){function i(r,o){if(!r.length)throw o;var a=r.shift();if(!a.test(e))throw o;return Promise.resolve(t.call(n,e,a)).then(null,function(e){return i(r,e)})}return 404!==r.statusCode?Promise.reject(r):(n.npmContext||(n.npmContext={forwardSlashMap:{}}),i([].slice.call(f),r).then(null,function(e){return Promise.reject(r)}))})),r.catch(function(t){if(404===t.statusCode&&o.moduleName.isBareIdentifier(e.name)&&!o.pkg.isRoot(n,e.metadata.npmPackage)){var r=new Error(["Could not load '"+e.name+"'","Is this an npm module not saved in your package.json?"].join("\n"));throw r.statusCode=t.statusCode,r}throw t})};var l=function(e,t){var n=o.pkg.findByName(e,t.split("/")[0]);if(n){var r=o.moduleName.parse(t,n.name);return r.version=n.version,r.modulePath||(r.modulePath=o.pkg.main(n)),o.moduleName.create(r)}return t},h={map:function(e){var t,n={};for(var r in e)t=e[r],n[l(this,r)]="object"==typeof t?h.map(t):l(this,t);return n},meta:function(e){var t={};for(var n in e)t[l(this,n)]=e[n];return t},paths:function(e){var t={};for(var n in e)t[l(this,n)]=e[n];return t}},p=e.config;e.config=function(e){var t=this;if(t.npmContext){var n=t.npmContext,r=n.versions.__default,i=n.convert.steal(n,r,e,!0);return n.convert.updateConfigOnPackageLoad(i,!1,!0,n.applyBuildConfig),void p.apply(t,arguments)}for(var o in e)h[o]&&(e[o]=h[o].call(t,e[o]));p.apply(t,arguments)},i.addNpmPackages=function(e){for(var t=e||[],n=this.loader,r=0;r<t.length;r+=1){var i=t[r],o=i&&i.fileUrl;o&&(n.npmContext.paths[o]=i)}},i.getNpmPackages=function(){var e=this.loader.npmContext;return e?e.packages||[]:[]};var f=[{name:function(e,t){if(e.npmContext.forwardSlashMap[t.name]){var n=t.name.split("/");return n.pop(),n.concat(["index"]).join("/")}return t.name+"/index"},test:function(){return!0}},{name:".json",test:function(e){return o.moduleName.isNpm(e.name)&&"package.js"===o.path.basename(e.address)}}]}}(0,e,t)}),define("live-reload",[],function(){return function(){}}),define("node_modules/can-zone/register",function(e,t,n){!function(e,t,n,r){"use strict";"format cjs";!function(){function t(e,t){for(var n=t.split(".");n.length>1&&(t=n.shift(),e=e[t]);)1===n.length&&(t=n[0]);return[e,t]}function n(e){var n=e||c,r=n.__canZoneWrapped;r||(r=n.__canZoneWrapped={}),l.call(h,function(e){var a;"object"==typeof e&&(a=e.fn,e=e.prop);var s=e;if(!r[s]){var u=t(n,e),c=u[0];(o(e=u[1])||c&&c[e])&&(r[s]=!0,i(c,e,a,n))}})}function i(e,t,n,r){var i=function(){var e=r.CanZone;return void 0!==e&&e.current?e.tasks[t](n,e).apply(this,arguments):n.apply(this,arguments)},a=Object.getOwnPropertyDescriptor(e,t)||{};o(t)?(n=a.set,a.set=i):(n=n?n(e[t]):e[t],a.value=i,a.writable=!0),Object.defineProperty(e,t,a),i.zoneWrapped=!0}function o(e){return"on"===e.substr(0,2)}function a(e,n,r,o){var s=e[n];Object.defineProperty(e,n,{get:function(){return s},set:function(u){var c=!u.zoneWrapped&&u!==s;if(s=u,c){var l=t(e,r);i(l[0],l[1],null,o),a(e,n,r,o)}}})}var s="undefined"!=typeof process&&"[object process]"==={}.toString.call(process),u="undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope,c="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:s?e:window;void 0!==r&&r.exports&&(r.exports=n);var l=Array.prototype.forEach||function(e){for(var t=0,n=this.length;t<n;t++)e.call(this,this[t],t)},h=Array.prototype.concat.call(["setTimeout","clearTimeout","requestAnimationFrame","cancelAnimationFrame","Promise.prototype.then","XMLHttpRequest.prototype.send","Node.prototype.addEventListener","Node.prototype.removeEventListener","process.nextTick","setImmediate","clearImmediate",{prop:"MutationObserver",fn:function(e){return function(t){return new e(t)}}}],function(){var e=[];return s||u||(e=Object.getOwnPropertyNames(HTMLElement.prototype).filter(o)),e}().map(function(e){return"HTMLElement.prototype."+e}));n(c),c.Promise&&a(c,"Promise","Promise.prototype.then",c)}()}(function(){return this}(),0,0,n)}),define("node_modules/steal-conditional/conditional",["module","exports"],function(e,t){function n(e){function t(e,t){for(var n=e.split(".");n.length;)t=t[n.shift()];return t}function r(e,t){e.getModuleLoad(t).metadata.includeInBuild=!0}var i=/#\{[^\}]+\}|#\?.+$/;"object"==typeof process&&{}.toString.call(process),e._extensions&&e._extensions.push(n),e.set("@@conditional-helpers",e.newModule({isConditionalModuleName:function(e){return i.test(e)}}));var o=e.normalize;e.normalize=function(e,n,a,s){var u=this,c=e.match(i);if(c){var l="?"!==c[0][1],h=l?c[0].substr(2,c[0].length-3):c[0].substr(2),p="default",f=h.match(/^(?:\.\/|\.\.\/)+/),d=h.indexOf(".",f&&f[0].length);-1!==d&&(p=h.substr(d+1),h=h.substr(0,d));var m=!l&&"~"===h[0];m&&(h=h.substr(1));var g=function(){},y=function(r){var h="object"==typeof r?t(p,r):r;if(l){if("string"!=typeof h)throw new TypeError("The condition value for "+c[0]+" doesn't resolve to a string.");e=e.replace(i,h)}else{if("boolean"!=typeof h)throw new TypeError("The condition value for "+c[0]+" isn't resolving to a boolean.");m&&(h=!h),e=h?e.replace(i,""):"@empty"}return"@empty"===e?o.call(u,e,n,a,s):u.normalize.call(u,e,n,a,s)},v=0===(u.env||"").indexOf("build"),b=v?u:u.pluginLoader||u;return b.import(h,{name:n,address:a}).then(function(e){return b.normalize(h,n,a,s).then(function(t){return r(b,t),e})}).then(function(e){return v?g():y(e)})}return Promise.resolve(o.call(u,e,n,a,s))}}t.extensionBuilder="steal-conditional/slim","undefined"!=typeof System&&n(System)}),define("npm-load",[],function(){return{}}),define("semver",[],function(){return{}}),define("npm-crawl",[],function(){return{}}),define("npm-convert",[],function(){return{}}),define("npm",[],function(){return{}}),define("package.json!npm",["@loader","npm-extension","module","live-reload","node_modules/can-zone/register","node_modules/steal-conditional/conditional"],function(e,t,n){t.addExtension(e),e.main||(e.main="devjournal@0.0.0#index.stache!done-autorender"),e._npmExtensions=[].slice.call(arguments,2),function(e,t,r){var i=e.global;i.process||(i.process={argv:[],cwd:function(){return e.baseURL},browser:!0,env:{NODE_ENV:e.env},version:"",platform:navigator&&navigator.userAgent&&/Windows/.test(navigator.userAgent)?"win":""}),e.npm||(e.npm={},e.npmPaths={},e.globalBrowser={}),e.npmParentMap||(e.npmParentMap=r.npmParentMap||{});var o=e.npmPaths.__default=t[0],a=o.steal||o.system,s=(a&&a.directories&&a.directories.lib,function(t,n){for(var r in t)e.globalBrowser[r]={pkg:n,moduleName:t[r]}}),u=function(t,n){e.npm[t]||(e.npm[t]=n),e.npm[t+"@"+n.version]=n},c=function(e,t){for(var n=0,r=e.length;n<r&&(res=t.call(e,e[n],n),!1!==res);n++);},l=["bundle","configDependencies","transpiler"];t.reverse(),c(t,function(t){var n=t.steal||t.system;if(n){var r=n.main;delete n.main;var i=n.configDependencies;t!==o&&c(l,function(e){delete n[e]}),e.config(n),t===o&&(n.configDependencies=i),n.main=r}t.globalBrowser&&("steal"===t.name&&!1===a.builtins||s(t.globalBrowser,t));var h=n&&n.name;h?u(h,t):u(t.name,t),e.npm[t.name]||(e.npm[t.name]=t),e.npm[t.name+"@"+t.version]=t;var p=t.fileUrl.replace(/\/package\.json.*/,"");e.npmPaths[p]=t}),e.liveReloadInstalled&&e.import("live-reload",{name:n.id}).then(function(t){t.dispose(function(){var t=e.npmContext.pkgInfo;delete t[o.name+"@"+o.version];var n=-1;c(t,function(e,t){if(e.name===o.name&&e.version===o.version)return n=t,!1}),t.splice(n,1)})}),c(e._npmExtensions||[],function(t){t.systemConfig&&e.config(t.systemConfig)})}(e,[{name:"devjournal",version:"0.0.0",fileUrl:"./package.json",main:"devjournal/index.stache!done-autorender",steal:{main:"devjournal/index.stache!done-autorender",directories:{lib:"src"},configDependencies:["live-reload","node_modules/can-zone/register","node_modules/steal-conditional/conditional"],plugins:["done-css","done-component","steal-less","steal-stache"],envs:{"server-production":{renderingBaseURL:"https://devjournal-firebase-1.firebaseapp.com/"}},serviceBaseURL:"",npmAlgorithm:"flat"},resolutions:{devjournal:"0.0.0","done-autorender":"2.5.0","can-log":"1.0.0","can-symbol":"1.6.1","full-url":"1.0.0","can-namespace":"1.0.0","can-reflect":"1.17.7","can-stache-bindings":"4.6.4","can-view-import":"4.2.0","can-util":"3.14.0","can-dom-mutate":"1.3.5","can-route":"4.4.6","can-stache":"4.15.9","can-view-scope":"4.12.0","can-zone":"0.6.23","steal-less":"1.3.4","steal-stache":"4.1.2","can-route-pushstate":"4.1.2","can-define":"2.7.1","can-stache-route-helpers":"1.1.3","can-component":"4.4.9",showdown:"1.9.0",firebase:"5.6.0","can-debug":"1.3.0"}},{name:"done-component",version:"2.2.1",fileUrl:"./node_modules/done-component/package.json",main:"component.js",steal:{ext:{component:"done-component"},plugins:["steal-less","steal-stache"]},resolutions:{}},{name:"done-css",version:"3.0.2",fileUrl:"./node_modules/done-css/package.json",main:"css.js",steal:{ext:{css:"done-css"},map:{$css:"done-css@3.0.2#css"},plugins:["steal-css"]},resolutions:{}},{name:"steal-less",version:"1.3.4",fileUrl:"./node_modules/steal-less/package.json",main:"less.js",steal:{plugins:["steal-css"],envs:{build:{map:{"steal-less/less-engine":"steal-less/less-engine-node"}},"server-development":{map:{"steal-less/less-engine":"steal-less/less-engine-node"}},"server-production":{map:{"steal-less/less-engine":"steal-less/less-engine-node"}},"bundle-build":{map:{"steal-less/less-engine":"steal-less/less-engine-node"},meta:{"steal-less/less":{useLocalDeps:!0}}}},ext:{less:"steal-less"},meta:{}},resolutions:{}},{name:"steal-stache",version:"4.1.2",fileUrl:"./node_modules/steal-stache/package.json",main:"steal-stache.js",steal:{main:"steal-stache",configDependencies:["live-reload"],npmIgnore:{documentjs:!0,testee:!0,"steal-tools":!0},npmAlgorithm:"flat",ext:{stache:"steal-stache"}},resolutions:{"can-view-import":"4.2.0","can-stache-bindings":"4.6.4"}},{name:"steal",version:"1.12.6",fileUrl:"./node_modules/steal/package.json",main:"main",steal:{npmDependencies:{"console-browserify":!0,"constants-browserify":!0,"crypto-browserify":!0,"http-browserify":!0,buffer:!0,"os-browserify":!0,"vm-browserify":!0,"zlib-browserify":!0,assert:!0,"domain-browser":!0,events:!0,"https-browserify":!0,"path-browserify":!0,string_decoder:!0,"tty-browserify":!0,process:!0,punycode:!0}},globalBrowser:{console:"console-browserify",constants:"constants-browserify",crypto:"crypto-browserify",http:"http-browserify",buffer:"buffer",os:"os-browserify",vm:"vm-browserify",zlib:"zlib-browserify",assert:"assert",child_process:"steal#ext/builtin/child_process",cluster:"steal#ext/builtin/cluster",dgram:"steal#ext/builtin/dgram",dns:"steal#ext/builtin/dns",domain:"domain-browser",events:"events",fs:"steal#ext/builtin/fs",https:"https-browserify",module:"steal#ext/builtin/module",net:"steal#ext/builtin/net",path:"path-browserify",process:"process",querystring:"steal#ext/builtin/querystring",readline:"steal#ext/builtin/readline",repl:"steal#ext/builtin/repl",stream:"steal#ext/builtin/stream",string_decoder:"string_decoder",sys:"steal#ext/builtin/sys",timers:"steal#ext/builtin/timers",tls:"steal#ext/builtin/tls",tty:"tty-browserify",url:"steal#ext/builtin/url",util:"steal#ext/builtin/util",_stream_readable:"steal#ext/builtin/_stream_readable",_stream_writable:"steal#ext/builtin/_stream_writable",_stream_duplex:"steal#ext/builtin/_stream_duplex",_stream_transform:"steal#ext/builtin/_stream_transform",_stream_passthrough:"steal#ext/builtin/_stream_passthrough"},resolutions:{}},{name:"steal-css",version:"1.3.2",fileUrl:"./node_modules/steal-css/package.json",main:"css.js",steal:{ext:{css:"steal-css"},map:{$css:"steal-css@1.3.2#css"}},resolutions:{}},{name:"assert",version:"1.4.1",fileUrl:"./node_modules/assert/package.json",main:"./assert.js",resolutions:{}},{name:"buffer",version:"5.0.8",fileUrl:"./node_modules/buffer/package.json",main:"index.js",jspm:{},resolutions:{}},{name:"console-browserify",version:"1.1.0",fileUrl:"./node_modules/console-browserify/package.json",main:"index",resolutions:{}},{name:"domain-browser",version:"1.1.7",fileUrl:"./node_modules/domain-browser/package.json",main:"./index.js",jspm:{},resolutions:{}},{name:"events",version:"1.1.1",fileUrl:"./node_modules/events/package.json",main:"./events.js",resolutions:{}},{name:"constants-browserify",version:"1.0.0",fileUrl:"./node_modules/constants-browserify/package.json",main:"constants.json",resolutions:{}},{name:"http-browserify",version:"1.7.0",fileUrl:"./node_modules/http-browserify/package.json",main:"index.js",browser:"index.js",resolutions:{}},{name:"https-browserify",version:"1.0.0",fileUrl:"./node_modules/https-browserify/package.json",main:"index.js",resolutions:{}},{name:"crypto-browserify",version:"3.11.1",fileUrl:"./node_modules/crypto-browserify/package.json",browser:{crypto:"@empty"},resolutions:{}},{name:"process",version:"0.11.10",fileUrl:"./node_modules/process/package.json",main:"./index.js",browser:"./browser.js",resolutions:{}},{name:"os-browserify",version:"0.3.0",fileUrl:"./node_modules/os-browserify/package.json",main:"main.js",browser:"browser.js",jspm:{},resolutions:{}},{name:"path-browserify",version:"0.0.1",fileUrl:"./node_modules/path-browserify/package.json",main:"index.js",resolutions:{}},{name:"punycode",version:"2.0.1",fileUrl:"./node_modules/punycode/package.json",main:"punycode.js",jspm:{},resolutions:{}},{name:"string_decoder",version:"1.1.1",fileUrl:"./node_modules/string_decoder/package.json",main:"lib/string_decoder.js",resolutions:{}},{name:"zlib-browserify",version:"0.0.3",fileUrl:"./node_modules/zlib-browserify/package.json",main:"index.js",resolutions:{}},{name:"tty-browserify",version:"0.0.1",fileUrl:"./node_modules/tty-browserify/package.json",main:"index.js",resolutions:{}},{name:"vm-browserify",version:"0.0.4",fileUrl:"./node_modules/vm-browserify/package.json",main:"index.js",resolutions:{}},{name:"string_decoder",version:"1.0.3",fileUrl:"./node_modules/steal/node_modules/string_decoder/package.json",main:"lib/string_decoder.js",resolutions:{}},{name:"done-autorender",version:"2.5.0",fileUrl:"./node_modules/done-autorender/package.json",main:"src/autorender.js",resolutions:{"can-stache":"4.15.9","can-dom-mutate":"1.3.5","can-route":"4.4.6","can-view-scope":"4.12.0","can-util":"3.14.0","can-reflect":"1.17.7","can-symbol":"1.6.1","can-namespace":"1.0.0","can-log":"1.0.0","can-stache-bindings":"4.6.4","can-view-import":"4.2.0","can-zone":"0.6.23","full-url":"1.0.0"}},{name:"can-zone",version:"0.6.23",fileUrl:"./node_modules/can-zone/package.json",main:"lib/zone.js",steal:{npmDependencies:{"steal-mocha":!0,mocha:!0,chai:!0},map:{"can-zone@0.6.23#assert":"chai/chai"},meta:{"chai/chai":{format:"global",exports:"chai.assert"}},plugins:["chai"]},resolutions:{"can-zone":"0.6.23"}},{name:"steal-config-utils",version:"1.0.0",fileUrl:"./node_modules/steal-config-utils/package.json",main:"main.js",resolutions:{}},{name:"can-stache-ast",version:"1.1.0",fileUrl:"./node_modules/can-stache-ast/package.json",main:"can-stache-ast.js",resolutions:{"can-stache-ast":"1.1.0","can-view-parser":"4.1.2"}},{name:"can-reflect",version:"1.17.7",fileUrl:"./node_modules/can-reflect/package.json",main:"can-reflect",resolutions:{"can-reflect":"1.17.7","can-namespace":"1.0.0","can-symbol":"1.6.1"}},{name:"can-namespace",version:"1.0.0",fileUrl:"./node_modules/can-namespace/package.json",main:"can-namespace",steal:{npmAlgorithm:"flat"},resolutions:{}},{name:"can-view-parser",version:"4.1.2",fileUrl:"./node_modules/can-view-parser/package.json",main:"can-view-parser",resolutions:{"can-namespace":"1.0.0","can-log":"1.0.0","can-attribute-encoder":"1.1.1"}},{name:"can-symbol",version:"1.6.1",fileUrl:"./node_modules/can-symbol/package.json",main:"can-symbol",steal:{npmIgnore:{testee:!0,"generator-donejs":!0,"donejs-cli":!0,"steal-tools":!0},main:"can-symbol"},resolutions:{"can-namespace":"1.0.0"}},{name:"can-log",version:"1.0.0",fileUrl:"./node_modules/can-log/package.json",main:"dist/cjs/can-log",steal:{npmIgnore:{testee:!0,"generator-donejs":!0,"donejs-cli":!0,"steal-tools":!0},main:"can-log"},resolutions:{"can-log":"1.0.0"}},{name:"can-attribute-encoder",version:"1.1.1",fileUrl:"./node_modules/can-attribute-encoder/package.json",main:"can-attribute-encoder",steal:{npmIgnore:{testee:!0,"steal-tools":!0},main:"can-attribute-encoder"},resolutions:{"can-namespace":"1.0.0","can-log":"1.0.0"}},{name:"can-stache",version:"4.15.9",fileUrl:"./node_modules/can-stache/package.json",main:"can-stache",resolutions:{"can-stache":"4.15.9","can-log":"1.0.0","can-namespace":"1.0.0","can-reflect":"1.17.7","can-view-scope":"4.12.0","can-symbol":"1.6.1","can-assign":"1.3.1","can-globals":"1.2.0","can-view-nodelist":"4.3.2","can-view-callbacks":"4.3.2","can-view-parser":"4.1.2","can-stache-ast":"1.1.0","can-attribute-encoder":"1.1.1","can-observation-recorder":"1.3.0","can-view-target":"4.1.2","can-import-module":"1.2.0","can-dom-mutate":"1.3.5","can-observation":"4.1.1","can-stache-key":"1.4.0","can-stache-helpers":"1.2.0","can-dom-data-state":"1.0.5","can-define-lazy-value":"1.1.0","can-fragment":"1.3.0","can-view-live":"4.2.7","can-simple-observable":"2.4.1","can-dom-data":"1.0.1","can-join-uris":"1.2.0"}},{name:"can-dom-mutate",version:"1.3.5",fileUrl:"./node_modules/can-dom-mutate/package.json",main:"can-dom-mutate",steal:{main:"can-dom-mutate"},resolutions:{"can-namespace":"1.0.0","can-dom-mutate":"1.3.5","can-reflect":"1.17.7","can-globals":"1.2.0"}},{name:"can-route",version:"4.4.6",fileUrl:"./node_modules/can-route/package.json",main:"can-route",resolutions:{"can-namespace":"1.0.0","can-log":"1.0.0","can-reflect":"1.17.7","can-symbol":"1.6.1","can-route":"4.4.6","can-bind":"1.2.0","can-queues":"1.2.1","can-observation":"4.1.1","can-route-hash":"1.0.1","can-simple-observable":"2.4.1","can-globals":"1.2.0","can-define":"2.7.1","can-string":"1.0.0","can-deparam":"1.2.0","can-param":"1.1.0","can-diff":"1.4.2"}},{name:"can-view-scope",version:"4.12.0",fileUrl:"./node_modules/can-view-scope/package.json",main:"can-view-scope",resolutions:{"can-view-scope":"4.12.0","can-namespace":"1.0.0","can-reflect":"1.17.7","can-log":"1.0.0","can-observation-recorder":"1.3.0","can-stache-key":"1.4.0","can-stache-helpers":"1.2.0","can-define-lazy-value":"1.1.0","can-simple-map":"4.3.0","can-assign":"1.3.1","can-single-reference":"1.2.0","can-observation":"4.1.1","can-symbol":"1.6.1","can-reflect-dependencies":"1.1.1","can-event-queue":"1.1.3","can-simple-observable":"2.4.1"}},{name:"can-util",version:"3.14.0",fileUrl:"./node_modules/can-util/package.json",main:"can-util",resolutions:{"can-namespace":"1.0.0","can-assign":"1.3.1"}},{name:"can-stache-bindings",version:"4.6.4",fileUrl:"./node_modules/can-stache-bindings/package.json",main:"can-stache-bindings",steal:{main:"can-stache-bindings"},resolutions:{"can-stache":"4.15.9","can-log":"1.0.0","can-dom-mutate":"1.3.5","can-symbol":"1.6.1","can-reflect":"1.17.7","can-view-scope":"4.12.0","can-bind":"1.2.0","can-queues":"1.2.1","can-attribute-encoder":"1.1.1","can-view-model":"4.0.1","can-stache-key":"1.4.0","can-reflect-dependencies":"1.1.1","can-attribute-observable":"1.2.0","can-view-callbacks":"4.3.2","can-observation-recorder":"1.3.0","can-simple-observable":"2.4.1","can-assign":"1.3.1","can-dom-data-state":"1.0.5","can-view-nodelist":"4.3.2"}},{name:"can-view-import",version:"4.2.0",fileUrl:"./node_modules/can-view-import/package.json",main:"can-view-import",resolutions:{"can-symbol":"1.6.1","can-dom-mutate":"1.3.5","can-log":"1.0.0","can-assign":"1.3.1","can-globals":"1.2.0","can-dom-data-state":"1.0.5","can-child-nodes":"1.2.0","can-view-nodelist":"4.3.2","can-view-callbacks":"4.3.2","can-import-module":"1.2.0"}},{name:"full-url",version:"1.0.0",fileUrl:"./node_modules/full-url/package.json",main:"index.js",browser:"browser.js",resolutions:{}},{name:"can-assign",version:"1.3.1",fileUrl:"./node_modules/can-assign/package.json",main:"dist/cjs/can-assign",steal:{npmIgnore:{testee:!0,"generator-donejs":!0,"donejs-cli":!0,"steal-tools":!0},main:"can-assign"},resolutions:{"can-namespace":"1.0.0"}},{name:"can-globals",version:"1.2.0",fileUrl:"./node_modules/can-globals/package.json",main:"can-globals.js",resolutions:{"can-globals":"1.2.0","can-namespace":"1.0.0","can-reflect":"1.17.7"}},{name:"can-dom-data-state",version:"1.0.5",fileUrl:"./node_modules/can-dom-data-state/package.json",main:"can-dom-data-state.js",steal:{npmIgnore:{testee:!0,"generator-donejs":!0,"donejs-cli":!0,"steal-tools":!0},main:"can-dom-data-state"},resolutions:{"can-namespace":"1.0.0","can-dom-mutate":"1.3.5","can-cid":"1.3.0"}},{name:"can-child-nodes",version:"1.2.0",fileUrl:"./node_modules/can-child-nodes/package.json",main:"can-child-nodes",steal:{npmIgnore:{testee:!0,"generator-donejs":!0,"donejs-cli":!0,"steal-tools":!0}},resolutions:{"can-namespace":"1.0.0"}},{name:"can-route-pushstate",version:"4.1.2",fileUrl:"./node_modules/can-route-pushstate/package.json",main:"can-route-pushstate",resolutions:{"can-route":"4.4.6","can-reflect":"1.17.7","can-queues":"1.2.1","can-simple-observable":"2.4.1","can-observation-recorder":"1.3.0","can-globals":"1.2.0","can-util":"3.14.0","can-dom-events":"1.3.3","can-key-tree":"1.2.0"}},{name:"can-define",version:"2.7.1",fileUrl:"./node_modules/can-define/package.json",main:"can-define.js",resolutions:{"can-define":"2.7.1","can-observation-recorder":"1.3.0","can-namespace":"1.0.0","can-log":"1.0.0","can-reflect":"1.17.7","can-symbol":"1.6.1","can-queues":"1.2.1","can-event-queue":"1.1.3","can-construct":"3.5.3","can-assign":"1.3.1","can-diff":"1.4.2","can-single-reference":"1.2.0","can-observation":"4.1.1","can-simple-observable":"2.4.1","can-define-lazy-value":"1.1.0","can-string-to-any":"1.2.0","can-data-types":"1.2.0"}},{name:"can-view-nodelist",version:"4.3.2",fileUrl:"./node_modules/can-view-nodelist/package.json",main:"can-view-nodelist",resolutions:{"can-namespace":"1.0.0","can-dom-mutate":"1.3.5"}},{name:"can-view-callbacks",version:"4.3.2",fileUrl:"./node_modules/can-view-callbacks/package.json",main:"can-view-callbacks",resolutions:{"can-observation-recorder":"1.3.0","can-log":"1.0.0","can-globals":"1.2.0","can-dom-mutate":"1.3.5","can-namespace":"1.0.0","can-view-nodelist":"4.3.2","can-symbol":"1.6.1","can-reflect":"1.17.7","can-fragment":"1.3.0"}},{name:"can-import-module",version:"1.2.0",fileUrl:"./node_modules/can-import-module/package.json",main:"can-import-module.js",resolutions:{"can-globals":"1.2.0","can-namespace":"1.0.0"}},{name:"can-stache-route-helpers",version:"1.1.3",fileUrl:"./node_modules/can-stache-route-helpers/package.json",main:"can-stache-route-helpers",steal:{npmIgnore:{testee:!0,"generator-donejs":!0,"donejs-cli":!0,"steal-tools":!0}},resolutions:{"can-stache":"4.15.9","can-route":"4.4.6","can-reflect":"1.17.7"}},{name:"can-component",version:"4.4.9",fileUrl:"./node_modules/can-component/package.json",main:"can-component",steal:{},resolutions:{"can-component":"4.4.9","can-namespace":"1.0.0","can-bind":"1.2.0","can-stache":"4.15.9","can-stache-bindings":"4.6.4","can-view-scope":"4.12.0","can-view-callbacks":"4.3.2","can-view-nodelist":"4.3.2","can-reflect":"1.17.7","can-stache-key":"1.4.0","can-simple-observable":"2.4.1","can-simple-map":"4.3.0","can-define":"2.7.1","can-log":"1.0.0","can-assign":"1.3.1","can-observation-recorder":"1.3.0","can-view-model":"4.0.1","can-dom-data-state":"1.0.5","can-child-nodes":"1.2.0","can-dom-mutate":"1.3.5","can-symbol":"1.6.1","can-globals":"1.2.0","can-construct":"3.5.3","can-string":"1.0.0","can-dom-events":"1.3.3","can-control":"4.4.1"}},{name:"showdown",version:"1.9.0",fileUrl:"./node_modules/showdown/package.json",main:"./dist/showdown.js",resolutions:{}},{name:"can-bind",version:"1.2.0",fileUrl:"./node_modules/can-bind/package.json",main:"can-bind",steal:{npmIgnore:{"steal-tools":!0,testee:!0},main:"can-bind"},resolutions:{"can-reflect":"1.17.7","can-symbol":"1.6.1","can-namespace":"1.0.0","can-queues":"1.2.1","can-assign":"1.3.1","can-log":"1.0.0","can-reflect-dependencies":"1.1.1"}},{name:"can-queues",version:"1.2.1",fileUrl:"./node_modules/can-queues/package.json",main:"./can-queues.js",steal:{npmIgnore:{testee:!0,"generator-donejs":!0,"donejs-cli":!0,"steal-tools":!0},main:"can-queues"},resolutions:{"can-log":"1.0.0","can-queues":"1.2.1","can-namespace":"1.0.0","can-assign":"1.3.1"}},{name:"can-observation",version:"4.1.1",fileUrl:"./node_modules/can-observation/package.json",main:"can-observation",steal:{npmAlgorithm:"flat"},resolutions:{"can-namespace":"1.0.0","can-reflect":"1.17.7","can-queues":"1.2.1","can-observation-recorder":"1.3.0","can-symbol":"1.6.1","can-log":"1.0.0","can-observation":"4.1.1","can-event-queue":"1.1.3"}},{name:"can-route-hash",version:"1.0.1",fileUrl:"./node_modules/can-route-hash/package.json",main:"./can-route-hash.js",resolutions:{"can-globals":"1.2.0","can-reflect":"1.17.7","can-observation-recorder":"1.3.0","can-queues":"1.2.1","can-simple-observable":"2.4.1","can-dom-events":"1.3.3","can-key-tree":"1.2.0"}},{name:"can-simple-observable",version:"2.4.1",fileUrl:"./node_modules/can-simple-observable/package.json",main:"can-simple-observable",steal:{npmIgnore:{testee:!0,"steal-tools":!0}},resolutions:{"can-reflect":"1.17.7","can-simple-observable":"2.4.1","can-namespace":"1.0.0","can-symbol":"1.6.1","can-observation-recorder":"1.3.0","can-observation":"4.1.1","can-event-queue":"1.1.3","can-queues":"1.2.1","can-log":"1.0.0"}},{name:"can-observation-recorder",version:"1.3.0",fileUrl:"./node_modules/can-observation-recorder/package.json",main:"./can-observation-recorder.js",steal:{npmIgnore:{testee:!0,"generator-donejs":!0,"donejs-cli":!0,"steal-tools":!0}},resolutions:{"can-namespace":"1.0.0","can-symbol":"1.6.1"}},{name:"can-view-target",version:"4.1.2",fileUrl:"./node_modules/can-view-target/package.json",main:"can-view-target",resolutions:{"can-globals":"1.2.0","can-dom-mutate":"1.3.5","can-namespace":"1.0.0"}},{name:"can-view-model",version:"4.0.1",fileUrl:"./node_modules/can-view-model/package.json",main:"can-view-model",resolutions:{"can-simple-map":"4.3.0","can-namespace":"1.0.0","can-globals":"1.2.0","can-reflect":"1.17.7","can-symbol":"1.6.1"}},{name:"can-stache-key",version:"1.4.0",fileUrl:"./node_modules/can-stache-key/package.json",main:"can-stache-key",steal:{npmIgnore:{testee:!0,"generator-donejs":!0,"donejs-cli":!0,"steal-tools":!0},main:"can-stache-key"},resolutions:{"can-observation-recorder":"1.3.0","can-log":"1.0.0","can-symbol":"1.6.1","can-reflect":"1.17.7","can-reflect-promise":"2.2.0"}},{name:"can-reflect-dependencies",version:"1.1.1",fileUrl:"./node_modules/can-reflect-dependencies/package.json",main:"can-reflect-dependencies.js",resolutions:{"can-reflect-dependencies":"1.1.1","can-reflect":"1.17.7","can-symbol":"1.6.1","can-assign":"1.3.1"}},{name:"can-attribute-observable",version:"1.2.0",fileUrl:"./node_modules/can-attribute-observable/package.json",main:"can-attribute-observable",resolutions:{"can-queues":"1.2.1","can-attribute-observable":"1.2.0","can-reflect":"1.17.7","can-observation":"4.1.1","can-reflect-dependencies":"1.1.1","can-observation-recorder":"1.3.0","can-simple-observable":"2.4.1","can-assign":"1.3.1","can-symbol":"1.6.1","can-dom-events":"1.3.3","can-event-dom-radiochange":"2.2.0","can-globals":"1.2.0","can-dom-data-state":"1.0.5","can-dom-mutate":"1.3.5","can-diff":"1.4.2"}},{name:"can-stache-helpers",version:"1.2.0",fileUrl:"./node_modules/can-stache-helpers/package.json",main:"can-stache-helpers",steal:{npmIgnore:{testee:!0,"generator-donejs":!0,"donejs-cli":!0,"steal-tools":!0}},resolutions:{"can-namespace":"1.0.0"}},{name:"can-define-lazy-value",version:"1.1.0",fileUrl:"./node_modules/can-define-lazy-value/package.json",main:"define-lazy-value",steal:{npmIgnore:{testee:!0,"steal-tools":!0}},resolutions:{}},{name:"can-simple-map",version:"4.3.0",fileUrl:"./node_modules/can-simple-map/package.json",main:"can-simple-map",steal:{npmIgnore:{documentjs:!0,testee:!0,"generator-donejs":!0,"donejs-cli":!0,"steal-tools":!0},main:"can-simple-map"},resolutions:{"can-queues":"1.2.1","can-observation-recorder":"1.3.0","can-reflect":"1.17.7","can-log":"1.0.0","can-symbol":"1.6.1","can-construct":"3.5.3","can-event-queue":"1.1.3"}},{name:"can-cid",version:"1.3.0",fileUrl:"./node_modules/can-cid/package.json",main:"can-cid",resolutions:{"can-namespace":"1.0.0"}},{name:"firebase",version:"5.6.0",fileUrl:"./node_modules/firebase/package.json",main:"dist/index.node.cjs.js",browser:"dist/index.cjs.js",resolutions:{"@firebase/polyfill":"0.3.3","@firebase/app":"0.3.5","@firebase/auth":"0.8.0","@firebase/database":"0.3.7","@firebase/messaging":"0.3.7","@firebase/functions":"0.3.3","@firebase/firestore":"0.8.8","@firebase/storage":"0.2.4"}},{name:"can-string",version:"1.0.0",fileUrl:"./node_modules/can-string/package.json",main:"can-string",steal:{npmIgnore:{testee:!0,"generator-donejs":!0,"donejs-cli":!0,"steal-tools":!0},plugins:["steal-less","steal-stache"]},resolutions:{}},{name:"can-deparam",version:"1.2.0",fileUrl:"./node_modules/can-deparam/package.json",main:"can-deparam",steal:{npmIgnore:{testee:!0,"generator-donejs":!0,"donejs-cli":!0,"steal-tools":!0}},resolutions:{"can-namespace":"1.0.0"}},{name:"can-param",version:"1.1.0",fileUrl:"./node_modules/can-param/package.json",main:"can-param",steal:{npmIgnore:{testee:!0,"generator-donejs":!0,"donejs-cli":!0,"steal-tools":!0}},resolutions:{"can-namespace":"1.0.0"}},{name:"can-dom-events",version:"1.3.3",fileUrl:"./node_modules/can-dom-events/package.json",main:"can-dom-events",resolutions:{"can-namespace":"1.0.0","can-dom-events":"1.3.3","can-globals":"1.2.0","can-key-tree":"1.2.0","can-reflect":"1.17.7"}},{name:"can-diff",version:"1.4.2",fileUrl:"./node_modules/can-diff/package.json",main:"can-diff",steal:{main:"can-diff"},resolutions:{"can-reflect":"1.17.7","can-key-tree":"1.2.0","can-symbol":"1.6.1","can-diff":"1.4.2","can-queues":"1.2.1"}},{name:"can-key-tree",version:"1.2.0",fileUrl:"./node_modules/can-key-tree/package.json",main:"dist/cjs/can-key-tree",steal:{npmIgnore:{testee:!0,"generator-donejs":!0,"donejs-cli":!0,"steal-tools":!0},plugins:["steal-less","steal-stache"],main:"can-key-tree"},resolutions:{"can-reflect":"1.17.7"}},{name:"can-event-queue",version:"1.1.3",fileUrl:"./node_modules/can-event-queue/package.json",main:"./can-event-queue.js",steal:{npmIgnore:{testee:!0,"generator-donejs":!0,"donejs-cli":!0,"steal-tools":!0},plugins:["steal-less","steal-stache"]},resolutions:{"can-reflect":"1.17.7","can-symbol":"1.6.1","can-key-tree":"1.2.0","can-queues":"1.2.1","can-define-lazy-value":"1.1.0","can-event-queue":"1.1.3","can-log":"1.0.0","can-dom-events":"1.3.3"}},{name:"can-fragment",version:"1.3.0",fileUrl:"./node_modules/can-fragment/package.json",main:"can-fragment",steal:{npmIgnore:{testee:!0,"generator-donejs":!0,"donejs-cli":!0,"steal-tools":!0}},resolutions:{"can-globals":"1.2.0","can-namespace":"1.0.0","can-reflect":"1.17.7","can-child-nodes":"1.2.0","can-symbol":"1.6.1"}},{name:"can-construct",version:"3.5.3",fileUrl:"./node_modules/can-construct/package.json",main:"can-construct",steal:{},resolutions:{"can-reflect":"1.17.7","can-log":"1.0.0","can-namespace":"1.0.0","can-string":"1.0.0"}},{name:"can-view-live",version:"4.2.7",fileUrl:"./node_modules/can-view-live/package.json",main:"can-view-live",steal:{npmIgnore:{documentjs:!0,testee:!0,"generator-donejs":!0,"donejs-cli":!0,"steal-tools":!0},main:"can-view-live"},resolutions:{"can-view-live":"4.2.7","can-view-nodelist":"4.3.2","can-fragment":"1.3.0","can-child-nodes":"1.2.0","can-reflect":"1.17.7","can-symbol":"1.6.1","can-queues":"1.2.1","can-view-parser":"4.1.2","can-dom-mutate":"1.3.5","can-reflect-dependencies":"1.1.1","can-view-callbacks":"4.3.2","can-attribute-observable":"1.2.0","can-simple-observable":"2.4.1","can-diff":"1.4.2"}},{name:"can-single-reference",version:"1.2.0",fileUrl:"./node_modules/can-single-reference/package.json",main:"can-single-reference",steal:{npmIgnore:{testee:!0,"generator-donejs":!0,"donejs-cli":!0,"steal-tools":!0}},resolutions:{"can-cid":"1.3.0"}},{name:"can-event-dom-radiochange",version:"2.2.0",fileUrl:"./node_modules/can-event-dom-radiochange/package.json",main:"can-event-dom-radiochange",steal:{npmIgnore:{testee:!0,"steal-tools":!0},main:"can-event-dom-radiochange"},resolutions:{"can-globals":"1.2.0","can-namespace":"1.0.0"}},{name:"can-dom-data",version:"1.0.1",fileUrl:"./node_modules/can-dom-data/package.json",main:"can-dom-data.js",steal:{npmIgnore:{"steal-tools":!0,testee:!0},main:"can-dom-data"},resolutions:{"can-namespace":"1.0.0"}},{name:"can-join-uris",version:"1.2.0",fileUrl:"./node_modules/can-join-uris/package.json",main:"can-join-uris",steal:{},resolutions:{"can-namespace":"1.0.0","can-parse-uri":"1.2.0"}},{name:"can-reflect-promise",version:"2.2.0",fileUrl:"./node_modules/can-reflect-promise/package.json",main:"can-reflect-promise",steal:{npmAlgorithm:"flat"},resolutions:{"can-reflect":"1.17.7","can-symbol":"1.6.1","can-observation-recorder":"1.3.0","can-queues":"1.2.1","can-key-tree":"1.2.0","can-log":"1.0.0"}},{name:"@firebase/polyfill",version:"0.3.3",fileUrl:"./node_modules/@firebase/polyfill/package.json",main:"dist/index.cjs.js",resolutions:{"whatwg-fetch":"2.0.4"}},{name:"@firebase/app",version:"0.3.5",fileUrl:"./node_modules/@firebase/app/package.json",main:"dist/index.node.cjs.js",browser:"dist/index.cjs.js",resolutions:{"@firebase/util":"0.2.3"}},{name:"@firebase/auth",version:"0.8.0",fileUrl:"./node_modules/@firebase/auth/package.json",main:"dist/auth.js",resolutions:{"@firebase/app":"0.3.5"}},{name:"@firebase/database",version:"0.3.7",fileUrl:"./node_modules/@firebase/database/package.json",main:"dist/index.node.cjs.js",browser:"dist/index.cjs.js",resolutions:{"@firebase/util":"0.2.3",tslib:"1.9.0","@firebase/app":"0.3.5","@firebase/logger":"0.1.2"}},{name:"@firebase/messaging",version:"0.3.7",fileUrl:"./node_modules/@firebase/messaging/package.json",main:"dist/index.cjs.js",resolutions:{"@firebase/util":"0.2.3","@firebase/app":"0.3.5",tslib:"1.9.0"}},{name:"@firebase/functions",version:"0.3.3",fileUrl:"./node_modules/@firebase/functions/package.json",main:"dist/index.node.cjs.js",browser:"dist/index.cjs.js",resolutions:{"@firebase/app":"0.3.5",tslib:"1.9.0"}},{name:"@firebase/firestore",version:"0.8.8",fileUrl:"./node_modules/@firebase/firestore/package.json",main:"dist/index.node.cjs.js",browser:"dist/index.cjs.js",resolutions:{"@firebase/app":"0.3.5","@firebase/logger":"0.1.2",tslib:"1.9.0","@firebase/webchannel-wrapper":"0.2.11"}},{name:"@firebase/storage",version:"0.2.4",fileUrl:"./node_modules/@firebase/storage/package.json",main:"dist/index.cjs.js",resolutions:{"@firebase/app":"0.3.5"}},{name:"can-control",version:"4.4.1",fileUrl:"./node_modules/can-control/package.json",main:"can-control",resolutions:{"can-construct":"3.5.3","can-namespace":"1.0.0","can-assign":"1.3.1","can-stache-key":"1.4.0","can-reflect":"1.17.7","can-observation":"4.1.1","can-event-queue":"1.1.3","can-log":"1.0.0","can-string":"1.0.0","can-dom-mutate":"1.3.5","can-symbol":"1.6.1","can-key":"1.2.0"}},{name:"can-parse-uri",version:"1.2.0",fileUrl:"./node_modules/can-parse-uri/package.json",main:"can-parse-uri",steal:{npmIgnore:{testee:!0,"generator-donejs":!0,"donejs-cli":!0,"steal-tools":!0},main:"can-parse-uri"},resolutions:{"can-namespace":"1.0.0"}},{name:"can-string-to-any",version:"1.2.0",fileUrl:"./node_modules/can-string-to-any/package.json",main:"can-string-to-any",steal:{npmIgnore:{testee:!0,"generator-donejs":!0,"donejs-cli":!0,"steal-tools":!0},main:"can-string-to-any"},resolutions:{}},{name:"can-data-types",version:"1.2.0",fileUrl:"./node_modules/can-data-types/package.json",main:"can-data-types",steal:{npmIgnore:{testee:!0,"generator-donejs":!0,"donejs-cli":!0,"steal-tools":!0},main:"can-data-types"},resolutions:{"can-reflect":"1.17.7"}},{name:"@firebase/util",version:"0.2.3",fileUrl:"./node_modules/@firebase/util/package.json",main:"dist/index.node.cjs.js",browser:"dist/index.cjs.js",resolutions:{tslib:"1.9.0"}},{name:"can-key",version:"1.2.0",fileUrl:"./node_modules/can-key/package.json",main:"can-key",steal:{npmIgnore:{testee:!0,"generator-donejs":!0,"donejs-cli":!0,"steal-tools":!0},plugins:["steal-less","steal-stache"],main:"can-key"},resolutions:{"can-reflect":"1.17.7","can-key":"1.2.0"}},{name:"tslib",version:"1.9.0",fileUrl:"./node_modules/@firebase/functions/node_modules/tslib/package.json",main:"tslib.js",resolutions:{}},{name:"whatwg-fetch",version:"2.0.4",fileUrl:"./node_modules/@firebase/polyfill/node_modules/whatwg-fetch/package.json",main:"fetch.js",resolutions:{}},{name:"@firebase/logger",version:"0.1.2",fileUrl:"./node_modules/@firebase/logger/package.json",main:"dist/index.cjs.js",resolutions:{}},{name:"@firebase/webchannel-wrapper",version:"0.2.11",fileUrl:"./node_modules/@firebase/webchannel-wrapper/package.json",main:"dist/index.js",resolutions:{}},{name:"can-debug",version:"1.3.0",fileUrl:"./node_modules/can-debug/package.json",main:"can-debug",steal:{npmIgnore:{testee:!0,"steal-tools":!0},main:"can-debug"},resolutions:{}}],{npmParentMap:{}})}),define("can-log@1.0.0#can-log",function(e,t,n){"use strict";t.warnTimeout=5e3,t.logLevel=0,t.warn=function(){this.logLevel<2&&("undefined"!=typeof console&&console.warn?this._logger("warn",Array.prototype.slice.call(arguments)):"undefined"!=typeof console&&console.log&&this._logger("log",Array.prototype.slice.call(arguments)))},t.log=function(){this.logLevel<1&&"undefined"!=typeof console&&console.log&&this._logger("log",Array.prototype.slice.call(arguments))},t.error=function(){this.logLevel<1&&"undefined"!=typeof console&&console.error&&this._logger("error",Array.prototype.slice.call(arguments))},t._logger=function(e,t){try{console[e].apply(console,t)}catch(n){console[e](t)}}}),define("can-log@1.0.0#dev/dev",["require","exports","module","../can-log"],function(e,t,n){"use strict";var r=e("../can-log");n.exports={warnTimeout:5e3,logLevel:0,stringify:function(e){return JSON.stringify(e,function(e,t){return void 0===t?"/* void(undefined) */":t},"  ").replace(/"\/\* void\(undefined\) \*\/"/g,"undefined")},warn:function(){},log:function(){},error:function(){},_logger:r._logger}}),define("can-namespace@1.0.0#can-namespace",function(e,t,n){n.exports={}}),define("can-symbol@1.6.1#can-symbol",["require","exports","module","can-namespace"],function(e,t,n){!function(e,t,n,r){var i,o=t("can-namespace");if("undefined"!=typeof Symbol&&"function"==typeof Symbol.for)i=Symbol;else{var a=0,s={},u={};(i=function(e){var t="@@symbol"+a+++e,n={};return Object.defineProperties(n,{toString:{value:function(){return t}}}),n}).for=function(e){var t=s[e];return t||(t=s[e]=i(e),u[t]=e),t},i.keyFor=function(e){return u[e]},["hasInstance","isConcatSpreadable","iterator","match","prototype","replace","search","species","split","toPrimitive","toStringTag","unscopables"].forEach(function(e){i[e]=i("Symbol."+e)})}["isMapLike","isListLike","isValueLike","isFunctionLike","getOwnKeys","getOwnKeyDescriptor","proto","getOwnEnumerableKeys","hasOwnKey","hasKey","size","getName","getIdentity","assignDeep","updateDeep","getValue","setValue","getKeyValue","setKeyValue","updateValues","addValue","removeValues","apply","new","onValue","offValue","onKeyValue","offKeyValue","getKeyDependencies","getValueDependencies","keyHasDependencies","valueHasDependencies","onKeys","onKeysAdded","onKeysRemoved","onPatches"].forEach(function(e){i.for("can."+e)}),r.exports=o.Symbol=i}(0,e,0,n)}),define("full-url@1.0.0#index",function(e,t,n){n.exports=function(e){return"http"+(e.connection.encrypted||"https"===e.headers["x-forwarded-proto"]?"s":"")+"://"+e.headers.host+e.url}}),define("can-reflect@1.17.7#reflections/helpers",["require","exports","module","can-symbol"],function(e,t,n){"use strict";var r=e("can-symbol");n.exports={makeGetFirstSymbolValue:function(e){var t=e.map(function(e){return r.for(e)}),n=t.length;return function(e){for(var r=-1;++r<n;)if(void 0!==e[t[r]])return e[t[r]]}},hasLength:function(e){var t=typeof e;if("string"===t||Array.isArray(e))return!0;var n=e&&"boolean"!==t&&"number"!==t&&"length"in e&&e.length;return"function"!=typeof e&&(0===n||"number"==typeof n&&n>0&&n-1 in e)}}}),define("can-reflect@1.17.7#reflections/type/type",["require","exports","module","can-symbol","../helpers"],function(e,t,n){"use strict";function r(e){var t=typeof e;return null==e||"function"!==t&&"object"!==t}function i(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(t===Object.prototype||null===t)return!0;var n=h.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&p.call(n)===f}var o,a=e("can-symbol"),s=e("../helpers"),u=Object.getOwnPropertyNames(function(){}.prototype),c=Object.getPrototypeOf(function(){}.prototype),l=s.makeGetFirstSymbolValue(["can.new","can.apply"]),h=Object.prototype.hasOwnProperty,p=Function.prototype.toString,f=p.call(Object),d=a.for("can.onValue"),m=a.for("can.onKeyValue"),g=a.for("can.onPatches");o="undefined"!=typeof Symbol&&"function"==typeof Symbol.for?function(e){return"symbol"==typeof e}:function(e){return"object"==typeof e&&!Array.isArray(e)&&"@@symbol"===e.toString().substr(0,"@@symbol".length)},n.exports={isConstructorLike:function(e){var t=e[a.for("can.new")];if(void 0!==t)return t;if("function"!=typeof e)return!1;var n=e.prototype;if(!n)return!1;if(c!==Object.getPrototypeOf(n))return!0;var r=Object.getOwnPropertyNames(n);if(r.length===u.length){for(var i=0,o=r.length;i<o;i++)if(r[i]!==u[i])return!0;return!1}return!0},isFunctionLike:function(e){var t,n=!!e&&e[a.for("can.isFunctionLike")];return void 0!==n?n:void 0!==(t=l(e))?!!t:"function"==typeof e},isListLike:function(e){var t;if("string"==typeof e)return!0;if(r(e))return!1;if(void 0!==(t=e[a.for("can.isListLike")]))return t;var n=e[a.iterator];return void 0!==n?!!n:!!Array.isArray(e)||s.hasLength(e)},isMapLike:function(e){if(r(e))return!1;var t=e[a.for("can.isMapLike")];if(void 0!==t)return!!t;var n=e[a.for("can.getKeyValue")];return void 0===n||!!n},isObservableLike:function(e){return!r(e)&&Boolean(e[d]||e[m]||e[g])},isPrimitive:r,isBuiltIn:function(e){return!!(r(e)||Array.isArray(e)||i(e)||"[object Object]"!==Object.prototype.toString.call(e)&&-1!==Object.prototype.toString.call(e).indexOf("[object "))},isValueLike:function(e){var t;if(r(e))return!0;if(void 0!==(t=e[a.for("can.isValueLike")]))return t;var n=e[a.for("can.getValue")];return void 0!==n?!!n:void 0},isSymbolLike:o,isMoreListLikeThanMapLike:function(e){if(Array.isArray(e))return!0;if(e instanceof Array)return!0;if(null==e)return!1;var t=e[a.for("can.isMoreListLikeThanMapLike")];if(void 0!==t)return t;var n=this.isListLike(e),r=this.isMapLike(e);return!(!n||r)||!(!n&&r)&&void 0},isIteratorLike:function(e){return e&&"object"==typeof e&&"function"==typeof e.next&&0===e.next.length},isPromise:function(e){return e instanceof Promise||"[object Promise]"===Object.prototype.toString.call(e)},isPlainObject:i}}),define("can-reflect@1.17.7#reflections/call/call",["require","exports","module","can-symbol","../type/type"],function(e,t,n){"use strict";var r=e("can-symbol"),i=e("../type/type");n.exports={call:function(e,t){var n=[].slice.call(arguments,2),i=e[r.for("can.apply")];return i?i.call(e,t,n):e.apply(t,n)},apply:function(e,t,n){var i=e[r.for("can.apply")];return i?i.call(e,t,n):e.apply(t,n)},new:function(e){var t=[].slice.call(arguments,1),n=e[r.for("can.new")];if(n)return n.apply(e,t);var o=Object.create(e.prototype),a=e.apply(o,t);return i.isPrimitive(a)?o:a}}}),define("can-reflect@1.17.7#reflections/get-set/get-set",["require","exports","module","can-symbol","../type/type"],function(e,t,n){"use strict";var r=e("can-symbol"),i=e("../type/type"),o=r.for("can.setKeyValue"),a=r.for("can.getKeyValue"),s=r.for("can.getValue"),u=r.for("can.setValue"),c={setKeyValue:function(e,t,n){if(i.isSymbolLike(t))"symbol"==typeof t?e[t]=n:Object.defineProperty(e,t,{enumerable:!1,configurable:!0,value:n,writable:!0});else{var r=e[o];if(void 0!==r)return r.call(e,t,n);e[t]=n}},getKeyValue:function(e,t){var n=e[a];return n?n.call(e,t):e[t]},deleteKeyValue:function(e,t){var n=e[r.for("can.deleteKeyValue")];if(n)return n.call(e,t);delete e[t]},getValue:function(e){if(i.isPrimitive(e))return e;var t=e[s];return t?t.call(e):e},setValue:function(e,t){var n=e&&e[u];if(n)return n.call(e,t);throw new Error("can-reflect.setValue - Can not set value.")},splice:function(e,t,n,i){var o;if("number"!=typeof n){var a=e[r.for("can.updateValues")];if(a)return a.call(e,t,n,i);o=n.length}else o=n;arguments.length<=3&&(i=[]);var s=e[r.for("can.splice")];return s?s.call(e,t,o,i):[].splice.apply(e,[t,o].concat(i))},addValues:function(e,t,n){var i=e[r.for("can.addValues")];return i?i.call(e,t,n):Array.isArray(e)&&void 0===n?e.push.apply(e,t):c.splice(e,n,[],t)},removeValues:function(e,t,n){var i=e[r.for("can.removeValues")];return i?i.call(e,t,n):Array.isArray(e)&&void 0===n?void t.forEach(function(t){var n=e.indexOf(t);n>=0&&e.splice(n,1)}):c.splice(e,n,t,[])}};c.get=c.getKeyValue,c.set=c.setKeyValue,c.delete=c.deleteKeyValue,n.exports=c}),define("can-reflect@1.17.7#reflections/observe/observe",["require","exports","module","can-symbol"],function(e,t,n){"use strict";function r(e,t){return function(n,r,i,a){var s=n[o.for(e)];return void 0!==s?s.call(n,r,i,a):this[t].apply(this,arguments)}}function i(e,t){return function(n){var r=n[o.for(e)];if(void 0!==r){var i=a.call(arguments,1);return r.apply(n,i)}throw new Error(t)}}var o=e("can-symbol"),a=[].slice;n.exports={onKeyValue:r("can.onKeyValue","onEvent"),offKeyValue:r("can.offKeyValue","offEvent"),onKeys:i("can.onKeys","can-reflect: can not observe an onKeys event"),onKeysAdded:i("can.onKeysAdded","can-reflect: can not observe an onKeysAdded event"),onKeysRemoved:i("can.onKeysRemoved","can-reflect: can not unobserve an onKeysRemoved event"),getKeyDependencies:i("can.getKeyDependencies","can-reflect: can not determine dependencies"),getWhatIChange:i("can.getWhatIChange","can-reflect: can not determine dependencies"),getChangesDependencyRecord:function(e){var t=e[o.for("can.getChangesDependencyRecord")];if("function"==typeof t)return t()},keyHasDependencies:i("can.keyHasDependencies","can-reflect: can not determine if this has key dependencies"),onValue:i("can.onValue","can-reflect: can not observe value change"),offValue:i("can.offValue","can-reflect: can not unobserve value change"),getValueDependencies:i("can.getValueDependencies","can-reflect: can not determine dependencies"),valueHasDependencies:i("can.valueHasDependencies","can-reflect: can not determine if value has dependencies"),onPatches:i("can.onPatches","can-reflect: can not observe patches on object"),offPatches:i("can.offPatches","can-reflect: can not unobserve patches on object"),onInstancePatches:i("can.onInstancePatches","can-reflect: can not observe onInstancePatches on Type"),offInstancePatches:i("can.offInstancePatches","can-reflect: can not unobserve onInstancePatches on Type"),onInstanceBoundChange:i("can.onInstanceBoundChange","can-reflect: can not observe bound state change in instances."),offInstanceBoundChange:i("can.offInstanceBoundChange","can-reflect: can not unobserve bound state change"),isBound:i("can.isBound","can-reflect: cannot determine if object is bound"),onEvent:function(e,t,n,r){if(e){var i=e[o.for("can.onEvent")];if(void 0!==i)return i.call(e,t,n,r);e.addEventListener&&e.addEventListener(t,n,r)}},offEvent:function(e,t,n,r){if(e){var i=e[o.for("can.offEvent")];if(void 0!==i)return i.call(e,t,n,r);e.removeEventListener&&e.removeEventListener(t,n,r)}},setPriority:function(e,t){if(e){var n=e[o.for("can.setPriority")];if(void 0!==n)return n.call(e,t),!0}return!1},getPriority:function(e){if(e){var t=e[o.for("can.getPriority")];if(void 0!==t)return t.call(e)}}}}),define("can-reflect@1.17.7#reflections/shape/shape",["require","exports","module","can-symbol","../get-set/get-set","../type/type","../helpers"],function(e,t,n){"use strict";function r(e){return!!l.isPrimitive(e)||!T(e)&&l.isBuiltIn(e)&&!l.isPlainObject(e)&&!Array.isArray(e)}function i(e){var t=e||f;return{unwrap:new t,serialize:new t,isSerializing:{unwrap:new t,serialize:new t},circularReferenceIsSerializing:{unwrap:new t,serialize:new t}}}function o(e,t){function n(e){this.first=!o,this.first&&(o=i(e)),this.map=o,this.result=null}var o=null;return n.prototype.end=function(){return this.first&&(o=null),this.result},function(i,o){if(r(i))return i;var a=new n(o);if(l.isValueLike(i))a.result=this[e](c.getValue(i));else{var s=l.isIteratorLike(i)||l.isMoreListLikeThanMapLike(i);if(a.result=s?[]:{},a.map[e].has(i))return a.map.isSerializing[e].has(i)&&a.map.circularReferenceIsSerializing[e].set(i,!0),a.map[e].get(i);a.map[e].set(i,a.result);for(var u=0,h=t.length;u<h;u++){var p=i[t[u]];if(p){a.map.isSerializing[e].set(i,!0);var f=a.result;if(a.result=p.call(i,f),a.map.isSerializing[e].delete(i),a.result!==f){if(a.map.circularReferenceIsSerializing[e].has(i))throw a.end(),new Error("Cannot serialize cirular reference!");a.map[e].set(i,a.result)}return a.end()}}"function"==typeof obj?(a.map[e].set(i,i),a.result=i):s?this.eachIndex(i,function(t,n){a.result[n]=this[e](t)},this):this.eachKey(i,function(t,n){a.result[n]=this[e](t)},this)}return a.end()}}function a(e,t){var n=e[e.length-1];if(n&&n.deleteCount===n.insert.length&&t.index-n.index===n.deleteCount)return n.insert.push.apply(n.insert,t.insert),void(n.deleteCount+=t.deleteCount);e.push(t)}function s(e,t,n){var r=this.toArray(t),i=[],o=-1;this.eachIndex(e,function(t,s){if(o=s,s>=r.length)return n||a(i,{index:s,deleteCount:e.length-s+1,insert:[]}),!1;var u=r[s];l.isPrimitive(t)||l.isPrimitive(u)||!1===S(t)?a(i,{index:s,deleteCount:1,insert:[u]}):!0===n?this.assignDeep(t,u):this.updateDeep(t,u)},this),r.length>o&&a(i,{index:o+1,deleteCount:0,insert:r.slice(o+1)});for(var s=0,u=i.length;s<u;s++){var h=i[s];c.splice(e,h.index,h.deleteCount,h.insert)}return e}var u=e("can-symbol"),c=e("../get-set/get-set"),l=e("../type/type"),h=e("../helpers"),p=!0;try{Object.getPrototypeOf(1)}catch(e){p=!1}var f;if("function"==typeof Map)f=Map;else{var d=function(e){return e%2==0};(f=function(){this.contents=[]}).prototype={_getIndex:function(e){var t;do{t=this.contents.indexOf(e,t)}while(-1!==t&&!d(t));return t},has:function(e){return-1!==this._getIndex(e)},get:function(e){var t=this._getIndex(e);if(-1!==t)return this.contents[t+1]},set:function(e,t){var n=this._getIndex(e);-1!==n?this.contents[n+1]=t:(this.contents.push(e),this.contents.push(t))},delete:function(e){var t=this._getIndex(e);-1!==t&&this.contents.splice(t,2)}}}var m,g,y=Object.prototype.hasOwnProperty,v=function(e){return function(){var t=[this];return t.push.apply(t,arguments),e.apply(null,t)}},b=u.for("can.getKeyValue"),_=v(c.getKeyValue),w=u.for("can.setKeyValue"),k=v(c.setKeyValue),E=u.for("can.size"),T=h.makeGetFirstSymbolValue(["can.updateDeep","can.assignDeep","can.setKeyValue"]),S=function(e){return l.isPlainObject(e)||Array.isArray(e)||!!T(e)};try{Object.keys(1),g=Object.keys}catch(e){g=function(e){return l.isPrimitive(e)?[]:Object.keys(e)}}var C;C="undefined"!=typeof Map?function(e){var t=new Map;return m.eachIndex(e,function(e){t.set(e,!0)}),t}:function(e){var t={};return e.forEach(function(e){t[e]=!0}),{get:function(e){return t[e]},set:function(e,n){t[e]=n},keys:function(){return e}}};var I=function(e){var t=e[u.for("can.hasOwnKey")];if(t)return t.bind(e);var n=C(m.getOwnEnumerableKeys(e));return function(e){return n.get(e)}};(m={each:function(e,t,n){return l.isIteratorLike(e)||l.isMoreListLikeThanMapLike(e)?m.eachIndex(e,t,n):m.eachKey(e,t,n)},eachIndex:function(e,t,n){if(Array.isArray(e))return m.eachListLike(e,t,n);var r,i=e[u.iterator];if(l.isIteratorLike(e)?r=e:i&&(r=i.call(e)),r)for(var o,a=0;!(o=r.next()).done&&!1!==t.call(n||e,o.value,a++,e););else m.eachListLike(e,t,n);return e},eachListLike:function(e,t,n){var r=-1,i=e.length;if(void 0===i){var o=e[E];if(!o)throw new Error("can-reflect: unable to iterate.");i=o.call(e)}for(;++r<i;){var a=e[r];if(!1===t.call(n||a,a,r,e))break}return e},toArray:function(e){var t=[];return m.each(e,function(e){t.push(e)}),t},eachKey:function(e,t,n){if(e){var r=m.getOwnEnumerableKeys(e),i=e[b]||_;return m.eachIndex(r,function(r){var o=i.call(e,r);return t.call(n||e,o,r,e)})}return e},hasOwnKey:function(e,t){var n=e[u.for("can.hasOwnKey")];if(n)return n.call(e,t);var r=e[u.for("can.getOwnKeys")];if(r){var i=!1;return m.eachIndex(r.call(e),function(e){if(e===t)return i=!0,!1}),i}return y.call(e,t)},getOwnEnumerableKeys:function(e){var t=e[u.for("can.getOwnEnumerableKeys")];if(t)return t.call(e);if(e[u.for("can.getOwnKeys")]&&e[u.for("can.getOwnKeyDescriptor")]){var n=[];return m.eachIndex(m.getOwnKeys(e),function(t){m.getOwnKeyDescriptor(e,t).enumerable&&n.push(t)},this),n}return g(e)},getOwnKeys:function(e){var t=e[u.for("can.getOwnKeys")];return t?t.call(e):Object.getOwnPropertyNames(e)},getOwnKeyDescriptor:function(e,t){var n=e[u.for("can.getOwnKeyDescriptor")];return n?n.call(e,t):Object.getOwnPropertyDescriptor(e,t)},unwrap:o("unwrap",[u.for("can.unwrap")]),serialize:o("serialize",[u.for("can.serialize"),u.for("can.unwrap")]),assignMap:function(e,t){var n=I(e),r=e[b]||_,i=e[w]||k;return m.eachKey(t,function(t,o){n(o)&&r.call(e,o)===t||i.call(e,o,t)}),e},assignList:function(e,t){var n=m.toArray(t);return c.splice(e,0,n,n),e},assign:function(e,t){return l.isIteratorLike(t)||l.isMoreListLikeThanMapLike(t)?m.assignList(e,t):m.assignMap(e,t),e},assignDeepMap:function(e,t){var n=I(e),r=e[b]||_,i=e[w]||k;return m.eachKey(t,function(t,o){if(n(o)){var a=r.call(e,o);t===a||(l.isPrimitive(a)||l.isPrimitive(t)||!1===S(a)?i.call(e,o,t):m.assignDeep(a,t))}else c.setKeyValue(e,o,t)},this),e},assignDeepList:function(e,t){return s.call(this,e,t,!0)},assignDeep:function(e,t){var n=e[u.for("can.assignDeep")];return n?n.call(e,t):l.isMoreListLikeThanMapLike(t)?m.assignDeepList(e,t):m.assignDeepMap(e,t),e},updateMap:function(e,t){var n=C(m.getOwnEnumerableKeys(t)),r=t[b]||_,i=e[w]||k;return m.eachKey(e,function(o,a){if(n.get(a)){n.set(a,!1);var s=r.call(t,a);s!==o&&i.call(e,a,s)}else c.deleteKeyValue(e,a)},this),m.eachIndex(n.keys(),function(o){n.get(o)&&i.call(e,o,r.call(t,o))}),e},updateList:function(e,t){var n=m.toArray(t);return c.splice(e,0,e,n),e},update:function(e,t){return l.isIteratorLike(t)||l.isMoreListLikeThanMapLike(t)?m.updateList(e,t):m.updateMap(e,t),e},updateDeepMap:function(e,t){var n=C(m.getOwnEnumerableKeys(t)),r=t[b]||_,i=e[w]||k;return m.eachKey(e,function(o,a){if(n.get(a)){n.set(a,!1);var s=r.call(t,a);l.isPrimitive(o)||l.isPrimitive(s)||!1===S(o)?i.call(e,a,s):m.updateDeep(o,s)}else c.deleteKeyValue(e,a)},this),m.eachIndex(n.keys(),function(o){n.get(o)&&i.call(e,o,r.call(t,o))}),e},updateDeepList:function(e,t){return s.call(this,e,t)},updateDeep:function(e,t){var n=e[u.for("can.updateDeep")];return n?n.call(e,t):l.isMoreListLikeThanMapLike(t)?m.updateDeepList(e,t):m.updateDeepMap(e,t),e},hasKey:function(e,t){if(null==e)return!1;if(l.isPrimitive(e)){if(y.call(e,t))return!0;var n;return void 0!==(n=p?Object.getPrototypeOf(e):e.__proto__)?t in n:void 0!==e[t]}var r=e[u.for("can.hasKey")];return r?r.call(e,t):m.hasOwnKey(e,t)||t in e},getAllEnumerableKeys:function(){},getAllKeys:function(){},assignSymbols:function(e,t){return m.eachKey(t,function(t,n){var r=l.isSymbolLike(u[n])?u[n]:u.for(n);c.setKeyValue(e,r,t)}),e},isSerialized:r,size:function(e){if(null==e)return 0;var t=e[E],n=0;return t?t.call(e):h.hasLength(e)?e.length:l.isListLike(e)?(m.eachIndex(e,function(){n++}),n):e?m.getOwnEnumerableKeys(e).length:void 0},defineInstanceKey:function(e,t,n){var r=e[u.for("can.defineInstanceKey")];if(r)return r.call(e,t,n);var i=e.prototype;(r=i[u.for("can.defineInstanceKey")])?r.call(i,t,n):Object.defineProperty(i,t,m.assign({configurable:!0,enumerable:!l.isSymbolLike(t),writable:!0},n))}}).isSerializable=m.isSerialized,m.keys=m.getOwnEnumerableKeys,n.exports=m}),define("can-reflect@1.17.7#reflections/shape/schema/schema",["require","exports","module","can-symbol","../../type/type","../../get-set/get-set","../shape"],function(e,t,n){"use strict";function r(e,t){return e.localeCompare(t)}function i(e){if(s.isPrimitive(e))return e;var t;return s.isListLike(e)?(t=[],c.eachKey(e,function(e){t.push(i(e))}),t):s.isMapLike(e)?(t={},c.getOwnKeys(e).sort(r).forEach(function(n){t[n]=i(u.getKeyValue(e,n))}),t):e}function o(e){return e===Number||e===String||e===Boolean}var a=e("can-symbol"),s=e("../../type/type"),u=e("../../get-set/get-set"),c=e("../shape"),l=a.for("can.getSchema"),h=a.for("can.isMember"),p=a.for("can.new"),f={getSchema:function(e){if(void 0!==e){var t=e[l];return void 0===t&&(t=(e=e.constructor)&&e[l]),void 0!==t?t.call(e):void 0}},getIdentity:function(e,t){if(void 0===(t=t||f.getSchema(e)))throw new Error("can-reflect.getIdentity - Unable to find a schema for the given value.");var n=t.identity;if(n&&0!==n.length){if(1===n.length)return u.getKeyValue(e,n[0]);var r={};return n.forEach(function(t){r[t]=u.getKeyValue(e,t)}),JSON.stringify(f.cloneKeySort(r))}throw new Error("can-reflect.getIdentity - Provided schema lacks an identity property.")},cloneKeySort:function(e){return i(e)},convert:function(e,t){if(o(t))return t(e);var n=t[h],r=!1,i=typeof t,a=t[p];if(void 0!==n?r=n.call(t,e):"function"===i&&s.isConstructorLike(t)&&(r=e instanceof t),r)return e;if(void 0!==a)return a.call(t,e);if("function"===i)return s.isConstructorLike(t)?new t(e):t(e);throw new Error("can-reflect: Can not convert values into type. Type must provide `can.new` symbol.")}};n.exports=f}),define("can-reflect@1.17.7#reflections/get-name/get-name",["require","exports","module","can-symbol","../type/type"],function(e,t,n){"use strict";function r(e){var t=typeof e;if(null===e||"object"!==t&&"function"!==t)return""+e;var n=e[a];if(n)return n.call(e);if("function"===t)return"name"in e||(e.name="functionIE"+s++),e.name;if(e.constructor&&e!==e.constructor){var i=r(e.constructor);if(i){if(o.isValueLike(e))return i+"<>";if(o.isMoreListLikeThanMapLike(e))return i+"[]";if(o.isMapLike(e))return i+"{}"}}}var i=e("can-symbol"),o=e("../type/type"),a=i.for("can.getName"),s=0;n.exports={setName:function(e,t){if("function"!=typeof t){var n=t;t=function(){return n}}Object.defineProperty(e,a,{value:t})},getName:r}}),define("can-reflect@1.17.7#types/map",["require","exports","module","../reflections/shape/shape","can-symbol"],function(e,t,n){"use strict";var r=e("../reflections/shape/shape"),i=e("can-symbol");"undefined"!=typeof Map&&(r.assignSymbols(Map.prototype,{"can.getOwnEnumerableKeys":Map.prototype.keys,"can.setKeyValue":Map.prototype.set,"can.getKeyValue":Map.prototype.get,"can.deleteKeyValue":Map.prototype.delete,"can.hasOwnKey":Map.prototype.has}),"function"!=typeof Map.prototype.keys&&(Map.prototype.keys=Map.prototype[i.for("can.getOwnEnumerableKeys")]=function(){var e=[],t=0;return this.forEach(function(t,n){e.push(n)}),{next:function(){return{value:e[t],done:t++===e.length}}}})),"undefined"!=typeof WeakMap&&r.assignSymbols(WeakMap.prototype,{"can.getOwnEnumerableKeys":function(){throw new Error("can-reflect: WeakMaps do not have enumerable keys.")},"can.setKeyValue":WeakMap.prototype.set,"can.getKeyValue":WeakMap.prototype.get,"can.deleteKeyValue":WeakMap.prototype.delete,"can.hasOwnKey":WeakMap.prototype.has})}),define("can-reflect@1.17.7#types/set",["require","exports","module","../reflections/shape/shape","can-symbol"],function(e,t,n){"use strict";var r=e("../reflections/shape/shape"),i=e("can-symbol");"undefined"!=typeof Set&&(r.assignSymbols(Set.prototype,{"can.isMoreListLikeThanMapLike":!0,"can.updateValues":function(e,t,n){t!==n&&r.each(t,function(e){this.delete(e)},this),r.each(n,function(e){this.add(e)},this)},"can.size":function(){return this.size}}),"function"!=typeof Set.prototype[i.iterator]&&(Set.prototype[i.iterator]=function(){var e=[],t=0;return this.forEach(function(t){e.push(t)}),{next:function(){return{value:e[t],done:t++===e.length}}}})),"undefined"!=typeof WeakSet&&r.assignSymbols(WeakSet.prototype,{"can.isListLike":!0,"can.isMoreListLikeThanMapLike":!0,"can.updateValues":function(e,t,n){t!==n&&r.each(t,function(e){this.delete(e)},this),r.each(n,function(e){this.add(e)},this)},"can.size":function(){throw new Error("can-reflect: WeakSets do not have enumerable keys.")}})}),define("can-reflect@1.17.7#can-reflect",["require","exports","module","./reflections/call/call","./reflections/get-set/get-set","./reflections/observe/observe","./reflections/shape/shape","./reflections/shape/schema/schema","./reflections/type/type","./reflections/get-name/get-name","can-namespace","./types/map","./types/set"],function(e,t,n){"use strict";var r=e("./reflections/call/call"),i=e("./reflections/get-set/get-set"),o=e("./reflections/observe/observe"),a=e("./reflections/shape/shape"),s=e("./reflections/shape/schema/schema"),u=e("./reflections/type/type"),c=e("./reflections/get-name/get-name"),l=e("can-namespace"),h={};[r,i,o,a,u,c,s].forEach(function(e){for(var t in e)h[t]=e[t]}),e("./types/map"),e("./types/set"),n.exports=l.Reflect=h}),define("can-queues@1.2.1#queue-state",function(e,t,n){"use strict";n.exports={lastTask:null}}),define("can-assign@1.3.1#can-assign",["require","exports","module","can-namespace"],function(e,t,n){var r=e("can-namespace");n.exports=r.assign=function(e,t){for(var n in t){var r=Object.getOwnPropertyDescriptor(e,n);r&&!1===r.writable||(e[n]=t[n])}return e}}),define("can-queues@1.2.1#queue",["require","exports","module","./queue-state","can-log/dev/dev","can-assign"],function(e,t,n){"use strict";function r(){}var i=e("./queue-state"),o=(e("can-log/dev/dev"),e("can-assign")),a=function(e,t){this.callbacks=o({onFirstTask:r,onComplete:function(){i.lastTask=null}},t||{}),this.name=e,this.index=0,this.tasks=[],this._log=!1};a.prototype.constructor=a,a.noop=r,a.prototype.enqueue=function(e,t,n,r){1===this.tasks.push({fn:e,context:t,args:n,meta:r||{}})&&this.callbacks.onFirstTask(this)},a.prototype.flush=function(){for(;this.index<this.tasks.length;){var e=this.tasks[this.index++];e.fn.apply(e.context,e.args)}this.index=0,this.tasks=[],this.callbacks.onComplete(this)},a.prototype.log=function(){this._log=!arguments.length||arguments[0]},n.exports=a}),define("can-queues@1.2.1#priority-queue",["require","exports","module","./queue"],function(e,t,n){"use strict";var r=e("./queue"),i=function(){r.apply(this,arguments),this.taskMap=new Map,this.taskContainersByPriority=[],this.curPriorityIndex=1/0,this.curPriorityMax=0,this.isFlushing=!1,this.tasksRemaining=0};(i.prototype=Object.create(r.prototype)).constructor=i,i.prototype.enqueue=function(e,t,n,r){if(!this.taskMap.has(e)){this.tasksRemaining++;var i=0===this.taskContainersByPriority.length,o={fn:e,context:t,args:n,meta:r||{}};this.getTaskContainerAndUpdateRange(o).tasks.push(o),this.taskMap.set(e,o),i&&this.callbacks.onFirstTask(this)}},i.prototype.getTaskContainerAndUpdateRange=function(e){var t=e.meta.priority||0;t<this.curPriorityIndex&&(this.curPriorityIndex=t),t>this.curPriorityMax&&(this.curPriorityMax=t);var n=this.taskContainersByPriority,r=n[t];return r||(r=n[t]={tasks:[],index:0}),r},i.prototype.flush=function(){if(!this.isFlushing)for(this.isFlushing=!0;;){if(!(this.curPriorityIndex<=this.curPriorityMax))return this.taskMap=new Map,this.curPriorityIndex=1/0,this.curPriorityMax=0,this.taskContainersByPriority=[],this.isFlushing=!1,void this.callbacks.onComplete(this);var e=this.taskContainersByPriority[this.curPriorityIndex];if(e&&e.tasks.length>e.index){var t=e.tasks[e.index++];this.tasksRemaining--,this.taskMap.delete(t.fn),t.fn.apply(t.context,t.args)}else this.curPriorityIndex++}},i.prototype.isEnqueued=function(e){return this.taskMap.has(e)},i.prototype.flushQueuedTask=function(e){var t=this.dequeue(e);t&&t.fn.apply(t.context,t.args)},i.prototype.dequeue=function(e){var t=this.taskMap.get(e);if(t){var n=t.meta.priority||0,r=this.taskContainersByPriority[n],i=r.tasks.indexOf(t,r.index);if(i>=0)return r.tasks.splice(i,1),this.tasksRemaining--,this.taskMap.delete(t.fn),t;console.warn("Task",e,"has already run")}},i.prototype.tasksRemainingCount=function(){return this.tasksRemaining},n.exports=i}),define("can-queues@1.2.1#completion-queue",["require","exports","module","./queue"],function(e,t,n){"use strict";var r=e("./queue"),i=function(){r.apply(this,arguments),this.flushCount=0};(i.prototype=Object.create(r.prototype)).constructor=i,i.prototype.flush=function(){if(0===this.flushCount){for(this.flushCount++;this.index<this.tasks.length;){var e=this.tasks[this.index++];e.fn.apply(e.context,e.args)}this.index=0,this.tasks=[],this.flushCount--,this.callbacks.onComplete(this)}},n.exports=i}),define("can-queues@1.2.1#can-queues",["require","exports","module","can-log/dev/dev","./queue","./priority-queue","./queue-state","./completion-queue","can-namespace"],function(e,t,n){"use strict";var r,i,o,a,s,u=e("can-log/dev/dev"),c=e("./queue"),l=e("./priority-queue"),h=e("./queue-state"),p=e("./completion-queue"),f=e("can-namespace"),d=0,m=!1,g=!1,y=0,v=["notify","derive","domUI","mutate"];i=new c("NOTIFY",{onComplete:function(){o.flush()},onFirstTask:function(){d?m=!0:i.flush()}}),o=new l("DERIVE",{onComplete:function(){a.flush()},onFirstTask:function(){m=!0}}),a=new p("DOM_UI",{onComplete:function(){s.flush()},onFirstTask:function(){m=!0}}),s=new c("MUTATE",{onComplete:function(){h.lastTask=null,g=!1},onFirstTask:function(){m=!0}});var b={Queue:c,PriorityQueue:l,CompletionQueue:p,notifyQueue:i,deriveQueue:o,domUIQueue:a,mutateQueue:s,batch:{start:function(){1==++d&&(r={number:++y})},stop:function(){0==--d&&m&&(m=!1,g=!0,i.flush())},isCollecting:function(){return d>0},number:function(){return y},data:function(){return r}},runAsTask:function(e,t){return e},enqueueByQueue:function(e,t,n,r,i){e&&(b.batch.start(),v.forEach(function(o){var a=b[o+"Queue"],s=e[o];void 0!==s&&s.forEach(function(e){var o=null!=r?r(e,t,n):{};o.reasonLog=i,a.enqueue(e,t,n,o)})}),b.batch.stop())},lastTask:function(){return h.lastTask},stack:function(e){for(var t=e||h.lastTask,n=[];t;)n.unshift(t),t=t.meta.parentTask;return n},logStack:function(e){this.stack(e).forEach(function(e,t){var n=e.meta;0===t&&n&&n.reasonLog&&u.log.apply(u,n.reasonLog);var r=n&&n.log?n.log:[e.fn.name,e];u.log.apply(u,[e.meta.stack.name+" ran task:"].concat(r))})},taskCount:function(){return i.tasks.length+o.tasks.length+a.tasks.length+s.tasks.length},flush:function(){i.flush()},log:function(){i.log.apply(i,arguments),o.log.apply(o,arguments),a.log.apply(a,arguments),s.log.apply(s,arguments)}};if(f.queues)throw new Error("You can't have two versions of can-queues, check your dependencies");n.exports=f.queues=b}),define("can-reflect-dependencies@1.1.1#src/add-mutated-by",["require","exports","module","can-reflect"],function(e,t,n){"use strict";var r=e("can-reflect"),i=function(){return{keyDependencies:new Map,valueDependencies:new Set}},o=function(){return{mutateDependenciesForKey:new Map,mutateDependenciesForValue:i()}};n.exports=function(e){return function(t,n,a){var s=3===arguments.length;if(2===arguments.length&&(a=n,n=void 0),!a.keyDependencies&&!a.valueDependencies){var u=new Set;u.add(a),a={valueDependencies:u}}var c=e.get(t);c||(c=o(),e.set(t,c)),s&&!c.mutateDependenciesForKey.get(n)&&c.mutateDependenciesForKey.set(n,i());var l=s?c.mutateDependenciesForKey.get(n):c.mutateDependenciesForValue;a.valueDependencies&&r.addValues(l.valueDependencies,a.valueDependencies),a.keyDependencies&&r.each(a.keyDependencies,function(e,t){var n=l.keyDependencies.get(t);n||(n=new Set,l.keyDependencies.set(t,n)),r.addValues(n,e)})}}}),define("can-reflect-dependencies@1.1.1#src/delete-mutated-by",["require","exports","module","can-reflect"],function(e,t,n){"use strict";var r=e("can-reflect");n.exports=function(e){return function(t,n,i){var o=3===arguments.length,a=e.get(t);if(2===arguments.length&&(i=n,n=void 0),!i.keyDependencies&&!i.valueDependencies){var s=new Set;s.add(i),i={valueDependencies:s}}var u=o?a.mutateDependenciesForKey.get(n):a.mutateDependenciesForValue;i.valueDependencies&&r.removeValues(u.valueDependencies,i.valueDependencies),i.keyDependencies&&r.each(i.keyDependencies,function(e,t){var n=u.keyDependencies.get(t);n&&(r.removeValues(n,e),n.size||u.keyDependencies.delete(t))})}}}),define("can-reflect-dependencies@1.1.1#src/is-function",function(e,t,n){"use strict";n.exports=function(e){return"function"==typeof e}}),define("can-reflect-dependencies@1.1.1#src/get-dependency-data-of",["require","exports","module","can-symbol","can-reflect","./is-function","can-assign"],function(e,t,n){"use strict";var r=e("can-symbol"),i=e("can-reflect"),o=e("./is-function"),a=e("can-assign"),s=r.for("can.getWhatIChange"),u=r.for("can.getKeyDependencies"),c=r.for("can.getValueDependencies"),l=function(e,t){if(o(e[u]))return i.getKeyDependencies(e,t)},h=function(e){if(o(e[c]))return i.getValueDependencies(e)},p=function(e,t,n){var r,i=e.get(t);return i&&i.mutateDependenciesForKey.has(n)&&(r=i.mutateDependenciesForKey.get(n)),r},f=function(e,t){var n,r=e.get(t);if(r){var i=r.mutateDependenciesForValue;i.keyDependencies.size&&((n=n||{}).keyDependencies=i.keyDependencies),i.valueDependencies.size&&((n=n||{}).valueDependencies=i.valueDependencies)}return n},d=function(e,t){if(o(e[s]))return 2===arguments.length?i.getWhatIChange(e,t):i.getWhatIChange(e)},m=function(e){return null==e||!Object.keys(e).length||e.keyDependencies&&!e.keyDependencies.size&&e.valueDependencies&&!e.valueDependencies.size},g=function(e,t,n){var r=3===arguments.length,i=r?p(e,t,n):f(e,t),o=r?l(t,n):h(t);if(!m(i)||!m(o))return a(a({},i?{mutate:i}:null),o?{derive:o}:null)};n.exports=function(e){return function(t,n){var r=2===arguments.length,i=r?g(e,t,n):g(e,t),o=r?d(t,n):d(t);if(i||o)return a(a({},o?{whatIChange:o}:null),i?{whatChangesMe:i}:null)}}}),define("can-reflect-dependencies@1.1.1#can-reflect-dependencies",["require","exports","module","./src/add-mutated-by","./src/delete-mutated-by","./src/get-dependency-data-of"],function(e,t,n){"use strict";var r=e("./src/add-mutated-by"),i=e("./src/delete-mutated-by"),o=e("./src/get-dependency-data-of"),a=new WeakMap;n.exports={addMutatedBy:r(a),deleteMutatedBy:i(a),getDependencyDataOf:o(a)}}),define("can-bind@1.2.0#can-bind",["require","exports","module","can-reflect","can-symbol","can-namespace","can-queues","can-assign"],function(e,t,n){"use strict";function r(e,t){c.setValue(t,e)}function i(e,t,n,r){e[m]&&c.offValue(e,n,r)}function o(e,t,n,r){e[m]&&c.onValue(e,n,r)}function a(e,t){this.value=0,this._binding=e,this._type=t}function s(e){this._options=e,void 0===e.queue&&(e.queue="domUI"),e.cycles>0==0&&(e.cycles=0),e.onInitDoNotUpdateChild="boolean"==typeof e.onInitDoNotUpdateChild&&e.onInitDoNotUpdateChild,e.onInitDoNotUpdateParent="boolean"==typeof e.onInitDoNotUpdateParent&&e.onInitDoNotUpdateParent,e.onInitSetUndefinedParentIfChildIsDefined="boolean"!=typeof e.onInitSetUndefinedParentIfChildIsDefined||e.onInitSetUndefinedParentIfChildIsDefined;var t=new a(this,"child"),n=new a(this,"parent"),i=!0;"boolean"==typeof e.childToParent?i=e.childToParent:null==e.child[d]?i=!1:void 0===e.setParent&&null==e.parent[g]&&(i=!1);var o=!0;if("boolean"==typeof e.parentToChild?o=e.parentToChild:null==e.parent[d]?o=!1:void 0===e.setChild&&null==e.child[g]&&(o=!1),!1===i&&!1===o)throw new Error("Neither the child nor parent will be updated; this is a no-way binding");this._childToParent=i,this._parentToChild=o,void 0===e.setChild&&(e.setChild=r),void 0===e.setParent&&(e.setParent=r),void 0!==e.priority&&(c.setPriority(e.child,e.priority),c.setPriority(e.parent,e.priority));var s=2*e.cycles,l=s+("childSticksToParent"===e.sticky?1:0),h=s+("parentSticksToChild"===e.sticky?1:0);this._bindingState={child:!1,parent:!1},this._updateChild=function(r){u.call(this,{bindingState:this._bindingState,newValue:r,debugObservableName:"child",debugPartnerName:"parent",observable:e.child,setValue:e.setChild,semaphore:t,allowedUpdates:l,sticky:"parentSticksToChild"===e.sticky,partner:e.parent,setPartner:e.setParent,partnerSemaphore:n})}.bind(this),this._updateParent=function(r){u.call(this,{bindingState:this._bindingState,newValue:r,debugObservableName:"parent",debugPartnerName:"child",observable:e.parent,setValue:e.setParent,semaphore:n,allowedUpdates:h,sticky:"childSticksToParent"===e.sticky,partner:e.child,setPartner:e.setChild,partnerSemaphore:t})}.bind(this)}function u(e){var t=e.bindingState;if(!1!==t.child||!1!==t.parent){var n=e.semaphore;if(n.value+e.partnerSemaphore.value<=e.allowedUpdates&&(p.batch.start(),n.increment(e),e.setValue(e.newValue,e.observable),p.mutateQueue.enqueue(n.decrement,n,[]),p.batch.stop(),e.sticky)){var r=c.getValue(e.observable);r!==c.getValue(e.partner)&&e.setPartner(r,e.partner)}}}var c=e("can-reflect"),l=e("can-symbol"),h=e("can-namespace"),p=e("can-queues"),f=e("can-assign"),d=(l.for("can.getChangesDependencyRecord"),l.for("can.getValue")),m=l.for("can.onValue"),g=l.for("can.setValue");f(a.prototype,{decrement:function(){this.value-=1},increment:function(e){this._incremented=!0,this.value+=1}}),Object.defineProperty(s.prototype,"parentValue",{get:function(){return c.getValue(this._options.parent)}}),f(s.prototype,{start:function(){var e,t,n=this._options;this.startParent(),this.startChild(),!0===this._childToParent&&!0===this._parentToChild?void 0===(t=c.getValue(n.parent))?void 0===(e=c.getValue(n.child))?!1===n.onInitDoNotUpdateChild&&this._updateChild(t):!1===n.onInitDoNotUpdateParent&&!0===n.onInitSetUndefinedParentIfChildIsDefined&&this._updateParent(e):!1===n.onInitDoNotUpdateChild&&this._updateChild(t):!0===this._childToParent?!1===n.onInitDoNotUpdateParent&&(e=c.getValue(n.child),this._updateParent(e)):!0===this._parentToChild&&!1===n.onInitDoNotUpdateChild&&(t=c.getValue(n.parent),this._updateChild(t))},startChild:function(){if(!1===this._bindingState.child&&!0===this._childToParent){var e=this._options;this._bindingState.child=!0,o(e.child,e.parent,this._updateParent,e.queue)}},startParent:function(){if(!1===this._bindingState.parent&&!0===this._parentToChild){var e=this._options;this._bindingState.parent=!0,o(e.parent,e.child,this._updateChild,e.queue)}},stop:function(){var e=this._bindingState,t=this._options;!0===e.parent&&!0===this._parentToChild&&(e.parent=!1,i(t.parent,t.child,this._updateChild,t.queue)),!0===e.child&&!0===this._childToParent&&(e.child=!1,i(t.child,t.parent,this._updateParent,t.queue))}}),n.exports=h.Bind=s}),define("can-stache@4.15.9#expressions/arg",function(e,t,n){"use strict";var r=function(e,t){this.expr=e,this.modifiers=t||{},this.isCompute=!1};r.prototype.value=function(){return this.expr.value.apply(this.expr,arguments)},n.exports=r}),define("can-stache@4.15.9#expressions/literal",function(e,t,n){"use strict";var r=function(e){this._value=e};r.prototype.value=function(){return this._value},n.exports=r}),define("can-observation-recorder@1.3.0#can-observation-recorder",["require","exports","module","can-namespace","can-symbol"],function(e,t,n){"use strict";var r=e("can-namespace"),i=e("can-symbol"),o=[],a=i.for("can.addParent"),s=i.for("can.getValue"),u={stack:o,start:function(e){var t={keyDependencies:new Map,valueDependencies:new Set,childDependencies:new Set,traps:null,ignore:0,name:e};return o.push(t),t},stop:function(){return o.pop()},add:function(e,t){var n=o[o.length-1];if(n&&0===n.ignore)if(n.traps)n.traps.push([e,t]);else if(void 0===t)n.valueDependencies.add(e);else{var r=n.keyDependencies.get(e);r||(r=new Set,n.keyDependencies.set(e,r)),r.add(t)}},addMany:function(e){var t=o[o.length-1];if(t)if(t.traps)t.traps.push.apply(t.traps,e);else for(var n=0,r=e.length;n<r;n++)this.add(e[n][0],e[n][1])},created:function(e){var t=o[o.length-1];t&&(t.childDependencies.add(e),e[a]&&e[a](t))},ignore:function(e){return function(){if(o.length){var t=o[o.length-1];t.ignore++;var n=e.apply(this,arguments);return t.ignore--,n}return e.apply(this,arguments)}},peekValue:function(e){if(!e||!e[s])return e;if(o.length){var t=o[o.length-1];t.ignore++;var n=e[s]();return t.ignore--,n}return e[s]()},isRecording:function(){var e=o.length,t=e&&o[e-1];return t&&0===t.ignore&&t},makeDependenciesRecord:function(e){return{traps:null,keyDependencies:new Map,valueDependencies:new Set,ignore:0,name:e}},makeDependenciesRecorder:function(){return u.makeDependenciesRecord()},trap:function(){if(o.length){var e=o[o.length-1],t=e.traps,n=e.traps=[];return function(){return e.traps=t,n}}return function(){return[]}},trapsCount:function(){return o.length?o[o.length-1].traps.length:0}};if(r.ObservationRecorder)throw new Error("You can't have two versions of can-observation-recorder, check your dependencies");n.exports=r.ObservationRecorder=u}),define("can-key-tree@1.2.0#can-key-tree",["require","exports","module","can-reflect"],function(e,t,n){"use strict";function r(e){if(e===Object.prototype)return!0;var t=Object.prototype.toString.call(e),n="[object Object]"!==t,r=-1!==t.indexOf("[object ");return n&&r}function i(e,t){if(0===t)return s.size(e);if(0===s.size(e))return 0;var n=0;return s.each(e,function(e){n+=i(e,t-1)}),n}function o(e,t,n,r){if(e)if(r===n){if(!s.isMoreListLikeThanMapLike(e))throw new Error("can-key-tree: Map-type leaf containers are not supported yet.");s.addValues(t,s.toArray(e))}else s.each(e,function(e){o(e,t,n+1,r)})}function a(e,t,n,r){if(n===t.length){if(!s.isMoreListLikeThanMapLike(e))throw new Error("can-key-tree: Map-type leaf containers are not supported yet.");var i=s.toArray(e);r&&i.forEach(function(e){r.apply(null,t.concat(e))}),s.removeValues(e,i)}else s.each(e,function(i,o){a(i,t.concat(o),n,r),s.deleteKeyValue(e,o)})}var s=e("can-reflect"),u=function(e,t){var n=e[0];s.isConstructorLike(n)?this.root=new n:this.root=n,this.callbacks=t||{},this.treeStructure=e,this.empty=!0};s.assign(u.prototype,{add:function(e){if(e.length>this.treeStructure.length)throw new Error("can-key-tree: Can not add path deeper than tree.");for(var t=this.root,n=!0===this.empty,i=0;i<e.length-1;i++){var o=e[i],a=s.getKeyValue(t,o);if(!a){var u=this.treeStructure[i+1];a=r(u.prototype)?new u:new u(o),s.setKeyValue(t,o,a)}t=a}if(!s.isMoreListLikeThanMapLike(t))throw new Error("can-key-tree: Map types are not supported yet.");return s.addValues(t,[e[e.length-1]]),n&&(this.empty=!1,this.callbacks.onFirst&&this.callbacks.onFirst.call(this)),this},getNode:function(e){for(var t=this.root,n=0;n<e.length;n++){var r=e[n];if(!(t=s.getKeyValue(t,r)))return}return t},get:function(e){var t=this.getNode(e);if(this.treeStructure.length===e.length)return t;var n=new(0,this.treeStructure[this.treeStructure.length-1]);return o(t,n,e.length,this.treeStructure.length-1),n},delete:function(e,t){for(var n=this.root,r=[this.root],i=e[e.length-1],o=0;o<e.length-1;o++){var u=e[o],c=s.getKeyValue(n,u);if(void 0===c)return!1;r.push(c),n=c}if(e.length)if(e.length===this.treeStructure.length){if(!s.isMoreListLikeThanMapLike(n))throw new Error("can-key-tree: Map types are not supported yet.");t&&t.apply(null,e.concat(i)),s.removeValues(n,[i])}else{var l=s.getKeyValue(n,i);if(void 0===l)return!1;a(l,e,this.treeStructure.length-1,t),s.deleteKeyValue(n,i)}else a(n,[],this.treeStructure.length-1,t);for(o=r.length-2;o>=0&&0===s.size(n);o--)n=r[o],s.deleteKeyValue(n,e[o]);return 0===s.size(this.root)&&(this.empty=!0,this.callbacks.onEmpty&&this.callbacks.onEmpty.call(this)),!0},size:function(){return i(this.root,this.treeStructure.length-1)},isEmpty:function(){return this.empty}}),n.exports=u}),define("can-define-lazy-value@1.1.0#define-lazy-value",function(e,t,n){"use strict";n.exports=function(e,t,n,r){Object.defineProperty(e,t,{configurable:!0,get:function(){Object.defineProperty(this,t,{value:void 0,writable:!0});var i=n.call(this,e,t);return Object.defineProperty(this,t,{value:i,writable:!!r}),i},set:function(e){return Object.defineProperty(this,t,{value:e,writable:!!r}),e}})}}),define("can-event-queue@1.1.3#dependency-record/merge",["require","exports","module","can-reflect"],function(e,t,n){"use strict";var r=e("can-reflect"),i=function(e,t){var n=t.valueDependencies;if(n){var i=e.valueDependencies;i||(i=new Set,e.valueDependencies=i),r.eachIndex(n,function(e){i.add(e)})}},o=function(e,t){var n=t.keyDependencies;if(n){var i=e.keyDependencies;i||(i=new Map,e.keyDependencies=i),r.eachKey(n,function(e,t){var n=i.get(t);n||(n=new Set,i.set(t,n)),r.eachIndex(e,function(e){n.add(e)})})}};n.exports=function(e,t){return o(e,t),i(e,t),e}}),define("can-event-queue@1.1.3#value/value",["require","exports","module","can-queues","can-key-tree","can-reflect","can-define-lazy-value","../dependency-record/merge"],function(e,t,n){"use strict";function r(){return new o([Object,Array],{onFirst:void 0!==this.onBound&&this.onBound.bind(this),onEmpty:void 0!==this.onUnbound&&this.onUnbound.bind(this)})}var i=e("can-queues"),o=e("can-key-tree"),a=e("can-reflect"),s=e("can-define-lazy-value"),u=(e("../dependency-record/merge"),{on:function(e,t){this.handlers.add([t||"mutate",e])},off:function(e,t){void 0===e?void 0===t?this.handlers.delete([]):this.handlers.delete([t]):this.handlers.delete([t||"mutate",e])}}),c={"can.onValue":u.on,"can.offValue":u.off,"can.dispatch":function(e,t){var n=[];n=[this.handlers.getNode([]),this,[e,t]],i.enqueueByQueue.apply(i,n)},"can.getWhatIChange":function(){},"can.isBound":function(){return!this.handlers.isEmpty()}},l=function(e){return a.assign(e,u),a.assignSymbols(e,c),s(e,"handlers",r,!0),e};l.addHandlers=function(e,t){return console.warn("can-event-queue/value: Avoid using addHandlers. Add onBound and onUnbound methods instead."),e.handlers=new o([Object,Array],t),e},n.exports=l}),define("can-observation@4.1.1#recorder-dependency-helpers",["require","exports","module","can-reflect"],function(e,t,n){"use strict";function r(e){void 0!==this.oldEventSet&&!1!==this.oldEventSet.delete(e)||c.onKeyValue(this.observable,e,this.onDependencyChange,"notify")}function i(e,t){e.forEach(r,{onDependencyChange:this.onDependencyChange,observable:t,oldEventSet:this.oldDependencies.keyDependencies.get(t)})}function o(e){c.offKeyValue(this.observable,e,this.onDependencyChange,"notify")}function a(e,t){e.forEach(o,{onDependencyChange:this.onDependencyChange,observable:t})}function s(e){!1===this.oldDependencies.valueDependencies.delete(e)&&c.onValue(e,this.onDependencyChange,"notify")}function u(e){c.offValue(e,this.onDependencyChange,"notify")}var c=e("can-reflect");n.exports={updateObservations:function(e){e.newDependencies.keyDependencies.forEach(i,e),e.oldDependencies.keyDependencies.forEach(a,e),e.newDependencies.valueDependencies.forEach(s,e),e.oldDependencies.valueDependencies.forEach(u,e)},stopObserving:function(e,t){e.keyDependencies.forEach(a,{onDependencyChange:t}),e.valueDependencies.forEach(u,{onDependencyChange:t})}}}),define("can-observation@4.1.1#temporarily-bind",["require","exports","module","can-reflect"],function(e,t,n){"use strict";var r,i=e("can-reflect"),o=function(){},a=function(){for(var e=0,t=r.length;e<t;e++)i.offValue(r[e],o);r=null};n.exports=function(e){var t=e.computeInstance||e;i.onValue(t,o),r||(r=[],setTimeout(a,10)),r.push(t)}}),define("can-observation@4.1.1#can-observation",["require","exports","module","can-namespace","can-reflect","can-queues","can-observation-recorder","can-symbol","can-log/dev/dev","can-event-queue/value/value","./recorder-dependency-helpers","./temporarily-bind"],function(e,t,n){!function(e,t,n,r){"use strict";function i(e,t,n){this.func=e,this.context=t,this.options=n||{priority:0,isObservable:!0},this.bound=!1,this._value=void 0,this.newDependencies=u.makeDependenciesRecord(),this.oldDependencies=null;var r=this;this.onDependencyChange=function(e){r.dependencyChange(this,e)},this.update=this.update.bind(this)}var o=t("can-namespace"),a=t("can-reflect"),s=t("can-queues"),u=t("can-observation-recorder"),c=t("can-symbol"),l=(t("can-log/dev/dev"),t("can-event-queue/value/value")),h=t("./recorder-dependency-helpers"),p=t("./temporarily-bind"),f=c.for("can.dispatch"),d=(c.for("can.getChangesDependencyRecord"),c.for("can.getValueDependencies"));l(i.prototype),a.assign(i.prototype,{onBound:function(){this.bound=!0,this.oldDependencies=this.newDependencies,u.start(),this._value=this.func.call(this.context),this.newDependencies=u.stop(),h.updateObservations(this)},dependencyChange:function(e,t){if(!0===this.bound){var n=[];n=[this.update,this,[],{priority:this.options.priority}],s.deriveQueue.enqueue.apply(s.deriveQueue,n)}},update:function(){if(!0===this.bound){var e=this._value;this.oldValue=null,this.onBound(),e!==this._value&&this[f](this._value,e)}},onUnbound:function(){this.bound=!1,h.stopObserving(this.newDependencies,this.onDependencyChange),this.newDependencies=u.makeDependenciesRecorder()},get:function(){return this.options.isObservable&&u.isRecording()&&(u.add(this),this.bound||i.temporarilyBind(this)),!0===this.bound?(s.deriveQueue.tasksRemainingCount()>0&&i.updateChildrenAndSelf(this),this._value):this.func.call(this.context)},hasDependencies:function(){var e=this.newDependencies;return this.bound?e.valueDependencies.size+e.keyDependencies.size>0:void 0},log:function(){}}),Object.defineProperty(i.prototype,"value",{get:function(){return this.get()}});var m={"can.getValue":i.prototype.get,"can.isValueLike":!0,"can.isMapLike":!1,"can.isListLike":!1,"can.valueHasDependencies":i.prototype.hasDependencies,"can.getValueDependencies":function(){if(!0===this.bound){var e=this.newDependencies,t={};return e.keyDependencies.size&&(t.keyDependencies=e.keyDependencies),e.valueDependencies.size&&(t.valueDependencies=e.valueDependencies),t}},"can.getPriority":function(){return this.options.priority},"can.setPriority":function(e){this.options.priority=e}};a.assignSymbols(i.prototype,m),i.updateChildrenAndSelf=function(e){if(void 0!==e.update&&!0===s.deriveQueue.isEnqueued(e.update))return s.deriveQueue.flushQueuedTask(e.update),!0;if(e[d]){var t=!1;return(e[d]().valueDependencies||[]).forEach(function(e){!0===i.updateChildrenAndSelf(e)&&(t=!0)}),t}return!1};var g={addAll:"addMany"};["add","addAll","ignore","trap","trapsCount","isRecording"].forEach(function(e){i[e]=function(){var t=g[e]?g[e]:e;return console.warn("can-observation: Call "+t+"() on can-observation-recorder."),u[t].apply(this,arguments)}}),i.prototype.start=function(){return console.warn("can-observation: Use .on and .off to bind."),this.onBound()},i.prototype.stop=function(){return console.warn("can-observation: Use .on and .off to bind."),this.onUnbound()},i.temporarilyBind=p,r.exports=o.Observation=i}(0,e,0,n)}),define("can-reflect-promise@2.2.0#can-reflect-promise",["require","exports","module","can-reflect","can-symbol","can-observation-recorder","can-queues","can-key-tree","can-log/dev/dev"],function(e,t,n){"use strict";function r(e,t,n){var r=e[p],i=r[t];r[t]=n,c.enqueueByQueue(r.handlers.getNode([t]),e,[n,i],function(){return{}},["Promise",e,"resolved with value",n,"and changed virtual property: "+t])}function i(e){var t=e[p];t||(Object.defineProperty(e,p,{enumerable:!1,configurable:!1,writable:!1,value:Object.create(f)}),(t=e[p]).handlers=new l([Object,Object,Array])),e.then(function(t){c.batch.start(),r(e,"isPending",!1),r(e,"isResolved",!0),r(e,"value",t),r(e,"state","resolved"),c.batch.stop()},function(t){c.batch.start(),r(e,"isPending",!1),r(e,"isRejected",!0),r(e,"reason",t),r(e,"state","rejected"),c.batch.stop()})}function o(e){var t,n="getPrototypeOf"in Object?Object.getPrototypeOf(e):e.__proto__;e[h]&&e[p]||(null!==n&&n!==Object.prototype||"function"==typeof(n=e).promise&&(t=n.promise,n.promise=function(){var e=t.call(n);return o(e),e}),a.assignSymbols(n,{"can.getKeyValue":function(e){switch(this[p]||i(this),u.add(this,e),e){case"state":case"isPending":case"isResolved":case"isRejected":case"value":case"reason":return this[p][e];default:return this[e]}},"can.getValue":function(){return this[h]("value")},"can.isValueLike":!1,"can.onKeyValue":function(e,t,n){this[p]||i(this),this[p].handlers.add([e,n||"mutate",t])},"can.offKeyValue":function(e,t,n){this[p]||i(this),this[p].handlers.delete([e,n||"mutate",t])},"can.hasOwnKey":function(e){return this[p]||i(this),e in this[p]}}))}var a=e("can-reflect"),s=e("can-symbol"),u=e("can-observation-recorder"),c=e("can-queues"),l=e("can-key-tree"),h=(e("can-log/dev/dev"),s.for("can.getKeyValue")),p=s.for("can.meta"),f={isPending:!0,state:"pending",isResolved:!1,isRejected:!1,value:void 0,reason:void 0};n.exports=o}),define("can-stache-key@1.4.0#can-stache-key",["require","exports","module","can-observation-recorder","can-log/dev/dev","can-symbol","can-reflect","can-reflect-promise"],function(e,t,n){"use strict";var r,i=e("can-observation-recorder"),o=e("can-log/dev/dev"),a=e("can-symbol"),s=e("can-reflect"),u=e("can-reflect-promise"),c=a.for("can.getValue"),l=a.for("can.setValue"),h=a.for("can.isValueLike"),p=i.ignore(s.getKeyValue.bind(s)),f=Function.prototype.bind,d=function(e,t){var n=t[e-1];return n&&n.at},m=function(e,t,n,i,o,a){var s;do{s=!1;for(var u=0,c=r.valueReaders.length;u<c;u++)r.valueReaders[u].test(e,t,n,i)&&(e=r.valueReaders[u].read(e,t,n,i,o,a))}while(s);return e},g=function(e,t,n,r,o){e.foundObservable&&!t.foundObservable&&i.trapsCount()&&(i.addMany(n()),e.foundObservable(r,o),t.foundObservable=!0)},y=function(e,t,n){return!!(t&&t.length&&s.hasKey(e,t[n].key))};(r={read:function(e,t,n){var o,a={foundObservable:!1};(n=n||{}).foundObservable&&(o=i.trap());var s,u,c=m(e,0,t,n,a),l=t.length,h=0;for(g(n,a,o,e,0);h<l;){s=c;for(var p=0,f=r.propertyReaders.length;p<f;p++){var d=r.propertyReaders[p];if(d.test(c)){c=d.read(c,t[h],h,n,a);break}}if(g(n,a,o,s,h),h+=1,c=m(c,h,t,n,a,s),g(n,a,o,s,h-1),h<t.length&&(null===c||void 0===c))return u=y(s,t,h-1),n.earlyExit&&!u&&n.earlyExit(s,h-1,c),{value:void 0,parent:s,parentHasKey:u,foundLastParent:!1}}return u=y(s,t,t.length-1),void 0!==c||u||n.earlyExit&&n.earlyExit(s,h-1),{value:c,parent:s,parentHasKey:u,foundLastParent:!0}},get:function(e,t,n){return r.read(e,r.reads(t),n||{}).value},valueReadersMap:{},valueReaders:[{name:"function",test:function(e){return e&&s.isFunctionLike(e)&&!s.isConstructorLike(e)},read:function(e,t,n,r,i,a){return r.callMethodsOnObservables&&s.isObservableLike(a)&&s.isMapLike(a)?(o.warn("can-stache-key: read() called with `callMethodsOnObservables: true`."),e.apply(a,r.args||[])):!1!==r.proxyMethods?f.call(e,a):e}},{name:"isValueLike",test:function(e,t,n,r){return e&&e[c]&&!1!==e[h]&&(r.foundAt||!d(t,n))},read:function(e,t,n,r){return!1===r.readCompute&&t===n.length?e:s.getValue(e)},write:function(e,t){e[l]?e[l](t):e.set?e.set(t):e(t)}}],propertyReadersMap:{},propertyReaders:[{name:"map",test:function(e){return(s.isPromise(e)||"object"==typeof e&&e&&"function"==typeof e.then)&&u(e),s.isObservableLike(e)&&s.isMapLike(e)},read:function(e,t){var n=s.getKeyValue(e,t.key);return void 0!==n?n:e[t.key]},write:s.setKeyValue},{name:"object",test:function(){return!0},read:function(e,t,n,r){if(null!=e)return"object"!=typeof e?e[t.key]:t.key in e?e[t.key]:void 0},write:function(e,t,n){var r=e[t];null!=n&&"object"==typeof n&&s.isMapLike(r)?(o.warn('can-stache-key: Merging data into "'+t+'" because its parent is non-observable'),s.update(r,n)):null!=r&&void 0!==r[l]?s.setValue(r,n):e[t]=n}}],reads:function(e){var t=""+e,n=[],r=0,i=!1;"@"===t.charAt(0)&&(r=1,i=!0);for(var o="",a=r;a<t.length;a++){var s=t.charAt(a);"."===s||"@"===s?"\\"!==t.charAt(a-1)?(n.push({key:o,at:i}),i="@"===s,o=""):o=o.substr(0,o.length-1)+".":o+=s}return n.push({key:o,at:i}),n},write:function(e,t,n,i){var o,a="string"==typeof t?r.reads(t):t;if(i=i||{},a.length>1?(o=a.pop(),e=r.read(e,a,i).value,a.push(o)):o=a[0],e){var s=p(e,o.key);r.valueReadersMap.isValueLike.test(s,a.length-1,a,i)?r.valueReadersMap.isValueLike.write(s,n,i):(r.valueReadersMap.isValueLike.test(e,a.length-1,a,i)&&(e=e[c]()),r.propertyReadersMap.map.test(e)?r.propertyReadersMap.map.write(e,o.key,n,i):r.propertyReadersMap.object.test(e)&&(r.propertyReadersMap.object.write(e,o.key,n,i),i.observation&&i.observation.update()))}}}).propertyReaders.forEach(function(e){r.propertyReadersMap[e.name]=e}),r.valueReaders.forEach(function(e){r.valueReadersMap[e.name]=e}),r.set=r.write,n.exports=r}),define("can-cid@1.3.0#can-cid",["require","exports","module","can-namespace"],function(e,t,n){"use strict";var r=e("can-namespace"),i=0,o="can"+new Date,a=function(e,t){var n=e.nodeName?o:"_cid";return e[n]||(i++,e[n]=(t||"")+i),e[n]};if(a.domExpando=o,a.get=function(e){var t=typeof e;return null===t||"object"!==t&&"function"!==t?t+":"+e:a(e)},r.cid)throw new Error("You can't have two versions of can-cid, check your dependencies");n.exports=r.cid=a}),define("can-single-reference@1.2.0#can-single-reference",["require","exports","module","can-cid"],function(e,t,n){!function(e,t,n,r){"use strict";function i(e,t){return(t?a(e)+":"+t:a(e))||e}var o,a=t("can-cid");o={set:function(e,t,n,r){e[i(t,r)]=n},getAndDelete:function(e,t,n){var r=i(t,n),o=e[r];return delete e[r],o}},r.exports=o}(0,e,0,n)}),define("can-view-scope@4.12.0#make-compute-like",["require","exports","module","can-single-reference","can-reflect"],function(e,t,n){"use strict";var r=e("can-single-reference"),i=e("can-reflect"),o=function(e){return arguments.length?i.setValue(this,e):i.getValue(this)};n.exports=function(e){var t=o.bind(e);return t.on=t.bind=t.addEventListener=function(n,i){var o=function(e,n){i.call(t,{type:"change"},e,n)};r.set(i,this,o),e.on(o)},t.off=t.unbind=t.removeEventListener=function(t,n){e.off(r.getAndDelete(n,this))},i.assignSymbols(t,{"can.getValue":function(){return i.getValue(e)},"can.setValue":function(t){return i.setValue(e,t)},"can.onValue":function(t,n){return i.onValue(e,t,n)},"can.offValue":function(t,n){return i.offValue(e,t,n)},"can.valueHasDependencies":function(){return i.valueHasDependencies(e)},"can.getPriority":function(){return i.getPriority(e)},"can.setPriority":function(t){i.setPriority(e,t)},"can.isValueLike":!0,"can.isFunctionLike":!1}),t.isComputed=!0,t}}),define("can-simple-observable@2.4.1#log",["require","exports","module","can-log/dev/dev","can-reflect"],function(e,t,n){"use strict";e("can-log/dev/dev"),e("can-reflect"),n.exports=function(){}}),define("can-simple-observable@2.4.1#can-simple-observable",["require","exports","module","./log","can-namespace","can-symbol","can-reflect","can-observation-recorder","can-event-queue/value/value"],function(e,t,n){"use strict";function r(e){this._value=e}var i=e("./log"),o=e("can-namespace"),a=e("can-symbol"),s=e("can-reflect"),u=e("can-observation-recorder"),c=e("can-event-queue/value/value"),l=a.for("can.dispatch");c(r.prototype),s.assignMap(r.prototype,{log:i,get:function(){return u.add(this),this._value},set:function(e){var t=this._value;this._value=e,this[l](e,t)}}),Object.defineProperty(r.prototype,"value",{set:function(e){return this.set(e)},get:function(){return this.get()}});var h={"can.getValue":r.prototype.get,"can.setValue":r.prototype.set,"can.isMapLike":!1,"can.valueHasDependencies":function(){return!0}};s.assignSymbols(r.prototype,h),n.exports=o.SimpleObservable=r}),define("can-simple-observable@2.4.1#settable/settable",["require","exports","module","can-reflect","can-observation-recorder","../can-simple-observable","can-observation","can-queues","../log","can-event-queue/value/value"],function(e,t,n){"use strict";function r(e,t,n){this.lastSetValue=new a(n),this.handler=this.handler.bind(this),this.observation=new s(function(){return e.call(t,this.lastSetValue.get())},this)}var i=e("can-reflect"),o=e("can-observation-recorder"),a=e("../can-simple-observable"),s=e("can-observation"),u=e("can-queues"),c=e("../log"),l=e("can-event-queue/value/value"),h=o.ignore(i.getValue.bind(i));l(r.prototype),i.assignMap(r.prototype,{log:c,constructor:r,handler:function(e){var t=this._value;this._value=e,u.enqueueByQueue(this.handlers.getNode([]),this,[e,t],null,void 0)},onBound:function(){this.bound||(this.bound=!0,this.activate())},activate:function(){i.onValue(this.observation,this.handler,"notify"),this._value=h(this.observation)},onUnbound:function(){this.bound=!1,i.offValue(this.observation,this.handler,"notify")},set:function(e){var t=this.lastSetValue.get();i.isObservableLike(t)&&i.isValueLike(t)&&!i.isObservableLike(e)?i.setValue(t,e):e!==t&&this.lastSetValue.set(e)},get:function(){return o.isRecording()&&(o.add(this),this.bound||this.onBound()),!0===this.bound?this._value:this.observation.get()},hasDependencies:function(){return i.valueHasDependencies(this.observation)},getValueDependencies:function(){return i.getValueDependencies(this.observation)}}),Object.defineProperty(r.prototype,"value",{set:function(e){return this.set(e)},get:function(){return this.get()}}),i.assignSymbols(r.prototype,{"can.getValue":r.prototype.get,"can.setValue":r.prototype.set,"can.isMapLike":!1,"can.getPriority":function(){return i.getPriority(this.observation)},"can.setPriority":function(e){i.setPriority(this.observation,e)},"can.valueHasDependencies":r.prototype.hasDependencies,"can.getValueDependencies":r.prototype.getValueDependencies}),n.exports=r}),define("can-simple-observable@2.4.1#setter/setter",["require","exports","module","can-reflect","can-observation","../settable/settable","can-event-queue/value/value"],function(e,t,n){"use strict";function r(e,t){this.setter=t,this.observation=new o(e),this.handler=this.handler.bind(this)}var i=e("can-reflect"),o=e("can-observation"),a=e("../settable/settable");e("can-event-queue/value/value"),(r.prototype=Object.create(a.prototype)).constructor=r,r.prototype.set=function(e){this.setter(e)},r.prototype.hasDependencies=function(){return i.valueHasDependencies(this.observation)},i.assignSymbols(r.prototype,{"can.setValue":r.prototype.set,"can.valueHasDependencies":r.prototype.hasDependencies}),n.exports=r}),define("can-stache@4.15.9#src/expression-helpers",["require","exports","module","../expressions/arg","../expressions/literal","can-reflect","can-stache-key","can-symbol","can-observation","can-view-scope/make-compute-like","can-simple-observable/setter/setter"],function(e,t,n){"use strict";var r=e("../expressions/arg"),i=e("../expressions/literal"),o=e("can-reflect"),a=e("can-stache-key"),s=e("can-symbol"),u=e("can-observation"),c=e("can-view-scope/make-compute-like"),l=e("can-simple-observable/setter/setter");n.exports={getObservableValue_fromKey:function(e,t,n){var r=t.computeData(e,n);return u.temporarilyBind(r),r},computeHasDependencies:function(e){return e[s.for("can.valueHasDependencies")]?o.valueHasDependencies(e):e.computeInstance.hasDependencies},getObservableValue_fromDynamicKey_fromObservable:function(e,t,n,r){var i,s=function(){return a.reads((""+o.getValue(e)).replace(/\./g,"\\."))},c=new l(function(){var e=a.read(o.getValue(t),s());return i=e.parentHasKey,e.value},function(e){a.write(o.getValue(t),s(),e)});return u.temporarilyBind(c),c.initialValue=o.getValue(c),c.parentHasKey=i,c},convertToArgExpression:function(e){return e instanceof r||e instanceof i?e:new r(e)},toComputeOrValue:function(e){return o.isObservableLike(e)?o.isValueLike(e)&&!1===o.valueHasDependencies(e)?o.getValue(e):e.compute?e.compute:c(e):e},toCompute:function(e){return e?e.isComputed?e:e.compute?e.compute:c(e):e}}}),define("can-stache@4.15.9#expressions/hashes",["require","exports","module","can-reflect","can-observation","../src/expression-helpers"],function(e,t,n){"use strict";var r=e("can-reflect"),i=e("can-observation"),o=e("../src/expression-helpers"),a=function(e){this.hashExprs=e};a.prototype.value=function(e,t){var n={};for(var a in this.hashExprs){var s=o.convertToArgExpression(this.hashExprs[a]),u=s.value.apply(s,arguments);n[a]={call:!s.modifiers||!s.modifiers.compute,value:u}}return new i(function(){var e={};for(var t in n)e[t]=n[t].call?r.getValue(n[t].value):o.toComputeOrValue(n[t].value);return e})},n.exports=a}),define("can-stache@4.15.9#expressions/bracket",["require","exports","module","../src/expression-helpers"],function(e,t,n){"use strict";var r=e("../src/expression-helpers"),i=function(e,t,n){this.root=t,this.key=e};i.prototype.value=function(e,t){var n=this.root?this.root.value(e,t):e.peek("this");return r.getObservableValue_fromDynamicKey_fromObservable(this.key.value(e,t),n,e,t,{})},i.prototype.closingTag=function(){},n.exports=i}),define("can-stache@4.15.9#src/set-identifier",function(e,t,n){"use strict";n.exports=function(e){this.value=e}}),define("can-string@1.0.0#can-string",function(e,t,n){"use strict";var r=/\=\=/,i=/([A-Z]+)([A-Z][a-z])/g,o=/([a-z\d])([A-Z])/g,a=/([a-z\d])([A-Z])/g,s=/"/g,u=/'/g,c=/-+(.)?/g,l=/[a-z][A-Z]/g,h=function(e){return""+(null===e||void 0===e||isNaN(e)&&""+e=="NaN"?"":e)},p={esc:function(e){return h(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(s,"&#34;").replace(u,"&#39;")},capitalize:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},camelize:function(e){return h(e).replace(c,function(e,t){return t?t.toUpperCase():""})},hyphenate:function(e){return h(e).replace(l,function(e){return e.charAt(0)+"-"+e.charAt(1).toLowerCase()})},underscore:function(e){return e.replace(r,"/").replace(i,"$1_$2").replace(o,"$1_$2").replace(a,"_").toLowerCase()},undHash:/_|-/};n.exports=p}),define("can-construct@3.5.3#can-construct",["require","exports","module","can-reflect","can-log/dev/dev","can-namespace"],function(e,t,n){"use strict";var r,i=e("can-reflect"),o=(e("can-log/dev/dev"),e("can-namespace")),a=0,s=function(){if(arguments.length)return s.extend.apply(s,arguments)};try{Object.getOwnPropertyDescriptor({}),r=!0}catch(e){r=!1}var u=function(e,t){var n=Object.getOwnPropertyDescriptor(e,t);return n&&(n.get||n.set)?n:null},c=function(e,t,n){Object.defineProperty(e,t,{configurable:!0,writable:!0,enumerable:!1,value:n})};i.assignMap(s,{constructorExtends:!0,newInstance:function(){var e,t=this.instance();if(t.setup){if(Object.defineProperty(t,"__inSetup",{configurable:!0,enumerable:!1,value:!0,writable:!0}),(e=t.setup.apply(t,arguments))instanceof s.ReturnValue)return e.value;t.__inSetup=!1}return t.init&&t.init.apply(t,e||arguments),t},_inherit:r?function(e,t,n){n=n||e;var r;for(var i in e)(r=u(e,i))?this._defineProperty(n,t,i,r):s._overwrite(n,t,i,e[i])}:function(e,t,n){n=n||e;for(var r in e)s._overwrite(n,t,r,e[r])},_defineProperty:function(e,t,n,r){Object.defineProperty(e,n,r)},_overwrite:function(e,t,n,r){Object.defineProperty(e,n,{value:r,configurable:!0,enumerable:!0,writable:!0})},setup:function(e){var t=i.assignDeepMap({},e.defaults);this.defaults=i.assignDeepMap(t,this.defaults)},instance:function(){a=1;var e=new this;return a=0,e},extend:function(e,t,n){function r(){if(!a)return this&&this.constructor===h||!arguments.length||!h.constructorExtends?h.newInstance.apply(h,arguments):h.extend.apply(h,arguments)}var o=e,u=t,l=n;"string"!=typeof o&&(l=u,u=o,o=null),l||(l=u,u=null),l=l||{};var h,p,f=this,d=this.prototype;p=this.instance(),s._inherit(l,d,p),o||(u&&u.shortName?o=u.shortName:this.shortName&&(o=this.shortName)),h="function"==typeof namedCtor?namedCtor(constructorName,r):function(){return r.apply(this,arguments)};for(var m in f)f.hasOwnProperty(m)&&(h[m]=f[m]);if(s._inherit(u,f,h),i.assignMap(h,{constructor:h,prototype:p}),void 0!==o){if(Object.getOwnPropertyDescriptor){var g=Object.getOwnPropertyDescriptor(h,"name");g&&!g.configurable||Object.defineProperty(h,"name",{writable:!0,value:o,configurable:!0})}h.shortName=o}c(h.prototype,"constructor",h);var y=[f].concat(Array.prototype.slice.call(arguments)),v=h.setup.apply(h,y);return h.init&&h.init.apply(h,v||y),h},ReturnValue:function(e){this.value=e}}),c(s.prototype,"setup",function(){}),c(s.prototype,"init",function(){}),n.exports=o.Construct=s}),define("can-globals@1.2.0#can-globals-proto",["require","exports","module","can-reflect"],function(e,t,n){!function(e,t,n,r){"use strict";function i(e){var t=this.eventHandlers[e];if(t)for(var n=t.slice(),r=this.getKeyValue(e),i=0;i<n.length;i++)n[i](r)}function o(){this.eventHandlers={},this.properties={}}var a=t("can-reflect");o.prototype.define=function(e,t,n){return void 0===n&&(n=!0),this.properties[e]||(this.properties[e]={default:t,value:t,enableCache:n}),this},o.prototype.getKeyValue=function(e){var t=this.properties[e];if(t)return"function"==typeof t.value?t.cachedValue?t.cachedValue:t.enableCache?(t.cachedValue=t.value(),t.cachedValue):t.value():t.value},o.prototype.makeExport=function(e){return function(t){return 0===arguments.length?this.getKeyValue(e):void 0!==t&&null!==t?("function"==typeof t?this.setKeyValue(e,function(){return t}):this.setKeyValue(e,t),t):void this.deleteKeyValue(e)}.bind(this)},o.prototype.offKeyValue=function(e,t){if(this.properties[e]){var n=this.eventHandlers[e];if(n){var r=n.indexOf(t);n.splice(r,1)}}return this},o.prototype.onKeyValue=function(e,t){return this.properties[e]&&(this.eventHandlers[e]||(this.eventHandlers[e]=[]),this.eventHandlers[e].push(t)),this},o.prototype.deleteKeyValue=function(e){var t=this.properties[e];return void 0!==t&&(t.value=t.default,t.cachedValue=void 0,i.call(this,e)),this},o.prototype.setKeyValue=function(e,t){if(!this.properties[e])return this.define(e,t);var n=this.properties[e];return n.value=t,n.cachedValue=void 0,i.call(this,e),this},o.prototype.reset=function(){for(var e in this.properties)this.properties.hasOwnProperty(e)&&(this.properties[e].value=this.properties[e].default,this.properties[e].cachedValue=void 0,i.call(this,e));return this},a.assignSymbols(o.prototype,{"can.getKeyValue":o.prototype.getKeyValue,"can.setKeyValue":o.prototype.setKeyValue,"can.deleteKeyValue":o.prototype.deleteKeyValue,"can.onKeyValue":o.prototype.onKeyValue,"can.offKeyValue":o.prototype.offKeyValue}),r.exports=o}(0,e,0,n)}),define("can-globals@1.2.0#can-globals-instance",["require","exports","module","can-namespace","./can-globals-proto"],function(e,t,n){!function(e,t,n,r){"use strict";var i=t("can-namespace"),o=new(t("./can-globals-proto"));if(i.globals)throw new Error("You can't have two versions of can-globals, check your dependencies");r.exports=i.globals=o}(0,e,0,n)}),define("can-globals@1.2.0#global/global",["require","exports","module","can-globals/can-globals-instance"],function(e,t,n){!function(e,t,n,r){"use strict";var i=t("can-globals/can-globals-instance");i.define("global",function(){return"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:"object"==typeof process&&"[object process]"==={}.toString.call(process)?e:window}),r.exports=i.makeExport("global")}(function(){return this}(),e,0,n)}),define("can-globals@1.2.0#document/document",["require","exports","module","can-globals/global/global","can-globals/can-globals-instance"],function(e,t,n){!function(e,t,n,r){"use strict";t("can-globals/global/global");var i=t("can-globals/can-globals-instance");i.define("document",function(){return i.getKeyValue("global").document}),r.exports=i.makeExport("document")}(0,e,0,n)}),define("can-globals@1.2.0#is-node/is-node",["require","exports","module","can-globals/can-globals-instance"],function(e,t,n){!function(e,t,n,r){"use strict";var i=t("can-globals/can-globals-instance");i.define("isNode",function(){return"object"==typeof process&&"[object process]"==={}.toString.call(process)}),r.exports=i.makeExport("isNode")}(0,e,0,n)}),define("can-globals@1.2.0#is-browser-window/is-browser-window",["require","exports","module","can-globals/can-globals-instance","../is-node/is-node"],function(e,t,n){!function(e,t,n,r){"use strict";var i=t("can-globals/can-globals-instance");t("../is-node/is-node"),i.define("isBrowserWindow",function(){var e=i.getKeyValue("isNode");return"undefined"!=typeof window&&"undefined"!=typeof document&&!1===e}),r.exports=i.makeExport("isBrowserWindow")}(0,e,0,n)}),define("can-dom-events@1.3.3#helpers/util",["require","exports","module","can-globals/document/document","can-globals/is-browser-window/is-browser-window"],function(e,t,n){!function(e,t,n,r){"use strict";function i(e){return e.ownerDocument||s()}function o(e){if(!e||!e.nodeName)return e===window;var t=e.nodeType;return 1===t||9===t||11===t}function a(e,t){var n=t.type,r="inserted"===n||"removed"===n,i=!!e.disabled;return r&&i}var s=t("can-globals/document/document"),u=t("can-globals/is-browser-window/is-browser-window"),c=!1;!function(){if(u()){var e="fix_synthetic_events_on_disabled_test",t=document.createElement("input");t.disabled=!0;var n=setTimeout(function(){c=!0},50),r=function r(){clearTimeout(n),t.removeEventListener(e,r)};t.addEventListener(e,r);try{var i=document.create("HTMLEvents");i.initEvent(e,!1),t.dispatchEvent(i)}catch(e){r(),c=!0}}}(),r.exports={createEvent:function(e,t,n,r){var o,a=i(e).createEvent("HTMLEvents");if("string"==typeof t)o=t;else{o=t.type;for(var s in t)void 0===a[s]&&(a[s]=t[s])}return void 0===n&&(n=!0),a.initEvent(o,n,r),a},addDomContext:function(e,t){return o(e)&&(t=Array.prototype.slice.call(t,0)).unshift(e),t},removeDomContext:function(e,t){return o(e)||(e=(t=Array.prototype.slice.call(t,0)).shift()),{context:e,args:t}},isDomEventTarget:o,getTargetDocument:i,forceEnabledForDispatch:function(e,t){return c&&a(e,t)}}}(0,e,0,n)}),define("can-dom-events@1.3.3#helpers/make-event-registry",function(e,t,n){"use strict";function r(){this._registry={}}n.exports=function(){return new r},r.prototype.has=function(e){return!!this._registry[e]},r.prototype.get=function(e){return this._registry[e]},r.prototype.add=function(e,t){if(!e)throw new Error("An EventDefinition must be provided");if("function"!=typeof e.addEventListener)throw new TypeError("EventDefinition addEventListener must be a function");if("function"!=typeof e.removeEventListener)throw new TypeError("EventDefinition removeEventListener must be a function");if("string"!=typeof(t=t||e.defaultEventType))throw new TypeError("Event type must be a string, not "+t);if(this.has(t))throw new Error('Event "'+t+'" is already registered');this._registry[t]=e;var n=this;return function(){n._registry[t]=void 0}}}),define("can-dom-events@1.3.3#helpers/-make-delegate-event-tree",["require","exports","module","can-key-tree","can-reflect"],function(e,t,n){"use strict";function r(e){var t=function(e){this.element=e,this.events={},this.delegated={}};return o.assignSymbols(t.prototype,{"can.setKeyValue":function(t,n){var r=this.delegated[t]=function(e){o.each(n,function(t,n){var r=e.target;do{var i=r===document?document.documentElement:r,o=i.matches||i.msMatchesSelector;o&&o.call(i,n)&&t.forEach(function(t){t.call(i,e)}),r=r.parentNode}while(r&&r!==e.currentTarget)})};this.events[t]=n,e.addEventListener(this.element,t,r,a(t))},"can.getKeyValue":function(e){return this.events[e]},"can.deleteKeyValue":function(t){e.removeEventListener(this.element,t,this.delegated[t],a(t)),delete this.delegated[t],delete this.events[t]},"can.getOwnEnumerableKeys":function(){return Object.keys(this.events)}}),t}var i=e("can-key-tree"),o=e("can-reflect"),a=function(e){return"focus"===e||"blur"===e};n.exports=function(e){var t=r(e);return new i([Map,t,Object,Array])}}),define("can-dom-events@1.3.3#can-dom-events",["require","exports","module","can-namespace","./helpers/util","./helpers/make-event-registry","./helpers/-make-delegate-event-tree"],function(e,t,n){!function(e,t,n,r){"use strict";var i=t("can-namespace"),o=t("./helpers/util"),a=t("./helpers/make-event-registry"),s=t("./helpers/-make-delegate-event-tree"),u={_eventRegistry:a(),addEvent:function(e,t){return this._eventRegistry.add(e,t)},addEventListener:function(e,t){if(u._eventRegistry.has(t))return u._eventRegistry.get(t).addEventListener.apply(u,arguments);var n=Array.prototype.slice.call(arguments,1);return e.addEventListener.apply(e,n)},removeEventListener:function(e,t){if(u._eventRegistry.has(t))return u._eventRegistry.get(t).removeEventListener.apply(u,arguments);var n=Array.prototype.slice.call(arguments,1);return e.removeEventListener.apply(e,n)},addDelegateListener:function(e,t,n,r){u._eventTree.add([e,t,n,r])},removeDelegateListener:function(e,t,n,r){u._eventTree.delete([e,t,n,r])},dispatch:function(e,t,n,r){var i=o.createEvent(e,t,n,r),a=o.forceEnabledForDispatch(e,i);a&&(e.disabled=!1);var s=e.dispatchEvent(i);return a&&(e.disabled=!0),s}};u._eventTree=s(u),r.exports=i.domEvents=u}(0,e,0,n)}),define("can-event-queue@1.1.3#map/map",["require","exports","module","can-log/dev/dev","can-queues","can-reflect","can-symbol","can-key-tree","can-dom-events","can-dom-events/helpers/util","../dependency-record/merge"],function(e,t,n){"use strict";function r(e,t){t.handlers||(t.handlers=new l([Object,Object,Object,Array],{onFirst:function(){void 0!==e._eventSetup&&e._eventSetup();var t=e.constructor;void 0!==t[d]&&e instanceof t&&t[d](e,!0)},onEmpty:function(){void 0!==e._eventTeardown&&e._eventTeardown();var t=e.constructor;void 0!==t[d]&&e instanceof t&&t[d](e,!1)}})),t.listenHandlers||(t.listenHandlers=new l([Map,Map,Object,Array]))}function i(e,t,n,r){arguments.length&&u.isPrimitive(e)&&(r=n,n=t,t=e,e=this.context),"function"==typeof t&&(r=n,n=t,t=void 0),"string"==typeof n&&(r=n,n=void 0);var i=[];return e&&(i.push(e),(t||n||r)&&(i.push(t),(r||n)&&(i.push(r||this.defaultQueue),n&&i.push(n)))),i}function o(e,t,n){Object.defineProperty(e,t,{enumerable:!1,value:n})}e("can-log/dev/dev");var a,s=e("can-queues"),u=e("can-reflect"),c=e("can-symbol"),l=e("can-key-tree"),h=e("can-dom-events"),p=e("can-dom-events/helpers/util").isDomEventTarget,f=(e("../dependency-record/merge"),c.for("can.meta")),d=c.for("can.dispatchInstanceBoundChange"),m=c.for("can.dispatchInstanceOnPatches"),g=c.for("can.onKeyValue"),y=c.for("can.offKeyValue"),v=c.for("can.onEvent"),b=c.for("can.offEvent"),_=c.for("can.onValue"),w=c.for("can.offValue"),k=function(e){var t=e[f];return t||(t={},u.setKeyValue(e,f,t)),r(e,t),t},E={dispatch:function(e,t){if(!this.__inSetup){"string"==typeof e&&(e={type:e});var n=k(this).handlers,r=void 0!==e.type&&n.getNode([e.type]),i=e.patches&&this.constructor[m],o=void 0!==e.patches&&n.getNode(["can.patches","onKeyValue"]),a=void 0!==e.keyChanged&&n.getNode(["can.keys","onKeyValue"]),u=i||r||o||a;if(u&&s.batch.start(),r&&(r.onKeyValue&&s.enqueueByQueue(r.onKeyValue,this,t,e.makeMeta,e.reasonLog),r.event)){e.batchNum=s.batch.number();var c=[e].concat(t);s.enqueueByQueue(r.event,this,c,e.makeMeta,e.reasonLog)}a&&s.enqueueByQueue(a,this,[e.keyChanged],e.makeMeta,e.reasonLog),o&&s.enqueueByQueue(o,this,[e.patches],e.makeMeta,e.reasonLog),i&&this.constructor[m](this,e.patches),u&&s.batch.stop()}return e},addEventListener:function(e,t,n){return k(this).handlers.add([e,"event",n||"mutate",t]),this},removeEventListener:function(e,t,n){if(void 0===e){var r=k(this).handlers,i=r.getNode([]);Object.keys(i).forEach(function(e){r.delete([e,"event"])})}else t||n?t?k(this).handlers.delete([e,"event",n||"mutate",t]):k(this).handlers.delete([e,"event",n||"mutate"]):k(this).handlers.delete([e,"event"]);return this},one:function(e,t){var n=function(){return a.off.call(this,e,n),t.apply(this,arguments)};return a.on.call(this,e,n),this},listenTo:function(e,t,n,r){return u.isPrimitive(e)&&(r=n,n=t,t=e,e=this),"function"==typeof t&&(r=n,n=t,t=void 0),k(this).listenHandlers.add([e,t,r||"mutate",n]),a.on.call(e,t,n,r||"mutate"),this},stopListening:function(){var e=i.apply({context:this,defaultQueue:"mutate"},arguments);return k(this).listenHandlers.delete(e,function(e,t,n,r){a.off.call(e,t,r,n)}),this},on:function(e,t,n){if(p(this))"string"==typeof t?h.addDelegateListener(this,e,t,n):h.addEventListener(this,e,t,n);else if("addEventListener"in this)this.addEventListener(e,t,n);else if(this[g])u.onKeyValue(this,e,t,n);else if(this[v])this[v](e,t,n);else{if(e||!this[_])throw new Error("can-event-queue: Unable to bind "+e);u.onValue(this,t,n)}return this},off:function(e,t,n){if(p(this))"string"==typeof t?h.removeDelegateListener(this,e,t,n):h.removeEventListener(this,e,t,n);else if("removeEventListener"in this)this.removeEventListener(e,t,n);else if(this[y])u.offKeyValue(this,e,t,n);else if(this[b])this[b](e,t,n);else{if(e||!this[w])throw new Error("can-event-queue: Unable to unbind "+e);u.offValue(this,t,n)}return this}},T={"can.onKeyValue":function(e,t,n){k(this).handlers.add([e,"onKeyValue",n||"mutate",t])},"can.offKeyValue":function(e,t,n){k(this).handlers.delete([e,"onKeyValue",n||"mutate",t])},"can.isBound":function(){return!k(this).handlers.isEmpty()},"can.getWhatIChange":function(e){},"can.onPatches":function(e,t){k(this).handlers.add(["can.patches","onKeyValue",t||"notify",e])},"can.offPatches":function(e,t){k(this).handlers.delete(["can.patches","onKeyValue",t||"notify",e])}};o(a=function(e){return u.assignMap(e,E),u.assignSymbols(e,T)},"addHandlers",r),o(a,"stopListeningArgumentsToKeys",i),E.bind=E.addEventListener,E.unbind=E.removeEventListener,u.assignMap(a,E),u.assignSymbols(a,T),o(a,"start",function(){console.warn("use can-queues.batch.start()"),s.batch.start()}),o(a,"stop",function(){console.warn("use can-queues.batch.stop()"),s.batch.stop()}),o(a,"flush",function(){console.warn("use can-queues.flush()"),s.flush()}),o(a,"afterPreviousEvents",function(e){console.warn("don't use afterPreviousEvents"),s.mutateQueue.enqueue(function(){s.mutateQueue.enqueue(e)}),s.flush()}),o(a,"after",function(e){console.warn("don't use after"),s.mutateQueue.enqueue(e),s.flush()}),n.exports=a}),define("can-simple-map@4.3.0#can-simple-map",["require","exports","module","can-construct","can-event-queue/map/map","can-queues","can-observation-recorder","can-reflect","can-log/dev/dev","can-symbol"],function(e,t,n){"use strict";var r=e("can-construct"),i=e("can-event-queue/map/map"),o=e("can-queues"),a=e("can-observation-recorder"),s=e("can-reflect"),u=(e("can-log/dev/dev"),e("can-symbol"),r.extend("SimpleMap",{setup:function(e){this._data={},e&&"object"==typeof e&&this.attr(e)},attr:function(e,t){var n=this;if(0===arguments.length){a.add(this,"can.keys");var r={};return s.eachKey(this._data,function(e,t){a.add(this,t),r[t]=e},this),r}if(arguments.length>1){var i=this._data.hasOwnProperty(e),u=this._data[e];if(this._data[e]=t,u!==t){var c={keyChanged:i?void 0:e,type:e};this.dispatch(c,[t,u])}}else{if("object"!=typeof e)return"constructor"!==e?(a.add(this,e),this._data[e]):this.constructor;o.batch.start(),s.eachKey(e,function(e,t){n.attr(t,e)}),o.batch.stop()}},serialize:function(){return s.serialize(this,Map)},get:function(){return this.attr.apply(this,arguments)},set:function(){return this.attr.apply(this,arguments)},log:function(e){}}));i(u.prototype);var c={"can.isMapLike":!0,"can.isListLike":!1,"can.isValueLike":!1,"can.getKeyValue":u.prototype.get,"can.setKeyValue":u.prototype.set,"can.deleteKeyValue":function(e){var t;if(this._data.hasOwnProperty(e)){var n=this._data[e];delete this._data[e],t={keyChanged:e,type:e},this.dispatch(t,[void 0,n])}},"can.getOwnEnumerableKeys":function(){return a.add(this,"can.keys"),Object.keys(this._data)},"can.assignDeep":function(e){o.batch.start(),s.assignMap(this,e),o.batch.stop()},"can.updateDeep":function(e){o.batch.start(),s.updateMap(this,e),o.batch.stop()},"can.keyHasDependencies":function(e){return!1},"can.getKeyDependencies":function(e){},"can.hasOwnKey":function(e){return this._data.hasOwnProperty(e)}};s.assignSymbols(u.prototype,c),n.exports=u}),define("can-view-scope@4.12.0#template-context",["require","exports","module","can-simple-map"],function(e,t,n){"use strict";var r=e("can-simple-map");n.exports=function(e){e=e||{},this.vars=new r(e.vars||{}),this.helpers=new r(e.helpers||{}),this.partials=new r(e.partials||{}),this.tags=new r(e.tags||{})}}),define("can-stache-helpers@1.2.0#can-stache-helpers",["require","exports","module","can-namespace"],function(e,t,n){"use strict";var r=e("can-namespace");if(r.stacheHelpers)throw new Error("You can't have two versions of can-stache-helpers, check your dependencies");n.exports=r.stacheHelpers={}}),define("can-view-scope@4.12.0#scope-key-data",["require","exports","module","can-observation","can-stache-key","can-assign","can-reflect","can-symbol","can-observation-recorder","./make-compute-like","can-reflect-dependencies","can-event-queue/value/value","can-stache-helpers","can-simple-observable","can-log/dev/dev"],function(e,t,n){"use strict";function r(){this._value=this.newVal}function i(){this.value=this.newVal}var o=e("can-observation"),a=e("can-stache-key"),s=e("can-assign"),u=e("can-reflect"),c=e("can-symbol"),l=e("can-observation-recorder"),h=e("./make-compute-like"),p=(e("can-reflect-dependencies"),e("can-event-queue/value/value")),f=e("can-stache-helpers"),d=e("can-simple-observable"),m=(e("can-log/dev/dev"),c.for("can.dispatch")),g=l.ignore(function(e){if(e.reads&&1===e.reads.length){var t=e.root;return t&&t[c.for("can.getValue")]&&(t=u.getValue(t)),t&&u.isObservableLike(t)&&u.isMapLike(t)&&"function"!=typeof t[e.reads[0].key]&&t}}),y=function(e){return e&&"number"==typeof e.batchNum&&"string"==typeof e.type},v=function(e,t,n){this.startingScope=e,this.key=t,this.read=this.read.bind(this),this.dispatch=this.dispatch.bind(this),"debugger"===t&&(this.startingScope={_context:f},this.read=function(){var t={scope:e};return(0,f.debugger)(t)});var r=this.observation=new o(this.read,this);this.options=s({observation:this.observation},n),this.fastPath=void 0,this.root=void 0,this.reads=void 0,this.setRoot=void 0,this._thisArg=new d,this.parentHasKey=void 0;var i=new Set;i.add(r),this.dependencies={valueDependencies:i},this._latestValue=void 0};p(v.prototype),s(v.prototype,{constructor:v,dispatch:function(e){var t=this.value;this._latestValue=this.value=e,this[m].call(this,this.value,t)},onBound:function(){this.bound=!0,u.onValue(this.observation,this.dispatch,"notify");var e=g(this);e&&this.toFastPath(e),this._latestValue=this.value=l.peekValue(this.observation)},onUnbound:function(){this.bound=!1,u.offValue(this.observation,this.dispatch,"notify"),this.toSlowPath()},set:function(e){var t=this.root||this.setRoot;t?this.reads.length?a.write(t,this.reads,e,this.options):u.setValue(t,e):this.startingScope.set(this.key,e,this.options)},get:function(){return l.isRecording()&&(l.add(this),this.bound||o.temporarilyBind(this)),!0===this.bound&&!0===this.fastPath?this._latestValue:l.peekValue(this.observation)},toFastPath:function(e){var t=this,n=this.observation;this.fastPath=!0,n.dependencyChange=function(n,r){if(y(r))throw"no event objects!";return n===e&&"function"!=typeof r?(t._latestValue=r,this.newVal=r):t.toSlowPath(),o.prototype.dependencyChange.apply(this,arguments)},n.hasOwnProperty("_value")?n.onBound=r:n.onBound=i},toSlowPath:function(){this.observation.dependencyChange=o.prototype.dependencyChange,this.observation.onBound=o.prototype.onBound,this.fastPath=!1},read:function(){var e;return this.root?(e=a.read(this.root,this.reads,this.options),this.thisArg=e.parent,e.value):(e=this.startingScope.read(this.key,this.options),this.scope=e.scope,this.reads=e.reads,this.root=e.rootObserve,this.setRoot=e.setRoot,this.thisArg=e.thisArg,this.parentHasKey=e.parentHasKey,e.value)},hasDependencies:function(){return this.bound||o.temporarilyBind(this),u.valueHasDependencies(this.observation)}}),Object.defineProperty(v.prototype,"thisArg",{get:function(){return this._thisArg.get()},set:function(e){this._thisArg.set(e)}});var b={"can.getValue":v.prototype.get,"can.setValue":v.prototype.set,"can.valueHasDependencies":v.prototype.hasDependencies,"can.getValueDependencies":function(){return this.dependencies},"can.getPriority":function(){return u.getPriority(this.observation)},"can.setPriority":function(e){u.setPriority(this.observation,e)}};u.assignSymbols(v.prototype,b),Object.defineProperty(v.prototype,"compute",{get:function(){var e=h(this);return Object.defineProperty(this,"compute",{value:e,writable:!1,configurable:!1}),e},configurable:!0}),Object.defineProperty(v.prototype,"initialValue",{get:function(){return this.bound||o.temporarilyBind(this),this.get()},set:function(){throw new Error("initialValue should not be set")},configurable:!0}),n.exports=v}),define("can-view-scope@4.12.0#compute_data",["require","exports","module","./scope-key-data"],function(e,t,n){"use strict";var r=e("./scope-key-data");n.exports=function(e,t,n){return new r(e,t,n||{args:[]})}}),define("can-view-scope@4.12.0#can-view-scope",["require","exports","module","can-stache-key","can-observation-recorder","./template-context","./compute_data","can-assign","can-namespace","can-reflect","can-log/dev/dev","can-define-lazy-value","can-stache-helpers","can-simple-map"],function(e,t,n){!function(e,t,n,r){"use strict";function i(e){return null!=e}function o(){return!1}function a(e,t,n){this._context=e,this._parent=t,this._meta=n||{},this.__cache={}}var s=t("can-stache-key"),u=t("can-observation-recorder"),c=t("./template-context"),l=t("./compute_data"),h=t("can-assign"),p=t("can-namespace"),f=t("can-reflect"),d=t("can-log/dev/dev"),m=t("can-define-lazy-value"),g=t("can-stache-helpers"),y=t("can-simple-map").extend("LetContext",{}),v=/(\.\.\/)|(\.\/)|(this[\.@])/g;h(a,{read:s.read,TemplateContext:c,keyInfo:function(e){"./"===e&&(e="this");var t={remainingKey:e};if(t.isScope="scope"===e,t.isScope)return t;var n=e.substr(0,6);return t.isInScope="scope."===n||"scope@"===n,t.isInScope?(t.remainingKey=e.substr(6),t):"scope/"===n?(t.walkScope=!0,t.remainingKey=e.substr(6),t):"@scope/"===e.substr(0,7)?(t.walkScope=!0,t.remainingKey=e.substr(7),t):(t.parentContextWalkCount=0,t.remainingKey=e.replace(v,function(e,n,r,i,o){return t.isContextBased=!0,void 0!==n&&t.parentContextWalkCount++,""}),".."===t.remainingKey?(t.parentContextWalkCount++,t.remainingKey="this"):"."!==t.remainingKey&&""!==t.remainingKey||(t.remainingKey="this"),"this"===t.remainingKey&&(t.isContextBased=!0),t)},isTemplateContextOrCanNotHaveProperties:function(e){var t=e._context;return t instanceof c||!i(t)},shouldSkipIfSpecial:function(e){return!0==(!0===e._meta.special)||!!a.isTemplateContextOrCanNotHaveProperties(e)},shouldSkipEverythingButSpecial:function(e){return!1==(!0===e._meta.special)||!!a.isTemplateContextOrCanNotHaveProperties(e)},makeShouldExitOnSecondNormalContext:function(){var e=!1;return function(t){var n=!t.isSpecial(),r=n&&e;return n&&(e=!0),r}},makeShouldExitAfterFirstNormalContext:function(){var e=!1;return function(t){return!!e||(!t.isSpecial()&&(e=!0),!1)}},makeShouldSkipSpecialContexts:function(e){var t=e||0;return function(e){return!(t<0&&e._meta.notContext||!e.isSpecial()&&--t<0)}}}),h(a.prototype,{add:function(e,t){return e!==this._context?new this.constructor(e,this,t):this},find:function(e,t){var n=s.reads(e),r={shouldExit:o,shouldSkip:a.shouldSkipIfSpecial,shouldLookForHelper:!0,read:s.read};return this._walk(n,t,r).value},readFromSpecialContext:function(e){return this._walk([{key:e,at:!1}],{special:!0},{shouldExit:o,shouldSkip:a.shouldSkipEverythingButSpecial,shouldLookForHelper:!1,read:s.read})},readFromTemplateContext:function(e,t){var n=s.reads(e);return s.read(this.templateContext,n,t)},read:function(e,t){return t=t||{},this.readKeyInfo(a.keyInfo(e),t||{})},readKeyInfo:function(e,t){var n,r,i={read:t.read||s.read};if(e.isScope)return{value:this};if(e.isInScope)return r=s.reads(e.remainingKey),void 0!==(n=s.read(this,r,t)).value||n.parentHasKey||(n=this.readFromTemplateContext(e.remainingKey,t)),h(n,{thisArg:r.length>0?n.parent:void 0});if(e.isContextBased)return r="this"!==e.remainingKey?s.reads(e.remainingKey):[],i.shouldExit=a.makeShouldExitOnSecondNormalContext(),i.shouldSkip=a.makeShouldSkipSpecialContexts(e.parentContextWalkCount),i.shouldLookForHelper=!0,this._walk(r,t,i);if(e.walkScope)return i.shouldExit=o,i.shouldSkip=a.shouldSkipIfSpecial,i.shouldLookForHelper=!0,r=s.reads(e.remainingKey),this._walk(r,t,i);r=s.reads(e.remainingKey);var u=t&&!0===t.special;return i.shouldExit=a.makeShouldExitOnSecondNormalContext(),i.shouldSkip=u?a.shouldSkipEverythingButSpecial:a.shouldSkipIfSpecial,i.shouldLookForHelper=!u,this._walk(r,t,i)},_walk:function(e,t,n){for(var r,i,o,a,s,c=this,l=[],p=-1,d=h({foundObservable:function(t,n){i=t,o=e.slice(n)},earlyExit:function(t,n){(!0==(!0===c._meta.variable)&&0===n?f.hasKey(t,e[n].key):n>p||n===p&&"object"==typeof t&&f.hasOwnKey(t,e[n].key))&&(s=i,a=o,p=n)}},t),m=u.isRecording(),g=!1;c;)if(!0!==n.shouldSkip(c)){if(!0===n.shouldExit(c))break;g=!0,r=c._context;var y=u.trap(),v=n.read(r,e,d),b=y();if(void 0!==v.value||v.parentHasKey)return!b.length&&m?(i=v.parent,o=e.slice(e.length-1)):u.addMany(b),{scope:c,rootObserve:i,value:v.value,reads:o,thisArg:v.parent,parentHasKey:v.parentHasKey};l.push.apply(l,b),c=c._parent}else c=c._parent;if(n.shouldLookForHelper){var _=this.getHelperOrPartial(e);if(_&&_.value)return{value:_.value}}return u.addMany(l),{setRoot:s,reads:a,value:void 0,noContextAvailable:!g}},getDataForScopeSet:function(e,t){var n,r=a.keyInfo(e),i=h({read:function(e,r){if(void 0!==n||e instanceof y||(n=e),r.length>1){var i=r.slice(0,r.length-1),o=s.read(e,i,t).value;return null!=o&&f.hasKey(o,r[r.length-1].key)?{parent:o,parentHasKey:!0,value:void 0}:{}}return 1===r.length?f.hasKey(e,r[0].key)?{parent:e,parentHasKey:!0,value:void 0}:{}:{value:e}}},t),o=this.readKeyInfo(r,i);if("this"===r.remainingKey)return{parent:o.value,how:"setValue"};var u,c=r.remainingKey.split(".").pop();return o.thisArg?u=o.thisArg:n&&(u=n),void 0===u?{error:"Attempting to set a value at "+e+" where the context is undefined."}:!f.isObservableLike(u)&&f.isObservableLike(u[c])?f.isMapLike(u[c])?{parent:u,key:c,how:"updateDeep",warn:'can-view-scope: Merging data into "'+c+'" because its parent is non-observable'}:f.isValueLike(u[c])?{parent:u,key:c,how:"setValue"}:{parent:u,how:"write",key:c,passOptions:!0}:{parent:u,how:"write",key:c,passOptions:!0}},getHelper:function(e){return console.warn(".getHelper is deprecated, use .getHelperOrPartial"),this.getHelperOrPartial(e)},getHelperOrPartial:function(e){for(var t,n,r=this;r;){if((t=r._context)instanceof c){if(void 0!==(n=s.read(t.helpers,e,{proxyMethods:!1})).value)return n;if(void 0!==(n=s.read(t.partials,e,{proxyMethods:!1})).value)return n}r=r._parent}return s.read(g,e,{proxyMethods:!1})},get:function(e,t){return t=h({isArgument:!0},t),this.read(e,t).value},peek:u.ignore(function(e,t){return this.get(e,t)}),peak:u.ignore(function(e,t){return this.peek(e,t)}),getScope:function(e){for(var t=this;t;){if(e(t))return t;t=t._parent}},getContext:function(e){var t=this.getScope(e);return t&&t._context},getTemplateContext:function(){var e,t=this.getScope(function(t){return e=t,t._context instanceof c});return t||(t=new a(new c),e._parent=t),t},addTemplateContext:function(){return this.add(new c)},addLetContext:function(e){return this.add(new y(e||{}),{variable:!0})},getRoot:function(){for(var e=this,t=this;e._parent;)t=e,e=e._parent;return e._context instanceof c&&(e=t),e._context},getViewModel:function(){var e=this.getScope(function(e){return e._meta.viewModel});return e&&e._context},getTop:function(){var e;return this.getScope(function(t){return t._meta.viewModel&&(e=t),!1}),e&&e._context},getPathsForKey:function(e){},hasKey:function(e){var t,n=s.reads(e);return(t="scope"===n[0].key?s.read(this,n.slice(1),e):s.read(this._context,n,e)).foundLastParent&&t.parentHasKey},set:function(e,t,n){n=n||{};var r=this.getDataForScopeSet(e,n),i=r.parent;switch(r.warn&&d.warn(r.warn),r.how){case"set":i.set(r.key,t,r.passOptions?n:void 0);break;case"write":s.write(i,r.key,t,n);break;case"setValue":f.setValue("key"in r?i[r.key]:i,t);break;case"setKeyValue":f.setKeyValue(i,r.key,t);break;case"updateDeep":f.updateDeep(i[r.key],t)}},attr:u.ignore(function(e,t,n){return d.warn("can-view-scope::attr is deprecated, please use peek, get or set"),n=h({isArgument:!0},n),2===arguments.length?this.set(e,t,n):this.get(e,n)}),computeData:function(e,t){return l(this,e,t)},compute:function(e,t){return this.computeData(e,t).compute},cloneFromRef:function(){for(var e,t=[],n=this;n;){if(n._context instanceof c){e=n._parent;break}t.unshift(n),n=n._parent}return e?(t.forEach(function(t){e=e.add(t._context,t._meta)}),e):this},isSpecial:function(){return this._meta.notContext||this._meta.special||this._context instanceof c||this._meta.variable}}),a.prototype._read=a.prototype._walk,f.assignSymbols(a.prototype,{"can.hasKey":a.prototype.hasKey}),["filename","lineNumber"].forEach(function(e){Object.defineProperty(a.prototype,e,{get:function(){return this.readFromTemplateContext(e).value},set:function(t){this.templateContext[e]=t}})}),m(a.prototype,"templateContext",function(){return this.getTemplateContext()._context}),m(a.prototype,"root",function(){return d.warn("`scope.root` is deprecated. Use either `scope.top` or `scope.vm` instead."),this.getRoot()}),m(a.prototype,"vm",function(){return this.getViewModel()}),m(a.prototype,"top",function(){return this.getTop()}),m(a.prototype,"helpers",function(){return g}),["index","key","element","event","viewModel","arguments","helperOptions"].forEach(function(e){Object.defineProperty(a.prototype,e,{get:function(){return this.readFromSpecialContext(e).value}})}),p.view=p.view||{},r.exports=p.view.Scope=a}(0,e,0,n)}),define("can-stache@4.15.9#expressions/call",["require","exports","module","./hashes","../src/set-identifier","can-symbol","can-simple-observable/setter/setter","../src/expression-helpers","can-reflect","can-assign","can-view-scope"],function(e,t,n){"use strict";var r=e("./hashes"),i=e("../src/set-identifier"),o=e("can-symbol"),a=e("can-simple-observable/setter/setter"),s=e("../src/expression-helpers"),u=e("can-reflect"),c=e("can-assign"),l=(o.for("can-stache.sourceText"),o.for("can.isView")),h=e("can-view-scope"),p=function(e,t){this.methodExpr=e,this.argExprs=t.map(s.convertToArgExpression)};p.prototype.args=function(e,t){for(var n={},i=[],o="function"==typeof t,a=0,l=this.argExprs.length;a<l;a++){var h=this.argExprs[a];if(h.expr instanceof r&&c(n,h.expr.hashExprs),!o||!t(a)){var p=h.value.apply(h,arguments);i.push({call:!h.modifiers||!h.modifiers.compute,value:p})}}return function(e){var t=[];u.size(n)>0&&(t.hashExprs=n);for(var r=0,o=i.length;r<o;r++)t[r]=e?i[r].value:i[r].call?u.getValue(i[r].value):s.toCompute(i[r].value);return t}},p.prototype.value=function(e,t){var n=this,r=this.methodExpr.value(e,{proxyMethods:!1}),o=u.getValue(r),s=n.args(e,o&&o.ignoreArgLookup),c=function(n){var o=u.getValue(r);if("function"==typeof o){var a=s(o.isLiveBound);return o.requiresOptionsArgument&&(a.hashExprs&&t&&t.exprData&&(t.exprData.hashExprs=a.hashExprs),void 0!==t&&a.push(t)),!0===o[l]&&(a[0]instanceof h||(a[0]=e.getTemplateContext().add(a[0])),a.push(t.nodeList)),arguments.length&&a.unshift(new i(n)),o.apply(r.thisArg||e.peek("this"),a)}};return t&&t.doNotWrapInObservation?c():new a(c,c)},p.prototype.closingTag=function(){return this.methodExpr.key},n.exports=p}),define("can-stache@4.15.9#expressions/helper",["require","exports","module","./literal","./hashes","can-assign","can-log/dev/dev","../src/expression-helpers","can-reflect"],function(e,t,n){"use strict";var r=e("./literal"),i=(e("./hashes"),e("can-assign")),o=(e("can-log/dev/dev"),e("../src/expression-helpers")),a=e("can-reflect"),s=function(e,t,n){this.methodExpr=e,this.argExprs=t,this.hashExprs=n,this.mode=null};s.prototype.args=function(e){for(var t=[],n=0,r=this.argExprs.length;n<r;n++){var i=this.argExprs[n];t.push(o.toComputeOrValue(i.value.apply(i,arguments)))}return t},s.prototype.hash=function(e){var t={};for(var n in this.hashExprs){var r=this.hashExprs[n];t[n]=o.toComputeOrValue(r.value.apply(r,arguments))}return t},s.prototype.value=function(e,t){var n=this.methodExpr instanceof r?""+this.methodExpr._value:this.methodExpr.key,a=this,s=o.getObservableValue_fromKey(n,e,{proxyMethods:!1}),u=s&&s.initialValue,c=s&&s.thisArg;return"function"==typeof u&&(s=function(){var n=a.args(e),r=i(i({},t),{hash:a.hash(e),exprData:a});return n.push(r),u.apply(c||e.peek("this"),n)}),s},s.prototype.closingTag=function(){return this.methodExpr.key},"production"!==process.env.NODE_ENV&&a.assignSymbols(s.prototype,{"can.getName":function(){return a.getName(this.constructor)+"{{"+this.sourceText()+"}}"}}),n.exports=s}),define("can-stache@4.15.9#expressions/lookup",["require","exports","module","../src/expression-helpers","can-reflect","can-symbol","can-log/dev/dev","can-stache-key"],function(e,t,n){"use strict";var r=e("../src/expression-helpers"),i=e("can-reflect"),o=e("can-symbol").for("can-stache.sourceText"),a=(e("can-log/dev/dev"),e("can-stache-key"),function(e,t,n){this.key=e,this.rootExpr=t,i.setKeyValue(this,o,n)});a.prototype.value=function(e,t){return this.rootExpr?r.getObservableValue_fromDynamicKey_fromObservable(this.key,this.rootExpr.value(e),e,{},{}):r.getObservableValue_fromKey(this.key,e,t)},n.exports=a}),define("can-stache@4.15.9#src/key-observable",["require","exports","module","can-simple-observable/settable/settable","can-stache-key"],function(e,t,n){"use strict";function r(e,t){t=""+t,this.key=t,this.root=e,i.call(this,function(){return o.get(this,t)},e)}var i=e("can-simple-observable/settable/settable"),o=e("can-stache-key");(r.prototype=Object.create(i.prototype)).set=function(e){o.set(this.root,this.key,e)},n.exports=r}),define("can-stache@4.15.9#src/utils",["require","exports","module","can-view-scope","can-observation-recorder","can-stache-key","can-reflect","./key-observable","can-symbol"],function(e,t,n){"use strict";var r=e("can-view-scope"),i=e("can-observation-recorder"),o=e("can-stache-key"),a=e("can-reflect"),s=e("./key-observable"),u=e("can-symbol").for("can.isView"),c=function(e){return function(){e&&(e.rendered=!0)}};n.exports={last:function(e){return null!=e&&e[e.length-1]},emptyHandler:function(){},jsonParse:function(e){return"'"===e[0]?e.substr(1,e.length-2):"undefined"===e?void 0:JSON.parse(e)},mixins:{last:function(){return this.stack[this.stack.length-1]},add:function(e){this.last().add(e)},subSectionDepth:function(){return this.stack.length-1}},createRenderers:function(e,t,n,r,i,o){e.fn=r?this.makeRendererConvertScopes(r,t,n,o,e.metadata):c(e.metadata),e.inverse=i?this.makeRendererConvertScopes(i,t,n,o,e.metadata):c(e.metadata),e.isSection=!(!r&&!i)},makeRendererConvertScopes:function(e,t,n,o,a){var s=function(i,o,s){return void 0===i||i instanceof r||(i=t?t.add(i):new r(i||{})),a&&(a.rendered=!0),e(i||t,s||n)};return o?s:i.ignore(s)},makeView:function(e){var t=i.ignore(function(t,n){return t instanceof r||(t=new r(t)),e(t,n)});return t[u]=!0,t},getItemsStringContent:function(e,t,n){for(var r="",i=o.get(e,"length"),u=a.isObservableLike(e),c=0;c<i;c++){var l=u?new s(e,c):e[c];r+=n.fn(l)}return r},getItemsFragContent:function(e,t,n){var r,i=[],u=o.get(e,"length"),c=a.isObservableLike(e),l=t.exprData&&t.exprData.hashExprs;a.size(l)>0&&(r={},a.eachKey(l,function(e,t){r[e.key]=t}));for(var h=0;h<u;h++){var p={},f=c?new s(e,h):e[h];a.size(r)>0&&(r.value&&(p[r.value]=f),r.index&&(p[r.index]=h)),i.push(t.fn(n.add(p,{notContext:!0}).add({index:h},{special:!0}).add(f)))}return i}}}),define("can-stache@4.15.9#src/expression",["require","exports","module","../expressions/arg","../expressions/literal","../expressions/hashes","../expressions/bracket","../expressions/call","../expressions/helper","../expressions/lookup","./set-identifier","../src/expression-helpers","./utils","can-assign","can-reflect","can-symbol"],function(e,t,n){"use strict";var r=e("../expressions/arg"),i=e("../expressions/literal"),o=e("../expressions/hashes"),a=e("../expressions/bracket"),s=e("../expressions/call"),u=e("../expressions/helper"),c=e("../expressions/lookup"),l=e("./set-identifier"),h=e("../src/expression-helpers"),p=e("./utils"),f=e("can-assign"),d=p.last,m=e("can-reflect"),g=e("can-symbol").for("can-stache.sourceText"),y=/[\w\.\\\-_@\/\&%]+/,v=/('.*?'|".*?"|=|[\w\.\\\-_@\/*%\$]+|[\(\)]|,|\~|\[|\]\s*|\s*(?=\[))/g,b=/\]\s+/,_=/^('.*?'|".*?"|-?[0-9]+\.?[0-9]*|true|false|null|undefined)$/,w=function(e){return y.test(e)},k=/^[\.@]\w/,E=function(e){return w(e)&&k.test(e)},T=function(e){return e.children||(e.children=[]),e},S=function(){this.root={children:[],type:"Root"},this.current=this.root,this.stack=[this.root]};f(S.prototype,{top:function(){return d(this.stack)},isRootTop:function(){return this.top()===this.root},popTo:function(e){this.popUntil(e),this.pop()},pop:function(){this.isRootTop()||this.stack.pop()},first:function(e){for(var t=this.stack.length-1;t>0&&-1===e.indexOf(this.stack[t].type);)t--;return this.stack[t]},firstParent:function(e){for(var t=this.stack.length-2;t>0&&-1===e.indexOf(this.stack[t].type);)t--;return this.stack[t]},popUntil:function(e){for(;-1===e.indexOf(this.top().type)&&!this.isRootTop();)this.stack.pop();return this.top()},addTo:function(e,t){var n=this.popUntil(e);T(n).children.push(t)},addToAndPush:function(e,t){this.addTo(e,t),this.stack.push(t)},push:function(e){this.stack.push(e)},topLastChild:function(){return d(this.top().children)},replaceTopLastChild:function(e){var t=T(this.top()).children;return t.pop(),t.push(e),e},replaceTopLastChildAndPush:function(e){this.replaceTopLastChild(e),this.stack.push(e)},replaceTopAndPush:function(e){var t;return this.top()===this.root?t=T(this.top()).children:(this.stack.pop(),t=T(this.top()).children),t.pop(),t.push(e),this.stack.push(e),e}});var C=function(e){var t=e.lastIndexOf("./"),n=e.lastIndexOf(".");if(n>t)return e.substr(0,n)+"@"+e.substr(n+1);var r=-1===t?0:t+2,i=e.charAt(r);return"."===i||"@"===i?e.substr(0,r)+"@"+e.substr(r+1):e.substr(0,r)+"@"+e.substr(r)},I=function(e){return"Lookup"===e.type&&(m.setKeyValue(e,g,e.key),e.key=C(e.key)),e},N=function(e){var t=e.top();if(t&&"Lookup"===t.type){var n=e.stack[e.stack.length-2];"Helper"!==n.type&&n&&e.replaceTopAndPush({type:"Helper",method:t})}},D={toComputeOrValue:h.toComputeOrValue,convertKeyToLookup:C,Literal:i,Lookup:c,Arg:r,Hash:function(){},Hashes:o,Call:s,Helper:u,Bracket:a,SetIdentifier:l,tokenize:function(e){var t=[];return(e.trim()+" ").replace(v,function(e,n){b.test(n)?(t.push(n[0]),t.push(n.slice(1))):t.push(n)}),t},lookupRules:{default:function(e,t,n){return"Helper"===e.type?u:c},method:function(e,t,n){return c}},methodRules:{default:function(e){return"Call"===e.type?s:u},call:function(e){return s}},parse:function(e,t){t=t||{};var n=this.ast(e);return t.lookupRule||(t.lookupRule="default"),"string"==typeof t.lookupRule&&(t.lookupRule=D.lookupRules[t.lookupRule]),t.methodRule||(t.methodRule="default"),"string"==typeof t.methodRule&&(t.methodRule=D.methodRules[t.methodRule]),this.hydrateAst(n,t,t.baseMethodType||"Helper")},hydrateAst:function(e,t,n,u){var c;if("Lookup"===e.type)return new(t.lookupRule(e,n,u))(e.key,e.root&&this.hydrateAst(e.root,t,n),e[g]);if("Literal"===e.type)return new i(e.value);if("Arg"===e.type)return new r(this.hydrateAst(e.children[0],t,n,u),{compute:!0});if("Hash"===e.type)throw new Error("");if("Hashes"===e.type)return c={},e.children.forEach(function(e){c[e.prop]=this.hydrateAst(e.children[0],t,n,!0)},this),new o(c);if("Call"===e.type||"Helper"===e.type){c={};var l=[],h=e.children,p=t.methodRule(e);if(h)for(var f=0;f<h.length;f++){var d=h[f];"Hashes"===d.type&&"Helper"===e.type&&p!==s?d.children.forEach(function(n){c[n.prop]=this.hydrateAst(n.children[0],t,e.type,!0)},this):l.push(this.hydrateAst(d,t,e.type,!0))}return new p(this.hydrateAst(e.method,t,e.type),l,c)}return"Bracket"===e.type?new a(this.hydrateAst(e.children[0],t),e.root?this.hydrateAst(e.root,t):void 0,void 0):void 0},ast:function(e){var t=this.tokenize(e);return this.parseAst(t,{index:0})},parseAst:function(e,t){for(var n,r,i,o=new S;t.index<e.length;){var a=e[t.index],s=e[t.index+1];if(t.index++,"="===s){(n=o.top())&&"Lookup"===n.type&&("Call"!==(r=o.firstParent(["Call","Helper","Hash"])).type&&"Root"!==r.type||(o.popUntil(["Call"]),n=o.top(),o.replaceTopAndPush({type:"Helper",method:"Root"===n.type?d(n.children):n})));var u={type:"Hash",prop:a};"Hashes"===(r=o.first(["Call","Helper","Hashes","Root"])).type?o.addToAndPush(["Hashes"],u):(o.addToAndPush(["Helper","Call","Root"],{type:"Hashes",children:[u]}),o.push(u)),t.index++}else if(_.test(a))N(o),"Hash"===(r=o.first(["Helper","Call","Hash","Bracket"])).type&&r.children&&r.children.length>0?o.addTo(["Helper","Call","Bracket"],{type:"Literal",value:p.jsonParse(a)}):"Bracket"===r.type&&r.children&&r.children.length>0?o.addTo(["Helper","Call","Hash"],{type:"Literal",value:p.jsonParse(a)}):o.addTo(["Helper","Call","Hash","Bracket"],{type:"Literal",value:p.jsonParse(a)});else if(y.test(a))i=o.topLastChild(),r=o.first(["Helper","Call","Hash","Bracket"]),i&&("Call"===i.type||"Bracket"===i.type)&&E(a)?o.replaceTopLastChildAndPush({type:"Lookup",root:i,key:a.slice(1)}):"Bracket"===r.type?r.children&&r.children.length>0?"Helper"===o.first(["Helper","Call","Hash","Arg"]).type&&"."!==a[0]?o.addToAndPush(["Helper"],{type:"Lookup",key:a}):o.replaceTopAndPush({type:"Lookup",key:a.slice(1),root:r}):o.addToAndPush(["Bracket"],{type:"Lookup",key:a}):(N(o),o.addToAndPush(["Helper","Call","Hash","Arg","Bracket"],{type:"Lookup",key:a}));else if("~"===a)N(o),o.addToAndPush(["Helper","Call","Hash"],{type:"Arg",key:a});else if("("===a){if("Lookup"!==(n=o.top()).type)throw new Error("Unable to understand expression "+e.join(""));o.replaceTopAndPush({type:"Call",method:I(n)})}else if(")"===a)o.popTo(["Call"]);else if(","===a)"Call"!==o.first(["Call"]).type?o.popUntil(["Hash"]):o.popUntil(["Call"]);else if("["===a)if(n=o.top(),!(i=o.topLastChild())||"Call"!==i.type&&"Bracket"!==i.type)if("Lookup"===n.type||"Bracket"===n.type){var c={type:"Bracket",root:n};o.replaceTopAndPush(c)}else"Call"===n.type?o.addToAndPush(["Call"],{type:"Bracket"}):" "===n?(o.popUntil(["Lookup","Call"]),N(o),o.addToAndPush(["Helper","Call","Hash"],{type:"Bracket"})):o.replaceTopAndPush({type:"Bracket"});else o.replaceTopLastChildAndPush({type:"Bracket",root:i});else"]"===a?o.pop():" "===a&&o.push(a)}return o.root.children[0]}};n.exports=D}),define("can-globals@1.2.0#location/location",["require","exports","module","can-globals/global/global","can-globals/can-globals-instance"],function(e,t,n){!function(e,t,n,r){"use strict";t("can-globals/global/global");var i=t("can-globals/can-globals-instance");i.define("location",function(){return i.getKeyValue("global").location}),r.exports=i.makeExport("location")}(0,e,0,n)}),define("can-globals@1.2.0#mutation-observer/mutation-observer",["require","exports","module","can-globals/global/global","can-globals/can-globals-instance"],function(e,t,n){!function(e,t,n,r){"use strict";t("can-globals/global/global");var i=t("can-globals/can-globals-instance");i.define("MutationObserver",function(){var e=i.getKeyValue("global");return e.MutationObserver||e.WebKitMutationObserver||e.MozMutationObserver}),r.exports=i.makeExport("MutationObserver")}(0,e,0,n)}),define("can-globals@1.2.0#custom-elements/custom-elements",["require","exports","module","can-globals/global/global","can-globals/can-globals-instance"],function(e,t,n){!function(e,t,n,r){"use strict";t("can-globals/global/global");var i=t("can-globals/can-globals-instance");i.define("customElements",function(){return i.getKeyValue("global").customElements}),r.exports=i.makeExport("customElements")}(0,e,0,n)}),define("can-globals@1.2.0#can-globals",["require","exports","module","can-globals/can-globals-instance","./global/global","./document/document","./location/location","./mutation-observer/mutation-observer","./is-browser-window/is-browser-window","./is-node/is-node","./custom-elements/custom-elements"],function(e,t,n){!function(e,t,n,r){"use strict";var i=t("can-globals/can-globals-instance");t("./global/global"),t("./document/document"),t("./location/location"),t("./mutation-observer/mutation-observer"),t("./is-browser-window/is-browser-window"),t("./is-node/is-node"),t("./custom-elements/custom-elements"),r.exports=i}(0,e,0,n)}),define("can-dom-mutate@1.3.5#-util",["require","exports","module","can-globals/document/document"],function(e,t,n){!function(e,t,n,r){"use strict";function i(e,t){return e.contains?e.contains(t):e.nodeType===Node.DOCUMENT_NODE&&e.documentElement?i(e.documentElement,t):(t=t.parentNode)===e}function o(e){return!(!e||11!==e.nodeType)}function a(e){return!(!e||1!==e.nodeType)}function s(e){for(var t=[],n=e.firstChild;n;)t.push(n),n=n.nextSibling;return t}function u(e){var t,n,r=0,i=o(e)?[]:[e];if(null==e.firstChild)return i;do{!t&&(n=e.firstChild)?(r++,i.push(n)):(n=e.nextSibling)?(t=!1,i.push(n)):(n=e.parentNode,r--,t=!0),e=n}while(r>0);return i}function c(){return NodeFilter.FILTER_ACCEPT}function l(e){for(var t,n=o(e)?[]:[e],r=a(e)&&h().createTreeWalker(e,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,p,!1);t=r&&r.nextNode();)n.push(t);return n}var h=t("can-globals/document/document"),p=c;p.acceptNode=c,r.exports={eliminate:function(e,t){var n=e.indexOf(t);n>=0&&e.splice(n,1)},isInDocument:function(e){var t=h();return t===e||i(t,e)},getDocument:h,isDocumentElement:function(e){return h().documentElement===e},isFragment:o,getParents:function(e){return o(e)?s(e):[e]},getAllNodes:function(e){return void 0!==h().createTreeWalker?l(e):u(e)},getChildren:s,subscription:function(e){return function(){var t=e.apply(this,arguments),n=!1;return function(){if(n){var r="Disposal function returned by "+(e.name||e.displayName||"an anonymous function")+" called more than once.";throw new Error(r)}t.apply(this,arguments),n=!0}}},addToSet:function(e,t){for(var n=0,r=e.length;n<r;n++)t.add(e[n])}}}(0,e,0,n)}),define("can-dom-mutate@1.3.5#can-dom-mutate",["require","exports","module","can-globals","can-globals/global/global","can-globals/mutation-observer/mutation-observer","can-namespace","can-globals/document/document","can-reflect","./-util"],function(e,t,n){!function(e,t,n,r){"use strict";function i(e,t){var n=L.get(e);if(n)return n[t]}function o(e,t,n){var r=L.get(e);r||(r={},L.set(e,r)),r[t]=n}function a(e,t){return delete L.get(e)[t]}function s(e){for(var t=[],n=0;n<e.length;n++)t.push({target:e[n]});return t}function u(e){return function(t,n){e(t),n&&n()}}function c(e,t){var n=i(I(),t);if(n)return n.listeners}function l(e,t){var n=i(I(),t);if(n)return n.get(e)}function h(e,t,n){var r=I(),a=i(r,t);a||o(r,t,a=new Map);var s=a.get(e);s||(s=[],a.set(e,s)),s.push(n)}function p(e,t,n){var r=I(),o=i(r,t);if(o){var s=o.get(e);s&&(A(s,n),0===s.length&&(o.delete(e),0===o.size&&a(r,t)))}}function f(e,t){for(var n=R.call(e,0),r=n.length,i=0;i<r;i++)n[i](t)}function d(e,t){return function(n){for(var r=0;r<n.length;r++){var i=n[r],o=i.target,a=l(o,e);if(a&&f(a,i),t){var s=c(o,t);s&&f(s,i)}}}}function m(e,t,n,r){var s=i(e,t);s||o(e,t,s={observingCount:0});var u=function(){s.observer&&(s.observer.disconnect(),s.observer=null);var t=S();if(t){var i=T().Node;if(i&&e instanceof i){var o=new t(r);o.id=M++,o.observe(e,n),s.observer=o}}};return 0===s.observingCount&&(E.onKeyValue("MutationObserver",u),u()),s.observingCount++,function(){var n=i(e,t);n&&(n.observingCount--,n.observingCount<=0&&(n.observer&&n.observer.disconnect(),a(e,t),E.offKeyValue("MutationObserver",u)))}}function g(e){if("undefined"!=typeof Set){for(var t=e.length,n=new Set,r=new Set,i=0;i<t;i++){for(var o=e[i],a=o.addedNodes.length,u=0;u<a;u++)D.addToSet(P(o.addedNodes[u]),n);for(var c=o.removedNodes.length,l=0;l<c;l++)D.addToSet(P(o.removedNodes[l]),r)}k(s(N.toArray(r))),w(s(N.toArray(n)))}}function y(e){for(var t=e.length,n=0;n<t;n++){var r=e[n];if("attributes"===r.type){var i=r.target,o=r.attributeName,a=r.oldValue;_.dispatchNodeAttributeChange(i,o,a)}}}function v(e,t,n){return x(function(r,i){if(11===r.nodeType)return Function.prototype;var o;return o=n?m(r,t,j,y):m(I(),t,V,g),h(r,e,i),function(){o(),p(r,e,i)}})}function b(e,t){return x(function(n,r){if(!O(n))throw new Error("Global mutation listeners must pass a documentElement");var s=I(),u=i(s,e);u||o(s,e,u={listeners:[]});var c=u.listeners;return 0===c.length&&(u.removeListener=t(s,function(){})),c.push(r),function(){var t=i(s,e);if(t){var n=t.listeners;A(n,r),0===n.length&&(t.removeListener(),a(s,e))}}})}var _,w,k,E=t("can-globals"),T=t("can-globals/global/global"),S=t("can-globals/mutation-observer/mutation-observer"),C=t("can-namespace"),I=t("can-globals/document/document"),N=t("can-reflect"),D=t("./-util"),A=D.eliminate,x=D.subscription,O=D.isDocumentElement,P=D.getAllNodes,R=Array.prototype.slice,L=new WeakMap,M=0,V={subtree:!0,childList:!0},j={attributes:!0,attributeOldValue:!0};w=u(d("domMutationInsertionData","domMutationDocumentInsertionData")),k=u(d("domMutationRemovalData","domMutationDocumentRemovalData"));var U=u(d("domMutationAttributeChangeData","domMutationDocumentAttributeChangeData")),q=v("domMutationInsertionData","domMutationTreeData"),F=v("domMutationRemovalData","domMutationTreeData"),B=v("domMutationAttributeChangeData","domMutationAttributeData",!0),K=b("domMutationDocumentInsertionData",q),W=b("domMutationDocumentRemovalData",F),H=b("domMutationDocumentAttributeChangeData",B);_={dispatchNodeInsertion:function(e,t){var n=new Set;D.addToSet(P(e),n);var r=s(N.toArray(n));w(r,t)},dispatchNodeRemoval:function(e,t){var n=new Set;D.addToSet(P(e),n);var r=s(N.toArray(n));k(r,t)},dispatchNodeAttributeChange:function(e,t,n,r){U([{target:e,attributeName:t,oldValue:n}],r)},onNodeInsertion:q,onNodeRemoval:F,onNodeAttributeChange:B,onRemoval:W,onInsertion:K,onAttributeChange:H},r.exports=C.domMutate=_}(0,e,0,n)}),define("can-dom-mutate@1.3.5#node",["require","exports","module","can-globals","can-namespace","./can-dom-mutate","./-util"],function(e,t,n){!function(e,t,n,r){"use strict";function i(e){var t=e?f:p;for(var n in t)d[n]=t[n]}var o=t("can-globals"),a=t("can-namespace"),s=t("./can-dom-mutate"),u=t("./-util"),c=u.isInDocument,l=u.getParents,h={dispatchNodeInsertion:function(e,t){c(t)&&s.dispatchNodeInsertion(t)},dispatchNodeRemoval:function(e,t){c(e)&&!c(t)&&s.dispatchNodeRemoval(t)}},p={replaceChild:function(e,t){var n=l(e),r=this.replaceChild(e,t);h.dispatchNodeRemoval(this,t);for(var i=0;i<n.length;i++)h.dispatchNodeInsertion(this,n[i]);return r},setAttribute:function(e,t){var n=this.getAttribute(e),r=this.setAttribute(e,t);return n!==this.getAttribute(e)&&s.dispatchNodeAttributeChange(this,e,n),r},removeAttribute:function(e){var t=this.getAttribute(e),n=this.removeAttribute(e);return t&&s.dispatchNodeAttributeChange(this,e,t),n}};[["appendChild","Insertion"],["insertBefore","Insertion"],["removeChild","Removal"]].forEach(function(e){var t=e[0],n="dispatchNode"+e[1];p[t]=function(e){for(var r=l(e),i=this[t].apply(this,arguments),o=0;o<r.length;o++)h[n](this,r[o]);return i}});var f={};["appendChild","insertBefore","removeChild","replaceChild","setAttribute","removeAttribute"].forEach(function(e){f[e]=function(){return this[e].apply(this,arguments)}});var d={};i(o.getKeyValue("MutationObserver")),o.onKeyValue("MutationObserver",i),r.exports=a.domMutateNode=s.node=d}(0,e,0,n)}),define("can-view-nodelist@4.3.2#can-view-nodelist",["require","exports","module","can-namespace","can-dom-mutate/node"],function(e,t,n){"use strict";var r=e("can-namespace"),i=e("can-dom-mutate/node"),o=new Map,a=[].splice,s=[].push,u=function(e){for(var t=0,n=0,r=e.length;n<r;n++){var i=e[n];i.nodeType?t++:t+=u(i)}return t},c=function(e){for(var t=new Map,n=0,r=e.length;n<r;n++){var i=h.first(e[n]);t.set(i,e[n])}return t},l=function(e,t){t.forEach(function(t){e.newDeepChildren.push(t)})},h={update:function(e,t,n){n||(n=h.unregisterChildren(e));for(var r=[],i=0,o=r.length=t.length;i<o;i++)r[i]=t[i];t=r;var s=e.length;return a.apply(e,[0,s].concat(t)),e.replacements?(h.nestReplacements(e),e.deepChildren=e.newDeepChildren,e.newDeepChildren=[]):h.nestList(e),n},nestReplacements:function(e){for(var t=0,n=c(e.replacements),r=e.replacements.length;t<e.length&&r;){var i=e[t],o=n.get(i);o&&(n.delete(i),e.splice(t,u(o),o),r--),t++}r&&l(e,n),e.replacements=[]},nestList:function(e){for(var t=0;t<e.length;){var n=e[t],r=o.get(n);r?r!==e&&e.splice(t,u(r),r):o.set(n,e),t++}},last:function(e){var t=e[e.length-1];return t.nodeType?t:h.last(t)},first:function(e){var t=e[0];return t.nodeType?t:h.first(t)},flatten:function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];r.nodeType?t.push(r):t.push.apply(t,h.flatten(r))}return t},register:function(e,t,n,r){return e.unregistered=t,e.parentList=n,e.nesting=n&&void 0!==n.nesting?n.nesting+1:0,n?(e.deepChildren=[],e.newDeepChildren=[],e.replacements=[],!0!==n&&(r?n.replacements.push(e):n.newDeepChildren.push(e))):h.nestList(e),e},unregisterChildren:function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];r.nodeType?(e.replacements||o.delete(r),t.push(r)):s.apply(t,h.unregister(r,!0))}var i=e.deepChildren;if(i)for(var a=0;a<i.length;a++)h.unregister(i[a],!0);return t},unregister:function(e,t){var n=h.unregisterChildren(e,!0);if(e.isUnregistered=!0,e.unregistered){var r=e.unregistered;if(e.replacements=e.unregistered=null,!t){var i=e.parentList&&e.parentList.deepChildren;if(i){var o=i.indexOf(e);-1!==o&&i.splice(o,1)}}r()}return n},after:function(e,t){var n=e[e.length-1];n.nextSibling?i.insertBefore.call(n.parentNode,t,n.nextSibling):i.appendChild.call(n.parentNode,t)},replace:function(e,t){var n,r=e[0].parentNode;"SELECT"===r.nodeName.toUpperCase()&&r.selectedIndex>=0&&(n=r.value),1===e.length?i.replaceChild.call(r,t,e[0]):(h.after(e,t),h.remove(e)),void 0!==n&&(r.value=n)},remove:function(e){for(var t=e[0]&&e[0].parentNode,n=0;n<e.length;n++)i.removeChild.call(t,e[n])},nodeMap:o};n.exports=r.nodeLists=h}),define("can-child-nodes@1.2.0#can-child-nodes",["require","exports","module","can-namespace"],function(e,t,n){"use strict";var r=e("can-namespace");n.exports=r.childNodes=function(e){var t=e.childNodes;if("length"in t)return t;for(var n=e.firstChild,r=[];n;)r.push(n),n=n.nextSibling;return r}}),define("can-fragment@1.3.0#can-fragment",["require","exports","module","can-globals/document/document","can-namespace","can-reflect","can-child-nodes","can-symbol"],function(e,t,n){!function(e,t,n,r){"use strict";function i(e,t,n){void 0===t&&(t=h.test(e)&&RegExp.$1),e&&"[object Function]"===p.call(e.replace)&&(e=e.replace(/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,"<$1></$2>"));var r=n.createElement("div"),i=n.createElement("div");return"tbody"===t||"tfoot"===t||"thead"===t||"colgroup"===t?(i.innerHTML="<table>"+e+"</table>",r=3===i.firstChild.nodeType?i.lastChild:i.firstChild):"col"===t?(i.innerHTML="<table><colgroup>"+e+"</colgroup></table>",r=3===i.firstChild.nodeType?i.lastChild:i.firstChild.firstChild):"tr"===t?(i.innerHTML="<table><tbody>"+e+"</tbody></table>",r=3===i.firstChild.nodeType?i.lastChild:i.firstChild.firstChild):"td"===t||"th"===t?(i.innerHTML="<table><tbody><tr>"+e+"</tr></tbody></table>",r=3===i.firstChild.nodeType?i.lastChild:i.firstChild.firstChild.firstChild):"option"===t?(i.innerHTML="<select>"+e+"</select>",r=3===i.firstChild.nodeType?i.lastChild:i.firstChild):r.innerHTML=""+e,[].slice.call(c(r))}function o(e,t){if(e&&11===e.nodeType)return e;t?t.length&&(t=t[0]):t=a();for(var n=i(e,void 0,t),r=(t||document).createDocumentFragment(),o=0,s=n.length;o<s;o++)r.appendChild(n[o]);return r}var a=t("can-globals/document/document"),s=t("can-namespace"),u=t("can-reflect"),c=t("can-child-nodes"),l=t("can-symbol"),h=/^\s*<(\w+)[^>]*>/,p={}.toString,f=l.for("can.toDOM"),d=function(e,t){var n,r=t||a();if(e&&"string"!=typeof e){if("function"==typeof e[f])return d(e[f]());if(11===e.nodeType)return e;if("number"==typeof e.nodeType)return(n=r.createDocumentFragment()).appendChild(e),n;u.isListLike(e)?(n=r.createDocumentFragment(),u.eachIndex(e,function(e){n.appendChild(d(e))})):n=o(""+e,r)}else n=o(null==e?"":""+e,r);return c(n).length||n.appendChild(r.createTextNode("")),n};r.exports=s.fragment=s.frag=d}(0,e,0,n)}),define("can-view-callbacks@4.3.2#can-view-callbacks",["require","exports","module","can-observation-recorder","can-log/dev/dev","can-globals/global/global","can-dom-mutate/node","can-namespace","can-view-nodelist","can-fragment","can-globals","can-symbol","can-reflect"],function(e,t,n){!function(e,t,n,r){"use strict";var i,o=t("can-observation-recorder"),a=(t("can-log/dev/dev"),t("can-globals/global/global")),s=t("can-dom-mutate/node"),u=t("can-namespace"),c=t("can-view-nodelist"),l=t("can-fragment"),h=t("can-globals"),p=t("can-symbol"),f=t("can-reflect"),d=p.for("can.callbackMap"),m={},g=function(){var e=h.getKeyValue("document");return null!=e&&null!=e.documentElement&&"false"!==e.documentElement.getAttribute("data-can-automount")},y=new WeakMap,v=function(e){var t=e.tagName&&e.tagName.toLowerCase();m[t]&&D.tagHandler(e,t,{})},b=function(e){var t;if(v(e),e.getElementsByTagName){t=e.getElementsByTagName("*");for(var n,r=0;void 0!==(n=t[r]);r++)b(n)}},_=!1,w=function(){if(!_){var e=h.getKeyValue("MutationObserver");e&&((i=new e(function(e){for(var t,n,r=0;void 0!==(n=e[r]);r++)if("childList"===n.type){t=n.addedNodes;for(var i,o=0;void 0!==(i=t[o]);o++)b(i)}})).observe(a().document.documentElement,{childList:!0,subtree:!0}),_=!0)}},k=function(e){for(var t,n=a().document.getElementsByTagName(e),r=0;void 0!==(t=n[r]);r++)v(t)},E=function(e,t){if(!t){var n=T[e];if(!n)for(var r=0,i=S.length;r<i;r++){var o=S[r];if(o.match.test(e))return o.handler}return n}"string"==typeof e?T[e]=t:S.push({match:e,handler:t})},T={},S=[],C=new WeakMap,I=/[-\:]/,N=function(){},D={_tags:m,_attributes:T,_regExpAttributes:S,defaultCallback:N,tag:function(e,t){if(!t){var n;return null===t?delete m[e.toLowerCase()]:n=m[e.toLowerCase()],!n&&I.test(e)&&(n=N),n}var r,o=a(),s=I.test(e);if(m[e.toLowerCase()],o.html5&&(o.html5.elements+=" "+e,o.html5.shivDocument()),m[e.toLowerCase()]=t,g()){var u=h.getKeyValue("customElements");if(u){if(r=u.get(e.toLowerCase()),s&&!r){var c=function(){return Reflect.construct(HTMLElement,[],c)};c.prototype=Object.create(HTMLElement.prototype),c.prototype.connectedCallback=function(){D.tagHandler(this,e.toLowerCase(),{})},u.define(e,c)}}else w(),k(e)}else _&&i.disconnect()},attr:E,attrs:function(e){var t=f.getKeyValue(e,d)||e;C.has(t)||(C.set(t,!0),f.eachKey(t,function(e,t){E(t,e)}))},tagHandler:function(e,t,n){if(!y.has(e)){var r,i=n.scope,a=i&&i.templateContext.tags.get(t)||m[t];if(a?(r=o.ignore(a)(e,n),y.set(e,!0)):r=i,r&&n.subtemplate){i!==r&&(i=i.add(r));var u=c.register([],void 0,n.parentNodeList||!0,!1);u.expression="<"+e.tagName+">";var h=n.subtemplate(i,n.options,u),p="string"==typeof h?l(h):h;s.appendChild.call(e,p)}}}};if(u.view=u.view||{},u.view.callbacks)throw new Error("You can't have two versions of can-view-callbacks, check your dependencies");r.exports=u.view.callbacks=D}(0,e,0,n)}),define("can-view-model@4.0.1#can-view-model",["require","exports","module","can-simple-map","can-namespace","can-globals/document/document","can-reflect","can-symbol"],function(e,t,n){!function(e,t,n,r){"use strict";var i=t("can-simple-map"),o=t("can-namespace"),a=t("can-globals/document/document"),s=t("can-reflect"),u=t("can-symbol").for("can.viewModel");r.exports=o.viewModel=function(e,t,n){if("string"==typeof e?e=a().querySelector(e):s.isListLike(e)&&!e.nodeType&&(e=e[0]),s.isObservableLike(t)&&s.isMapLike(t))e[u]=t;else{var r=e[u];switch(r||(r=new i,e[u]=r),arguments.length){case 0:case 1:return r;case 2:return s.getKeyValue(r,t);default:return s.setKeyValue(r,t,n),e}}}}(0,e,0,n)}),define("can-dom-data-state@1.0.5#can-dom-data-state",["require","exports","module","can-namespace","can-dom-mutate","can-cid"],function(e,t,n){"use strict";var r=e("can-namespace"),i=e("can-dom-mutate"),o=e("can-cid"),a=function(e){for(var t in e)return!1;return!0},s={},u={},c=function(){var e=o.get(this),t=!1;return e&&s[e]&&(t=!0,delete s[e]),u[e]&&(u[e](),delete u[e]),t},l={_data:s,_removalDisposalMap:u,getCid:function(){return o.get(this)},cid:function(){return o(this)},expando:o.domExpando,get:function(e){var t=o.get(this),n=t&&s[t];return void 0===e?n:n&&n[e]},set:function(e,t){var n=o(this),r=s[n]||(s[n]={});if(void 0!==e&&(r[e]=t,this&&"number"==typeof this.nodeType&&!u[n])){var a=this;u[n]=i.onNodeRemoval(a,function(){var e=a.ownerDocument,t=e.contains?e:e.documentElement;t&&t.contains(a)||setTimeout(function(){c.call(a)},13)})}return r},clean:function(e){var t=o.get(this),n=s[t];n&&n[e]&&delete n[e],a(n)&&c.call(this)},delete:c};if(r.domDataState)throw new Error("You can't have two versions of can-dom-data-state, check your dependencies");n.exports=r.domDataState=l}),define("can-attribute-encoder@1.1.1#can-attribute-encoder",["require","exports","module","can-namespace","can-log/dev/dev"],function(e,t,n){"use strict";function r(e,t){for(var n=0;n<e.length;n++)t(e[n],n)}function i(e,t,n){return t+"-"+n.toLowerCase()}function o(e,t){return 0===e.indexOf(t)}function a(e,t){return e.length-e.lastIndexOf(t)===t.length}var s=e("can-namespace"),u=(e("can-log/dev/dev"),function(e){var t={};return r("allowReorder,attributeName,attributeType,autoReverse,baseFrequency,baseProfile,calcMode,clipPathUnits,contentScriptType,contentStyleType,diffuseConstant,edgeMode,externalResourcesRequired,filterRes,filterUnits,glyphRef,gradientTransform,gradientUnits,kernelMatrix,kernelUnitLength,keyPoints,keySplines,keyTimes,lengthAdjust,limitingConeAngle,markerHeight,markerUnits,markerWidth,maskContentUnits,maskUnits,patternContentUnits,patternTransform,patternUnits,pointsAtX,pointsAtY,pointsAtZ,preserveAlpha,preserveAspectRatio,primitiveUnits,repeatCount,repeatDur,requiredExtensions,requiredFeatures,specularConstant,specularExponent,spreadMethod,startOffset,stdDeviation,stitchTiles,surfaceScale,systemLanguage,tableValues,textLength,viewBox,viewTarget,xChannelSelector,yChannelSelector".split(","),function(e){t[e]=!0}),t}()),c={leftParens:/\(/g,rightParens:/\)/g,leftBrace:/\{/g,rightBrace:/\}/g,camelCase:/([a-z]|^)([A-Z])/g,forwardSlash:/\//g,space:/\s/g,uppercase:/[A-Z]/g,uppercaseDelimiterThenChar:/:u:([a-z])/g,caret:/\^/g,dollar:/\$/g,at:/@/g},l={prependUppercase:":u:",replaceSpace:":s:",replaceForwardSlash:":f:",replaceLeftParens:":lp:",replaceRightParens:":rp:",replaceLeftBrace:":lb:",replaceRightBrace:":rb:",replaceCaret:":c:",replaceDollar:":d:",replaceAt:":at:"},h={};if(h.encode=function(e){var t=e;return!u[t]&&t.match(c.camelCase)&&(o(t,"on:")||a(t,":to")||a(t,":from")||a(t,":bind")||a(t,":raw")?t=t.replace(c.uppercase,function(e){return l.prependUppercase+e.toLowerCase()}):(o(t,"(")||o(t,"{"))&&(t=t.replace(c.camelCase,i))),t=t.replace(c.space,l.replaceSpace).replace(c.forwardSlash,l.replaceForwardSlash).replace(c.leftParens,l.replaceLeftParens).replace(c.rightParens,l.replaceRightParens).replace(c.leftBrace,l.replaceLeftBrace).replace(c.rightBrace,l.replaceRightBrace).replace(c.caret,l.replaceCaret).replace(c.dollar,l.replaceDollar).replace(c.at,l.replaceAt)},h.decode=function(e){var t=e;return!u[t]&&c.uppercaseDelimiterThenChar.test(t)&&(o(t,"on:")||a(t,":to")||a(t,":from")||a(t,":bind")||a(t,":raw"))&&(t=t.replace(c.uppercaseDelimiterThenChar,function(e,t){return t.toUpperCase()})),t=t.replace(l.replaceLeftParens,"(").replace(l.replaceRightParens,")").replace(l.replaceLeftBrace,"{").replace(l.replaceRightBrace,"}").replace(l.replaceForwardSlash,"/").replace(l.replaceSpace," ").replace(l.replaceCaret,"^").replace(l.replaceDollar,"$").replace(l.replaceAt,"@")},s.encoder)throw new Error("You can't have two versions of can-attribute-encoder, check your dependencies");n.exports=s.encoder=h}),define("can-attribute-observable@1.2.0#event",["require","exports","module","can-reflect","can-dom-events","can-dom-events/helpers/util"],function(e,t,n){"use strict";var r=e("can-reflect"),i=e("can-dom-events"),o=e("can-dom-events/helpers/util").isDomEventTarget,a={on:function(e,t,n){o(this)?i.addEventListener(this,e,t,n):r.onKeyValue(this,e,t,n)},off:function(e,t,n){o(this)?i.removeEventListener(this,e,t,n):r.offKeyValue(this,e,t,n)},one:function(e,t,n){var r=function(){return a.off.call(this,e,r,n),t.apply(this,arguments)};return a.on.call(this,e,r,n),this}};n.exports=a}),define("can-diff@1.4.2#list/list",["require","exports","module","can-reflect"],function(e,t,n){"use strict";function r(e,t){return e===t}function i(e){return e.identity&&e.identity.length?function(t,n){return u.getIdentity(t,e)===u.getIdentity(n,e)}:r}function o(e){return null!=e.values?i(u.getSchema(e.values)):r}function a(e,t){var n,o=u.getSchema(e);if(null!=o){if(null==o.values)return r;n=u.getSchema(o.values)}return null==n&&t>0&&(n=u.getSchema(u.getKeyValue(e,0))),n?i(n):r}function s(e,t,n,r,i){for(var o=n.length-1,a=r.length-1;o>e&&a>t;){if(!i(n[o],r[a],o))return[{type:"splice",index:t,deleteCount:o-e+1,insert:c.call(r,t,a+1)}];o--,a--}return[{type:"splice",index:t,deleteCount:o-e+1,insert:c.call(r,t,a+1)}]}var u=e("can-reflect"),c=[].slice;n.exports=function(e,t,n){var r,l=0,h=0,p=u.size(e),f=u.size(t),d=[];for(r="function"==typeof n?n:null!=n?"map"===n.type?i(n):o(n):a(e,p);l<p&&h<f;){var m=e[l],g=t[h];if(r(m,g,l))l++,h++;else if(h+1<f&&r(m,t[h+1],l))d.push({index:h,deleteCount:0,insert:[t[h]],type:"splice"}),l++,h+=2;else{if(!(l+1<p&&r(e[l+1],g,l+1)))return d.push.apply(d,s(l,h,e,t,r)),d;d.push({index:h,deleteCount:1,insert:[],type:"splice"}),l+=2,h++}}return h===f&&l===p?d:(d.push({type:"splice",index:h,deleteCount:p-l,insert:c.call(t,h)}),d)}}),define("can-attribute-observable@1.2.0#behaviors",["require","exports","module","can-globals/document/document","can-globals/global/global","can-dom-data-state","can-dom-events","can-dom-mutate","can-dom-mutate/node","can-globals/mutation-observer/mutation-observer","can-diff/list/list","can-queues"],function(e,t,n){!function(e,t,n,r){"use strict";var i=t("can-globals/document/document"),e=t("can-globals/global/global")(),o=t("can-dom-data-state"),a=t("can-dom-events"),s=t("can-dom-mutate"),u=t("can-dom-mutate/node"),c=t("can-globals/mutation-observer/mutation-observer"),l=t("can-diff/list/list"),h=t("can-queues"),p={INPUT:!0,TEXTAREA:!0,SELECT:!0,BUTTON:!0},f=function(e){return null==e?"":""+e},d=function(e){return"http://www.w3.org/2000/svg"===e.namespaceURI},m=function(){return!0},g=function(e){return e&&e.test||m},y=function(e,t){return t=t||{},t.get=function(){return this[e]},t.set=function(t){this[e]!==t&&(this[e]=t)},t},v=function(e){return{isBoolean:!0,set:function(t){e in this?this[e]=t:u.setAttribute.call(this,e,"")},remove:function(){this[e]=!1}}},b=function(e,t){if(!o.get.call(e,"attrMO")){var n=function(){t.call(e)},r=c();if(r){var i=new r(n);i.observe(e,{childList:!0,subtree:!0}),o.set.call(e,"attrMO",i)}else o.set.call(e,"attrMO",!0),o.set.call(e,"canBindingCallback",{onMutation:n})}},_=function(e,t){for(var n=e.firstChild;n;){if("OPTION"===n.nodeName&&t===n.value)return n;if("OPTGROUP"===n.nodeName){var r=_(n,t);if(r)return r}n=n.nextSibling}},w=function(e,t){var n;null!=t&&(n=_(e,t)),n?n.selected=!0:e.selectedIndex=-1},k=function(e,t){for(var n=e.firstChild;n;)"OPTION"===n.nodeName&&t(n),"OPTGROUP"===n.nodeName&&k(n,t),n=n.nextSibling},E=function(e){var t=[];return k(e,function(e){e.selected&&t.push(e.value)}),t},T=function(e,t){k(e,function(e){e.selected=-1!==t.indexOf(e.value)})},S=function(e,t){var n=o.get.call(e,"attrSetChildOptions");return n?Function.prototype:(n=function(){w(e,e.value)},o.set.call(e,"attrSetChildOptions",n),t.call(e,"change",n),function(t){o.clean.call(e,"attrSetChildOptions"),t.call(e,"change",n)})},C=new Map,I=function(e,t){var n=Object.getOwnPropertyDescriptor(e,t);if(n)return n.writable||n.set;var r=Object.getPrototypeOf(e);return!!r&&I(r,t)},N=function(e,t,n){var r;return(r=C.get(e.prototype))||(r={},C.set(e.constructor,r)),r[t]=n,n},D={checked:{get:function(){return this.checked},set:function(e){var t=!!e||""===e||0===arguments.length;this.checked=t,t&&"radio"===this.type&&(this.defaultChecked=!0)},remove:function(){this.checked=!1},test:function(){return"INPUT"===this.nodeName}},class:{get:function(){return d(this)?this.getAttribute("class"):this.className},set:function(e){e=e||"",d(this)?u.setAttribute.call(this,"class",""+e):this.className=e}},disabled:v("disabled"),focused:{get:function(){return this===document.activeElement},set:function(e){function t(){e?i.focus():i.blur()}var n=A.get(this,"focused"),r=this.ownerDocument.documentElement,i=this;if(n!==e)if(r.contains(i))h.enqueueByQueue({mutate:[t]},null,[]);else var o=s.onNodeInsertion(i,function(){o(),t()});return!0},addEventListener:function(e,t,n){return n.call(this,"focus",t),n.call(this,"blur",t),function(e){e.call(this,"focus",t),e.call(this,"blur",t)}},test:function(){return"INPUT"===this.nodeName}},for:y("htmlFor"),innertext:y("innerText"),innerhtml:y("innerHTML"),innerHTML:y("innerHTML",{addEventListener:function(e,t,n){var r=[],i=this;return["change","blur"].forEach(function(e){var n=function(){t.apply(this,arguments)};a.addEventListener(i,e,n),r.push([e,n])}),function(e){r.forEach(function(t){e.call(i,t[0],t[1])})}}}),required:v("required"),readonly:v("readOnly"),selected:{get:function(){return this.selected},set:function(e){e=!!e,o.set.call(this,"lastSetValue",e),this.selected=e},addEventListener:function(e,t,n){var r=this,i=this.parentNode,s=r.selected,u=function(t){var n=r.selected;n!==(s=o.get.call(r,"lastSetValue")||s)&&(s=n,a.dispatch(r,e))},c=S(i,n);return a.addEventListener(i,"change",u),n.call(r,e,t),function(n){c(n),a.removeEventListener(i,"change",u),n.call(r,e,t)}},test:function(){return"OPTION"===this.nodeName&&this.parentNode&&"SELECT"===this.parentNode.nodeName}},style:{set:function(){var t=e.document&&i().createElement("div");return t&&t.style&&"cssText"in t.style?function(e){this.style.cssText=e||""}:function(e){u.setAttribute.call(this,"style",e)}}()},textcontent:y("textContent"),value:{get:function(){var e=this.value;return"SELECT"===this.nodeName&&"selectedIndex"in this&&-1===this.selectedIndex&&(e=void 0),e},set:function(e){var t=this.nodeName.toLowerCase();if("input"===t&&(e=f(e)),this.value===e&&"option"!==t||(this.value=e),"input"!==t&&"textarea"!==t||(this.defaultValue=e),"select"===t){if(o.set.call(this,"attrValueLastVal",e),w(this,null===e?e:this.value),!this.ownerDocument.documentElement.contains(this))var n=this,r=s.onNodeInsertion(n,function(){r(),w(n,null===e?e:n.value)});b(this,function(){var e=o.get.call(this,"attrValueLastVal");A.set(this,"value",e),a.dispatch(this,"change")})}},test:function(){return p[this.nodeName]}},values:{get:function(){return E(this)},set:function(e){T(this,e=e||[]),o.set.call(this,"stickyValues",A.get(this,"values")),b(this,function(){var e=o.get.call(this,"stickyValues");A.set(this,"values",e);var t=o.get.call(this,"stickyValues");l(e.slice().sort(),t.slice().sort()).length&&a.dispatch(this,"values")})},addEventListener:function(e,t,n){var r=function(){a.dispatch(this,"values")};return a.addEventListener(this,"change",r),n.call(this,e,t),function(n){a.removeEventListener(this,"change",r),n.call(this,e,t)}}}},A={rules:C,specialAttributes:D,getRule:function(e,t){var n=D[t];if(n)return n;var r=C.get(e.constructor),i=r&&r[t];if(i)return i;if(!(t in e))return this.attribute(t);var o=I(e,t)?this.property(t):this.attribute(t);return N(e,t,o)},attribute:function(e){return{get:function(){return this.getAttribute(e)},set:function(t){u.setAttribute.call(this,e,t)}}},property:function(e){return{get:function(){return this[e]},set:function(t){this[e]=t}}},findSpecialListener:function(e){return D[e]&&D[e].addEventListener},setAttrOrProp:function(e,t,n){return this.set(e,t,n)},set:function(e,t,n){var r=this.getRule(e,t),i=r&&r.set;if(i)return i.call(e,n)},get:function(e,t){var n=this.getRule(e,t),r=n&&n.get;if(r)return n.test?n.test.call(e)&&r.call(e):r.call(e)},remove:function(e,t){t=t.toLowerCase();var n=D[t],r=n&&n.set,i=n&&n.remove,o=g(n);"function"==typeof i&&o.call(e)?i.call(e):"function"==typeof r&&o.call(e)?r.call(e,void 0):u.removeAttribute.call(e,t)}};r.exports=A}(function(){return this}(),e,0,n)}),define("can-attribute-observable@1.2.0#get-event-name",["require","exports","module","./behaviors"],function(e,t,n){"use strict";var r=e("./behaviors"),i=function(e){return"input"===e.nodeName.toLowerCase()&&"radio"===e.type},o=function(e,t){return"checked"===e&&!t.legacyBindings};n.exports=function(e,t,n){var a="change";return i(e)&&o(t,n)&&(a="can-attribute-observable-radiochange"),r.findSpecialListener(t)&&(a=t),a}}),define("can-event-dom-radiochange@2.2.0#can-event-dom-radiochange",["require","exports","module","can-globals/document/document","can-namespace"],function(e,t,n){!function(e,t,n,r){"use strict";function i(){return l().documentElement}function o(e){for(;e&&"FORM"!==e.nodeName;)e=e.parentNode;return e}function a(e,t){var n=e.getAttribute("name");return n&&n===t.getAttribute("name")&&o(e)===o(t)}function s(e){return"INPUT"===e.nodeName&&"radio"===e.type}function u(e,t){var n=i(),r=function(n){var r=n.target;if(s(r))for(var i in t){var o={type:i};t[i].forEach(function(t){a(r,t)&&e.dispatch(t,o,!1)})}};return e.addEventListener(n,"change",r),r}function c(e,t){var n=i();e.removeEventListener(n,"change",t)}var l=t("can-globals/document/document"),h=t("can-namespace"),p={defaultEventType:"radiochange",addEventListener:function(e,t,n){if(!s(e))throw new Error("Listeners for "+t+" must be radio inputs");var r=p._eventTypeTrackedRadios;r||(r=p._eventTypeTrackedRadios={},p._rootListener||(p._rootListener=u(this,r)));var i=p._eventTypeTrackedRadios[t];i||(i=p._eventTypeTrackedRadios[t]=new Set),i.add(e),e.addEventListener(t,n)},removeEventListener:function(e,t,n){e.removeEventListener(t,n);var r=p._eventTypeTrackedRadios;if(r){var i=r[t];if(i&&(i.delete(e),0===i.size)){delete r[t];for(var o in r)if(r.hasOwnProperty(o))return;delete p._eventTypeTrackedRadios,c(this,p._rootListener),delete p._rootListener}}}};r.exports=h.domEventRadioChange=p}(0,e,0,n)}),define("can-attribute-observable@1.2.0#can-attribute-observable",["require","exports","module","can-queues","./event","can-reflect","can-observation","./behaviors","./get-event-name","can-reflect-dependencies","can-observation-recorder","can-simple-observable/settable/settable","can-assign","can-symbol","can-dom-events","can-event-dom-radiochange"],function(e,t,n){!function(e,t,n,r){"use strict";function i(){var e=S.call(arguments,0);return e.unshift(this),w.addEventListener.apply(null,e)}function o(){var e=S.call(arguments,0);return e.unshift(this),w.removeEventListener.apply(null,e)}function a(e,t,n,r){this.el=e,this.bound=!1,this.bindingData=n,this.prop=T(e,t)?"values":t,this.event=r||p(e,t,n),this.handler=this.handler.bind(this),void 0!==r&&(this[y]=null,this[v]=null,this[b]=a.prototype.on,this[_]=a.prototype.off)}var s=t("can-queues"),u=t("./event"),c=t("can-reflect"),l=t("can-observation"),h=t("./behaviors"),p=t("./get-event-name"),f=(t("can-reflect-dependencies"),t("can-observation-recorder")),d=t("can-simple-observable/settable/settable"),m=t("can-assign"),g=t("can-symbol"),y=g.for("can.onValue"),v=g.for("can.offValue"),b=g.for("can.onEmit"),_=g.for("can.offEmit"),w=t("can-dom-events"),k=t("can-event-dom-radiochange");w.addEvent(k,"can-attribute-observable-radiochange");var E=function(e){return"select"===e.nodeName.toLowerCase()},T=function(e,t){return E(e)&&"value"===t&&e.multiple},S=Array.prototype.slice;a.prototype=Object.create(d.prototype),m(a.prototype,{constructor:a,get:function(){f.isRecording()&&(f.add(this),this.bound||l.temporarilyBind(this));var e=h.get(this.el,this.prop);return"function"==typeof e&&(e=e.bind(this.el)),e},set:function(e){return h.setAttrOrProp(this.el,this.prop,e)||(this._value=e),e},handler:function(e,t){var n=this._value,r=[];this._value=h.get(this.el,this.prop),void 0===t&&this._value===n||(r=[this.handlers.getNode([]),this,[e,n]],s.enqueueByQueue.apply(s,r))},onBound:function(){var e=this;e.bound=!0,e._handler=function(t){e.handler(h.get(e.el,e.prop),t)},"can-attribute-observable-radiochange"===e.event&&u.on.call(e.el,"change",e._handler);var t=h.findSpecialListener(e.prop);t&&(e._specialDisposal=t.call(e.el,e.prop,e._handler,i)),u.on.call(e.el,e.event,e._handler),this._value=h.get(this.el,this.prop)},onUnbound:function(){var e=this;e.bound=!1,"can-attribute-observable-radiochange"===e.event&&u.off.call(e.el,"change",e._handler),e._specialDisposal&&(e._specialDisposal.call(e.el,o),e._specialDisposal=null),u.off.call(e.el,e.event,e._handler)},valueHasDependencies:function(){return!0},getValueDependencies:function(){var e=new Map,t=new Set;return t.add(this.prop),e.set(this.el,t),{keyDependencies:e}}}),c.assignSymbols(a.prototype,{"can.isMapLike":!1,"can.getValue":a.prototype.get,"can.setValue":a.prototype.set,"can.onValue":a.prototype.on,"can.offValue":a.prototype.off,"can.valueHasDependencies":a.prototype.hasDependencies,"can.getValueDependencies":a.prototype.getValueDependencies}),r.exports=a}(0,e,0,n)}),define("can-stache-bindings@4.6.4#can-stache-bindings",["require","exports","module","can-bind","can-stache/src/expression","can-view-callbacks","can-view-model","can-stache-key","can-observation-recorder","can-simple-observable","can-assign","can-log/dev/dev","can-dom-mutate","can-dom-data-state","can-symbol","can-reflect","can-reflect-dependencies","can-attribute-encoder","can-queues","can-simple-observable/setter/setter","can-attribute-observable","can-view-scope/make-compute-like","can-view-nodelist","can-attribute-observable/event"],function(e,t,n){"use strict";function r(e){if(void 0!==e.special.on)return e.tokens[e.special.on+1]}function i(e){var t={tokens:[],special:{}};return e.split(":").forEach(function(e){L[e]?t.special[e]=t.tokens.push(e)-1:t.tokens.push(e)}),t}var o=e("can-bind"),a=e("can-stache/src/expression"),s=e("can-view-callbacks"),u=e("can-view-model"),c=e("can-stache-key"),l=e("can-observation-recorder"),h=e("can-simple-observable"),p=e("can-assign"),f=(e("can-log/dev/dev"),e("can-dom-mutate")),d=e("can-dom-data-state"),m=e("can-symbol"),g=e("can-reflect"),y=e("can-reflect-dependencies"),v=e("can-attribute-encoder"),b=e("can-queues"),_=e("can-simple-observable/setter/setter"),w=e("can-attribute-observable"),k=e("can-view-scope/make-compute-like"),E=e("can-view-nodelist"),T=e("can-attribute-observable/event"),S=new Map,C=function(){throw new Error("can-stache-bindings - you can not have contextual bindings ( this:from='value' ) and key bindings ( prop:from='value' ) on one element.")},I=function(e,t){var n=t.parentToChild&&"viewModel"===t.child;if(!n)return e;var r=t.childName;if(!n||"this"!==r&&"."!==r){if(!e.isSettingViewModel)return{isSettingOnViewModel:!0,initialViewModelData:e.initialViewModelData};C()}else{if(!e.isSettingViewModel&&!e.isSettingOnViewModel)return{isSettingViewModel:!0,initialViewModelData:void 0};C()}},N=function(e,t,n,r,i){var o={element:e,event:t,viewModel:n,arguments:r};return i.scope.add(o,{special:!0})},D=function(e,t,n,r,i,o,a){b.batch.start();var s=[];s=[function(){var t=i.value(r,{doNotWrapInObservation:!0});return"function"==typeof(t=g.isValueLike(t)?g.getValue(t):t)?t(e):t},null,null,{}],b.mutateQueue.enqueue.apply(b.mutateQueue,s),b.batch.stop()},A={viewModel:function(e,t,n,r,i){var o,a=[],s={},u={},c=p({},r),l={isSettingOnViewModel:!1,isSettingViewModel:!1,initialViewModelData:r||{}},h=!1;if(g.each(e.attributes||[],function(n){var r=j(n,e,{templateType:t.templateType,scope:t.scope,getViewModel:function(){return o},attributeViewModelBindings:c,alreadyUpdatedChild:!0,nodeList:t.parentNodeList,favorViewModel:!0});if(r){var i=r.bindingInfo;if(l=I(l,i),h=!0,i.parentToChild){var u=i.stickyParentToChild?k(r.parent):r.canBinding.parentValue;void 0!==u&&(l.isSettingViewModel?l.initialViewModelData=u:l.initialViewModelData[U(i.childName,t.scope)]=u)}a.push(r.canBinding.start.bind(r.canBinding)),s[n.name]=r.canBinding.stop.bind(r.canBinding)}}),!i||h){o=n(l.initialViewModelData,h,l);for(var d=0,m=a.length;d<m;d++)a[d]();var y;return l.isSettingViewModel||(y=f.onNodeAttributeChange(e,function(n){var r=n.attributeName,i=e.getAttribute(r);s[r]&&s[r]();var a=u[r]&&"attribute"===u[r].parent;if(null!==i||a){var l=j({name:r,value:i},e,{templateType:t.templateType,scope:t.scope,getViewModel:function(){return o},attributeViewModelBindings:c,initializeValues:!0,nodeList:t.parentNodeList});l&&(l.canBinding.start(),u[r]=l.bindingInfo,s[r]=l.canBinding.stop.bind(l.canBinding))}})),function(){y&&(y(),y=void 0);for(var e in s)s[e]()}}},data:function(e,t){if(!d.get.call(e,"preventDataBindings")){var n,r,i,o,a=l.ignore(function(){return n||(n=u(e))}),s=j({name:t.attributeName,value:e.getAttribute(t.attributeName),nodeList:t.nodeList},e,{templateType:t.templateType,scope:t.scope,getViewModel:a,syncChildWithParent:!1});s.canBinding.start();var c=function(){r&&(r(),r=void 0),o&&(o(),o=void 0),i&&(i(),i=void 0)};t.nodeList&&E.register([],c,t.nodeList,!1),r=s.canBinding.stop.bind(s.canBinding),i=f.onNodeAttributeChange(e,function(n){var i=n.attributeName,o=e.getAttribute(i);if(i===t.attributeName&&(r&&r(),null!==o)){var s=j({name:i,value:o},e,{templateType:t.templateType,scope:t.scope,getViewModel:a,initializeValues:!0,nodeList:t.nodeList,syncChildWithParent:!1});s&&(s.canBinding.start(),r=s.canBinding.stop.bind(s.canBinding)),r=s.onTeardown}}),o=f.onNodeRemoval(e,function(){var t=e.ownerDocument,n=t.contains?t:t.documentElement;n&&!1!==n.contains(e)||c()})}},event:function(e,t){var n,r,i=v.decode(t.attributeName);if(-1!==i.indexOf(":to:")||-1!==i.indexOf(":from:")||-1!==i.indexOf(":bind:"))return this.data(e,t);if(!O.call(i,"on:"))throw new Error("can-stache-bindings - unsupported event bindings "+i);n=i.substr("on:".length);var o=e[m.for("can.viewModel")],s=t.scope;if(O.call(n,"el:"))n=n.substr("el:".length),r=e;else{O.call(n,"vm:")?(n=n.substr("vm:".length),r=o,s=o):r=o||e;var c=n.indexOf(":by:");c>=0&&(r=s.get(n.substr(c+":by:".length)),n=n.substr(0,c))}var l,h,p=function(n){var r=e.getAttribute(v.encode(i));if(r){var o=u(e),s=a.parse(r,{lookupRule:function(){return a.Lookup},methodRule:"call"}),c=N(e,n,o,arguments,t);if(s instanceof a.Hashes){var l=s.hashExprs,h=Object.keys(l)[0],p=s.hashExprs[h].value(c),f=g.isObservableLike(p)&&g.isValueLike(p);c.set(h,f?g.getValue(p):p)}else{if(!(s instanceof a.Call))throw new Error("can-stache-bindings: Event bindings must be a call expression. Make sure you have a () in "+t.attributeName+"="+JSON.stringify(r));D(e,0,0,c,s)}}},d=function(){T.off.call(r,n,p),l&&(l(),l=void 0),h&&(h(),h=void 0)};T.on.call(r,n,p),l=f.onNodeAttributeChange(e,function(t){var n=t.attributeName===i,r=!e.getAttribute(i);n&&r&&d()}),h=f.onNodeRemoval(e,function(){var t=e.ownerDocument,n=t.contains?t:t.documentElement;n&&n.contains(e)||d()})}};S.set(/[\w\.:]+:to$/,A.data),S.set(/[\w\.:]+:from$/,A.data),S.set(/[\w\.:]+:bind$/,A.data),S.set(/[\w\.:]+:raw$/,A.data),S.set(/[\w\.:]+:to:on:[\w\.:]+/,A.data),S.set(/[\w\.:]+:from:on:[\w\.:]+/,A.data),S.set(/[\w\.:]+:bind:on:[\w\.:]+/,A.data),S.set(/on:[\w\.:]+/,A.event);var x={viewModelOrAttribute:function(e,t,n,r,i,o,a){return e[m.for("can.viewModel")]?this.viewModel.apply(this,arguments):this.attribute.apply(this,arguments)},scope:function(e,t,n,r,i,o){if(n){if(i||n.indexOf("(")>=0||n.indexOf("=")>=0){var s=a.parse(n,{baseMethodType:"Call"});return s instanceof a.Hashes?new h(function(){var e=s.hashExprs,n=Object.keys(e)[0],r=s.hashExprs[n].value(t),i=g.isObservableLike(r)&&g.isValueLike(r);t.set(n,i?g.getValue(r):r)}):s.value(t)}var u={};g.assignSymbols(u,{"can.getValue":function(){},"can.valueHasDependencies":function(){return!1},"can.setValue":function(e){var r=a.parse(U(n,t),{baseMethodType:"Call"}).value(t);g.setValue(r,e)},"can.getWhatIChange":function(){var e=t.getDataForScopeSet(U(n,t)),r=new Map,i=new Set;return i.add(e.key),r.set(e.parent,i),{mutate:{keyDependencies:r}}},"can.getName":function(){}});var c=t.getDataForScopeSet(U(n,t));return c.parent&&c.key&&y.addMutatedBy(c.parent,c.key,u),u}return new h},viewModel:function(e,t,n,r,i,o,a){var s=U(n,t),u="."===n||"this"===n,l=u?[]:c.reads(n);return new _(function(){var e=r.getViewModel();return c.read(e,l,{}).value},function(e){var t=r.getViewModel();if(o){var n=g.getKeyValue(t,s);g.isObservableLike(n)?g.setValue(n,e):g.setKeyValue(t,s,new h(g.getValue(o)))}else u?g.setValue(t,e):g.setKeyValue(t,s,e)})},attribute:function(e,t,n,r,i,o,a,s){return new w(e,n,r,a)}},O=String.prototype.startsWith||function(e){return 0===this.indexOf(e)},P={to:{childToParent:!0,parentToChild:!1,syncChildWithParent:!1},from:{childToParent:!1,parentToChild:!0,syncChildWithParent:!1},bind:{childToParent:!0,parentToChild:!0,syncChildWithParent:!0},raw:{childToParent:!1,parentToChild:!0,syncChildWithParent:!1}},R=[],L={vm:!0,on:!0};g.each(P,function(e,t){R.push(t),L[t]=!0});var M=function(e,t){return e.indexOf("vm")>=0?"viewModel":e.indexOf("el")>=0?"attribute":t?"viewModel":"viewModelOrAttribute"},V=function(e,t,n,o,a){var s,u,c,l=v.decode(e.name),h=e.value||"",f=i(l);if(R.forEach(function(e){if(void 0!==f.special[e]&&f.special[e]>0)return u=e,c=f.special[e],!1}),u){var d=r(f),m=!d||"bind"===u;return s=p({parent:"scope",child:M(f.tokens,a),childName:f.tokens[c-1],childEvent:d,bindingAttributeName:l,parentName:f.special.raw?'"'+h+'"':h,initializeValues:m},P[u]),"~"===h.trim().charAt(0)&&(s.stickyParentToChild=!0),s}},j=function(e,t,n){var r=V(e,n.attributeViewModelBindings,n.templateType,t.nodeName.toLowerCase(),n.favorViewModel);if(r){var i=x[r.parent](t,n.scope,r.parentName,n,r.parentToChild,void 0,void 0,r),a=x[r.child](t,n.scope,r.childName,n,r.childToParent,r.stickyParentToChild&&i,r.childEvent,r),s=!!r.childToParent,u=!!r.parentToChild,c={child:a,childToParent:s,cycles:!0===s&&!0===u?0:100,onInitDoNotUpdateChild:n.alreadyUpdatedChild,onInitSetUndefinedParentIfChildIsDefined:!0,parent:i,parentToChild:u,priority:n.nodeList?n.nodeList.nesting+1:void 0,queue:"domUI",sticky:r.syncChildWithParent?"childSticksToParent":void 0},l=new o(c);return l.startParent(),{bindingInfo:r,canBinding:l,parent:i}}},U=function(e,t){return e.replace(/@/g,"")},q={behaviors:A,getBindingInfo:V,bindings:S};q[m.for("can.callbackMap")]=S,s.attrs(q),n.exports=q}),define("can-import-module@1.2.0#can-import-module",["require","exports","module","can-globals/global/global","can-namespace"],function(e,t,n){!function(e,t,n,r){"use strict";function i(e){return"function"==typeof e}var o=t("can-globals/global/global"),a=t("can-namespace");r.exports=a.import=function(e,t){return new Promise(function(n,r){try{var a=o();"object"==typeof a.System&&i(a.System.import)?a.System.import(e,{name:t}).then(n,r):a.define&&a.define.amd?a.require([e],function(e){n(e)}):a.require?n(a.require(e)):"undefined"!=typeof stealRequire?steal.import(e,{name:t}).then(n,r):n()}catch(e){r(e)}})}}(0,e,0,n)}),define("can-view-import@4.2.0#can-view-import",["require","exports","module","can-assign","can-dom-data-state","can-symbol","can-globals/document/document","can-child-nodes","can-import-module","can-dom-mutate","can-dom-mutate/node","can-view-nodelist","can-view-callbacks","can-log/","can-log/dev/dev"],function(e,t,n){!function(e,t,n,r){"use strict";function i(e,t){e[u.for("can.viewModel")]=t}function o(e,t){var n=e.getAttribute("from"),r=t.scope.get("scope.helpers.module"),o=r?r.id:void 0;if(!n)return Promise.reject("No module name provided");var u=h(n,o);u.catch(function(e){y.error(e)}),i(e,u),s.set.call(e,"scope",u);var v=t.scope.add(u,{notContext:!0}),b=e.getAttribute("can-tag");if(b){var _=g(b);_&&_!==m.defaultCallback&&(s.set.call(e,"preventDataBindings",!0),_(e,a(t,{scope:v})),s.set.call(e,"preventDataBindings",!1),i(e,u),s.set.call(e,"scope",u))}else{var w=d.register([],void 0,t.parentNodeList||!0,!1);w.expression="<"+this.tagName+">";var k=t.subtemplate?t.subtemplate(v,t.options,w):c().createDocumentFragment(),E=p.onNodeRemoval(e,function(){e.ownerDocument.contains(e)||(E(),d.unregister(w))});f.appendChild.call(e,k),d.update(w,l(e))}}var a=t("can-assign"),s=t("can-dom-data-state"),u=t("can-symbol"),c=t("can-globals/document/document"),l=t("can-child-nodes"),h=t("can-import-module"),p=t("can-dom-mutate"),f=t("can-dom-mutate/node"),d=t("can-view-nodelist"),m=t("can-view-callbacks"),g=m.tag,y=t("can-log/");t("can-log/dev/dev"),["can-import","can-dynamic-import"].forEach(function(e){g(e,o.bind({tagName:e}))})}(0,e)}),define("can-util@3.14.0#js/is-empty-object/is-empty-object",["require","exports","module","can-namespace"],function(e,t,n){"use strict";var r=e("can-namespace");n.exports=r.isEmptyObject=function(e){for(var t in e)return!1;return!0}}),define("can-util@3.14.0#dom/child-nodes/child-nodes",["require","exports","module","can-namespace"],function(e,t,n){"use strict";var r=e("can-namespace");n.exports=r.childNodes=function(e){var t=e.childNodes;if("length"in t)return t;for(var n=e.firstChild,r=[];n;)r.push(n),n=n.nextSibling;return r}}),define("can-simple-observable@2.4.1#make-compute/make-compute",["require","exports","module","can-reflect"],function(e,t,n){"use strict";var r=e("can-reflect"),i=function(e){return arguments.length?r.setValue(this,e):r.getValue(this)},o=new WeakMap;n.exports=function(e){var t=i.bind(e);return t.on=t.bind=t.addEventListener=function(n,i){var a=o.get(i);a||(a=function(e,n){i.call(t,{type:"change"},e,n)},o.set(i,a)),r.onValue(e,a)},t.off=t.unbind=t.removeEventListener=function(t,n){r.offValue(e,o.get(n))},r.assignSymbols(t,{"can.getValue":function(){return r.getValue(e)},"can.setValue":function(t){return r.setValue(e,t)},"can.onValue":function(t,n){return r.onValue(e,t,n)},"can.offValue":function(t,n){return r.offValue(e,t,n)},"can.valueHasDependencies":function(){return r.valueHasDependencies(e)},"can.getPriority":function(){return r.getPriority(e)},"can.setPriority":function(t){r.setPriority(e,t)},"can.isValueLike":!0,"can.isFunctionLike":!1}),t.isComputed=!0,t}}),define("can-simple-observable@2.4.1#async/async",["require","exports","module","../can-simple-observable","can-observation","can-queues","../settable/settable","can-reflect","can-observation-recorder","can-event-queue/value/value"],function(e,t,n){"use strict";function r(e,t,n){this.resolve=this.resolve.bind(this),this.lastSetValue=new i(n),this.handler=this.handler.bind(this),this.observation=new o(function(){this.resolveCalled=!1,this.inGetter=!0;var n=e.call(t,this.lastSetValue.get(),!0===this.bound?this.resolve:void 0);if(this.inGetter=!1,void 0!==n?this.resolve(n):this.resolveCalled&&this.resolve(this._value),!0!==this.bound)return n},this)}var i=e("../can-simple-observable"),o=e("can-observation"),a=e("can-queues"),s=e("../settable/settable"),u=e("can-reflect"),c=e("can-observation-recorder");e("can-event-queue/value/value"),(r.prototype=Object.create(s.prototype)).constructor=r,r.prototype.handler=function(e){void 0!==e&&s.prototype.handler.apply(this,arguments)};var l=c.ignore(u.getValue.bind(u));r.prototype.activate=function(){u.onValue(this.observation,this.handler,"notify"),this.resolveCalled||(this._value=l(this.observation))},r.prototype.resolve=function(e){this.resolveCalled=!0;var t=this._value;if(this._value=e,!this.inGetter){var n=[this.handlers.getNode([]),this,[e,t],null];a.enqueueByQueue.apply(a,n)}},n.exports=r}),define("can-simple-observable@2.4.1#resolver/resolver",["require","exports","module","can-reflect","can-symbol","can-observation-recorder","can-observation","can-queues","can-event-queue/map/map","../settable/settable","../can-simple-observable"],function(e,t,n){"use strict";function r(e,t,n){this.resolver=s.ignore(e),this.context=t,this._valueOptions={resolve:this.resolve.bind(this),listenTo:this.listenTo.bind(this),stopListening:this.stopListening.bind(this),lastSet:new h(n)},this.update=this.update.bind(this),this.contextHandlers=new WeakMap,this.teardown=null,this.binder={}}function i(e,t,n,r){c.off.call(e,t,r,n)}var o=e("can-reflect"),a=e("can-symbol"),s=e("can-observation-recorder"),u=(e("can-observation"),e("can-queues")),c=e("can-event-queue/map/map"),l=e("../settable/settable"),h=e("../can-simple-observable"),p=a.for("can.getChangesDependencyRecord");r.prototype=Object.create(l.prototype),o.assignMap(r.prototype,{constructor:r,listenTo:function(e,t,n,r){o.isPrimitive(e)&&(n=t,t=e,e=this.context),"function"==typeof t&&(n=t,t=void 0);var i=this,a=n.bind(this.context);a[p]=function(){var e=new Set;return e.add(i),{valueDependencies:e}},this.contextHandlers.set(n,a),c.listenTo.call(this.binder,e,t,a,r||"notify")},stopListening:function(){var e=this.binder[a.for("can.meta")],t=e&&e.listenHandlers;if(t){var n=c.stopListeningArgumentsToKeys.call({context:this.context,defaultQueue:"notify"});t.delete(n,i)}return this},resolve:function(e){if(this._value=e,this.isBinding)return this.lastValue=this._value,e;if(this._value!==this.lastValue){var t={};u.batch.start(),u.deriveQueue.enqueue(this.update,this,[],t),u.batch.stop()}return e},update:function(){if(this.lastValue!==this._value){var e=this.lastValue;this.lastValue=this._value,u.enqueueByQueue(this.handlers.getNode([]),this,[this._value,e])}},activate:function(){this.isBinding=!0,this.teardown=this.resolver.call(this.context,this._valueOptions),this.isBinding=!1},onUnbound:function(){this.bound=!1,c.stopListening.call(this.binder),null!=this.teardown&&(this.teardown(),this.teardown=null)},set:function(e){this._valueOptions.lastSet.set(e)},get:function(){if(s.isRecording()&&(s.add(this),this.bound||this.onBound()),!0===this.bound)return this._value;var e=function(){};this.on(e);var t=this._value;return this.off(e),t},hasDependencies:function(){var e=!1;if(this.bound){var t=this.binder[a.for("can.meta")];e=!!(t&&t.listenHandlers).size()}return e},getValueDependencies:function(){if(this.bound){var e=this.binder[a.for("can.meta")],t=e&&e.listenHandlers,n=new Map,r=new Set;if(t&&(o.each(t.root,function(e,t){o.each(e,function(e,i){if(void 0===i)r.add(t);else{var o=n.get(t);o||(o=new Set,n.set(t,o)),o.add(i)}})}),r.size||n.size)){var i={};return n.size&&(i.keyDependencies=n),r.size&&(i.valueDependencies=r),i}}}}),o.assignSymbols(r.prototype,{"can.getValue":r.prototype.get,"can.setValue":r.prototype.set,"can.isMapLike":!1,"can.getPriority":function(){return this.priority||0},"can.setPriority":function(e){this.priority=e},"can.valueHasDependencies":r.prototype.hasDependencies,"can.getValueDependencies":r.prototype.getValueDependencies}),n.exports=r}),define("can-event-queue@1.1.3#type/type",["require","exports","module","can-reflect","can-symbol","can-key-tree","can-queues"],function(e,t,n){"use strict";function r(e,t){t.lifecycleHandlers||(t.lifecycleHandlers=new c([Object,Array])),t.instancePatchesHandlers||(t.instancePatchesHandlers=new c([Object,Array]))}function i(e){var t=e[h];return t||(t={},s.setKeyValue(e,h,t)),r(e,t),t}function o(e,t,n){p["can.on"+e]=function(e,t){i(this)[n].add([t||"mutate",e])},p["can.off"+e]=function(e,t){i(this)[n].delete([t||"mutate",e])},p["can."+t]=function(e,t){l.enqueueByQueue(i(this)[n].getNode([]),this,[e,t])}}function a(e){return s.assignSymbols(e,p)}var s=e("can-reflect"),u=e("can-symbol"),c=e("can-key-tree"),l=e("can-queues"),h=u.for("can.meta"),p={};o("InstancePatches","dispatchInstanceOnPatches","instancePatchesHandlers"),o("InstanceBoundChange","dispatchInstanceBoundChange","lifecycleHandlers"),Object.defineProperty(a,"addHandlers",{enumerable:!1,value:r}),n.exports=a}),define("can-string-to-any@1.2.0#can-string-to-any",function(e,t,n){"use strict";n.exports=function(e){switch(e){case"NaN":case"Infinity":return+e;case"null":return null;case"undefined":return;case"true":case"false":return"true"===e;default:var t=+e;return isNaN(t)?e:t}}}),define("can-data-types@1.2.0#maybe-boolean/maybe-boolean",["require","exports","module","can-reflect"],function(e,t,n){"use strict";function r(e){return null==e?e:!("false"===e||"0"===e||!e)}var i=e("can-reflect");n.exports=i.assignSymbols(r,{"can.new":r,"can.getSchema":function(){return{type:"Or",values:[!0,!1,void 0,null]}},"can.getName":function(){return"MaybeBoolean"},"can.isMember":function(e){return null==e||"boolean"==typeof e}})}),define("can-data-types@1.2.0#maybe-date/maybe-date",["require","exports","module","can-reflect"],function(e,t,n){"use strict";function r(e){var t=typeof e;return"string"===t?(e=Date.parse(e),isNaN(e)?null:new Date(e)):"number"===t?new Date(e):e}function i(e){this.setValue=e;var t=r(e);this.value=null==t?t:t.getTime()}var o=e("can-reflect");i.prototype.valueOf=function(){return this.value},o.assignSymbols(i.prototype,{"can.serialize":function(){return this.setValue}}),n.exports=o.assignSymbols(r,{"can.new":r,"can.getSchema":function(){return{type:"Or",values:[Date,void 0,null]}},"can.ComparisonSetType":i,"can.getName":function(){return"MaybeDate"},"can.isMember":function(e){return null==e||e instanceof Date}})}),define("can-data-types@1.2.0#maybe-number/maybe-number",["require","exports","module","can-reflect"],function(e,t,n){"use strict";function r(e){return null==e?e:+e}var i=e("can-reflect");n.exports=i.assignSymbols(r,{"can.new":r,"can.getSchema":function(){return{type:"Or",values:[Number,void 0,null]}},"can.getName":function(){return"MaybeNumber"},"can.isMember":function(e){return null==e||"number"==typeof e}})}),define("can-data-types@1.2.0#maybe-string/maybe-string",["require","exports","module","can-reflect"],function(e,t,n){"use strict";function r(e){return null==e?e:""+e}var i=e("can-reflect");n.exports=i.assignSymbols(r,{"can.new":r,"can.getSchema":function(){return{type:"Or",values:[String,void 0,null]}},"can.getName":function(){return"MaybeString"},"can.isMember":function(e){return null==e||"string"==typeof e}})}),define("can-define@2.7.1#can-define",["require","exports","module","can-namespace","can-symbol","can-reflect","can-observation","can-observation-recorder","can-simple-observable/async/async","can-simple-observable/settable/settable","can-simple-observable/resolver/resolver","can-event-queue/map/map","can-event-queue/type/type","can-queues","can-assign","can-log/dev/dev","can-string-to-any","can-define-lazy-value","can-data-types/maybe-boolean/maybe-boolean","can-data-types/maybe-date/maybe-date","can-data-types/maybe-number/maybe-number","can-data-types/maybe-string/maybe-string"],function(e,t,n){"use strict";"format cjs";function r(e){return e&&(!0===e.canDefineType||e[M])}function i(e,t,n){Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:!0,value:n})}function o(e,t){for(var n in e)e.hasOwnProperty(n)&&t.call(e,n,Object.getOwnPropertyDescriptor(e,n))}function a(e){var t=Object.getOwnPropertyNames(e),n="getOwnPropertySymbols"in Object?Object.getOwnPropertySymbols(e):[];return t.concat(n)}function s(e,t,n,r){void 0===t.value||"function"==typeof t.value&&0!==t.value.length||(t.default=t.value,delete t.value),void 0!==t.Value&&(t.Default=t.Value,delete t.Value)}function u(e){return"function"==typeof e.value&&e.value.length}function c(e,t){var n=e._computed&&e._computed[t];n&&n.compute&&(n.count?n.count++:(n.count=1,_.onValue(n.compute,n.handler,"notify"),n.oldValue=j(n.compute)))}function l(e,t){var n=e._computed&&e._computed[t];n&&(1===n.count?(n.count=0,_.offValue(n.compute,n.handler,"notify")):n.count--)}function h(e){return _.isValueLike(e)&&_.isObservableLike(e)}var p,f,d,m,g,y,v=e("can-namespace"),b=e("can-symbol"),_=e("can-reflect"),w=e("can-observation"),k=e("can-observation-recorder"),E=e("can-simple-observable/async/async"),T=e("can-simple-observable/settable/settable"),S=e("can-simple-observable/resolver/resolver"),C=e("can-event-queue/map/map"),I=e("can-event-queue/type/type"),N=e("can-queues"),D=e("can-assign"),A=(e("can-log/dev/dev"),e("can-string-to-any")),x=e("can-define-lazy-value"),O=e("can-data-types/maybe-boolean/maybe-boolean"),P=e("can-data-types/maybe-date/maybe-date"),R=e("can-data-types/maybe-number/maybe-number"),L=e("can-data-types/maybe-string/maybe-string"),M=b.for("can.new"),V=b.for("can.serialize"),j=k.ignore(_.getValue.bind(_)),U=Object.defineProperty;n.exports=f=v.define=function(e,t,n){var r,o=Object.create(n?n.dataInitializers:null),s=Object.create(n?n.computedInitializers:null),u=g(t,n,e);if(u.dataInitializers=o,u.computedInitializers=s,_.eachKey(u.definitions,function(t,n){f.property(e,n,t,o,s,u.defaultDefinition)}),e.hasOwnProperty("_data"))for(r in o)x(e._data,r,o[r].bind(e),!0);else x(e,"_data",function(){var e=this,t={};for(var n in o)x(t,n,o[n].bind(e),!0);return t});if(e.hasOwnProperty("_computed"))for(r in s)x(e._computed,r,s[r].bind(e));else x(e,"_computed",function(){var e=this,t=Object.create(null);for(var n in s)x(t,n,s[n].bind(e));return t});a(p).forEach(function(t){Object.defineProperty(e,t,{enumerable:!1,value:p[t],configurable:!0,writable:!0})}),Object.defineProperty(e,"_define",{enumerable:!1,value:u,configurable:!0,writable:!0});var c=b.iterator||b.for("iterator");return e[c]||i(e,c,function(){return new f.Iterator(this)}),u};var q=function(e){for(var t in e)if("type"!==t)return!1;return!0};f.extensions=function(){},f.property=function(e,t,n,r,i,o){var a=f.extensions.apply(this,arguments);a&&(n=m(t,a,o||{},e));var s=n.type;if(s&&q(n)&&s===f.types["*"])U(e,t,{get:d.get.data(t),set:d.set.events(t,d.get.data(t),d.set.data(t),d.eventType.data(t)),enumerable:!0,configurable:!0});else{n.type=s;var c,l=n.get||u(n)?"computed":"data",h=d.read[l](t),p=d.get[l](t),g=d.set[l](t),y=function(e){return e};n.Type&&(y=d.set.Type(t,n.Type,y)),s&&(y=d.set.type(t,s,y));var v=d.set.events(t,h,g,d.eventType[l](t));u(n)?i[t]=d.valueResolver(t,n,y):void 0===n.default&&void 0===n.Default||(c=k.ignore(d.get.defaultValue(t,n,y,v))),n.get?i[t]=d.compute(t,n.get,c):c&&(r[t]=c),n.get&&n.set?g=d.set.setter(t,n.set,d.read.lastSet(t),g,!0):n.set?g=d.set.setter(t,n.set,h,v,!1):"data"===l?g=v:n.get&&n.get.length<1&&(g=function(){}),s&&(g=d.set.type(t,s,g)),n.Type&&(g=d.set.Type(t,n.Type,g)),U(e,t,{get:p,set:g,enumerable:"serialize"in n?!!n.serialize:!n.get,configurable:!0})}},f.makeDefineInstanceKey=function(e){e[b.for("can.defineInstanceKey")]=function(t,n){var r=this.prototype._define;"object"==typeof n&&s(0,n);var i=y(t,n,r.defaultDefinition,this);i&&"object"==typeof i?(f.property(e.prototype,t,i,r.dataInitializers,r.computedInitializers,r.defaultDefinition),r.definitions[t]=i):r.methods[t]=i,this.prototype.dispatch({type:"can.keys",target:this.prototype})}},f.Constructor=function(e,t){var n=function(e){Object.defineProperty(this,"__inSetup",{configurable:!0,enumerable:!1,value:!0,writable:!0}),f.setup.call(this,e,t),this.__inSetup=!1},r=f(n.prototype,e);return I(n),f.makeDefineInstanceKey(n,r),n},d={computeObj:function(e,t,n){var r={oldValue:void 0,compute:n,count:0,handler:function(n){var i=r.oldValue;r.oldValue=n,e.dispatch({type:t,target:e},[n,i])}};return r},valueResolver:function(e,t,n){var r=d.get.defaultValue(e,t,n);return function(){var n=this,i=r.call(this);return d.computeObj(n,e,new S(t.value,n,i))}},compute:function(e,t,n){return function(){var r,i=this,o=n&&n.call(this);return r=0===t.length?new w(t,i):1===t.length?new T(t,i,o):new E(t,i,o),d.computeObj(i,e,r)}},set:{data:function(e){return function(t){this._data[e]=t}},computed:function(e){return function(t){_.setValue(this._computed[e].compute,t)}},events:function(e,t,n,r){return function(r){if(this.__inSetup)n.call(this,r);else{var i=t.call(this);if(r!==i){var o;n.call(this,r),o={patches:[{type:"set",key:e,value:r}],type:e,target:this},this.dispatch(o,[r,i])}}}},setter:function(e,t,n,r,i){return function(e){var o=this;N.batch.start();var a=!1,s=n.call(this),u=t.call(this,e,function(e){r.call(o,e),a=!0},s);if(a)N.batch.stop();else if(i)if(void 0!==u)s!==u&&r.call(this,u),N.batch.stop();else{if(0===t.length)return r.call(this,e),void N.batch.stop();if(1!==t.length)return void N.batch.stop();N.batch.stop()}else if(void 0!==u)r.call(this,u),N.batch.stop();else{if(0===t.length)return r.call(this,e),void N.batch.stop();if(1!==t.length)return void N.batch.stop();r.call(this,void 0),N.batch.stop()}}},type:function(e,t,n){function i(r){return n.call(this,t.call(this,r,e))}return r(t)?t.canDefineType?i:function(e){return n.call(this,_.convert(e,t))}:"object"==typeof t?d.set.Type(e,t,n):i},Type:function(e,t,n){return Array.isArray(t)&&f.DefineList?t=f.DefineList.extend({"#":t[0]}):"object"==typeof t&&(t=f.DefineMap?f.DefineMap.extend(t):f.Constructor(t)),function(e){return e instanceof t||null==e?n.call(this,e):n.call(this,new t(e))}}},eventType:{data:function(e){return function(t,n){return void 0!==n||this._data.hasOwnProperty(e)?"set":"add"}},computed:function(){return function(){return"set"}}},read:{data:function(e){return function(){return this._data[e]}},computed:function(e){return function(){return _.getValue(this._computed[e].compute)}},lastSet:function(e){return function(){var t=this._computed[e].compute;if(t.lastSetValue)return _.getValue(t.lastSetValue)}}},get:{defaultValue:function(e,t,n,r){return function(){var i=t.default;if(void 0!==i)"function"==typeof i&&(i=i.call(this)),i=n.call(this,i);else{var o=t.Default;o&&(i=n.call(this,new o))}if(t.set){var a,s=!0;return d.set.setter(e,t.set,function(){},function(e){s?a=e:r.call(this,e)},t.get).call(this,i),s=!1,a}return i}},data:function(e){return function(){return this.__inSetup||k.add(this,e),this._data[e]}},computed:function(e){return function(t){var n=this._computed[e].compute;return k.isRecording()&&(k.add(this,e),_.isBound(n)||w.temporarilyBind(n)),j(n)}}}},f.behaviors=["get","set","value","Value","type","Type","serialize"];var F=function(e,t,n){if("enumerable"===t)e.serialize=!!n;else if("type"===t){var i=n;"string"==typeof i&&("object"!=typeof(i=f.types[i])||r(i)||(D(e,i),i=i[t])),void 0!==i&&(e[t]=i)}else e[t]=n};m=function(e,t,n,r){var i={};if(_.eachKey(t,function(e,t){F(i,t,e)}),_.eachKey(n,function(e,t){void 0===i[t]&&"type"!==t&&"Type"!==t&&(i[t]=e)}),t.Type){var o=t.Type,a=o[V];a&&(i.serialize=function(e){return a.call(e)}),o[M]&&(i.type=o[M],delete i.Type)}if("string"!=typeof t.type){if(!i.type&&!i.Type){var u=_.assignMap({},n);i=_.assignMap(u,i)}0===_.size(i)&&(i.type=f.types["*"])}return s(0,i),i},y=function(e,t,n,r){var i;return"string"==typeof t?i={type:t}:t&&(t[V]||t[M])?i={Type:t}:"function"==typeof t?_.isConstructorLike(t)&&(i={Type:t}):Array.isArray(t)?i={Type:t}:_.isPlainObject(t)&&(i=t),i?m(e,i,n,r):t},g=function(e,t,n){var r,a=Object.create(t?t.definitions:null),s={},u=e["*"];return u?(delete e["*"],r=y("*",u,{})):r=Object.create(null),o(e,function(e,t){var i;if(i=t.get||t.set?{get:t.get,set:t.set}:t.value,"constructor"!==e){var o=y(e,i,r,n);o&&"object"==typeof o&&_.size(o)>0?a[e]=o:"function"==typeof o&&(s[e]=o)}else s[e]=i}),u&&i(e,"*",u),{definitions:a,methods:s,defaultDefinition:r}},p=C({});var B=b.for("can.meta");D(p,{_eventSetup:function(){},_eventTeardown:function(){},addEventListener:function(e,t,n){return c(this,e),C.addEventListener.apply(this,arguments)},removeEventListener:function(e,t){return l(this,e),C.removeEventListener.apply(this,arguments)}}),p.on=p.bind=p.addEventListener,p.off=p.unbind=p.removeEventListener;var K=b.for("can.onKeyValue"),W=b.for("can.offKeyValue");_.assignSymbols(p,{"can.onKeyValue":function(e){return c(this,e),C[K].apply(this,arguments)},"can.offKeyValue":function(e){return l(this,e),C[W].apply(this,arguments)}}),delete p.one,f.setup=function(e,t){Object.defineProperty(this,"constructor",{value:this.constructor,enumerable:!1,writable:!1}),Object.defineProperty(this,B,{value:Object.create(null),enumerable:!1,writable:!1});var n=this._define.definitions,r=Object.create(null),o=this;_.eachKey(e,function(e,t){void 0!==n[t]?o[t]=e:f.expando(o,t,e)}),_.size(r)>0&&i(this,"_instanceDefinitions",r)};var H=function(e){return e};f.expando=function(e,t,n){if(f._specialKeys[t])return!0;var r=e._define.definitions;if(!r||!r[t]){var i=e._instanceDefinitions;if(!i){if(Object.isSealed(e))return;Object.defineProperty(e,"_instanceDefinitions",{configurable:!0,enumerable:!1,writable:!0,value:{}}),i=e._instanceDefinitions}if(!i[t]){var o=e._define.defaultDefinition||{type:f.types.observable};return f.property(e,t,o,{},{}),e._data[t]=o.type?f.make.set.type(t,o.type,H).call(e,n):f.types.observable(n),i[t]=o,e.__inSetup||(N.batch.start(),e.dispatch({type:"can.keys",target:e}),void 0!==e._data[t]&&e.dispatch({type:t,target:e,patches:[{type:"set",key:t,value:e._data[t]}]},[e._data[t],void 0]),N.batch.stop()),!0}}},f.replaceWith=x,f.eventsProto=p,f.defineConfigurableAndNotEnumerable=i,f.make=d,f.getDefinitionOrMethod=y,f._specialKeys={_data:!0,_computed:!0};var z={};f.makeSimpleGetterSetter=function(e){if(void 0===z[e]){var t=d.set.events(e,d.get.data(e),d.set.data(e),d.eventType.data(e));z[e]={get:d.get.data(e),set:function(e){return t.call(this,f.types.observable(e))},enumerable:!0,configurable:!0}}return z[e]},f.Iterator=function(e){this.obj=e,this.definitions=Object.keys(e._define.definitions),this.instanceDefinitions=e._instanceDefinitions?Object.keys(e._instanceDefinitions):Object.keys(e),this.hasGet="function"==typeof e.get},f.Iterator.prototype.next=function(){var e;if(this.definitions.length){if(e=this.definitions.shift(),this.obj._define.definitions[e].get)return this.next()}else{if(!this.instanceDefinitions.length)return{value:void 0,done:!0};e=this.instanceDefinitions.shift()}return{value:[e,this.hasGet?this.obj.get(e):this.obj[e]],done:!1}},f.types={date:P,number:R,boolean:O,observable:function(e){return Array.isArray(e)&&f.DefineList?e=new f.DefineList(e):_.isPlainObject(e)&&f.DefineMap&&(e=new f.DefineMap(e)),e},stringOrObservable:function(e){return Array.isArray(e)?new f.DefaultList(e):_.isPlainObject(e)?new f.DefaultMap(e):_.convert(e,f.types.string)},htmlbool:function(e){return""===e||!!A(e)},"*":function(e){return e},any:function(e){return e},string:L,compute:{set:function(e,t,n,r){return h(e)?e:h(r)?(_.setValue(r,e),r):e},get:function(e){return h(e)?_.getValue(e):e}}},f.updateSchemaKeys=function(e,t){for(var n in t){var r=t[n];!1!==r.serialize&&(r.type?e.keys[n]=r.type:e.keys[n]=function(e){return e},!0===t[n].identity&&e.identity.push(n))}return e}}),define("can-define@2.7.1#ensure-meta",["require","exports","module","can-symbol","can-reflect"],function(e,t,n){"use strict";var r=e("can-symbol"),i=e("can-reflect");n.exports=function(e){var t=r.for("can.meta"),n=e[t];return n||(n={},i.setKeyValue(e,t,n)),n}}),define("can-define@2.7.1#define-helpers/define-helpers",["require","exports","module","can-define","can-reflect","can-queues","can-log/dev/dev","../ensure-meta"],function(e,t,n){"use strict";var r=e("can-define"),i=e("can-reflect"),o=e("can-queues"),a=e("can-log/dev/dev"),s=e("../ensure-meta"),u={defineExpando:r.expando,reflectSerialize:function(e){var t=this._define.definitions,n=this._define.defaultDefinition;return this.forEach(function(r,o){var a=t[o];void 0!==(r=a&&"function"==typeof a.serialize?a.serialize.call(this,r,o):n&&"function"==typeof n.serialize?n.serialize.call(this,r,o):i.serialize(r))&&(e[o]=r)},this),e},reflectUnwrap:function(e){return this.forEach(function(t,n){void 0!==t&&(e[n]=i.unwrap(t))}),e},log:function(e){var t=this,n=function(e){return"string"==typeof e?JSON.stringify(e):e},r=s(t),o=r.allowedLogKeysSet||new Set;r.allowedLogKeysSet=o,e&&o.add(e),r._log=function(r,s){var u=r.type;"can.onPatches"===u||e&&!o.has(u)||"can.keys"===u||e&&!o.has(u)||("add"===u||"remove"===u?a.log(i.getName(t),"\n how   ",n(u),"\n what  ",n(s[0]),"\n index ",n(s[1])):a.log(i.getName(t),"\n key ",n(u),"\n is  ",n(s[0]),"\n was ",n(s[1])))}},deleteKey:function(e){var t=this._instanceDefinitions;if(t&&Object.prototype.hasOwnProperty.call(t,e)&&!Object.isSealed(this)){delete t[e],o.batch.start(),this.dispatch({type:"can.keys",target:this});var n=this._data[e];void 0!==n&&(delete this._data[e],this.dispatch({type:e,target:this,patches:[{type:"delete",key:e}]},[void 0,n])),o.batch.stop()}else this.set(e,void 0);return this}};n.exports=u}),define("can-define@2.7.1#map/map",["require","exports","module","can-construct","can-define","../define-helpers/define-helpers","can-observation-recorder","can-namespace","can-log","can-log/dev/dev","can-reflect","can-symbol","can-queues","can-event-queue/type/type"],function(e,t,n){"use strict";function r(e){v.batch.start(),g.assignMap(this,e||{}),v.batch.stop()}function i(e){v.batch.start(),g.updateMap(this,e||{}),v.batch.stop()}function o(e){v.batch.start(),g.assignDeepMap(this,e||{}),v.batch.stop()}function a(e){v.batch.start(),g.updateDeepMap(this,e||{}),v.batch.stop()}function s(e,t){p.defineExpando(this,e,t)||(this[e]=t)}function u(e){var t=this[e];return void 0!==t||e in this||Object.isSealed(this)?t:(f.add(this,e),this[e])}function c(){var e=this.prototype._define,t=e?e.definitions:{},n={type:"map",identity:[],keys:{}};return h.updateSchemaKeys(n,t)}var l=e("can-construct"),h=e("can-define"),p=e("../define-helpers/define-helpers"),f=e("can-observation-recorder"),d=e("can-namespace"),m=e("can-log"),g=(e("can-log/dev/dev"),e("can-reflect")),y=e("can-symbol"),v=e("can-queues"),b=e("can-event-queue/type/type"),_=function(e){var t=[];for(var n in e){var r=e[n];"object"==typeof r&&("serialize"in r?!r.serialize:r.get)||t.push(n)}return t},w=y.for("can.getSchema"),k=function(e){h.setup.call(this,e||{},this.constructor.seal)},E=l.extend("DefineMap",{setup:function(e){var t,n=this.prototype;if(E){var r=h(n,n,e.prototype._define);h.makeDefineInstanceKey(this,r),b(this);for(t in E.prototype)h.defineConfigurableAndNotEnumerable(n,t,n[t]);n.setup===E.prototype.setup&&h.defineConfigurableAndNotEnumerable(n,"setup",k);var i=Object.getOwnPropertyDescriptor(n,"_computed").get;Object.defineProperty(n,"_computed",{configurable:!0,enumerable:!1,get:function(){if(this!==n)return i.call(this,arguments)}})}else for(t in n)h.defineConfigurableAndNotEnumerable(n,t,n[t]);h.defineConfigurableAndNotEnumerable(n,"constructor",this),this[w]=c}},{setup:function(e,t){this._define||(Object.defineProperty(this,"_define",{enumerable:!1,value:{definitions:{}}}),Object.defineProperty(this,"_data",{enumerable:!1,value:{}})),h.setup.call(this,e||{},!0===t)},get:function(e){return e?u.call(this,e):g.unwrap(this,Map)},set:function(e,t){return"object"==typeof e?!0===t?a.call(this,e):o.call(this,e):s.call(this,e,t),this},assignDeep:function(e){return o.call(this,e),this},updateDeep:function(e){return a.call(this,e),this},assign:function(e){return r.call(this,e),this},update:function(e){return i.call(this,e),this},serialize:function(){return g.serialize(this,Map)},deleteKey:p.deleteKey,forEach:function(){var e=function(e,t,n){return g.eachKey(e,t,n)},t=f.ignore(e);return function(n,r,i){return!1===i?t(this,n,r):e(this,n,r)}}(),"*":{type:h.types.observable}}),T={"can.isMapLike":!0,"can.isListLike":!1,"can.isValueLike":!1,"can.getKeyValue":u,"can.setKeyValue":s,"can.deleteKeyValue":p.deleteKey,"can.getOwnKeys":function(){var e=g.getOwnEnumerableKeys(this);if(this._computed)for(var t,n=g.getOwnKeys(this._computed),r=0;r<n.length;r++)t=n[r],e.indexOf(t)<0&&e.push(t);return e},"can.getOwnEnumerableKeys":function(){return f.add(this,"can.keys"),f.add(Object.getPrototypeOf(this),"can.keys"),_(this._define.definitions).concat(_(this._instanceDefinitions))},"can.hasOwnKey":function(e){return Object.hasOwnProperty.call(this._define.definitions,e)},"can.hasKey":function(e){return!!this._define.definitions[e]},"can.assignDeep":o,"can.updateDeep":a,"can.unwrap":p.reflectUnwrap,"can.serialize":p.reflectSerialize,"can.keyHasDependencies":function(e){return!!(this._computed&&this._computed[e]&&this._computed[e].compute)},"can.getKeyDependencies":function(e){var t;return this._computed&&this._computed[e]&&this._computed[e].compute&&((t={}).valueDependencies=new Set,t.valueDependencies.add(this._computed[e].compute)),t}};g.assignSymbols(E.prototype,T),g.setKeyValue(E.prototype,y.iterator,function(){return new h.Iterator(this)});for(var S in h.eventsProto)E[S]=h.eventsProto[S],Object.defineProperty(E.prototype,S,{enumerable:!1,value:h.eventsProto[S],writable:!0});("getOwnPropertySymbols"in Object?Object.getOwnPropertySymbols(h.eventsProto):[y.for("can.onKeyValue"),y.for("can.offKeyValue")]).forEach(function(e){Object.defineProperty(E.prototype,e,{configurable:!0,enumerable:!1,value:h.eventsProto[e],writable:!0})}),h.DefineMap=E,Object.defineProperty(E.prototype,"toObject",{enumerable:!1,writable:!0,value:function(){return m.warn("Use DefineMap::get instead of DefineMap::toObject"),this.get()}}),n.exports=d.DefineMap=E}),define("can-route@4.4.6#src/string-coercion",["require","exports","module","can-reflect","can-symbol"],function(e,t,n){var r=e("can-reflect"),i=e("can-symbol"),o=function(e){return e&&"object"==typeof e?(e=e&&"object"==typeof e&&"serialize"in e?e.serialize():"function"==typeof e.slice?e.slice():r.assign({},e),r.eachKey(e,function(t,n){e[n]=o(t)})):void 0!==e&&null!==e&&"function"==typeof e.toString&&(e=e.toString()),e};t.stringCoercingMapDecorator=function(e){var t=i.for("can.route.stringCoercingMapDecorator");if(!e.attr[t]){var n=e.attr;e.attr=function(e,t){var r;return r="string"!=typeof e||void 0!==this.define&&void 0!==this.define[e]&&!this.define[e].serialize?arguments:o(Array.apply(null,arguments)),n.apply(this,r)},r.setKeyValue(e.attr,t,!0)}return e},t.stringify=o}),define("can-route@4.4.6#src/routedata",["require","exports","module","can-define/map/map","./string-coercion"],function(e,t,n){var r=e("can-define/map/map"),i=e("./string-coercion").stringify;n.exports=r.extend("RouteData",{seal:!1},{"*":{type:i}})}),define("can-route@4.4.6#src/binding-proxy",["require","exports","module","can-reflect","can-symbol","can-simple-observable"],function(e,t,n){"use strict";var r=e("can-reflect"),i=e("can-symbol"),o=new(e("can-simple-observable"))(null);r.setName(o,"route.urlData");var a={defaultBinding:null,urlDataObservable:o,bindings:{},call:function(){var e=r.toArray(arguments),t=e.shift(),n=o.value;if(null===n)throw new Error("there is no current binding!!!");var a=n[0===t.indexOf("can.")?i.for(t):t];return a.apply?a.apply(n,e):a}};n.exports=a}),define("can-route@4.4.6#src/regexps",function(e,t,n){"use strict";n.exports={curlies:/\{\s*([\w.]+)\s*\}/g,colon:/\:([\w.]+)/g}}),define("can-diff@1.4.2#map/map",["require","exports","module","can-reflect"],function(e,t,n){"use strict";var r=e("can-reflect");n.exports=function(e,t){var n,i=[];n=r.assignMap({},e),r.eachKey(t,function(r,o){e&&e.hasOwnProperty(o)?t[o]!==e[o]&&i.push({key:o,type:"set",value:r}):i.push({key:o,type:"add",value:r}),delete n[o]});for(var o in n)i.push({key:o,type:"delete"});return i}}),define("can-route@4.4.6#src/register",["require","exports","module","can-reflect","can-log/dev/dev","./binding-proxy","./regexps","can-diff/list/list","can-diff/map/map","./routedata"],function(e,t,n){"use strict";var r=e("can-reflect"),i=(e("can-log/dev/dev"),e("./binding-proxy")),o=e("./regexps"),a=(e("can-diff/list/list"),e("can-diff/map/map"),e("./routedata")),s=function(e){return e.replace(/\\/g,"")},u=function(e){return(e+"").replace(/([.?*+\^$\[\]\\(){}|\-])/g,"\\$1")},c={routes:{},register:function(e,t){var n=i.call("root");n.lastIndexOf("/")===n.length-1&&0===e.indexOf("/")&&(e=e.substr(1)),t=t||{};var l,h,p,f=[],d="",m=i.call("querySeparator"),g=i.call("matchSlashes");for(p=(h=o.colon.test(e)?o.colon:o.curlies).lastIndex=0;l=h.exec(e);)f.push(l[1]),d+=s(e.substring(p,h.lastIndex-l[0].length)),d+="([^\\"+(s(e.substr(h.lastIndex,1))||m+(g?"":"|/"))+"]"+(t[l[1]]?"*":"+")+")",p=h.lastIndex;if(d+=e.substr(p).replace("\\",""),this.data instanceof a){var y=this.data;r.eachIndex(f,function(e){var n="string",i=t[e],o=typeof i;null!=i&&(n=o),r.defineInstanceKey(y.constructor,e,{type:n})})}return c.routes[e]={test:new RegExp("^"+d+"($|"+u(m)+")"),route:e,names:f,defaults:t,length:e.split("/").length}}};n.exports=c}),define("can-deparam@1.2.0#can-deparam",["require","exports","module","can-namespace"],function(e,t,n){"use strict";function r(e){return a.test(e)||"[]"===e}function i(e){return e}var o=e("can-namespace"),a=/^\d+$/,s=/([^\[\]]+)|(\[\])/g,u=/([^?#]*)(#.*)?$/,c=/%([^0-9a-f][0-9a-f]|[0-9a-f][^0-9a-f]|[^0-9a-f][^0-9a-f])/i,l=function(e){e=e.replace(/\+/g," ");try{return decodeURIComponent(e)}catch(t){return decodeURIComponent(e.replace(c,function(e,t){return"%25"+t}))}};n.exports=o.deparam=function(e,t){t=t||i;var n,o={};return e&&u.test(e)&&e.split("&").forEach(function(e){var i=e.split("="),a=l(i.shift()),u=l(i.join("=")),c=o;if(a){for(var h=0,p=(i=a.match(s)).length-1;h<p;h++){var f=i[h],d=i[h+1],m=r(f)&&c instanceof Array;c[f]||(m?c.push(r(d)?[]:{}):c[f]=r(d)?[]:{}),c=m?c[c.length-1]:c[f]}r(n=i.pop())?c.push(t(u)):c[n]=t(u)}}),o}}),define("can-route@4.4.6#src/deparam",["require","exports","module","can-deparam","can-reflect","./binding-proxy","./register"],function(e,t,n){"use strict";function r(e){var t=u.call("root");return t.lastIndexOf("/")===t.length-1&&0===e.indexOf("/")&&(e=e.substr(1)),e}function i(e){e=r(e);var t={length:-1};if(s.eachKey(c.routes,function(n,r){n.test.test(e)&&n.length>t.length&&(t=n)}),t.length>-1)return t}function o(e){var t=i(e),n=u.call("querySeparator"),o=u.call("paramsMatcher");if(e=r(e),t){var c=e.match(t.test),h=c.shift(),p=e.substr(h.length-(c[c.length-1]===n?1:0)),f=p&&o.test(p)?a(p.slice(1)):{};return f=s.assignDeep(s.assignDeep({},t.defaults),f),c.forEach(function(e,r){e&&e!==n&&(f[t.names[r]]=l(e))}),f}return e.charAt(0)!==n&&(e=n+e),o.test(e)?a(e.slice(1)):{}}var a=e("can-deparam"),s=e("can-reflect"),u=e("./binding-proxy"),c=e("./register"),l=function(e){try{return decodeURIComponent(e)}catch(t){return unescape(e)}};o.getRule=i,n.exports=o}),define("can-param@1.1.0#can-param",["require","exports","module","can-namespace"],function(e,t,n){"use strict";function r(e,t,n){if(Array.isArray(t))for(var i=0,o=t.length;i<o;++i)r(e+"[]",t[i],n);else if(t&&"object"==typeof t)for(var a in t)r(e+"["+a+"]",t[a],n);else n(e,t)}var i=e("can-namespace");n.exports=i.param=function(e){var t=[];for(var n in e)r(n,e[n],function(e,n){t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))});return t.join("&").replace(/%20/g,"+")}}),define("can-route@4.4.6#src/param",["require","exports","module","can-reflect","can-param","./register","./regexps","./binding-proxy"],function(e,t,n){"use strict";function r(e,t){var n,r,i=0,o=0;return delete e.route,a.eachKey(e,function(){o++}),a.eachKey(u.routes,function(t,a){if((r=h(t,e))>i&&(n=t,i=r),r>=o)return!1}),u.routes[t]&&h(u.routes[t],e)===i&&(n=u.routes[t]),n}function i(e,t){var n,r,i,o;return e?(n=a.assignMap({},t),o=c.colon.test(e.route)?c.colon:c.curlies,r=e.route.replace(o,function(r,i){return delete n[i],t[i]===e.defaults[i]?"":encodeURIComponent(t[i])}).replace("\\",""),a.eachKey(e.defaults,function(e,t){n[t]===e&&delete n[t]}),i=s(n),r+(i?l.call("querySeparator")+i:"")):0===a.size(t)?"":l.call("querySeparator")+s(t)}function o(e,t){return i(r(e,t),e)}var a=e("can-reflect"),s=e("can-param"),u=e("./register"),c=e("./regexps"),l=e("./binding-proxy"),h=function(e,t){var n=0,r=0,i={};for(var o in e.defaults)e.defaults[o]===t[o]&&(i[o]=1,n++);for(;r<e.names.length;r++){if(!t.hasOwnProperty(e.names[r]))return-1;i[e.names[r]]||n++}return n};n.exports=o,o.paramFromRoute=i,o.getMatchedRoute=r}),define("can-route@4.4.6#src/url-helpers",["require","exports","module","./binding-proxy","./deparam","./param","can-reflect","can-string"],function(e,t,n){"use strict";function r(e,t){if(t){var n=o(i.call("can.getValue"));e=s.assignMap(s.assignMap({},n),e)}return i.call("root")+a(e)}var i=e("./binding-proxy"),o=e("./deparam"),a=e("./param"),s=e("can-reflect"),u=e("can-string"),c=function(e){var t=[];return s.eachKey(e,function(e,n){t.push(("className"===n?"class":n)+'="'+("href"===n?e:u.esc(e))+'"')}),t.join(" ")},l=function(e,t){for(var n in e){var r=e[n],i=t[n];if(r&&i&&"object"==typeof r&&"object"==typeof t)return l(r,i);if(r!=i)return!1}return!0};n.exports={url:r,link:function(e,t,n,i){return"<a "+c(s.assignMap({href:r(t,i)},n))+">"+e+"</a>"},isCurrent:function(e,t){if(t){var n=o(i.call("can.getValue"));return l(e,n)}return i.call("can.getValue")===a(e)}}}),define("can-route-hash@1.0.1#can-route-hash",["require","exports","module","can-globals/location/location","can-reflect","can-observation-recorder","can-queues","can-key-tree","can-simple-observable","can-dom-events"],function(e,t,n){!function(e,t,n,r){function i(){return s().href.split(/#!?/)[1]||""}function o(){var e=this.dispatchHandlers.bind(this),t=this;this._value="",this.handlers=new h([Object,Array],{onFirst:function(){t._value=i(),f.addEventListener(window,"hashchange",e)},onEmpty:function(){f.removeEventListener(window,"hashchange",e)}})}var a=/^(?:&[^=]+=[^&]*)+/,s=t("can-globals/location/location"),u=t("can-reflect"),c=t("can-observation-recorder"),l=t("can-queues"),h=t("can-key-tree"),p=t("can-simple-observable"),f=t("can-dom-events");o.prototype=Object.create(p.prototype),o.constructor=o,u.assign(o.prototype,{paramsMatcher:a,querySeparator:"&",matchSlashes:!1,root:"#!",dispatchHandlers:function(){var e=this._value;this._value=i(),e!==this._value&&l.enqueueByQueue(this.handlers.getNode([]),this,[this._value,e])},get:function(){return c.add(this),i()},set:function(e){var t=s();return(e||t.hash)&&t.hash!=="#"+e&&(t.hash="!"+e),e}}),Object.defineProperty(o.prototype,"value",{get:function(){return u.getValue(this)},set:function(e){u.setValue(this,e)}}),u.assignSymbols(o.prototype,{"can.getValue":o.prototype.get,"can.setValue":o.prototype.set,"can.onValue":o.prototype.on,"can.offValue":o.prototype.off,"can.isMapLike":!1,"can.valueHasDependencies":function(){return!0}}),r.exports=o}(0,e,0,n)}),define("can-globals@1.2.0#is-web-worker/is-web-worker",["require","exports","module","can-globals/can-globals-instance"],function(e,t,n){!function(e,t,n,r){"use strict";var i=t("can-globals/can-globals-instance"),o=Function;i.define("isWebWorker",function(){var e=o("return this")();return"undefined"!=typeof WorkerGlobalScope&&e instanceof WorkerGlobalScope}),r.exports=i.makeExport("isWebWorker")}(0,e,0,n)}),define("can-route@4.4.6#can-route",["require","exports","module","can-bind","can-queues","can-observation","can-namespace","can-log/dev/dev","can-reflect","can-symbol","can-simple-observable/make-compute/make-compute","./src/routedata","./src/string-coercion","./src/register","./src/url-helpers","./src/param","./src/deparam","./src/binding-proxy","can-route-hash","can-globals/is-web-worker/is-web-worker","can-globals/is-browser-window/is-browser-window"],function(e,t,n){!function(e,t,n,r){"use strict";function i(e,t){return g.register(e,t),i}function o(e){clearTimeout(S),S=setTimeout(function(){var e=h.serialize(i.data),t=C.get(),n=v.getMatchedRoute(e,t),r=v.paramFromRoute(n,e);_.call("can.setValue",r);var o=i._onStartComplete;o&&(i._onStartComplete=void 0,o())},10)}function a(){var e=_.call("can.getValue");u.batch.start();var t=i.deparam(e);delete t.route,h.update(i.data,t),u.batch.stop()}var s=t("can-bind"),u=t("can-queues"),c=t("can-observation"),l=t("can-namespace"),h=(t("can-log/dev/dev"),t("can-reflect")),p=t("can-symbol"),f=t("can-simple-observable/make-compute/make-compute"),d=t("./src/routedata"),m=t("./src/string-coercion").stringCoercingMapDecorator,g=t("./src/register"),y=t("./src/url-helpers"),v=t("./src/param"),b=t("./src/deparam"),_=t("./src/binding-proxy"),w=t("can-route-hash"),k=t("can-globals/is-web-worker/is-web-worker"),E=t("can-globals/is-browser-window/is-browser-window"),T=new w;_.bindings.hashchange=T,_.defaultBinding="hashchange",_.urlDataObservable.value=T;var S,C=new c(function(){var e=_.call("can.getValue");return i.rule(e)});Object.defineProperty(i,"routes",{get:function(){return g.routes},set:function(e){return g.routes=e}}),Object.defineProperty(i,"defaultBinding",{get:function(){return _.defaultBinding},set:function(e){_.defaultBinding=e;var t=_.bindings[_.defaultBinding];t&&(_.urlDataObservable.value=t)}}),Object.defineProperty(i,"urlData",{get:function(){return _.urlDataObservable.value},set:function(e){i._teardown(),_.urlDataObservable.value=e}}),h.assignMap(i,{param:v,deparam:b,map:function(e){i.data=e},start:function(e){if(!0!==e&&(i._setup(),E()||k())){var t=_.call("can.getValue");u.batch.start();var n=i.deparam(t);delete n.route,h.assign(i.data,n),u.batch.stop(),o()}return i},url:y.url,link:y.link,isCurrent:y.isCurrent,bindings:_.bindings,_setup:function(){if(!i._canBinding){var e={parent:_.urlDataObservable.value,setParent:o,child:i.serializedObservation,setChild:a,onInitDoNotUpdateChild:!0,cycles:1,queue:"notify"};i._canBinding=new s(e),i._canBinding.start()}},_teardown:function(){i._canBinding&&(i._canBinding.stop(),i._canBinding=null),clearTimeout(S)},stop:function(){return this._teardown(),i},currentRule:f(C),register:g.register,rule:function(e){var t=b.getRule(e);if(t)return t.route}});var I=function(e,t){return i.data[e]?i.data[e].apply(i.data,t):i.data.addEventListener.apply(i.data,t)};["addEventListener","removeEventListener","bind","unbind","on","off"].forEach(function(e){i[e]=function(t,n){return"__url"===t?_.call("can.onValue",n):I(e,arguments)}}),["delegate","undelegate","removeAttr","compute","_get","___get","each"].forEach(function(e){i[e]=function(){return I(e,arguments)}});var N,D,A,x=function(e){return N=e};Object.defineProperty(i,"serializedObservation",{get:function(){return D||(D=new c(function(){return h.serialize(i.data)})),D}}),Object.defineProperty(i,"serializedCompute",{get:function(){return A||(A=f(i.serializedObservation)),A}});var O=p.for("can.viewModel");Object.defineProperty(i,"data",{get:function(){return N||x(new d)},set:function(e){h.isConstructorLike(e)&&(e=new e),e&&void 0!==e[O]&&(e=e[O]),x("attr"in e?m(e):e)}}),i.attr=function(e,t){return console.warn("can-route: can-route.attr is deprecated. Use methods on can-route.data instead."),"attr"in i.data?i.data.attr.apply(i.data,arguments):arguments.length>1?(h.setKeyValue(i.data,e,t),i.data):"object"==typeof e?(h.assignDeep(i.data,e),i.data):1===arguments.length?h.getKeyValue(i.data,e):h.unwrap(i.data)},h.setKeyValue(i,p.for("can.isFunctionLike"),!1),i.matched=i.currentRule,i.current=i.isCurrent,r.exports=l.route=i}(0,e,0,n)}),define("can-view-parser@4.1.2#can-view-parser",["require","exports","module","can-namespace","can-log/dev/dev","can-attribute-encoder"],function(e,t,n){"use strict";function r(e,t){for(var n=0;n<e.length;n++)t(e[n],n)}function i(e){var t={};return r(e.split(","),function(e){t[e]=!0}),t}function o(e,t){for(var n=0,r=e.length;n<r;n++){var i=e[n];t[i.tokenType].apply(t,i.args)}return e}var a=e("can-namespace"),s=(e("can-log/dev/dev"),e("can-attribute-encoder")),u=new RegExp("^<\\/([-:_A-Za-z0-9]+)[^>]*>"),c=new RegExp("\\{\\{(![\\s\\S]*?!|[\\s\\S]*?)\\}\\}\\}?","g"),l=/\s/,h=new RegExp("[A-Za-z0-9]"),p=new RegExp("[-:_A-Za-z0-9]+s*=s*(\"[^\"]*\"|'[^']*')"),f=i("area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed"),d=i("altGlyph,altGlyphDef,altGlyphItem,animateColor,animateMotion,animateTransform,clipPath,feBlend,feColorMatrix,feComponentTransfer,feComposite,feConvolveMatrix,feDiffuseLighting,feDisplacementMap,feDistantLight,feFlood,feFuncA,feFuncB,feFuncG,feFuncR,feGaussianBlur,feImage,feMerge,feMergeNode,feMorphology,feOffset,fePointLight,feSpecularLighting,feSpotLight,feTile,feTurbulence,foreignObject,glyphRef,linearGradient,radialGradient,textPath"),m=i("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr"),g=i("script"),y="start,end,close,attrStart,attrEnd,attrValue,chars,comment,special,done".split(","),v={"{":"}","(":")"},b=function(){},_=function(e,t,n){function i(e,n){var r;if(n)for(n=d[n]?n:n.toLowerCase(),r=k.length-1;r>=0&&k[r]!==n;r--);else r=0;if(r>=0){for(var i=k.length-1;i>=r;i--)t.close&&t.close(k[i],v);k.length=r,"body"===n&&(h=!0)}}if("object"==typeof e)return o(e,t);var a=[];t=t||{},n&&r(y,function(e){var n=t[e]||b;t[e]=function(){if(!1!==n.apply(this,arguments)){var t=arguments.length;void 0===arguments[t-1]&&(t=arguments.length-1),a.push({tokenType:e,args:[].slice.call(arguments,0,t)})}}});var s,l,h,p,v,w=function(){S&&!h&&t.chars&&t.chars(S,v),h=!1,S=""},k=[],T=e,S="";for(k.last=function(){return this[this.length-1]};e;){if(l=!0,k.last()&&g[k.last()])e=e.replace(new RegExp("([\\s\\S]*?)</"+k.last()+"[^>]*>"),function(e,n){return n=n.replace(/<!--([\s\S]*?)-->|<!\[CDATA\[([\s\S]*?)]]>/g,"$1$2"),t.chars&&t.chars(n,v),""}),i(0,k.last());else{if(0===e.indexOf("\x3c!--"))(s=e.indexOf("--\x3e"))>=0&&(w(),t.comment&&t.comment(e.substring(4,s),v),e=e.substring(s+3),l=!1);else if(0===e.indexOf("</"))(p=e.match(u))&&(w(),p[0].replace(u,i),e=e.substring(p[0].length),l=!1);else if(0===e.indexOf("<")){var C=_.searchStartTag(e);C&&(w(),function(e,n,r,o){n=d[n]?n:n.toLowerCase(),m[n]&&k.last()===n&&i(0,n),o=f[n]||!!o,t.start(n,o,v),o||k.push(n),_.parseAttrs(r,t,v),t.end(n,o,v),"html"===n&&(h=!0)}.apply(null,C.match),e=C.html,l=!1)}else 0===e.indexOf("{{")&&(p=e.match(c))&&(w(),p[0].replace(c,function(e,n){t.special&&t.special(n,v)}),e=e.substring(p[0].length));if(l){0===(s=E(e,"{{"))&&e===T&&(S+=e.charAt(0),e=e.substr(1),s=E(e,"{{"));var I=s<0?e:e.substring(0,s);e=s<0?"":e.substring(s),I&&(S+=I)}}if(e===T)throw new Error("Parse Error: "+e);T=e}return w(),i(),t.done(v),a},w=function(e,t,n,r,i){var o=r.substring("number"==typeof e.nameStart?e.nameStart:t,t),a=s.encode(o);e.attrStart=a,n.attrStart(e.attrStart,i),e.inName=!1},k=function(e,t,n,r,i){if(void 0!==e.valueStart&&e.valueStart<t){var o=r.substring(e.valueStart,t);n.attrValue(o,i)}n.attrEnd(e.attrStart,i),e.attrStart=void 0,e.valueStart=void 0,e.inValue=!1,e.inName=!1,e.lookingForEq=!1,e.inQuote=!1,e.lookingForName=!0},E=function(e,t){for(var n=t.length,r=0,i=e.length;r<i;r++)if("<"===e[r]||e.substr(r,n)===t)return r;return-1};_.parseAttrs=function(e,t,n){if(e){for(var r,i=0,o={inName:!1,nameStart:void 0,inValue:!1,valueStart:void 0,inQuote:!1,attrStart:void 0,lookingForName:!0,lookingForValue:!1,lookingForEq:!1};i<e.length;){r=i;var a=e.charAt(i);if(i++,"{{"===e.substr(r,"{{".length)){o.inValue&&r>o.valueStart?t.attrValue(e.substring(o.valueStart,r),n):o.inName&&o.nameStart<r?(w(o,r,t,e,n),k(o,r,t,e,n)):o.lookingForValue?o.inValue=!0:o.lookingForEq&&o.attrStart&&k(o,r,t,e,n),c.lastIndex=r;var s=c.exec(e);s&&(t.special(s[1],n),i=r+s[0].length,o.inValue&&(o.valueStart=r+s[0].length))}else if(o.inValue)o.inQuote?a===o.inQuote&&k(o,r,t,e,n):l.test(a)&&k(o,r,t,e,n);else if("="===a&&(o.lookingForEq||o.lookingForName||o.inName))o.attrStart||w(o,r,t,e,n),o.lookingForValue=!0,o.lookingForEq=!1,o.lookingForName=!1;else if(o.inName){var u,h=e[o.nameStart];v[h]===a?(u=v["{"===h?"(":"{"],e[r+1]===u?(w(o,r+2,t,e,n),i++):w(o,r+1,t,e,n),o.lookingForEq=!0):l.test(a)&&"{"!==h&&"("!==h&&(w(o,r,t,e,n),o.lookingForEq=!0)}else o.lookingForName?l.test(a)||(o.attrStart&&k(o,r,t,e,n),o.nameStart=r,o.inName=!0):o.lookingForValue&&(l.test(a)?i===e.length&&k(o,r,t,e,n):(o.lookingForValue=!1,o.inValue=!0,"'"===a||'"'===a?(o.inQuote=a,o.valueStart=r+1):o.valueStart=r))}o.inName?(w(o,r+1,t,e,n),k(o,r+1,t,e,n)):(o.lookingForEq||o.lookingForValue||o.inValue)&&k(o,r+1,t,e,n),c.lastIndex=0}},_.searchStartTag=function(e){for(var t=e.indexOf(">"),n=p.exec(e.substring(1)),r=1;n&&t>=r+n.index;){for(r+=n.index+n[0].length;t<r;)t+=e.substring(t+1).indexOf(">")+1;n=p.exec(e.substring(r))}if(-1===t||!h.test(e[1]))return null;var i,o,a,s="",u="",c=e.substring(0,t+1),f="/"===c[c.length-2],d=c.search(l);return f?(u="/",o=c.substring(1,c.length-2).trim()):o=c.substring(1,c.length-1).trim(),-1===d?i=o:(d--,i=o.substring(0,d),s=o.substring(d)),a=[c,i,s,u],{match:a,html:e.substring(c.length)}},n.exports=a.HTMLParser=_}),define("can-view-target@4.1.2#can-view-target",["require","exports","module","can-globals/document/document","can-dom-mutate/node","can-namespace","can-globals/mutation-observer/mutation-observer"],function(e,t,n){!function(e,t,n,r){"use strict";function i(e,t,n,r){var i,o,a,s,u,l=n,h=typeof e,d=function(){return i||(i={path:n,callbacks:[]},t.push(i),l=[]),i};if("object"===h){if(e.tag){if(o=m&&e.namespace?r.createElementNS(e.namespace,e.tag):r.createElement(e.tag),e.attrs)for(var g in e.attrs){var y=e.attrs[g];"function"==typeof y?d().callbacks.push({callback:y}):null!==y&&"object"==typeof y&&y.namespaceURI?o.setAttributeNS(y.namespaceURI,g,y.value):c.setAttribute.call(o,g,y)}if(e.attributes)for(s=0,u=e.attributes.length;s<u;s++)d().callbacks.push({callback:e.attributes[s]});e.children&&e.children.length&&(a=i?i.paths=[]:t,o.appendChild(p(e.children,a,l,r)))}else if(e.comment&&(o=r.createComment(e.comment),e.callbacks))for(s=0,u=e.attributes.length;s<u;s++)d().callbacks.push({callback:e.callbacks[s]})}else"string"===h?o=r.createTextNode(e):"function"===h&&(f?(o=r.createTextNode(""),d().callbacks.push({callback:e})):(o=r.createComment("~"),d().callbacks.push({callback:function(){var t=r.createTextNode("");return c.replaceChild.call(this.parentNode,t,this),e.apply(t,arguments)}})));return o}function o(e,t,n){for(var r=t.path,i=t.callbacks,a=t.paths,s=e,u=r?r.length:0,c=a?a.length:0,l=0;l<u;l++)s=s.childNodes.item(r[l]);for(l=0;l<c;l++)o(s,a[l],n);n.push({element:s,callbacks:i})}function a(e,t){for(var n,r,i,o=e.length,a=0;a<o;a++){n=(i=e[a]).callbacks.length,r=i.element;for(var s=0;s<n;s++)i.callbacks[s].callback.apply(r,t)}}function s(e,t){var n=[],r=p(e,n,[],t||u());return{paths:n,clone:r,hydrate:function(){for(var e=g(this.clone),t=[],r=0,i=t.length=arguments.length;r<i;r++)t[r]=arguments[r];for(var s=[],u=0;u<n.length;u++)o(e,n[u],s);return a(s,t),e}}}var u=t("can-globals/document/document"),c=t("can-dom-mutate/node"),l=t("can-namespace"),h=t("can-globals/mutation-observer/mutation-observer"),p=function(e,t,n,r){for(var o=r.createDocumentFragment(),a=0,s=e.length;a<s;a++){var u=e[a];o.appendChild(i(u,t,n.concat(a),r))}return o},f="undefined"!=typeof document&&function(){var e=document.createDocumentFragment(),t=document.createElement("div");return t.appendChild(document.createTextNode("")),t.appendChild(document.createTextNode("")),e.appendChild(t),2===e.cloneNode(!0).firstChild.childNodes.length}(),d="undefined"!=typeof document&&function(){var e=document.createElement("a");e.innerHTML="<xyz></xyz>";var t,n,r=e.cloneNode(!0),i="<xyz></xyz>"===r.innerHTML;return i?((e=document.createDocumentFragment()).appendChild(document.createTextNode("foo-bar")),(t=h())?((n=new t(function(){})).observe(document.documentElement,{childList:!0,subtree:!0}),r=e.cloneNode(!0),n.disconnect()):r=e.cloneNode(!0),1===r.childNodes.length):i}(),m="undefined"!=typeof document&&!!document.createElementNS,g=d?function(e){return e.cloneNode(!0)}:function(e){var t,n=e.ownerDocument;if(1===e.nodeType?t="http://www.w3.org/1999/xhtml"!==e.namespaceURI&&m&&n.createElementNS?n.createElementNS(e.namespaceURI,e.nodeName):n.createElement(e.nodeName):3===e.nodeType?t=n.createTextNode(e.nodeValue):8===e.nodeType?t=n.createComment(e.nodeValue):11===e.nodeType&&(t=n.createDocumentFragment()),e.attributes)for(var r=e.attributes,i=0;i<r.length;i++){var o=r[i];o&&o.specified&&(o.namespaceURI?t.setAttributeNS(o.namespaceURI,o.nodeName||o.name,o.nodeValue||o.value):t.setAttribute(o.nodeName||o.name,o.nodeValue||o.value))}if(e&&e.firstChild)for(var a=e.firstChild;a;)t.appendChild(g(a)),a=a.nextSibling;return t};s.keepsTextNodes=f,s.cloneNode=g,l.view=l.view||{},r.exports=l.view.target=s}(0,e,0,n)}),define("can-stache@4.15.9#src/html_section",["require","exports","module","can-view-target","./utils","can-globals/document/document","can-assign"],function(e,t,n){!function(e,t,n,r){"use strict";var i=t("can-view-target"),o=t("./utils"),a=t("can-globals/document/document"),s=t("can-assign"),u=o.last,c="undefined"!=typeof document&&function(){var e=a().createElement("div");return function(t){return-1===t.indexOf("&")?t.replace(/\r\n/g,"\n"):(e.innerHTML=t,0===e.childNodes.length?"":e.childNodes.item(0).nodeValue)}}(),l=function(e){e&&(this.filename=e),this.stack=[new h]};s(l.prototype,o.mixins),s(l.prototype,{startSubSection:function(e){var t=new h(e);return this.stack.push(t),t},endSubSectionAndReturnRenderer:function(){if(this.last().isEmpty())return this.stack.pop(),null;var e=this.endSection();return o.makeView(e.compiled.hydrate.bind(e.compiled))},startSection:function(e){var t=new h(e);this.last().add(t.targetCallback),this.stack.push(t)},endSection:function(){return this.last().compile(),this.stack.pop()},inverse:function(){this.last().inverse()},compile:function(){var e=this.stack.pop().compile();return o.makeView(e.hydrate.bind(e))},push:function(e){this.last().push(e)},pop:function(){return this.last().pop()},removeCurrentNode:function(){this.last().removeCurrentNode()}});var h=function(e){this.data="targetData",this.targetData=[],this.targetStack=[];var t=this;this.targetCallback=function(n,r){e.call(this,n,r,t.compiled.hydrate.bind(t.compiled),t.inverseCompiled&&t.inverseCompiled.hydrate.bind(t.inverseCompiled))}};s(h.prototype,{inverse:function(){this.inverseData=[],this.data="inverseData"},push:function(e){this.add(e),this.targetStack.push(e)},pop:function(){return this.targetStack.pop()},add:function(e){"string"==typeof e&&(e=c(e)),this.targetStack.length?u(this.targetStack).children.push(e):this[this.data].push(e)},compile:function(){return this.compiled=i(this.targetData,a()),this.inverseData&&(this.inverseCompiled=i(this.inverseData,a()),delete this.inverseData),this.targetStack=this.targetData=null,this.compiled},removeCurrentNode:function(){return this.children().pop()},children:function(){return this.targetStack.length?u(this.targetStack).children:this[this.data]},isEmpty:function(){return!this.targetData.length}}),l.HTMLSection=h,r.exports=l}(0,e,0,n)}),define("can-view-live@4.2.7#lib/core",["require","exports","module","can-view-parser","can-dom-mutate","can-view-nodelist","can-fragment","can-child-nodes","can-reflect","can-reflect-dependencies"],function(e,t,n){"use strict";function r(e,t){return e.contains?e.contains(t):e.nodeType===Node.DOCUMENT_NODE&&e.documentElement?r(e.documentElement,t):(t=t.parentNode)===e}var i=e("can-view-parser"),o=e("can-dom-mutate"),a=e("can-view-nodelist"),s=e("can-fragment"),u=e("can-child-nodes"),c=e("can-reflect"),l=(e("can-reflect-dependencies"),{setup:function(e,t,n){var i,a,s=!1,u=function(){return s||(s=!0,n(a),i&&(i(),i=void 0)),!0};return a={teardownCheck:function(e){return!e&&u()}},i=o.onNodeRemoval(e,function(){r(e.ownerDocument,e)||u()}),t(a),a},listen:function(e,t,n,r){return l.setup(e,function(){c.onValue(t,n,r||"notify")},function(e){c.offValue(t,n,r||"notify"),e.nodeList&&a.unregister(e.nodeList)})},getAttributeParts:function(e){var t,n={};return i.parseAttrs(e,{attrStart:function(e){n[e]="",t=e},attrValue:function(e){n[t]+=e},attrEnd:function(){}}),n},isNode:function(e){return e&&e.nodeType},addTextNodeIfNoChildren:function(e){e.firstChild||e.appendChild(e.ownerDocument.createTextNode(""))},replace:function(e,t,n){var r=e.slice(0),i=s(t);return a.register(e,n),a.update(e,u(i)),a.replace(r,i),e},getParentNode:function(e,t){return t&&11===e.parentNode.nodeType?t:e.parentNode},makeString:function(e){return null==e?"":""+e}});n.exports=l}),define("can-view-live@4.2.7#lib/attr",["require","exports","module","./core","can-reflect","can-queues","can-attribute-observable/behaviors"],function(e,t,n){"use strict";var r=e("./core"),i=e("can-reflect"),o=e("can-queues"),a=e("can-attribute-observable/behaviors");r.attr=function(e,t,n){r.listen(e,n,function(n){o.domUIQueue.enqueue(a.set,a,[e,t,n])}),a.set(e,t,i.getValue(n))}}),define("can-view-live@4.2.7#lib/attrs",["require","exports","module","./core","can-view-callbacks","can-dom-mutate","can-dom-mutate/node","can-reflect","can-reflect-dependencies"],function(e,t,n){"use strict";var r=e("./core"),i=e("can-view-callbacks"),o=e("can-dom-mutate"),a=e("can-dom-mutate/node"),s=e("can-reflect");e("can-reflect-dependencies"),r.attrs=function(e,t,n,u){function c(t){var o,s=r.getAttributeParts(t);for(o in s){var c=s[o];if(c!==l[o]){a.setAttribute.call(e,o,c);var h=i.attr(o);h&&h(e,{attributeName:o,scope:n,options:u})}delete l[o]}for(o in l)a.removeAttribute.call(e,o);l=s}if(s.isObservableLike(t)){var l={};s.onValue(t,c,"domUI");var h,p=function(){s.offValue(t,c,"domUI"),h&&(h(),h=void 0)};h=o.onNodeRemoval(e,function(){var t=e.ownerDocument;(t.contains?t:t.documentElement).contains(e)||p()}),c(s.getValue(t))}else{var f=r.getAttributeParts(t);for(var d in f)a.setAttribute.call(e,d,f[d])}}}),define("can-view-live@4.2.7#lib/html",["require","exports","module","./core","can-view-nodelist","can-fragment","can-child-nodes","can-reflect","can-symbol","can-queues"],function(e,t,n){"use strict";function r(e,t,n){if(!0!==e.nodeList.isUnregistered){var r=u.toArray(s(t));n||o.update(e.nodeList,r,e.oldNodes);var i=e.oldNodes;e.oldNodes=r,o.replace(i,t)}}var i=e("./core"),o=e("can-view-nodelist"),a=e("can-fragment"),s=e("can-child-nodes"),u=e("can-reflect"),c=e("can-symbol"),l=e("can-queues"),h=c.for("can.viewInsert");i.html=function(e,t,n,c){var p,f,d,m,g;void 0!==c&&(Array.isArray(c)?d=c:(d=c.nodeList,g=c));var y={reasonLog:"live.html replace::"+u.getName(t)};n=i.getParentNode(e,n),p=i.listen(n,t,function(e){o.first(m).parentNode&&f(e,!0);var t=o.first(m).parentNode;p.teardownCheck(t)}),m=d||[e],f=function(e,t){e&&"function"==typeof e[h]&&(e=e[h](g));var n="function"==typeof e,u=a(n?"":e);if(i.addTextNodeIfNoChildren(u),!0===t){p.oldNodes=o.unregisterChildren(m,!0);var c=!1;n&&(e(u.firstChild),c=o.first(m)===u.firstChild),l.domUIQueue.enqueue(r,null,[p,u,c],y)}else p.oldNodes=o.update(m,s(u)),n&&e(u.firstChild),o.replace(p.oldNodes,u)},p.nodeList=m,d?d.unregistered=p.teardownCheck:o.register(m,p.teardownCheck),f(u.getValue(t))}}),define("can-view-live@4.2.7#lib/set-observable",["require","exports","module","can-simple-observable","can-reflect"],function(e,t,n){"use strict";function r(e,t){this.setter=t,i.call(this,e)}var i=e("can-simple-observable"),o=e("can-reflect");(r.prototype=Object.create(i.prototype)).constructor=r,r.prototype.set=function(e){this.setter(e)},o.assignSymbols(r.prototype,{"can.setValue":r.prototype.set}),n.exports=r}),define("can-diff@1.4.2#patcher/patcher",["require","exports","module","can-reflect","can-key-tree","can-symbol","../list/list","can-queues","can-symbol"],function(e,t,n){"use strict";var r=e("can-reflect"),i=e("can-key-tree"),o=e("can-symbol"),a=e("../list/list"),s=e("can-queues"),u=(o=e("can-symbol")).for("can.onValue"),c=o.for("can.offValue"),l=o.for("can.onPatches"),h=o.for("can.offPatches"),p=function(e,t){this.handlers=new i([Object,Array],{onFirst:this.setup.bind(this),onEmpty:this.teardown.bind(this)}),this.observableOrList=e,this.isObservableValue=r.isValueLike(this.observableOrList)||r.isObservableLike(this.observableOrList),this.isObservableValue?this.priority=r.getPriority(e):this.priority=t||0,this.onList=this.onList.bind(this),this.onPatchesNotify=this.onPatchesNotify.bind(this),this.onPatchesDerive=this.onPatchesDerive.bind(this),this.patches=[]};p.prototype={constructor:p,setup:function(){this.observableOrList[u]?(r.onValue(this.observableOrList,this.onList,"notify"),this.setupList(r.getValue(this.observableOrList))):this.setupList(this.observableOrList)},teardown:function(){this.observableOrList[c]&&r.offValue(this.observableOrList,this.onList,"notify")},setupList:function(e){this.currentList=e,e&&e[l]&&e[l](this.onPatchesNotify,"notify")},onList:function(e){var t=this.currentList||[];e=e||[],t[h]&&t[h](this.onPatchesNotify,"notify");var n=a(t,e);this.currentList=e,this.onPatchesNotify(n),e[l]&&e[l](this.onPatchesNotify,"notify")},onPatchesNotify:function(e){this.patches.push.apply(this.patches,e),s.deriveQueue.enqueue(this.onPatchesDerive,this,[],{priority:this.priority})},onPatchesDerive:function(){var e=this.patches;this.patches=[],s.enqueueByQueue(this.handlers.getNode([]),this.currentList,[e,this.currentList],null,["Apply patches",e])}},r.assignSymbols(p.prototype,{"can.onPatches":function(e,t){this.handlers.add([t||"mutate",e])},"can.offPatches":function(e,t){this.handlers.delete([t||"mutate",e])}}),n.exports=p}),define("can-view-live@4.2.7#lib/list",["require","exports","module","./core","can-view-nodelist","can-fragment","can-child-nodes","can-dom-mutate/node","can-reflect","can-symbol","can-reflect-dependencies","can-simple-observable","./set-observable","can-diff/patcher/patcher"],function(e,t,n){"use strict";function r(e,t,n,r,a,s,u){this.patcher=new f(t),a=i.getParentNode(e,a),this.value=t,this.render=n,this.context=r,this.parentNode=a,this.falseyRender=u,this.masterNodeList=s||o.register([e],null,!0),this.placeholder=e,this.indexMap=[],this.isValueLike=c.isValueLike(this.value),this.isObservableLike=c.isObservableLike(this.value),this.onPatches=this.onPatches.bind(this);var l=this.data=i.setup(a,this.setupValueBinding.bind(this),this.teardownValueBinding.bind(this));this.masterNodeList.unregistered=function(){l.teardownCheck()}}var i=e("./core"),o=e("can-view-nodelist"),a=e("can-fragment"),s=e("can-child-nodes"),u=e("can-dom-mutate/node"),c=e("can-reflect"),l=e("can-symbol"),h=(e("can-reflect-dependencies"),e("can-simple-observable")),p=e("./set-observable"),f=e("can-diff/patcher/patcher"),d=[].splice,m=function(e,t,n,r,i){var u=[];t&&(o.register(u,null,!0,!0),u.parentList=t,u.expression="#each SUBEXPRESSION");var l=n.apply(r,i.concat([u])),h=a(l),p=c.toArray(s(h));return t?(o.update(u,p),e.push(u)):e.push(o.register(p)),h},g=function(e,t,n){var r=[];return e.splice(t+1,n).forEach(function(e){var t=o.unregister(e);[].push.apply(r,t)}),r},y=l.for("can.onPatches"),v=l.for("can.offPatches"),y=l.for("can.onPatches"),v=l.for("can.offPatches");r.prototype={setupValueBinding:function(){this.patcher[y](this.onPatches,"domUI"),this.patcher.currentList&&this.patcher.currentList.length?this.onPatches([{insert:this.patcher.currentList,index:0,deleteCount:0}]):this.addFalseyIfEmpty()},teardownValueBinding:function(){this.patcher[v](this.onPatches,"domUI"),this.exit=!0,this.remove({length:this.patcher.currentList?this.patcher.currentList.length:0},0,!0)},onPatches:function(e){if(!this.exit)for(var t=0,n=e.length;t<n;t++){var r=e[t];"move"===r.type?this.move(r.toIndex,r.fromIndex):(r.deleteCount&&this.remove({length:r.deleteCount},r.index,!0),r.insert&&r.insert.length&&this.add(r.insert,r.index))}},add:function(e,t){var n=this.placeholder.ownerDocument.createDocumentFragment(),r=[],i=[],a=this.masterNodeList,s=this.render,l=this.context;e.forEach(function(e,o){var u=new h(o+t),f=new p(e,function(e){c.setKeyValue(this.patcher.currentList,u.get(),e)}.bind(this)),d=m(r,a,s,l,[f,u]);n.appendChild(d),i.push(u)},this);var f=t+1;if(!this.indexMap.length){var y=g(a,0,a.length-1);o.remove(y)}if(a[f]){var v=o.first(a[f]);u.insertBefore.call(v.parentNode,n,v)}else o.after(1===f?[this.placeholder]:[o.last(this.masterNodeList[f-1])],n);d.apply(this.masterNodeList,[f,0].concat(r)),d.apply(this.indexMap,[t,0].concat(i));for(var b=t+i.length,_=this.indexMap.length;b<_;b++)this.indexMap[b].set(b)},remove:function(e,t){t<0&&(t=this.indexMap.length+t);var n=g(this.masterNodeList,t,e.length),r=this.indexMap;r.splice(t,e.length);for(var i=t,a=r.length;i<a;i++)r[i].set(i);this.exit?o.unregister(this.masterNodeList):(this.addFalseyIfEmpty(),o.remove(n))},addFalseyIfEmpty:function(){if(this.falseyRender&&0===this.indexMap.length){var e=[],t=m(e,this.masterNodeList,this.falseyRender,this.currentList,[this.currentList]);o.after([this.masterNodeList[0]],t),this.masterNodeList.push(e[0])}},move:function(e,t){e+=1,t+=1;var n,r=this.masterNodeList,i=this.indexMap,s=r[e],u=a(o.flatten(r[t]));n=t<e?o.last(s).nextSibling:o.first(s),r[0].parentNode.insertBefore(u,n);var c=r[t];[].splice.apply(r,[t,1]),[].splice.apply(r,[e,0,c]),e-=1;var l=i[t-=1];[].splice.apply(i,[t,1]),[].splice.apply(i,[e,0,l]);var h=Math.min(t,e),p=i.length;for(p;h<p;h++)i[h].set(h)},set:function(e,t){this.remove({length:1},t,!0),this.add([e],t)}},i.list=function(e,t,n,i,a,s,u){if(e.nodeType!==Node.TEXT_NODE){var c;s?(c=document.createTextNode(""),o.replace(s,c),o.update(s,[c]),e=c):(c=document.createTextNode(""),e.parentNode.replaceChild(c,e),e=c)}new r(e,t,n,i,a,s,u)}}),define("can-view-live@4.2.7#lib/text",["require","exports","module","./core","can-view-nodelist","can-reflect"],function(e,t,n){"use strict";var r=e("./core"),i=e("can-view-nodelist"),o=e("can-reflect");r.text=function(e,t,n,a){if(e.nodeType!==Node.TEXT_NODE){var s;a?(s=document.createTextNode(""),i.replace(a,s),i.update(a,[s]),e=s):(s=document.createTextNode(""),e.parentNode.replaceChild(s,e),e=s)}var u=r.getParentNode(e,n);e.nodeValue=r.makeString(o.getValue(t));var c=r.listen(u,t,function(t){e.nodeValue=r.makeString(t)},"domUI");a||(a=i.register([e],null,!0)),a.unregistered=c.teardownCheck,c.nodeList=a}}),define("can-view-live@4.2.7#can-view-live",["require","exports","module","./lib/core","./lib/attr","./lib/attrs","./lib/html","./lib/list","./lib/text"],function(e,t,n){"use strict";var r=e("./lib/core");e("./lib/attr"),e("./lib/attrs"),e("./lib/html"),e("./lib/list"),e("./lib/text"),n.exports=r}),define("can-stache@4.15.9#src/text_section",["require","exports","module","can-view-live","./utils","can-dom-mutate/node","can-assign","can-reflect","can-observation"],function(e,t,n){"use strict";var r=e("can-view-live"),i=e("./utils"),o=e("can-dom-mutate/node"),a=e("can-assign"),s=e("can-reflect"),u=e("can-observation"),c=function(){},l=function(e){e&&(this.filename=e),this.stack=[new p]};a(l.prototype,i.mixins),a(l.prototype,{startSection:function(e){var t=new p;this.last().add({process:e,truthy:t}),this.stack.push(t)},endSection:function(){this.stack.pop()},inverse:function(){this.stack.pop();var e=new p;this.last().last().falsey=e,this.stack.push(e)},compile:function(e){var t=this.stack[0].compile();return function(n){var i=new u(function(){return t(n)},null,{isObservable:!1});s.onValue(i,c);var a=s.getValue(i);s.valueHasDependencies(i)?(e.textContentOnly?r.text(this,i):e.attr?r.attr(this,e.attr,i):r.attrs(this,i,n),s.offValue(i,c)):e.textContentOnly?this.nodeValue=a:e.attr?o.setAttribute.call(this,e.attr,a):r.attrs(this,a)}}});var h=function(e,t,n){return function(r){return e.call(this,r,t,n)}},p=function(){this.values=[]};a(p.prototype,{add:function(e){this.values.push(e)},last:function(){return this.values[this.values.length-1]},compile:function(){for(var e=this.values,t=e.length,n=0;n<t;n++){var r=this.values[n];"object"==typeof r&&(e[n]=h(r.process,r.truthy&&r.truthy.compile(),r.falsey&&r.falsey.compile()))}return function(n){for(var r,i="",o=0;o<t;o++)i+="string"==typeof(r=e[o])?r:r.call(this,n);return i}}}),n.exports=l}),define("can-stache@4.15.9#src/mustache_core",["require","exports","module","can-view-live","can-view-nodelist","can-observation","can-observation-recorder","./utils","./expression","can-fragment","can-dom-mutate","can-symbol","can-reflect","can-log/dev/dev","can-globals/document/document","can-define-lazy-value"],function(e,t,n){!function(e,t,n,r){"use strict";function i(e,t,n,r){this.metadata={rendered:!1},this.stringOnly=r,this.scope=e,this.nodeList=t,this.exprData=n}function o(e){return null!==e&&"object"==typeof e&&("function"==typeof e[v]||"function"==typeof e[k]||"number"==typeof e.nodeType)}var a=t("can-view-live"),s=t("can-view-nodelist"),u=t("can-observation"),c=t("can-observation-recorder"),l=t("./utils"),h=t("./expression"),p=t("can-fragment"),f=t("can-dom-mutate"),d=t("can-symbol"),m=t("can-reflect"),g=(t("can-log/dev/dev"),t("can-globals/document/document")),y=t("can-define-lazy-value"),v=d.for("can.toDOM");y(i.prototype,"context",function(){return this.scope.peek("this")});var b=/(?:(^|\r?\n)(\s*)(\{\{([\s\S]*)\}\}\}?)([^\S\n\r]*)($|\r?\n))|(\{\{([\s\S]*)\}\}\}?)/g,_=/(\s*)(\{\{\{?)(-?)([\s\S]*?)(-?)(\}\}\}?)(\s*)/g,w=function(){},k=d.for("can.viewInsert"),E={expression:h,makeEvaluator:function(e,t,n,r,o,a,s){if("^"===n){var u=o;o=a,a=u}var c,f=new i(e,t,r,s);if(l.createRenderers(f,e,t,o,a,s),r instanceof h.Call)c=r.value(e,f);else if(r instanceof h.Bracket)c=r.value(e);else if(r instanceof h.Lookup)c=r.value(e);else if(r instanceof h.Helper&&r.methodExpr instanceof h.Bracket)c=r.methodExpr.value(e,f);else if("function"==typeof(c=r.value(e,f)))return c;return!n||f.metadata.rendered?c:"#"===n||"^"===n?function(){var t,n=m.getValue(c);if(f.metadata.rendered)t=n;else if("string"!=typeof n&&m.isListLike(n)){var r=m.isObservableLike(n)&&m.isListLike(n);t=m.getKeyValue(n,"length")?s?l.getItemsStringContent(n,r,f):p(l.getItemsFragContent(n,f,e)):f.inverse(e)}else t=n?f.fn(n||e):f.inverse(e);return f.metadata.rendered=!1,t}:void 0},makeLiveBindingPartialRenderer:function(e,t){var n,r=(e=e.trim()).split(/\s+/).shift();return r!==e&&(n=E.expression.parse(e)),function(e,i){var o=[this];o.expression=">"+r,s.register(o,null,i||!0,t.directlyNested);var l=new u(function(){var t=r;if(n&&1===n.argExprs.length){var i=m.getValue(n.argExprs[0].value(e));void 0===i||(e=e.add(i))}var a,s=m.getKeyValue(e.templateContext.partials,t);if(s)a=function(){return s.render?s.render(e,o):s(e)};else{var u=e.read(t,{isArgument:!0}).value;if(null===u||!u&&"*"===t[0])return p("");u&&(t=u),a=function(){if("function"==typeof t)return t(e,{},o);var n=E.getTemplateById(t);return n?n(e,{},o):g().createDocumentFragment()}}var l=c.ignore(a)();return p(l)});m.setPriority(l,o.nesting),a.html(this,l,this.parentNode,o)}},makeStringBranchRenderer:function(e,t,n){var r=E.expression.parse(t),i=e+t,o=function(t,n,o){var a=t.__cache[i];!e&&a||(a=T(t,null,e,r,n,o,!0),e||(t.__cache[i]=a));var s;return null==(s=a[d.for("can.onValue")]?m.getValue(a):a())?"":""+s};return o.exprData=r,o},makeLiveBindingBranchRenderer:function(e,t,n){var r=E.expression.parse(t);r instanceof h.Helper||r instanceof h.Call||r instanceof h.Bracket||r instanceof h.Lookup||(r=new h.Helper(r,[],{}));var i=function(i,l,g,y){var v=n.tag,b=[this];b.expression=t,s.register(b,null,l||!0,n.directlyNested);var _,E=T(i,b,e,r,g,y,v);if(_=E[d.for("can.onValue")]?E:new u(E,null,{isObservable:!1}),!1===m.setPriority(_,b.nesting))throw new Error("can-stache unable to set priority on observable");m.onValue(_,w);var S=m.getValue(_);if("function"!=typeof S||r instanceof h.Lookup){if(m.valueHasDependencies(_))n.attr?a.attr(this,n.attr,_):n.tag?a.attrs(this,_):n.text&&!o(S)?a.text(this,_,this.parentNode,b):a.html(this,_,this.parentNode,{nodeList:b});else if(n.attr)f.setAttribute(this,n.attr,S);else if(n.tag)a.attrs(this,S);else if(n.text&&!o(S))this.nodeValue=a.makeString(S);else if(null!=S)if("function"==typeof S[k]){var C=S[k]({nodeList:b}),I=s.update(b,[C]);s.replace(I,C)}else s.replace([this],p(S,this.ownerDocument))}else c.ignore(S)(this);m.offValue(_,w)};return i.exprData=r,i},splitModeFromExpression:function(e,t){var n=(e=e.trim()).charAt(0);return"#/{&^>!<".indexOf(n)>=0?e=e.substr(1).trim():n=null,"{"===n&&t.node&&(n=null),{mode:n,expression:e}},cleanLineEndings:function(e){return e.replace(b,function(e,t,n,r,i,o,a,s,u,c){o=o||"",t=t||"",n=n||"";var l=S(i||u,{});return s||">{".indexOf(l.mode)>=0?e:"^#!/".indexOf(l.mode)>=0?(n=t+n&&" ")+r+(0!==c&&a.length?t+"\n":""):n+r+o+(n.length||0!==c?t+"\n":"")})},cleanWhitespaceControl:function(e){return e.replace(_,function(e,t,n,r,i,o,a,s,u){return"-"===r&&(t=""),"-"===o&&(s=""),t+n+i+a+s})},getTemplateById:function(){}},T=E.makeEvaluator,S=E.splitModeFromExpression;r.exports=E}(0,e,0,n)}),define("can-globals@1.2.0#base-url/base-url",["require","exports","module","../can-globals-instance","../global/global","../document/document"],function(e,t,n){!function(e,t,n,r){"use strict";var i=t("../can-globals-instance");t("../global/global"),t("../document/document"),i.define("base-url",function(){var e=i.getKeyValue("global"),t=i.getKeyValue("document");if(t&&"baseURI"in t)return t.baseURI;if(e.location){var n=e.location.href,r=n.lastIndexOf("/");return-1!==r?n.substr(0,r):n}return"undefined"!=typeof process?process.cwd():void 0}),r.exports=i.makeExport("base-url")}(0,e,0,n)}),define("can-parse-uri@1.2.0#can-parse-uri",["require","exports","module","can-namespace"],function(e,t,n){"use strict";var r=e("can-namespace");n.exports=r.parseURI=function(e){var t=String(e).replace(/^\s+|\s+$/g,"").match(/^([^:\/?#]+:)?(\/\/(?:[^:@]*(?::[^:@]*)?@)?(([^:\/?#]*)(?::(\d*))?))?([^?#]*)(\?[^#]*)?(#[\s\S]*)?/);return t?{href:t[0]||"",protocol:t[1]||"",authority:t[2]||"",host:t[3]||"",hostname:t[4]||"",port:t[5]||"",pathname:t[6]||"",search:t[7]||"",hash:t[8]||""}:null}}),define("can-join-uris@1.2.0#can-join-uris",["require","exports","module","can-namespace","can-parse-uri"],function(e,t,n){"use strict";var r=e("can-namespace"),i=e("can-parse-uri");n.exports=r.joinURIs=function(e,t){return t=i(t||""),e=i(e||""),t&&e?(t.protocol||e.protocol)+(t.protocol||t.authority?t.authority:e.authority)+function(e){var t=[];return e.replace(/^(\.\.?(\/|$))+/,"").replace(/\/(\.(\/|$))+/g,"/").replace(/\/\.\.$/,"/../").replace(/\/?[^\/]*/g,function(e){"/.."===e?t.pop():t.push(e)}),t.join("").replace(/^\//,"/"===e.charAt(0)?"/":"")}(t.protocol||t.authority||"/"===t.pathname.charAt(0)?t.pathname:t.pathname?(e.authority&&!e.pathname?"/":"")+e.pathname.slice(0,e.pathname.lastIndexOf("/")+1)+t.pathname:e.pathname)+(t.protocol||t.authority||t.pathname?t.search:t.search||e.search)+t.hash:null}}),define("can-stache@4.15.9#helpers/-debugger",["require","exports","module","can-log"],function(e,t,n){"use strict";function r(){}function i(e,t){o.warn("Forgotten {{debugger}} helper")}var o=e("can-log"),a=r,s=r,u={};i.requiresOptionsArgument=!0,n.exports={helper:i,evaluateArgs:s,resolveValue:a,__testing:u}}),define("can-stache@4.15.9#src/truthy-observable",["require","exports","module","can-observation","can-reflect"],function(e,t,n){"use strict";var r=e("can-observation"),i=e("can-reflect");n.exports=function(e){return new r(function(){return!!i.getValue(e)})}}),define("can-dom-data@1.0.1#can-dom-data",["require","exports","module","can-namespace"],function(e,t,n){"use strict";var r=e("can-namespace"),i=function(e){for(var t in e)return!1;return!0},o=new WeakMap,a=function(e){var t=!1;return o.has(e)&&(t=!0,o.delete(e)),t},s={_data:o,get:function(e,t){var n=o.get(e);return void 0===t?n:n&&n[t]},set:function(e,t,n){var r=o.get(e);return void 0===r&&(r={},o.set(e,r)),void 0!==t&&(r[t]=n),r},clean:function(e,t){var n=o.get(e);n&&n[t]&&delete n[t],i(n)&&a(e)},delete:a};if(r.domData)throw new Error("You can't have two versions of can-dom-data, check your dependencies");n.exports=r.domData=s}),define("can-stache@4.15.9#helpers/-for-of",["require","exports","module","can-stache-helpers","can-reflect","can-observation","can-view-live","can-view-nodelist","../src/expression","../src/key-observable"],function(e,t,n){function r(e,t,n){var r=[];return o.each(e,function(i,o){var a=new l(e,o),s={};void 0!==t&&(s[t]=a),r.push(n.fn(n.scope.add({key:o},{special:!0}).addLetContext(s)))}),n.stringOnly?r.join(""):r}var i=e("can-stache-helpers"),o=e("can-reflect"),a=e("can-observation"),s=e("can-view-live"),u=e("can-view-nodelist"),c=e("../src/expression"),l=e("../src/key-observable"),h=function(e){return e&&o.isValueLike(e)?(a.temporarilyBind(e),o.getValue(e)):e},p=function(e){if(1!==e.exprData.argExprs.length)throw new Error("for(of) broken syntax");var t,n,i=e.exprData.argExprs[0].expr;if(i instanceof c.Lookup)n=i.value(e.scope);else if(i instanceof c.Helper){if("of"!==i.argExprs[0].key)throw new Error("for(of) broken syntax");t=i.methodExpr.key,n=i.argExprs[1].value(e.scope)}var a=n,l=[].slice.call(arguments).pop(),p=h(a);if(p&&!o.isListLike(p))return r(p,t,e);if(l.stringOnly){var f=[];return o.eachIndex(p,function(n,r){var i={};void 0!==t&&(i[t]=n),f.push(e.fn(l.scope.add({index:r},{special:!0}).addLetContext(i)))}),f.join("")}return l.metadata.rendered=!0,function(e){var n=[e];n.expression="live.list",u.register(n,null,l.nodeList,!0),u.update(l.nodeList,[e]),s.list(e,a,function(e,n,r){var i={};return void 0!==t&&(i[t]=e),l.fn(l.scope.add({index:n},{special:!0}).addLetContext(i),l.options,r)},l.context,e.parentNode,n,function(e,t){return l.inverse(l.scope,l.options,t)})}};p.isLiveBound=!0,p.requiresOptionsArgument=!0,p.ignoreArgLookup=function(e){return 0===e},i.for=p}),define("can-stache@4.15.9#helpers/-let",["require","exports","module","can-stache-helpers","can-reflect"],function(e,t,n){function r(e){return!0===e._meta.variable}var i=e("can-stache-helpers"),o=e("can-reflect");i.let=function(e){var t=e.scope.getScope(r);if(!t)throw new Error("There is no variable scope!");return o.assignMap(t._context,e.hash),document.createTextNode("")}}),define("can-stache@4.15.9#helpers/core",["require","exports","module","can-view-live","can-view-nodelist","../src/utils","can-globals/base-url/base-url","can-join-uris","can-assign","can-log/dev/dev","can-reflect","./-debugger","../src/key-observable","can-observation","../src/truthy-observable","can-stache-helpers","can-dom-data","can-dom-data-state","./-for-of","./-let"],function(e,t,n){!function(e,t,n,r){"use strict";var i=t("can-view-live"),o=t("can-view-nodelist"),a=t("../src/utils"),s=t("can-globals/base-url/base-url"),u=t("can-join-uris"),c=t("can-assign"),l=(t("can-log/dev/dev"),t("can-reflect")),h=t("./-debugger").helper,p=t("../src/key-observable"),f=t("can-observation"),d=t("../src/truthy-observable"),m=t("can-stache-helpers"),g=t("can-dom-data"),y=t("can-dom-data-state");t("./-for-of"),t("./-let");var v={},b={looksLikeOptions:function(e){return e&&"function"==typeof e.fn&&"function"==typeof e.inverse},resolve:function(e){return e&&l.isValueLike(e)?l.getValue(e):e},resolveHash:function(e){var t={};for(var n in e)t[n]=b.resolve(e[n]);return t},bindAndRead:function(e){return e&&l.isValueLike(e)?(f.temporarilyBind(e),l.getValue(e)):e},registerHelper:function(e,t){t.requiresOptionsArgument=!0,m[e]=t},registerHelpers:function(e){var t,n;for(t in e)n=e[t],b.registerHelper(t,b.makeSimpleHelper(n))},makeSimpleHelper:function(e){return function(){var t=[];return l.eachIndex(arguments,function(e){t.push(b.resolve(e))}),e.apply(this,t)}},addHelper:function(e,t){return"object"==typeof e?b.registerHelpers(e):b.registerHelper(e,b.makeSimpleHelper(t))},addLiveHelper:function(e,t){return t.isLiveBound=!0,b.registerHelper(e,t)},getHelper:function(e,t){var n=t&&t.getHelper(e);return n||(n=m[e]),n},__resetHelpers:function(){for(var e in m)delete m[e];b.addBuiltInHelpers()},addBuiltInHelpers:function(){l.each(v,function(e,t){m[t]=e})},_makeLogicHelper:function(e,t){return c(function(){var e,n=Array.prototype.slice.call(arguments,0);b.looksLikeOptions(n[n.length-1])&&(e=n.pop());var r=new f(function(){return e?!!t(n):t(n)});return e?r.get()?e.fn():e.inverse():r.get()},{requiresOptionsArgument:!0,isLiveBound:!0})}},_=c(function(e,t){return(e&&l.isValueLike(e)?l.getValue(new d(e)):!!b.resolve(e))?t.fn(t.scope||this):t.inverse(t.scope||this)},{requiresOptionsArgument:!0,isLiveBound:!0}),w=b._makeLogicHelper("eq",function(e){for(var t,n,r=0;r<e.length;r++){if(t=b.resolve(e[r]),t="function"==typeof t?t():t,r>0&&t!==n)return!1;n=t}return!0}),k=b._makeLogicHelper("and",function(e){if(0===e.length)return!1;for(var t,n=0,r=e.length;n<r;n++)if(!(t=b.resolve(e[n])))return t;return t}),E=b._makeLogicHelper("or",function(e){if(0===e.length)return!1;for(var t,n=0,r=e.length;n<r;n++)if(t=b.resolve(e[n]))return t;return t}),T=function(e,t){b.resolve(e);var n=!1,r=function(t,r){if(!n&&b.resolve(e)===b.resolve(t))return n=!0,r.fn(r.scope.peek("this")||this)};r.requiresOptionsArgument=!0;var i=function(e){if(!n)return!e||e.scope.peek("this")};i.requiresOptionsArgument=!0,l.assignSymbols(i,{"can.isValueLike":!0,"can.isFunctionLike":!1,"can.getValue":function(){return this(t)}});var o=t.scope.add({case:r,default:i},{notContext:!0});return t.fn(o,t)};T.requiresOptionsArgument=!0;var S=function(e){var t=[].slice.call(arguments),n=t.pop(),r=t.map(function(e){var t=b.resolve(e);return"function"==typeof t?t():t}).join(""),i=l.getKeyValue(n.scope.templateContext.helpers,"module"),o=i?i.uri:void 0;if("."===r[0]&&o)return u(o,r);var a="undefined"!=typeof System&&(System.renderingBaseURL||System.baseURL)||s();return"/"!==r[0]&&"/"!==a[a.length-1]&&(a+="/"),u(a,r)};S.requiresOptionsArgument=!0;var C=function(e){var t,n,r=[].slice.call(arguments).pop(),s=r.exprData.hashExprs,u=b.bindAndRead(e);if(l.size(s)>0&&(t={},l.eachKey(s,function(e,n){t[e.key]=n})),(l.isObservableLike(u)&&l.isListLike(u)||l.isListLike(u)&&l.isValueLike(e))&&!r.stringOnly)return r.metadata.rendered=!0,function(n){var a=[n];a.expression="live.list",o.register(a,null,r.nodeList,!0),o.update(r.nodeList,[n]),i.list(n,e,function(e,n,i){var o={};return l.size(t)>0&&(t.value&&(o[t.value]=e),t.index&&(o[t.index]=n)),r.fn(r.scope.add(o,{notContext:!0}).add({index:n},{special:!0}).add(e),r.options,i)},r.context,n.parentNode,a,function(e,t){return r.inverse(r.scope.add(e),r.options,t)})};var c,h=b.resolve(e);return h&&l.isListLike(h)?(c=a.getItemsFragContent(h,r,r.scope),r.stringOnly?c.join(""):c):l.isObservableLike(h)&&l.isMapLike(h)||h instanceof Object?(c=[],l.each(h,function(e,i){var o=new p(h,i);n={},l.size(t)>0&&(t.value&&(n[t.value]=o),t.key&&(n[t.key]=i)),c.push(r.fn(r.scope.add(n,{notContext:!0}).add({key:i},{special:!0}).add(o)))}),r.stringOnly?c.join(""):c):void 0};C.isLiveBound=!0,C.requiresOptionsArgument=!0,C.ignoreArgLookup=function(e){return 1===e};var I=c(function(e,t){t||(t=e,e=0);var n=t.scope.peek("scope.index");return""+(("function"==typeof n?n():n)+e)},{requiresOptionsArgument:!0}),N=function(e,t){var n=e;return t?(e=b.resolve(e),t.hash&&l.size(t.hash)>0&&(n=t.scope.add(t.hash,{notContext:!0}).add(n))):(t=e,e=!0,n=t.hash),t.fn(n||{})};N.requiresOptionsArgument=!0;var D=function(e,t){return _.apply(this,[e,c(c({},t),{fn:t.inverse,inverse:t.fn})])};D.requiresOptionsArgument=!0,D.isLiveBound=!0,v={debugger:h,each:C,eachOf:C,index:I,if:_,is:w,eq:w,unless:D,with:N,console:console,data:function(e,t){var n=(b.looksLikeOptions(t)?t.context:t)||this;return function(t){y.set.call(t,e,n)}},domData:function(e,t){var n=(b.looksLikeOptions(t)?t.context:t)||this;return function(t){g.set(t,e,n)}},switch:T,joinBase:S,and:k,or:E},b.addBuiltInHelpers(),r.exports=b}(0,e,0,n)}),define("can-stache@4.15.9#helpers/converter",["require","exports","module","./core","../src/set-identifier","can-reflect"],function(e,t,n){"use strict";function r(e){return e=e||{},function(t,n){var r=a.toArray(arguments);return t instanceof o?"function"==typeof e.set?e.set.apply(this,[t.value].concat(r.slice(1))):n(t.value):"function"==typeof e.get?e.get.apply(this,r):r[0]}}var i=e("./core"),o=e("../src/set-identifier"),a=e("can-reflect"),s=new WeakMap;i.addConverter=function(e,t){if("object"!=typeof e){var n=r(t);n.isLiveBound=!0,i.registerHelper(e,n)}else s.has(e)||(s.set(e,!0),a.eachKey(e,function(e,t){i.addConverter(t,e)}))},i.registerConverter=function(e,t){i.registerHelper(e,r(t))};var u={not:{get:function(e,t){return i.looksLikeOptions(t)?a.getValue(e)?t.inverse():t.fn():!a.getValue(e)},set:function(e,t){a.setValue(t,!e)}}};i.addConverter(u),n.exports=i}),define("can-stache-ast@1.1.0#controls",function(e,t,n){"use strict";function r(e,t){var n=(e=e.trim()).charAt(0);return"#/{&^>!<".indexOf(n)>=0?e=e.substr(1).trim():n=null,"{"===n&&t.node&&(n=null),{mode:n,expression:e}}function i(e,t,n,r,i,o,a,s){return"-"===r&&(t=""),"-"===o&&(s=""),t+n+i+a+s}var o=/(?:(^|\r?\n)(\s*)(\{\{([\s\S]*)\}\}\}?)([^\S\n\r]*)($|\r?\n))|(\{\{([\s\S]*)\}\}\}?)/g,a=/(\s*)(\{\{\{?)(-?)([\s\S]*?)(-?)(\}\}\}?)(\s*)/g;t.cleanLineEndings=function(e){return e.replace(o,function(e,t,n,i,o,a,s,u,c,l){a=a||"",t=t||"",n=n||"";var h=r(o||c,{});return u||">{".indexOf(h.mode)>=0?e:"^#!/".indexOf(h.mode)>=0?(n=t+n&&" ")+i+(0!==l&&s.length?t+"\n":""):n+i+a+(n.length||0!==l?t+"\n":"")})},t.cleanWhitespaceControl=function(e){return e.replace(a,i)}}),define("can-stache-ast@1.1.0#can-stache-ast",["require","exports","module","./controls","can-view-parser"],function(e,t,n){"use strict";var r=e("./controls"),i=e("can-view-parser");t.parse=function(e,t){function n(e){g&&(c[g]=y,g=""),m?s.push(y):a.push(y),u.push({specifier:y,loc:{line:e},attributes:l}),l=new Map}1===arguments.length&&(t=arguments[0],e=void 0);var o=t;o=r.cleanWhitespaceControl(o),o=r.cleanLineEndings(o);var a=[],s=[],u=[],c={},l=new Map,h=!1,p=!1,f=!1,d=!1,m=!1,g="",y="",v=null,b=i(o,{filename:e,start:function(e,t){"can-import"===e?(d=t,m=!1,h=!0):"can-dynamic-import"===e?(d=t,m=!0,h=!0):h&&(m=!0,h=!1)},attrStart:function(e){v=e,l.set(v,!0),"from"===e?p=!0:"as"!==e&&"export-as"!==e||(f=!0)},attrEnd:function(e){"from"===e?p=!1:"as"!==e&&"export-as"!==e||(f=!1)},attrValue:function(e){h&&l.set(v,e),p&&h?y=e:f&&h&&(g=e)},end:function(e,t,r){"can-import"!==e&&"can-dynamic-import"!==e||!d||n(r)},close:function(e,t,r){"can-import"!==e&&"can-dynamic-import"!==e||n(r)},chars:function(e){e.trim().length>0&&(m=!0)},special:function(){m=!0}},!0);return{intermediate:b,program:b,imports:a,dynamicImports:s,importDeclarations:u,ases:c,exports:c}}}),define("can-stache@4.15.9#can-stache",["require","exports","module","can-view-parser","can-view-callbacks","./src/html_section","./src/text_section","./src/mustache_core","./helpers/core","./helpers/converter","can-stache-ast","./src/utils","can-attribute-encoder","can-log/dev/dev","can-namespace","can-globals/document/document","can-assign","can-import-module","can-reflect","can-view-scope","can-view-scope/template-context","can-observation-recorder","can-symbol","can-view-target","can-view-nodelist"],function(e,t,n){!function(e,t,n,r){"use strict";function i(e,t){1===arguments.length&&(t=arguments[0],e=void 0);var n={};"string"==typeof t&&(t=c.cleanWhitespaceControl(t),t=c.cleanLineEndings(t));var r=new s(e),i={node:null,attr:null,sectionElementStack:[],text:!1,namespaceStack:[],textContentOnly:null},l=function(e,t,r,o){if(">"===t)e.add(c.makeLiveBindingPartialRenderer(r,p({filename:e.filename,lineNo:o})));else if("/"===t)"<"===e.last().startedWith?(n[r]=e.endSubSectionAndReturnRenderer(),e.removeCurrentNode()):e.endSection(),e instanceof s&&i.sectionElementStack.pop();else if("else"===t)e.inverse();else{var a=e instanceof s?c.makeLiveBindingBranchRenderer:c.makeStringBranchRenderer;if("{"===t||"&"===t)e.add(a(null,r,p({filename:e.filename,lineNo:o})));else if("#"===t||"^"===t||"<"===t){var u=a(t,r,p({filename:e.filename,lineNo:o})),l={type:"section"};e.startSection(u),e.last().startedWith=t,e instanceof s&&i.sectionElementStack.push(l)}else e.add(a(null,r,p({text:!0,filename:e.filename,lineNo:o})))}},h=function(){var e=i.sectionElementStack[i.sectionElementStack.length-1];return!i.sectionElementStack.length||"section"===e.type||"custom"===e.type},p=function(e){var t={tag:i.node&&i.node.tag,attr:i.attr&&i.attr.name,directlyNested:h(),textContentOnly:!!i.textContentOnly};return e?y(t,e):t},m=function(e,t){e.attributes||(e.attributes=[]),e.attributes.unshift(t)};o(t,{filename:e,start:function(e,t,n){var r=C[e];r&&!t&&i.namespaceStack.push(r),i.node={tag:e,children:[],namespace:r||d(i.namespaceStack)}},end:function(t,n,o){var s=a.tag(t),c=h();n?(r.add(i.node),s&&m(i.node,function(e,n){a.tagHandler(this,t,{scope:e,subtemplate:null,templateType:"stache",parentNodeList:n,directlyNested:c})})):(r.push(i.node),i.sectionElementStack.push({type:s?"custom":null,tag:s?null:t,templates:{},directlyNested:c}),s?r.startSubSection():N[t]&&(i.textContentOnly=new u(e))),i.node=null},close:function(e,t){C[e]&&i.namespaceStack.pop();var n,o=a.tag(e);o&&(n=r.endSubSectionAndReturnRenderer()),N[e]&&(r.last().add(i.textContentOnly.compile(p())),i.textContentOnly=null);var s=r.pop();if(o)if("can-template"===e){var u=i.sectionElementStack[i.sectionElementStack.length-2];n&&(u.templates[s.attrs.name]=f(n)),r.removeCurrentNode()}else{var c=i.sectionElementStack[i.sectionElementStack.length-1];m(s,function(t,r){a.tagHandler(this,e,{scope:t,subtemplate:n?f(n):n,templateType:"stache",parentNodeList:r,templates:c.templates,directlyNested:c.directlyNested})})}i.sectionElementStack.pop()},attrStart:function(e,t){i.node.section?i.node.section.add(e+'="'):i.attr={name:e,value:""}},attrEnd:function(e,t){var n=I[e];if(i.node.section)i.node.section.add('" ');else{i.node.attrs||(i.node.attrs={}),i.attr.section?i.node.attrs[i.attr.name]=i.attr.section.compile(p()):i.node.attrs[i.attr.name]=n?{value:i.attr.value,namespaceURI:I[e]}:i.attr.value;var r=a.attr(e);r&&(i.node.attributes||(i.node.attributes=[]),i.node.attributes.push(function(t,n){r(this,{attributeName:e,scope:t,nodeList:n})})),i.attr=null}},attrValue:function(e,t){var n=i.node.section||i.attr.section;n?n.add(e):i.attr.value+=e},chars:function(e,t){(i.textContentOnly||r).add(e)},special:function(t,n){var o=c.splitModeFromExpression(t,i),a=o.mode,s=o.expression;if("else"!==s){if("!"!==a)if(i.node&&i.node.section)l(i.node.section,a,s,n),0===i.node.section.subSectionDepth()&&(i.node.attributes.push(i.node.section.compile(p())),delete i.node.section);else if(i.attr)i.attr.section||(i.attr.section=new u(e),i.attr.value&&i.attr.section.add(i.attr.value)),l(i.attr.section,a,s,n);else if(i.node)if(i.node.attributes||(i.node.attributes=[]),a){if("#"!==a&&"^"!==a)throw new Error(a+" is currently not supported within a tag.");i.node.section||(i.node.section=new u(e)),l(i.node.section,a,s,n)}else i.node.attributes.push(c.makeLiveBindingBranchRenderer(null,s,p({filename:r.filename,lineNo:n})));else l(i.textContentOnly||r,a,s,n)}else(i.attr&&i.attr.section?i.attr.section:i.node&&i.node.section?i.node.section:i.textContentOnly||r).inverse()},comment:function(e){r.add({comment:e})},done:function(e){}});var g=r.compile(),v=k.ignore(function(e,t,r){void 0===r&&b.isListLike(t)&&(r=t,t=void 0),!t||t.helpers||t.partials||t.tags||(t={helpers:t}),b.eachKey(t&&t.helpers,function(e){e.requiresOptionsArgument=!0});var i=new w(t);if(b.eachKey(n,function(e,t){b.setKeyValue(i.partials,t,e)}),b.setKeyValue(i,"view",v),e instanceof _){var o=new _(i);o._parent=e._parent,e._parent=o}else e=new _(i).add(e);return g(e.addLetContext(),r)});return v[T]=!0,v}var o=t("can-view-parser"),a=t("can-view-callbacks"),s=t("./src/html_section"),u=t("./src/text_section"),c=t("./src/mustache_core"),l=t("./helpers/core");t("./helpers/converter");var h=t("can-stache-ast").parse,p=t("./src/utils"),f=p.makeRendererConvertScopes,d=p.last,m=(t("can-attribute-encoder"),t("can-log/dev/dev"),t("can-namespace")),g=t("can-globals/document/document"),y=t("can-assign"),v=t("can-import-module"),b=t("can-reflect"),_=t("can-view-scope"),w=t("can-view-scope/template-context"),k=t("can-observation-recorder"),E=t("can-symbol");t("can-view-target"),t("can-view-nodelist"),a.tag("content")||a.tag("content",function(e,t){return t.scope});var T=E.for("can.isView"),S="http://www.w3.org/2000/svg",C={svg:S,g:S,defs:S,path:S,filter:S,feMorphology:S,feGaussianBlur:S,feOffset:S,feComposite:S,feColorMatrix:S,use:S},I={xmlns:"http://www.w3.org/2000/xmlns/","xlink:href":"http://www.w3.org/1999/xlink"},N={style:!0,script:!0};y(i,l),i.safeString=function(e){return b.assignSymbols({},{"can.toDOM":function(){return e}})},i.async=function(e){var t=h(e),n=t.imports.map(function(e){return v(e)});return Promise.all(n).then(function(){return i(t.intermediate)})};var D={};i.from=c.getTemplateById=function(e){if(!D[e]){var t=g().getElementById(e);t&&(D[e]=i("#"+e,t.innerHTML))}return D[e]},i.registerPartial=function(e,t){D[e]="string"==typeof t?i(t):t},i.addBindings=a.attrs,r.exports=m.stache=i}(0,e,0,n)}),define("can-zone@0.6.23#lib/env",function(e,t,n){!function(e,t,n,r){"use strict";var i="undefined"!=typeof process&&"[object process]"==={}.toString.call(process),o=("undefined"!=typeof System&&System._nodeRequire&&System._nodeRequire,i&&function(){try{return"undefined"!=typeof System&&System._nodeRequire?"undefined"!==System._nodeRequire("nw.gui"):!("object"!=typeof e||!e.require)&&"undefined"!==e.require("nw.gui")}catch(e){return!1}}()),a="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,s=a?self:o?window:i?e:window;n.isNode=i,n.isNW=o,n.isWorker=a,n.global=s}(function(){return this}(),0,t)}),define("can-zone@0.6.23#lib/util",function(e,t,n){"use strict";t.forEach=Array.prototype.forEach||function(e){for(var t=0,n=this.length;t<n;t++)e.call(this,this[t],t)};var r="function"==typeof Symbol;t.symbol=function(e){return r?Symbol(e):e},t.defineProperty=function(e,t,n){Object.defineProperty?Object.defineProperty(e,t,n):e[t]=n.value}}),define("can-zone@0.6.23#lib/zones/xhr",["require","exports","module","../env","../util"],function(e,t,n){!function(e,t,n,r){"use strict";function i(e,t){return s.defineProperty(e,"responseText",{value:t.responseText}),s.defineProperty(e,"status",{value:t.status}),s.defineProperty(e,"readyState",{value:4}),e.getAllResponseHeaders=function(){return t.headers},e}function o(){this.data=[]}var a=t("../env"),s=t("../util");r.exports=a.isNode?function(e){var t,n,r,i=function(e,t){return s.defineProperty(this,u,{value:t,enumerable:!1}),n.apply(this,arguments)},a=function(t){var n=this.onload,i=this;return this.onload=function(r){var a=r?r.target:i;if(e.xhr||(e.xhr=new o),e.xhr.data.push({request:{url:a[u],data:t},response:{status:a.status,responseText:a.responseText,headers:a.getAllResponseHeaders()}}),n)return n.apply(this,arguments)},r.apply(this,arguments)};return{beforeTask:function(){t=XMLHttpRequest,r=XMLHttpRequest.prototype.send,n=XMLHttpRequest.prototype.open,XMLHttpRequest.prototype.send=a,XMLHttpRequest.prototype.open=i},afterTask:function(){t===XMLHttpRequest&&(XMLHttpRequest.prototype.send=r,XMLHttpRequest.prototype.open=n)}}}:function(e){var t,n,r,o,c=Function.prototype,l=function(e,t,n){var r=e.url;return"/"===t.substr(0,1)&&(r=r.replace(/^\w*:\/{2}[^\/]+\//i,"/")),r===t&&(!n||e.data===n)},h=function(e,t){return s.defineProperty(this,u,{value:t,enumerable:!1}),r.apply(this,arguments)},p=function(e){for(var n,r,a=this[u],s=0,h=t.length;s<h;s++)if(n=t[s],l(n.request,a,e)){r=i(this,n.response),t.splice(s,1);break}if(!r)return o.apply(this,arguments);var p=this.onload||c,f=this.onreadystatechange||c,d=this;setTimeout(function(){var e={target:d};f.call(d,e),p.call(d,e)},0)};return{beforeTask:function(){(t=a.global.XHR_CACHE)&&(n=XMLHttpRequest,r=XMLHttpRequest.prototype.open,o=XMLHttpRequest.prototype.send,XMLHttpRequest.prototype.open=h,XMLHttpRequest.prototype.send=p)},afterTask:function(){t&&n===XMLHttpRequest&&(XMLHttpRequest.prototype.open=r,XMLHttpRequest.prototype.send=o)}}};var u=s.symbol("__canWaitURL"),c={"<":"\\u003c",">":"\\u003e","&":"\\u0026","=":"\\u003d"},l=new RegExp("("+Object.keys(c).join("|")+")","g");o.prototype.toString=function(){var e=JSON.stringify(this.data);return"XHR_CACHE = "+(e=e.replace(l,function(e){return c[e]}))+";"}}(0,e,0,n)}),define("can-zone@0.6.23#xhr",["require","exports","module","./lib/zones/xhr"],function(e,t,n){"use strict";n.exports=e("./lib/zones/xhr")}),define("can-zone@0.6.23#lib/zones/globals",["require","exports","module","../util","../env","../zone"],function(e,t,n){!function(e,t,n,r){"use strict";function i(e,t,n){this.oldValue=e[t],this.obj=e,this.name=t,this.value=n(this.oldValue,this)}function o(){var e,t=function(){return!c.current||e.zoneWrapped?e.apply(this,arguments):c.tasks.then(e).apply(this,arguments)};return{beforeTask:function(n){n.nestedTask||(e=Promise.prototype.then,Promise.prototype.then=t)},afterTask:function(t){t.nestedTask||(Promise.prototype.then=e)}}}var a=t("../util"),s=t("../env"),u=s.global,c=t("../zone");s.isNode,r.exports=function(){var e,t=[];return{name:"globals",plugins:[o],created:function(){function n(e,t){var n=e.split("."),r=n.pop();return a.forEach.call(n,function(e){var n=t[e];n||(n=t[e]={}),t=n}),{obj:t,prop:r}}e=this.globals||{};for(var r in e)!function(e,r){var o=n(e,u);t.push(new i(o.obj,o.prop,function(){return r}))}(r,e[r])},beforeTask:function(e){e.nestedTask||a.forEach.call(t,function(e){e.trap()})},afterTask:function(e){e.nestedTask||a.forEach.call(t,function(e){e.release()})}}},i.prototype.trap=function(){this.obj[this.name]=this.value},i.prototype.release=function(){this.obj[this.name]=this.oldValue}}(0,e,0,n)}),define("can-zone@0.6.23#register",function(e,t,n){!function(e,t,n,r){"use strict";"format cjs";!function(){function t(e,t){for(var n=t.split(".");n.length>1&&(t=n.shift(),e=e[t]);)1===n.length&&(t=n[0]);return[e,t]}function n(e){var n=e||c,r=n.__canZoneWrapped;r||(r=n.__canZoneWrapped={}),l.call(h,function(e){var a;"object"==typeof e&&(a=e.fn,e=e.prop);var s=e;if(!r[s]){var u=t(n,e),c=u[0];(o(e=u[1])||c&&c[e])&&(r[s]=!0,i(c,e,a,n))}})}function i(e,t,n,r){var i=function(){var e=r.CanZone;return void 0!==e&&e.current?e.tasks[t](n,e).apply(this,arguments):n.apply(this,arguments)},a=Object.getOwnPropertyDescriptor(e,t)||{};o(t)?(n=a.set,a.set=i):(n=n?n(e[t]):e[t],a.value=i,a.writable=!0),Object.defineProperty(e,t,a),i.zoneWrapped=!0}function o(e){return"on"===e.substr(0,2)}function a(e,n,r,o){var s=e[n];Object.defineProperty(e,n,{get:function(){return s},set:function(u){var c=!u.zoneWrapped&&u!==s;if(s=u,c){var l=t(e,r);i(l[0],l[1],null,o),a(e,n,r,o)}}})}var s="undefined"!=typeof process&&"[object process]"==={}.toString.call(process),u="undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope,c="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:s?e:window;void 0!==r&&r.exports&&(r.exports=n);var l=Array.prototype.forEach||function(e){for(var t=0,n=this.length;t<n;t++)e.call(this,this[t],t)},h=Array.prototype.concat.call(["setTimeout","clearTimeout","requestAnimationFrame","cancelAnimationFrame","Promise.prototype.then","XMLHttpRequest.prototype.send","Node.prototype.addEventListener","Node.prototype.removeEventListener","process.nextTick","setImmediate","clearImmediate",{prop:"MutationObserver",fn:function(e){return function(t){return new e(t)}}}],function(){var e=[];return s||u||(e=Object.getOwnPropertyNames(HTMLElement.prototype).filter(o)),e}().map(function(e){return"HTMLElement.prototype."+e}));n(c),c.Promise&&a(c,"Promise","Promise.prototype.then",c)}()}(function(){return this}(),0,0,n)}),define("can-zone@0.6.23#lib/tasks",["require","exports","module","./env","./util"],function(e,t,n){!function(e,t,n,r){"use strict";var i=t("./env"),o=t("./util"),a=Array.prototype.slice,s="undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope;if(i.isNode)var u=1;var c=function(e,t){var n=e(),r=n;i.isNode&&"number"!=typeof r&&(r=n.__timeoutId=u++);var o=t.current;return o.isResolved||(o.ids[r]=n),{timeoutId:n,id:r}},l=function(e,t,n){if(null==e)return t();var r=n.current,o=r.ids,a=i.isNode&&"number"!=typeof e?e.__timeoutId:e;return!r.isResolved&&o[a]&&(delete o[a],r.removeWait()),t()},h=function(e,t){return function(n){if(n){var r=n[f];void 0===r&&(r=t.current.wrap(n),n[f]=r),e.call(this,r)}else e.call(this,n)}};(function(){var e=[];return i.isNode||s||(e=Object.getOwnPropertyNames(HTMLElement.prototype).filter(function(e){return"on"===e.substr(0,2)})),e})().forEach(function(e){n[e]=h}),n.setTimeout=function(e,t){return function(n,r){var i,o=Array.prototype.slice.call(arguments),a=t.current;o[0]=a.waitFor(function(){return delete a.ids[i.id],n.apply(this,arguments)});var s=this;return(i=c(function(){return e.apply(s,o)},t)).timeoutId}},n.clearTimeout=function(e,t){return function(n){var r=arguments,i=this;return l(n,function(){return e.apply(i,r)},t)}},n.setImmediate=function(e,t){return function(n){var r,i=t.current,o=i.waitFor(function(){return delete i.ids[r.id],n.apply(this,arguments)}),s=this,u=a.call(arguments,1);return(r=c(function(){return e.apply(s,[o].concat(u))},t)).timeoutId}},n.clearImmediate=function(e,t){return function(n){var r=arguments,i=this;return l(n,function(){return e.apply(i,r)},t)}},n.requestAnimationFrame=function(e,t){return function(n){var r=t.current,i=r.waitFor(n),o=e.call(this,i);return r.rafs[o]=!0,o}},n.cancelAnimationFrame=function(e,t){return function(n){var r=t.current,i=r.rafs,o=e.call(this,n);return!r.isResolved&&i[n]&&(delete i[n],r.removeWait()),o}},n.then=function(e,t){return function(n,r){var i,o,a=t.current.waitFor(function(e){return i?i.apply(this,arguments):o?Promise.reject(e):e},!1),s=function(e,t){return function(){return i=e,o=!!t,a.apply(this,arguments)}};return e.call(this,s(n),s(r,!0))}};var p=void 0;n.send=function(e,t){return void 0===p&&(p="onload"in new XMLHttpRequest),function(){function n(e){return e=e||function(){},function(){var n=new t.Task(s,e).run(this,arguments);return s.removeWait(),n}}var r=this.onreadystatechange,i=this.onload,o=this.onerror,a=this,s=t.current;if(s.addWait(),p&&this.onload)this.onload=n(i),this.onerror=n(o);else{var u=n(r=r||function(){}),c=function(e){var t=e?e.target:a;return 4===t.readyState?u.apply(this,arguments):(t.onload&&t.onload(e),r.apply(this,arguments))};this.onreadystatechange=c,Object.defineProperty(this,"onreadystatechange",{enumerable:!0,configurable:!0,get:function(){return c},set:function(e){u=n(r=e)}})}return e.apply(this,arguments)}},n.nextTick=function(e,t){return function(n){var r=t.current.waitFor(n),i=a.call(arguments,1);return i.unshift(r),e.apply(process,i)}},n.MutationObserver=function(e,t){return function(n){return n=t.current.wrap(n),new e(n)}};var f=o.symbol("zone-eventhandler");n.addEventListener=function(e,t){return function(n,r,i){var o=r[f];return void 0===o&&(o=t.current.wrap(r),r[f]=o),e.call(this,n,o,i)}},n.removeEventListener=function(e,t){return function(t,n,r){var i=n&&n[f]||n;return e.call(this,t,i,r)}}}(0,e,t)}),define("can-zone@0.6.23#lib/zone",["require","exports","module","./env","./zones/globals","./util","../register","./tasks"],function(e,t,n){!function(e,t,n,r){"use strict";function i(){var e=this;this.promise=new l(function(t,n){e.resolve=t,e.reject=n})}function o(e,t,n){this.zone=e,this.fn=t,this.catchErrors=n,this.nestedTask=e.runningTask}function a(e,t,n,r){if(t=t||{},-1===(r=r||[]).indexOf(t)){r.push(t),n=n||[],"function"==typeof t?t=t(e.data):Array.isArray(t)&&(t={plugins:t}),t.plugins&&(n=n.concat(t.plugins)),p.call(n,function(t){a(e,t,null,r)}),t.hooks&&(e.hooks=e.hooks.concat(t.hooks)),p.call(e.hooks,function(n){var r=n+"s",i=e[r];i||(i=e[r]=[]),t[n]&&i.push(t[n])});var i=u({},t.globals||{});p.call(y,function(e){t[e]&&(i[e]=t[e])});for(var o in i)e.globals[o]=i[o]}}function s(e){e=e||{},this.deferred=new i,this.waits=0,this.ids=Object.create(null),this.rafs=Object.create(null),this.errors=[],this.data={},this.globals={},this.parent=this.constructor.current,this.hooks=d.call(g),a(this,e,[h]),this.execHook("created")}function u(e,t){if(!t)return e;for(var n in t)e[n]=t[n];return e}var c=t("./env").global,l=c.Promise,h=t("./zones/globals"),p=t("./util").forEach,f=t("../register"),d=Array.prototype.slice,m=function(){};o.prototype.run=function(e,t){var n=this.zone.constructor,r=n.current,i=n.current=this.zone;this.nestedTask||i.execHook("beforeTask",this);var o;try{i.runningTask=!0,o=this.fn.apply(e,t),n.current=r,this.nestedTask||i.execHookR("afterTask",this)}catch(e){if(n.current=r,this.nestedTask||i.execHookR("afterTask",this),!1===this.catchErrors||this.zone.isResolved)throw e;i.errors.push(e)}finally{i.runningTask=this.nestedTask}return o};var g=["beforeTask","afterTask","created","ended","beforeRun","afterRun"],y=["document","window","location"];s.waitFor=function(e,t){var n=e||m,r=this.current;return r?r.waitFor(n,t):n},s.error=function(e){var t=this.current;return t?(t.errors.push(e),e):e},s.ignore=function(e){var t=this;return function(){var n=t.current;if(!n)return e.apply(this,arguments);var r=new o(n);t.current=void 0,n.execHookR("afterTask",r);var i=e.apply(this,arguments);return n.execHook("beforeTask",r),t.current=n,i}},s.prototype.runTask=function(e,t,n,r,i){var a,s,u=new o(this,e,r);try{a=u.run(t,n)}catch(e){s=e}if(i&&this.removeWait&&this.removeWait(),s)throw s;return a},s.prototype.run=function(e){this.isResolved?(this.deferred=new i,this.isResolved=!1):this.execHook("beforeRun");var t=new o(this,e);return this.data.result=t.run(),this.isResolved||this.execHook("afterRun"),this.waits&&!this.errors.length||this.end(),this.deferred.promise},s.prototype.fork=function(e){var t=this.constructor,n=[];return e&&n.push(e),n.unshift(this),new t({plugins:n})},s.prototype.execHook=function(e){var t=d.call(arguments,1),n=this,r=this[e+"s"];r&&p.call(r,function(e){e.apply(n,t)})},s.prototype.execHookR=function(e){var t=d.call(arguments,1),n=this,r=this[e+"s"];if(r)for(var i=r.length-1;i>=0;i--)r[i].apply(n,t)},s.prototype.wrap=function(e,t){var n=this;return function(){return n.runTask(e,this,arguments,t)}},s.prototype.end=function(){this.isResolved||this.execHook("ended");var e=this.deferred;if(this.errors.length){var t=this.errors[0];t.errors=this.errors,e.reject(t)}else e.resolve(this.data);this.isResolved=!0},s.prototype.waitFor=function(e,t){this.addWait();var n=this;return function(){return n.runTask(e,this,arguments,t,!0)}},s.prototype.addWait=function(){this.waits++,this.parent&&this.parent.addWait()},s.prototype.removeWait=function(){this.waits--,0===this.waits&&this.end(),this.parent&&this.parent.removeWait()},s.Task=o,s.register=f,s.tasks={},function(e){for(var t in e)s.tasks[t]=e[t]}(t("./tasks")),c.CanZone=c.CanZone||s,void 0!==r&&r.exports&&(r.exports=s)}(0,e,0,n)}),define("can-util@3.14.0#js/diff-object/diff-object",["require","exports","module","can-assign"],function(e,t,n){"use strict";var r=e("can-assign");n.exports=function(e,t){var n,i=[];n=r({},e);for(var o in t)e&&e.hasOwnProperty(o)?t[o]!==e[o]&&i.push({property:o,type:"set",value:t[o]}):i.push({property:o,type:"add",value:t[o]}),delete n[o];for(var a in n)i.push({property:a,type:"remove"});return i}}),define("can-route-pushstate@4.1.2#can-route-pushstate",["require","exports","module","can-route","can-route/src/binding-proxy","can-reflect","can-key-tree","can-queues","can-simple-observable","can-observation-recorder","can-globals/is-node/is-node","can-globals/location/location","can-dom-events","can-util/js/diff-object/diff-object"],function(e,t,n){!function(e,t,n,r){"use strict";function i(){var e=k(),t=d(),n=t.pathname+t.search,r=n.indexOf(e);return n.substr(r+e.length)}function o(e){this.options=e,this.dispatchHandlers=this.dispatchHandlers.bind(this);var t=this;this.anchorClickHandler=function(e){o.prototype.anchorClickHandler.call(t,this,e)},this.handlers=new c([Object,Array],{onFirst:this.setup.bind(this),onEmpty:this.teardown.bind(this)}),this.keepHash=!0}var a=t("can-route"),s=t("can-route/src/binding-proxy"),u=t("can-reflect"),c=t("can-key-tree"),l=t("can-queues"),h=t("can-simple-observable"),p=t("can-observation-recorder"),f=t("can-globals/is-node/is-node"),d=t("can-globals/location/location"),m=t("can-dom-events"),g=t("can-util/js/diff-object/diff-object"),y=window.history&&window.history.pushState,v=d(),b={"http:":!0,"https:":!0,"":!0},_=y&&v&&b[v.protocol],w=["pushState","replaceState"],k=function(){var e=location.protocol+"//"+location.host,t=s.call("root");return 0===t.indexOf(e)?t.substr(e.length):t};o.prototype=Object.create(h.prototype),o.constructor=o,u.assign(o.prototype,{root:"/",matchSlashes:!1,paramsMatcher:/^\?(?:[^=]+=[^&]*&)*[^=]+=[^&]*/,querySeparator:"?",dispatchHandlers:function(){var e=this._value,t=[];this._value=i(),e!==this._value&&(t=[this.handlers.getNode([]),this,[this._value,e]],l.enqueueByQueue.apply(l,t))},anchorClickHandler:function(e,t){if(!(t.isDefaultPrevented?t.isDefaultPrevented():!0===t.defaultPrevented)){var n=e.host||window.location.host;if("javascript://"===e.href)return;if("_blank"===e.target)return;if(t.altKey||t.ctrlKey||t.metaKey||t.shiftKey)return;if(window.location.host===n){var r=k();if(0===e.pathname.indexOf(r)){var i=e.pathname+e.search,o=i.substr(r.length);if(void 0!==a.rule(o)){e.href.indexOf("#")>=0&&(this.keepHash=!0);var s=i!==window.location.pathname+window.location.search||e.hash===window.location.hash;window.history.pushState(null,null,e.href),s&&t.preventDefault&&t.preventDefault()}}}}},setup:function(){if(!f()){this._value=i(),m.addDelegateListener(document.documentElement,"click","a",this.anchorClickHandler);var e=this.originalMethods={},t=this.dispatchHandlers;u.eachKey(w,function(n){this.originalMethods[n]=window.history[n],window.history[n]=function(r,i,o){var a=0===o.indexOf("http"),s=d(),u=s.search+s.hash;(!a&&o!==s.pathname+u||a&&o!==s.href+u)&&(e[n].apply(window.history,arguments),t())}},this),m.addEventListener(window,"popstate",this.dispatchHandlers)}},teardown:function(){m.removeDelegateListener(document.documentElement,"click","a",this.anchorClickHandler),u.eachKey(w,function(e){window.history[e]=this.originalMethods[e]},this),m.removeEventListener(window,"popstate",this.dispatchHandlers)},get:function(){return p.add(this),i()},set:function(e){var t,n=a.deparam(e),r=a.deparam(i()),o="pushState";if(this.keepHash&&-1===e.indexOf("#")&&window.location.hash&&(e+=window.location.hash),t={},g(r,n).forEach(function(e){return t[e.property]=!0}),this.options.replaceStateKeys.length&&this.options.replaceStateKeys.forEach(function(e){t[e]&&(o="replaceState")}),this.options.replaceStateOnceKeys.length)for(var u=this.options.replaceStateOnceKeys.length-1;u>=0;u--){var c=this.options.replaceStateOnceKeys[u];t[c]&&(o="replaceState",this.options.replaceStateOnceKeys.splice(u,1))}window.history[o](null,null,s.call("root")+e)}});var E={"can.getValue":o.prototype.get,"can.setValue":o.prototype.set,"can.onValue":o.prototype.on,"can.offValue":o.prototype.off,"can.isMapLike":!1,"can.valueHasDependencies":function(){return!0}};if(u.assignSymbols(o.prototype,E),_){var T={replaceStateOnceKeys:[],replaceStateKeys:[]},S=new o(T);a.bindings.pushstate=S,a.defaultBinding="pushstate",u.assignMap(a,{replaceStateOn:function(){u.addValues(T.replaceStateKeys,u.toArray(arguments))},replaceStateOnce:function(){u.addValues(T.replaceStateOnceKeys,u.toArray(arguments))},replaceStateOff:function(){u.removeValues(T.replaceStateKeys,u.toArray(arguments)),u.removeValues(T.replaceStateOnceKeys,u.toArray(arguments))}})}r.exports=a}(0,e,0,n)}),define("can-stache-route-helpers@1.1.3#can-stache-route-helpers",["require","exports","module","can-stache/helpers/core","can-route","can-stache/src/expression","can-reflect"],function(e,t,n){"use strict";var r=e("can-stache/helpers/core"),i=e("can-route"),o=e("can-stache/src/expression"),a=e("can-reflect"),s=r.looksLikeOptions,u=function(){var e,t,n;return a.eachIndex(arguments,function(i){"boolean"==typeof i?t=i:i&&"object"==typeof i&&(s(i)?n=i:e=r.resolveHash(i))}),!e&&n&&(e=r.resolveHash(n.hash)),{finalParams:e||{},finalMerge:t,optionsArg:n}};r.registerHelper("routeUrl",function(){var e=u.apply(this,arguments);return i.url(e.finalParams,"boolean"==typeof e.finalMerge?e.finalMerge:void 0)});var c=function(){var e=u.apply(this,arguments),t=i.isCurrent(e.finalParams,"boolean"==typeof e.finalMerge?e.finalMerge:void 0);return!e.optionsArg||e.optionsArg instanceof o.Call?t:t?e.optionsArg.fn():e.optionsArg.inverse()};c.callAsMethod=!0,r.registerHelper("routeCurrent",c)}),define("devjournal@0.0.0#app",["exports","can-define/map/","can-route","can-stache-route-helpers","can-route-pushstate","can-debug#?./is-dev"],function(e,t,n,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(t),a=i(n),s=(i(r),o.default.extend({env:{default:function(){return{NODE_ENV:"development"}},serialize:!1},page:{serialize:!1},date:{default:function(){var e=new Date(Date.now()).toISOString();return e.substring(0,e.indexOf("T"))},serialize:!1},title:{default:"devjournal",serialize:!1},htmloutput:{serialize:!1},currentUser:{serialize:!1}}));a.default.register("/",{page:"today"}),a.default.register("/today",{page:"today"}),a.default.register("logs",{page:"logs"}),a.default.register("logs/{date}",{page:"logview"}),a.default.register("profile",{page:"profile"}),a.default.start(),e.default=s}),define("steal-css@1.3.2#css",["require","exports","module","@loader","@steal"],function(e,t,n){!function(e,t,n,r){function i(){return o()&&!!Function("/*@cc_on return (/^9/.test(@_jscript_version) && /MSIE 9.0(?!.*IEMobile)/i.test(navigator.userAgent)); @*/")()}function o(){if("undefined"!=typeof doneSsr&&doneSsr.globalDocument)return doneSsr.globalDocument;if("undefined"!=typeof document)return document;throw new Error("Unable to load CSS in an environment without a document.")}function a(){var e=o(),t=e.head||e.getElementsByTagName("head")[0];if(!t){var n=e.documentElement||e;t=e.createElement("head"),n.insertBefore(t,n.firstChild)}return t}function s(e,t){"object"==typeof e?(this.load=e,this.loader=t,this.address=this.load.address,this.source=this.load.source):(this.address=e,this.source=t)}var u=t("@loader"),c=t("@steal"),l="object"==typeof process&&"[object process]"==={}.toString.call(process),h=/@import [^uU]['"]?([^'"\)]*)['"]?/g,p=/url\(['"]?([^'"\)]*)['"]?\)/g,f=u.cssOptions&&u.cssOptions.timeout?parseInt(u.cssOptions.timeout,10):60,d=function(e,t){for(var n=o().styleSheets,r=n.length;r--;)if(n[r].href===e.href)return t();setTimeout(function(){d(e,t)})};s.cssCount=0,s.ie9MaxStyleSheets=31,s.currentStyleSheet=null,s.prototype={injectLink:function(){if(this._loaded)return this._loaded;if(this.linkExists())return this._loaded=Promise.resolve(""),this._loaded;var e=o(),t=this.link=e.createElement("link");return t.type="text/css",t.rel="stylesheet",t.href=this.address,this._loaded=new Promise(function(e,n){var r=setTimeout(function(){n("Unable to load CSS")},1e3*f),i=function(o){clearTimeout(r),t.removeEventListener("load",i),t.removeEventListener("error",i),o&&"error"===o.type?n("Unable to load CSS"):e("")};"isApplicationInstalled"in navigator||!t.addEventListener?d(t,i):navigator.noUI?i():(t.addEventListener("load",i),t.addEventListener("error",i)),a().appendChild(t)}),this._loaded},injectStyle:function(){var e=o(),t=a(),n=this.style=e.createElement("style");n.type="text/css",n.sheet?n.sheet.cssText=this.source:n.styleSheet?n.styleSheet.cssText=this.source:n.appendChild(e.createTextNode(this.source)),t.appendChild(n)},ie9StyleSheetLimitHack:function(){var e=o();s.cssCount||(s.currentStyleSheet=e.createStyleSheet()),s.cssCount+=1,s.currentStyleSheet.cssText+=this.source,s.cssCount===s.ie9MaxStyleSheets&&(s.cssCount=0)},updateURLs:function(){var e=this.source,t=this.address;return this.source=e.replace(h,function(e,n){return l?"@import url("+n+")":"@import url("+c.joinURIs(t,n)+")"}),u.isEnv("build")||(this.source=this.source+"/*# sourceURL="+t+" */",this.source=this.source.replace(p,function(e,n){return"url("+c.joinURIs(t,n)+")"})),this.source},getExistingNode:function(){var e=o(),t="[href='"+this.address+"']";return e.querySelector&&e.querySelector(t)},linkExists:function(){for(var e=o().styleSheets,t=0;t<e.length;++t)if(this.address===e[t].href)return!0;return!1},setupLiveReload:function(e,t){var n=a(),i=this;if(e.liveReloadInstalled){var o=e.import("live-reload",{name:r.id});Promise.resolve(o).then(function(r){e.import(t).then(function(){r.once("!dispose/"+t,function(){i.style.__isDirty=!0,r.once("!cycleComplete",function(){n.removeChild(i.style)})})})})}}},u.isEnv("production")?n.fetch=function(e){return new s(e.address).injectLink()}:n.instantiate=function(e){var t=this,n=new s(e.address,e.source);e.source=n.updateURLs(),e.metadata.deps=[],e.metadata.format="css",e.metadata.execute=function(){return o()&&(i()?n.ie9StyleSheetLimitHack():n.injectStyle(),n.setupLiveReload(t,e.name)),t.newModule({source:n.source})}},n.CSSModule=s,n.getDocument=o,n.getHead=a,n.locateScheme=!0,n.buildType="css",n.includeInBuild=!0,n.pluginBuilder="steal-css/slim"}(0,e,t,n)}),define("done-css@3.0.2#css",["require","exports","module","@loader","steal-css"],function(e,t,n){function r(e,t){var n=u();if(n.querySelectorAll){var r="[asset-id='"+e.name+"']",i=n.querySelectorAll(r);return i&&i[0]}for(var o,a=n.getElementsByTagName("*"),s=0,c=a.length;s<c;s++)if((o=a[s]).getAttribute("asset-id")===e.name)return o}function i(e){return e+("/"===e[e.length-1]?"":"/")}var o=e("@loader"),a=e("steal-css"),s=a.CSSModule;t.locateScheme=a.locateScheme,t.buildType=a.buildType,t.includeInBuild=a.includeInBuild,t.pluginBuilder="steal-css/slim";var u=a.getDocument,c=a.getHead,l=function(){s.apply(this,arguments)},h=l.prototype=Object.create(s.prototype);h.constructor=l,h.getSSRRegister=function(){return o.has("asset-register")?o.get("asset-register").default:function(){}},h.updateProductionHref=function(){var e,t=this.address,n=this.loader,r="/"+(t=n._nodeRequire("path").relative(n.baseURL,t).replace(/\\/g,"/"));n.renderingBaseURL&&(r="/"!==(e=n.renderingBaseURL)?i(e)+t.replace("dist/",""):i(e)+t),this.href=r},h.registerSSR=function(){var e,t=this;o.isEnv("production")?(this.updateProductionHref(),e=function(){var e=u().createElement("link");return e.setAttribute("rel","stylesheet"),e.setAttribute("href",t.href),e}):e=function(){return t.style.cloneNode(!0)},this.getSSRRegister()(this.load.name,"css",e)},h.updateURLs=function(){var e=this.loader,t=this.address;if(e.renderingLoader||e.renderingBaseURL){var n=t.substr(e.baseURL.length),r=i(e.renderingBaseURL||e.renderingLoader.baseURL);t=steal.joinURIs(r,n)}return this.address=t,s.prototype.updateURLs.call(this)},h.shouldInjectStyle=function(){c();var e=r(this.load);return e&&(this.style=e),!e||e.__isDirty},h.injectStyle=function(){this.shouldInjectStyle()&&s.prototype.injectStyle.call(this)},h.dependencies=function(){var e=this.loader.meta[this.load.name];return e&&e.deps||[]};var p="object"==typeof process&&"[object process]"==={}.toString.call(process),f=function(){try{return void 0!==o._nodeRequire("nw.gui")}catch(e){return!1}}(),d=p&&!!process.versions.electron;o.isEnv("production")?t.fetch=function(e){var t=new l(e,this);return!p||f||d?t.injectLink():(t.registerSSR(),"")}:t.instantiate=function(e){var t=this,n=new l(e,this);e.source=n.updateURLs(),e.metadata.deps=n.dependencies(),e.metadata.format="css",e.metadata.execute=function(){return u()&&(n.injectStyle(),n.setupLiveReload(t,e.name)),!p||f||d||n.registerSSR(),t.newModule({source:n.source})}}}),define("devjournal@0.0.0#is-dev",["exports","@steal"],function(e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(t);e.default=!n.default.isEnv("production")}),define("@node-require/steal-less@1.3.4#less-engine-node",[],function(){return{}}),define("steal-less@1.3.4#less-engine-node",[],function(){return{}}),define("steal-less@1.3.4#less",[],function(){return{}}),define("can-key@1.2.0#utils",function(e,t,n){"use strict";var r={isContainer:function(e){var t=typeof e;return e&&("object"===t||"function"===t)},strReplacer:/\{([^\}]+)\}/g,parts:function(e){return Array.isArray(e)?e:void 0!==e?(e+"").replace(/\[/g,".").replace(/]/g,"").split("."):[]}};n.exports=r}),define("can-key@1.2.0#get/get",["require","exports","module","can-reflect","../utils"],function(e,t,n){"use strict";var r=e("can-reflect"),i=e("../utils");n.exports=function(e,t){var n,o,a,s=i.parts(t),u=s.length;if(!u)return e;for(n=e,o=0;o<u&&i.isContainer(n)&&null!==n;o++)a=n,n=r.getKeyValue(a,s[o]);return n}}),define("can-control@4.4.1#can-control",["require","exports","module","can-construct","can-namespace","can-assign","can-stache-key","can-reflect","can-observation","can-event-queue/map/map","can-log/dev/dev","can-string","can-key/get/get","can-dom-mutate","can-symbol"],function(e,t,n){"use strict";var r,i,o=e("can-construct"),a=e("can-namespace"),s=e("can-assign"),u=e("can-stache-key"),c=e("can-reflect"),l=e("can-observation"),h=e("can-event-queue/map/map"),p=(e("can-log/dev/dev"),e("can-string")),f=e("can-key/get/get"),d=e("can-dom-mutate"),m=e("can-symbol").for("can.controls"),g=function(e,t,n,r){return h.on.call(e,t,n,r),function(){h.off.call(e,t,n,r)}},y=[].slice,v=/\{([^\}]+)\}/g,b=function(e,t,n,r){return h.on.call(e,n,t,r),function(){h.off.call(e,n,t,r)}},_=function(e,t,n,r){return r?b(e,r.trim(),t,n):g(e,t,n)},w=o.extend("Control",{setup:function(){if(o.setup.apply(this,arguments),w){var e,t=this;t.actions={};for(e in t.prototype)t._isAction(e)&&(t.actions[e]=t._action(e))}},_shifter:function(e,t){var n="string"==typeof t?e[t]:t;"function"!=typeof n&&(n=e[n]);var r=this;return function(){var i=r.wrapElement(this);return e.called=t,n.apply(e,[i].concat(y.call(arguments,0)))}},_isAction:function(e){var t=this.prototype[e],n=typeof t;return"constructor"!==e&&("function"===n||"string"===n&&"function"==typeof this.prototype[t])&&!!(w.isSpecial(e)||r[e]||/[^\w]/.test(e))},_action:function(e,t,n){var r,o;if(v.lastIndex=0,t||!v.test(e)){if(r=new l(function(){var n,r=e.replace(v,function(e,r){var i,a;return this._isDelegate(t,r)?(n=this._getDelegate(t,r),""):(r=this._removeDelegateFromKey(r),a=this._lookup(t)[0],void 0===(i=u.read(a,u.reads(r),{readCompute:!1}).value)&&"undefined"!=typeof window&&(i=f(window,r)),a&&(c.isObservableLike(a)&&c.isMapLike(a)||i)?"string"==typeof i?i:(n=i,""):(o=!0,null))}.bind(this)),a=(r=r.trim()).split(/\s+/g),s=a.pop();return{processor:this.processors[s]||i,parts:[r,a.join(" "),s],delegate:n||void 0}},this),n){var a=function(t){n._bindings.control[e](n.element),n._bindings.control[e]=t.processor(t.delegate||n.element,t.parts[2],t.parts[1],e,n)};c.onValue(r,a,"mutate"),n._bindings.readyComputes[e]={compute:r,handler:a}}return r.get()}},_lookup:function(e){return[e,window]},_removeDelegateFromKey:function(e){return e},_isDelegate:function(e,t){return"element"===t},_getDelegate:function(e,t){},processors:{},defaults:{},convertElement:function(e){return e="string"==typeof e?document.querySelector(e):e,this.wrapElement(e)},wrapElement:function(e){return e},unwrapElement:function(e){return e},isSpecial:function(e){return"inserted"===e||"removed"===e}},{setup:function(e,t){var n,r=this.constructor,i=r.pluginName||r.shortName;if(!e)throw new Error("Creating an instance of a named control without passing an element");if(this.element=r.convertElement(e),i&&"Control"!==i&&this.element.classList&&this.element.classList.add(i),(n=this.element[m])||(n=[],this.element[m]=n),n.push(this),c.isObservableLike(t)&&c.isMapLike(t)){for(var o in r.defaults)t.hasOwnProperty(o)||u.set(t,o,r.defaults[o]);this.options=t}else this.options=s(s({},r.defaults),t);return this.on(),[this.element,this.options]},on:function(e,t,n,r){if(!e){this.off();var i,o,a=this.constructor,s=this._bindings,u=a.actions,c=this.constructor.unwrapElement(this.element),l=w._shifter(this,"destroy");for(i in u)u.hasOwnProperty(i)&&(o=u[i]||a._action(i,this.options,this))&&(s.control[i]=o.processor(o.delegate||c,o.parts[2],o.parts[1],i,this));var h=d.onNodeRemoval(c,function(){var e=c.ownerDocument,t=e.contains?e:e.documentElement;t&&!1!==t.contains(c)||l()});return s.user.push(function(){h&&(h(),h=void 0)}),s.user.length}return"string"==typeof e&&(r=n,n=t,t=e,e=this.element),void 0===r&&(r=n,n=t,t=null),"string"==typeof r&&(r=w._shifter(this,r)),this._bindings.user.push(_(e,n,r,t)),this._bindings.user.length},off:function(){var e=this.constructor.unwrapElement(this.element),t=this._bindings;t&&((t.user||[]).forEach(function(t){t(e)}),c.eachKey(t.control||{},function(t){t(e)}),c.eachKey(t.readyComputes||{},function(e){c.offValue(e.compute,e.handler,"mutate")})),this._bindings={user:[],control:{},readyComputes:{}}},destroy:function(){if(null!==this.element){var e,t=this.constructor,n=t.pluginName||t.shortName&&p.underscore(t.shortName);this.off(),n&&"can_control"!==n&&this.element.classList&&this.element.classList.remove(n),(e=this.element[m])&&e.splice(e.indexOf(this),1),this.element=null}}});r=w.processors,i=function(e,t,n,r,i){return _(e,t,w._shifter(i,r),n)},["beforeremove","change","click","contextmenu","dblclick","keydown","keyup","keypress","mousedown","mousemove","mouseout","mouseover","mouseup","reset","resize","scroll","select","submit","focusin","focusout","mouseenter","mouseleave","touchstart","touchmove","touchcancel","touchend","touchleave","inserted","removed","dragstart","dragenter","dragover","dragleave","drag","drop","dragend"].forEach(function(e){r[e]=i}),n.exports=a.Control=w}),define("can-component@4.4.9#control/control",["require","exports","module","can-control","can-reflect"],function(e,t,n){"use strict";var r=e("can-control"),i=e("can-reflect"),o=/\{([^\}]+)\}/g,a=r.extend({_lookup:function(e){return[e.scope,e,window]},_removeDelegateFromKey:function(e){return e.replace(/^(scope|^viewModel)\./,"")},_isDelegate:function(e,t){return"scope"===t||"viewModel"===t},_getDelegate:function(e,t){return e[t]},_action:function(e,t,n){var i;return o.lastIndex=0,i=o.test(e),!n&&i?void 0:r._action.apply(this,arguments)}},{setup:function(e,t){return this.scope=t.scope,this.viewModel=t.viewModel,r.prototype.setup.call(this,e,t)},off:function(){this._bindings&&i.eachKey(this._bindings.readyComputes||{},function(e){i.offValue(e.compute,e.handler)}),r.prototype.off.apply(this,arguments),this._bindings.readyComputes={}},destroy:function(){r.prototype.destroy.apply(this,arguments),"function"==typeof this.options.destroy&&this.options.destroy.apply(this,arguments)}});n.exports=a}),define("can-define@2.7.1#list/list",["require","exports","module","can-construct","can-define","can-queues","can-event-queue/type/type","can-observation-recorder","can-log","can-log/dev/dev","../define-helpers/define-helpers","can-assign","can-diff/list/list","can-namespace","can-reflect","can-symbol","can-single-reference"],function(e,t,n){"use strict";function r(){var e=this.prototype._define.definitions,t={type:"list",keys:{}};return(t=o.updateSchemaKeys(t,e)).keys["#"]&&(t.values=e["#"].Type,delete t.keys["#"]),t}var i=e("can-construct"),o=e("can-define"),a=o.make,s=e("can-queues"),u=e("can-event-queue/type/type"),c=e("can-observation-recorder"),l=e("can-log"),h=(e("can-log/dev/dev"),e("../define-helpers/define-helpers")),p=e("can-assign"),f=e("can-diff/list/list"),d=e("can-namespace"),m=e("can-reflect"),g=e("can-symbol"),y=e("can-single-reference"),v=[].splice,b=!1,_=function(e){return e},w=function(e){return function(t){for(var n in e)if(t[n]!==e[n])return!1;return!0}},k=o.eventsProto[g.for("can.onKeyValue")],E=o.eventsProto[g.for("can.offKeyValue")],T=g.for("can.getSchema"),S=i.extend("DefineList",{setup:function(e){if(S){u(this);var t=this.prototype,n=o(t,t,e.prototype._define);o.makeDefineInstanceKey(this,n);var i=n.definitions["#"]||n.defaultDefinition;i&&(i.Type?this.prototype.__type=a.set.Type("*",i.Type,_):i.type&&(this.prototype.__type=a.set.type("*",i.type,_))),this[T]=r}}},{setup:function(e){this._define||(Object.defineProperty(this,"_define",{enumerable:!1,value:{definitions:{length:{type:"number"},_length:{type:"number"}}}}),Object.defineProperty(this,"_data",{enumerable:!1,value:{}})),o.setup.call(this,{},!1),Object.defineProperty(this,"_length",{enumerable:!1,configurable:!0,writable:!0,value:0}),e&&this.splice.apply(this,[0,0].concat(m.toArray(e)))},__type:o.types.observable,_triggerChange:function(e,t,n,r){var i=+e;if(isNaN(i))this.dispatch({type:""+e,target:this},[n,r]);else{var o,a=this._define.definitions["#"];"add"===t?(a&&"function"==typeof a.added&&c.ignore(a.added).call(this,n,i),o={type:t,patches:[{type:"splice",insert:n,index:i,deleteCount:0}]},this.dispatch(o,[n,i])):"remove"===t?(a&&"function"==typeof a.removed&&c.ignore(a.removed).call(this,r,i),o={type:t,patches:[{type:"splice",index:i,deleteCount:r.length}]},this.dispatch(o,[r,i])):this.dispatch(t,[n,i])}},get:function(e){return arguments.length?(isNaN(e)?c.add(this,e):c.add(this,"length"),this[e]):m.unwrap(this,Map)},set:function(e,t){if("object"!=typeof e)if("number"==typeof(e=isNaN(+e)||e%1?e:+e)){if("number"==typeof e&&e>this._length-1){var n=new Array(e+1-this._length);return n[n.length-1]=t,this.push.apply(this,n),n}this.splice(e,1,t)}else h.defineExpando(this,e,t)||(this[e]=t);else m.isListLike(e)?t?this.replace(e):m.assignList(this,e):m.assignMap(this,e);return this},assign:function(e){return m.isListLike(e)?m.assignList(this,e):m.assignMap(this,e),this},update:function(e){return m.isListLike(e)?m.updateList(this,e):m.updateMap(this,e),this},assignDeep:function(e){return m.isListLike(e)?m.assignDeepList(this,e):m.assignDeepMap(this,e),this},updateDeep:function(e){return m.isListLike(e)?m.updateDeepList(this,e):m.updateDeepMap(this,e),this},_items:function(){var e=[];return this._each(function(t){e.push(t)}),e},_each:function(e){for(var t=0,n=this._length;t<n;t++)e(this[t],t)},splice:function(e,t){var n,r,i,o=m.toArray(arguments),a=[],u=o.length>2,c=this._length;for(e=e||0,n=0,r=o.length-2;n<r;n++)o[i=n+2]=this.__type(o[i],i),a.push(o[i]),this[n+e]!==o[i]&&(u=!1);if(u&&this._length<=a.length)return a;void 0===t&&(t=o[1]=this._length-e),b=!0;var l=v.apply(this,o);return b=!1,s.batch.start(),t>0&&this._triggerChange(""+e,"remove",void 0,l),o.length>2&&this._triggerChange(""+e,"add",a,l),this.dispatch("length",[this._length,c]),s.batch.stop(),l},serialize:function(){return m.serialize(this,Map)}});for(var C in o.eventsProto)Object.defineProperty(S.prototype,C,{enumerable:!1,value:o.eventsProto[C],writable:!0});("getOwnPropertySymbols"in Object?Object.getOwnPropertySymbols(o.eventsProto):[g.for("can.onKeyValue"),g.for("can.offKeyValue")]).forEach(function(e){Object.defineProperty(S.prototype,e,{configurable:!0,enumerable:!1,value:o.eventsProto[e],writable:!0})});var I=function(e){return e[0]&&Array.isArray(e[0])?e[0]:m.toArray(e)};m.eachKey({push:"length",unshift:0},function(e,t){var n=[][t];S.prototype[t]=function(){for(var t,r,i=[],o=e?this._length:0,a=arguments.length;a--;)r=arguments[a],i[a]=this.__type(r,a);return b=!0,t=n.apply(this,i),b=!1,this.comparator&&!i.length||(s.batch.start(),this._triggerChange(""+o,"add",i,void 0),this.dispatch("length",[this._length,o]),s.batch.stop()),t}}),m.eachKey({pop:"length",shift:0},function(e,t){var n=[][t];S.prototype[t]=function(){if(this._length){var t,r=I(arguments),i=e&&this._length?this._length-1:0,o=this._length?this._length:0;return b=!0,t=n.apply(this,r),b=!1,s.batch.start(),this._triggerChange(""+i,"remove",void 0,[t]),this.dispatch("length",[this._length,o]),s.batch.stop(),t}}}),m.eachKey({map:3,filter:3,reduce:4,reduceRight:4,every:3,some:3},function(e,t){S.prototype[t]=function(){var n=this,r=[].slice.call(arguments,0),i=r[0],o=r[e-1]||n;"object"==typeof i&&(i=w(i)),r[0]=function(){var t=[].slice.call(arguments,0);return t[e-3]=n.get(t[e-2]),i.apply(o,t)};var a=Array.prototype[t].apply(this,r);return"map"===t?new S(a):"filter"===t?new n.constructor(a):a}}),p(S.prototype,{indexOf:function(e,t){for(var n=t||0,r=this.length;n<r;n++)if(this.get(n)===e)return n;return-1},lastIndexOf:function(e,t){for(var n=t=void 0===t?this.length-1:t;n>=0;n--)if(this.get(n)===e)return n;return-1},join:function(){return c.add(this,"length"),[].join.apply(this,arguments)},reverse:function(){var e=[].reverse.call(this._items());return this.replace(e)},slice:function(){c.add(this,"length");var e=Array.prototype.slice.apply(this,arguments);return new this.constructor(e)},concat:function(){var e=[];return m.eachIndex(arguments,function(t){m.isListLike(t)?(Array.isArray(t)?t:m.toArray(t)).forEach(function(t){e.push(this.__type(t))},this):e.push(this.__type(t))},this),new this.constructor(Array.prototype.concat.apply(m.toArray(this),e))},forEach:function(e,t){for(var n,r=0,i=this.length;r<i&&(n=this.get(r),!1!==e.call(t||n,n,r,this));r++);return this},replace:function(e){var t=f(this,e);s.batch.start();for(var n=0,r=t.length;n<r;n++)this.splice.apply(this,[t[n].index,t[n].deleteCount].concat(t[n].insert));return s.batch.stop(),this},sort:function(e){var t=Array.prototype.slice.call(this);return Array.prototype.sort.call(t,e),this.splice.apply(this,[0,t.length].concat(t)),this}});for(var C in o.eventsProto)S[C]=o.eventsProto[C],Object.defineProperty(S.prototype,C,{enumerable:!1,value:o.eventsProto[C],writable:!0});Object.defineProperty(S.prototype,"length",{get:function(){return this.__inSetup||c.add(this,"length"),this._length},set:function(e){if(b)this._length=e;else if(null!=e&&!isNaN(+e)&&e!==this._length)if(e>this._length-1){var t=new Array(e-this._length);this.push.apply(this,t)}else this.splice(e)},enumerable:!0}),S.prototype.attr=function(e,t){return l.warn("DefineMap::attr shouldn't be called"),0===arguments.length?this.get():e&&"object"==typeof e?this.set.apply(this,arguments):1===arguments.length?this.get(e):this.set(e,t)},S.prototype.item=function(e,t){return 1===arguments.length?this.get(e):this.set(e,t)},S.prototype.items=function(){return l.warn("DefineList::get should should be used instead of DefineList::items"),this.get()};var N={"can.isMoreListLikeThanMapLike":!0,"can.isMapLike":!0,"can.isListLike":!0,"can.isValueLike":!1,"can.getKeyValue":S.prototype.get,"can.setKeyValue":S.prototype.set,"can.onKeyValue":function(e,t,n){var r;return isNaN(e)?k.apply(this,arguments):(r=function(){t(this[e])},y.set(t,this,r,e),k.call(this,"length",r,n))},"can.offKeyValue":function(e,t,n){var r;return isNaN(e)?E.apply(this,arguments):(r=y.getAndDelete(t,this,e),E.call(this,"length",r,n))},"can.deleteKeyValue":function(e){if("number"==typeof(e=isNaN(+e)||e%1?e:+e))this.splice(e,1);else{if("length"===e||"_length"===e)return;this.set(e,void 0)}return this},"can.assignDeep":function(e){s.batch.start(),m.assignList(this,e),s.batch.stop()},"can.updateDeep":function(e){s.batch.start(),this.replace(e),s.batch.stop()},"can.keyHasDependencies":function(e){return!!(this._computed&&this._computed[e]&&this._computed[e].compute)},"can.getKeyDependencies":function(e){var t;return this._computed&&this._computed[e]&&this._computed[e].compute&&((t={}).valueDependencies=new Set,t.valueDependencies.add(this._computed[e].compute)),t},"can.splice":function(e,t,n){this.splice.apply(this,[e,t].concat(n))},"can.onPatches":function(e,t){this[g.for("can.onKeyValue")]("can.patches",e,t)},"can.offPatches":function(e,t){this[g.for("can.offKeyValue")]("can.patches",e,t)}};m.assignSymbols(S.prototype,N),m.setKeyValue(S.prototype,g.iterator,function(){var e=-1;return"number"!=typeof this.length&&(this.length=0),{next:function(){return e++,{value:this[e],done:e>=this.length}}.bind(this)}}),o.DefineList=S,n.exports=d.DefineList=S}),define("can-component@4.4.9#can-component",["require","exports","module","./control/control","can-namespace","can-bind","can-construct","can-stache","can-stache-bindings","can-view-scope","can-view-callbacks","can-view-nodelist","can-reflect","can-stache-key","can-simple-observable/setter/setter","can-simple-observable","can-simple-map","can-define/map/map","can-log","can-log/dev/dev","can-assign","can-observation-recorder","can-view-model","can-define/list/list","can-dom-data-state","can-child-nodes","can-string","can-dom-events","can-dom-mutate","can-dom-mutate/node","can-symbol","can-globals/document/document"],function(e,t,n){!function(e,t,n,r){"use strict";function i(e,t,n){var r;S.set.call(e,"preventDataBindings",!0);var i=p.behaviors.viewModel(e,n,function(e,t,n){return r=n&&!0===n.isSettingOnViewModel?new _(e):new b(e)},void 0,!0);return i?E(E({},t),{teardown:i,scope:t.scope.add(r)}):t}function o(e,t,n,r,o){var a=n.options;return function n(s,u){var c=o(s)||u.subtemplate,l=c!==u.subtemplate;if(c){delete a.tags[e];var h;h=l?r.toLightContent?i(s,{scope:u.scope.cloneFromRef(),options:u.options},u):i(s,t,u):i(s,u,u);var p=m.register([s],function(){h.teardown&&h.teardown()},u.parentNodeList||!0,u.directlyNested);p.expression="<can-slot name='"+s.getAttribute("name")+"'/>";var f=c(h.scope,h.options,p),d=g.toArray(C(f)),y=m.update(p,d);m.replace(y,f),a.tags[e]=n}}}function a(e){return T.ignore(function(t,n,r){var i,o=[],a=[];g.eachKey(e,function(e,t){var n=null!=e&&!!e[R],s=null!=e&&!!e[L];if(!0===n||s){var u=y.reads(t),l=new v(function(){return y.read(i,u).value},function(e){g.setKeyValue(i,t,e)}),h=new c({child:l,parent:e,queue:"domUI"});h.startParent(),!0===n&&(r[t]=h.parentValue),o.push(h.start.bind(h)),a.push(h.stop.bind(h))}else r[t]=e}),i=n(r);for(var s=0,u=o.length;s<u;s++)o[s]();return function(){a.forEach(function(e){e()})}})}var s=t("./control/control"),u=t("can-namespace"),c=t("can-bind"),l=t("can-construct"),h=t("can-stache"),p=t("can-stache-bindings"),f=t("can-view-scope"),d=t("can-view-callbacks"),m=t("can-view-nodelist"),g=t("can-reflect"),y=t("can-stache-key"),v=t("can-simple-observable/setter/setter"),b=t("can-simple-observable"),_=t("can-simple-map"),w=t("can-define/map/map"),k=t("can-log"),E=(t("can-log/dev/dev"),t("can-assign")),T=t("can-observation-recorder");t("can-view-model"),t("can-define/list/list");var S=t("can-dom-data-state"),C=t("can-child-nodes"),I=t("can-string"),N=t("can-dom-events"),D=t("can-dom-mutate"),A=t("can-dom-mutate/node"),x=t("can-symbol"),O=t("can-globals/document/document"),P=x("can.createdByCanComponent"),R=x.for("can.getValue"),L=x.for("can.setValue"),M=x.for("can.viewInsert"),V=x.for("can.viewModel");h.addBindings(p);var j=l.extend({setup:function(){if(l.setup.apply(this,arguments),j){var e=this;void 0!==this.prototype.events&&0!==g.size(this.prototype.events)&&(this.Control=s.extend(this.prototype.events));var t=this.prototype.viewModel||this.prototype.scope;if(t&&this.prototype.ViewModel)throw new Error("Cannot provide both a ViewModel and a viewModel property");var n=I.capitalize(I.camelize(this.prototype.tag))+"VM";if(this.prototype.ViewModel?"function"==typeof this.prototype.ViewModel?this.ViewModel=this.prototype.ViewModel:this.ViewModel=w.extend(n,{},this.prototype.ViewModel):t?"function"==typeof t?g.isObservableLike(t.prototype)&&g.isMapLike(t.prototype)?this.ViewModel=t:this.viewModelHandler=t:g.isObservableLike(t)&&g.isMapLike(t)?this.viewModelInstance=t:(k.warn("can-component: "+this.prototype.tag+" is extending the viewModel into a can-simple-map"),this.ViewModel=_.extend(n,{},t)):this.ViewModel=_.extend(n,{},{}),this.prototype.template&&(this.renderer=this.prototype.template),this.prototype.view&&(this.renderer=this.prototype.view),"string"==typeof this.renderer){var r=I.capitalize(I.camelize(this.prototype.tag))+"View";this.renderer=h(r,this.renderer)}d.tag(this.prototype.tag,function(t,n){void 0===t[P]&&new e(t,n)})}}},{setup:function(e,t){this._initialArgs=[e,t];var n=this,r={helpers:{},tags:{}};void 0===t&&(void 0===e?t={}:(t=e,e=void 0)),void 0===e&&((e=O().createElement(this.tag))[P]=!0),this.element=e;var i=t.content;void 0!==i&&("function"==typeof i?t.subtemplate=i:"string"==typeof i&&(t.subtemplate=h(i)));var s=t.scope;void 0!==s&&s instanceof f==0&&(t.scope=new f(s));var u=t.templates;void 0!==u&&g.eachKey(u,function(e,t){if("string"==typeof e){var n=t+" template";u[t]=h(n,e)}});var c,l,d,y=[],v={},b=function(){for(var e=0,t=y.length;e<t;e++)y[e]()};if(S.get.call(e,"preventDataBindings"))c=e[V];else{var w;w=t.setupBindings?t.setupBindings:t.viewModel?a(t.viewModel):function(e,n,r){return p.behaviors.viewModel(e,t,n,r)},d=w(e,function(r){var i=n.constructor.ViewModel,o=n.constructor.viewModelHandler,a=n.constructor.viewModelInstance;if(o){var s=o.call(n,r,t.scope,e);g.isObservableLike(s)&&g.isMapLike(s)?a=s:i=g.isObservableLike(s.prototype)&&g.isMapLike(s.prototype)?s:_.extend(s)}return i&&(a=new n.constructor.ViewModel(r)),c=a,a},v)}if(this.viewModel=c,e[V]=c,e.viewModel=c,S.set.call(e,"preventDataBindings",!0),void 0!==this.helpers&&g.eachKey(this.helpers,function(e,t){"function"==typeof e&&(r.helpers[t]=e.bind(c))}),this.constructor.Control)this._control=new this.constructor.Control(e,{scope:this.viewModel,viewModel:this.viewModel,destroy:b});else var k=D.onNodeRemoval(e,function(){var t=e.ownerDocument,n=t.contains?t:t.documentElement;n&&n.contains(e)||(k(),b())});var E,T,I={toLightContent:!0===this.leakScope,intoShadowContent:!0===this.leakScope};if(this.constructor.renderer){var x;x=I.intoShadowContent?{scope:t.scope.add(this.viewModel,{viewModel:!0}),options:r}:{scope:new f(this.viewModel,null,{viewModel:!0}),options:r},r.tags["can-slot"]=o("can-slot",t,x,I,function(e){var n=t.templates;if(n)return n[e.getAttribute("name")]}),r.tags.content=o("content",t,x,I,function(){return t.subtemplate}),E=this.constructor.renderer,T=x}else T={scope:t.scope.add(this.viewModel,{viewModel:!0}),options:r},E=t.subtemplate||e.ownerDocument.createDocumentFragment.bind(e.ownerDocument);var R,L=m.register([],function(){n._torndown=!0,N.dispatch(e,"beforeremove",!1),d&&d(),R?R(e):"function"==typeof c.stopListening&&c.stopListening()},t.parentNodeList||!0,!1);if(L.expression="<"+this.tag+">",y.push(function(){m.unregister(L)}),this.nodeList=L,l=E(T.scope,T.options,L),A.appendChild.call(e,l),m.update(L,C(e)),c&&c.connectedCallback)if(O().body.contains(e))R=c.connectedCallback(e);else var M=D.onNodeInsertion(e,function(){M(),R=c.connectedCallback(e)});n._torndown=!1}});j.prototype[M]=function(e){return this._torndown&&this.setup.apply(this,this._initialArgs),e.nodeList.newDeepChildren.push(this.nodeList),this.element},r.exports=u.Component=j}(0,e,0,n)}),define("steal-stache@4.1.2#add-bundles",[],function(){return{}}),define("steal-config-utils@1.0.0#import-specifiers",[],function(){return{}}),define("steal-stache@4.1.2#steal-stache",[],function(){return{}}),define("devjournal@0.0.0#markdown-editor/markdown-editor.stache!steal-stache@4.1.2#steal-stache",["module","can-stache","can-stache/src/mustache_core","can-view-import@4.2.0#can-view-import","can-stache-bindings@4.6.4#can-stache-bindings"],function(e,t,n){var r=t("markdown-editor/markdown-editor.stache",[{tokenType:"start",args:["textarea",!0,1]},{tokenType:"attrStart",args:["id",1]},{tokenType:"attrValue",args:["markdown-editor-textarea",1]},{tokenType:"attrEnd",args:["id",1]},{tokenType:"attrStart",args:["on:keyup",1]},{tokenType:"attrValue",args:["markdownChanged()",1]},{tokenType:"attrEnd",args:["on:keyup",1]},{tokenType:"attrStart",args:["on:paste",1]},{tokenType:"attrValue",args:["markdownChanged()",1]},{tokenType:"attrEnd",args:["on:paste",1]},{tokenType:"attrStart",args:["value:from",1]},{tokenType:"attrValue",args:["./markdown",1]},{tokenType:"attrEnd",args:["value:from",1]},{tokenType:"end",args:["textarea",!0,5]},{tokenType:"done",args:[5]}]);return function(t,n,i){var o=Object.assign({},n);return o.helpers?o.helpers=Object.assign({module:e},o.helpers):o.module=e,r(t,o,i)}}),function(){function e(e){"use strict";var t={omitExtraWLInCodeBlocks:{defaultValue:!1,describe:"Omit the default extra whiteline added to code blocks",type:"boolean"},noHeaderId:{defaultValue:!1,describe:"Turn on/off generated header id",type:"boolean"},prefixHeaderId:{defaultValue:!1,describe:"Add a prefix to the generated header ids. Passing a string will prefix that string to the header id. Setting to true will add a generic 'section-' prefix",type:"string"},rawPrefixHeaderId:{defaultValue:!1,describe:'Setting this option to true will prevent showdown from modifying the prefix. This might result in malformed IDs (if, for instance, the " char is used in the prefix)',type:"boolean"},ghCompatibleHeaderId:{defaultValue:!1,describe:"Generate header ids compatible with github style (spaces are replaced with dashes, a bunch of non alphanumeric chars are removed)",type:"boolean"},rawHeaderId:{defaultValue:!1,describe:"Remove only spaces, ' and \" from generated header ids (including prefixes), replacing them with dashes (-). WARNING: This might result in malformed ids",type:"boolean"},headerLevelStart:{defaultValue:!1,describe:"The header blocks level start",type:"integer"},parseImgDimensions:{defaultValue:!1,describe:"Turn on/off image dimension parsing",type:"boolean"},simplifiedAutoLink:{defaultValue:!1,describe:"Turn on/off GFM autolink style",type:"boolean"},excludeTrailingPunctuationFromURLs:{defaultValue:!1,describe:"Excludes trailing punctuation from links generated with autoLinking",type:"boolean"},literalMidWordUnderscores:{defaultValue:!1,describe:"Parse midword underscores as literal underscores",type:"boolean"},literalMidWordAsterisks:{defaultValue:!1,describe:"Parse midword asterisks as literal asterisks",type:"boolean"},strikethrough:{defaultValue:!1,describe:"Turn on/off strikethrough support",type:"boolean"},tables:{defaultValue:!1,describe:"Turn on/off tables support",type:"boolean"},tablesHeaderId:{defaultValue:!1,describe:"Add an id to table headers",type:"boolean"},ghCodeBlocks:{defaultValue:!0,describe:"Turn on/off GFM fenced code blocks support",type:"boolean"},tasklists:{defaultValue:!1,describe:"Turn on/off GFM tasklist support",type:"boolean"},smoothLivePreview:{defaultValue:!1,describe:"Prevents weird effects in live previews due to incomplete input",type:"boolean"},smartIndentationFix:{defaultValue:!1,description:"Tries to smartly fix indentation in es6 strings",type:"boolean"},disableForced4SpacesIndentedSublists:{defaultValue:!1,description:"Disables the requirement of indenting nested sublists by 4 spaces",type:"boolean"},simpleLineBreaks:{defaultValue:!1,description:"Parses simple line breaks as <br> (GFM Style)",type:"boolean"},requireSpaceBeforeHeadingText:{defaultValue:!1,description:"Makes adding a space between `#` and the header text mandatory (GFM Style)",type:"boolean"},ghMentions:{defaultValue:!1,description:"Enables github @mentions",type:"boolean"},ghMentionsLink:{defaultValue:"https://github.com/{u}",description:"Changes the link generated by @mentions. Only applies if ghMentions option is enabled.",type:"string"},encodeEmails:{defaultValue:!0,description:"Encode e-mail addresses through the use of Character Entities, transforming ASCII e-mail addresses into its equivalent decimal entities",type:"boolean"},openLinksInNewWindow:{defaultValue:!1,description:"Open all links in new windows",type:"boolean"},backslashEscapesHTMLTags:{defaultValue:!1,description:"Support for HTML Tag escaping. ex: <div>foo</div>",type:"boolean"},emoji:{defaultValue:!1,description:"Enable emoji support. Ex: `this is a :smile: emoji`",type:"boolean"},underline:{defaultValue:!1,description:"Enable support for underline. Syntax is double or triple underscores: `__underline word__`. With this option enabled, underscores no longer parses into `<em>` and `<strong>`",type:"boolean"},completeHTMLDocument:{defaultValue:!1,description:"Outputs a complete html document, including `<html>`, `<head>` and `<body>` tags",type:"boolean"},metadata:{defaultValue:!1,description:"Enable support for document metadata (defined at the top of the document between `«««` and `»»»` or between `---` and `---`).",type:"boolean"},splitAdjacentBlockquotes:{defaultValue:!1,description:"Split adjacent blockquote blocks",type:"boolean"}};if(!1===e)return JSON.parse(JSON.stringify(t));var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=t[r].defaultValue);return n}function t(e,t){"use strict";var n=t?"Error in "+t+" extension->":"Error in unnamed extension",i={valid:!0,error:""};r.helper.isArray(e)||(e=[e]);for(var o=0;o<e.length;++o){var a=n+" sub-extension "+o+": ",s=e[o];if("object"!=typeof s)return i.valid=!1,i.error=a+"must be an object, but "+typeof s+" given",i;if(!r.helper.isString(s.type))return i.valid=!1,i.error=a+'property "type" must be a string, but '+typeof s.type+" given",i;var u=s.type=s.type.toLowerCase();if("language"===u&&(u=s.type="lang"),"html"===u&&(u=s.type="output"),"lang"!==u&&"output"!==u&&"listener"!==u)return i.valid=!1,i.error=a+"type "+u+' is not recognized. Valid values: "lang/language", "output/html" or "listener"',i;if("listener"===u){if(r.helper.isUndefined(s.listeners))return i.valid=!1,i.error=a+'. Extensions of type "listener" must have a property called "listeners"',i}else if(r.helper.isUndefined(s.filter)&&r.helper.isUndefined(s.regex))return i.valid=!1,i.error=a+u+' extensions must define either a "regex" property or a "filter" method',i;if(s.listeners){if("object"!=typeof s.listeners)return i.valid=!1,i.error=a+'"listeners" property must be an object but '+typeof s.listeners+" given",i;for(var c in s.listeners)if(s.listeners.hasOwnProperty(c)&&"function"!=typeof s.listeners[c])return i.valid=!1,i.error=a+'"listeners" property must be an hash of [event name]: [callback]. listeners.'+c+" must be a function but "+typeof s.listeners[c]+" given",i}if(s.filter){if("function"!=typeof s.filter)return i.valid=!1,i.error=a+'"filter" must be a function, but '+typeof s.filter+" given",i}else if(s.regex){if(r.helper.isString(s.regex)&&(s.regex=new RegExp(s.regex,"g")),!(s.regex instanceof RegExp))return i.valid=!1,i.error=a+'"regex" property must either be a string or a RegExp object, but '+typeof s.regex+" given",i;if(r.helper.isUndefined(s.replace))return i.valid=!1,i.error=a+'"regex" extensions must implement a replace string or function',i}}return i}function n(e,t){"use strict";return"¨E"+t.charCodeAt(0)+"E"}var r={},i={},o={},a=e(!0),s="vanilla",u={github:{omitExtraWLInCodeBlocks:!0,simplifiedAutoLink:!0,excludeTrailingPunctuationFromURLs:!0,literalMidWordUnderscores:!0,strikethrough:!0,tables:!0,tablesHeaderId:!0,ghCodeBlocks:!0,tasklists:!0,disableForced4SpacesIndentedSublists:!0,simpleLineBreaks:!0,requireSpaceBeforeHeadingText:!0,ghCompatibleHeaderId:!0,ghMentions:!0,backslashEscapesHTMLTags:!0,emoji:!0,splitAdjacentBlockquotes:!0},original:{noHeaderId:!0,ghCodeBlocks:!1},ghost:{omitExtraWLInCodeBlocks:!0,parseImgDimensions:!0,simplifiedAutoLink:!0,excludeTrailingPunctuationFromURLs:!0,literalMidWordUnderscores:!0,strikethrough:!0,tables:!0,tablesHeaderId:!0,ghCodeBlocks:!0,tasklists:!0,smoothLivePreview:!0,simpleLineBreaks:!0,requireSpaceBeforeHeadingText:!0,ghMentions:!1,encodeEmails:!0},vanilla:e(!0),allOn:function(){"use strict";var t=e(!0),n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=!0);return n}()};r.helper={},r.extensions={},r.setOption=function(e,t){"use strict";return a[e]=t,this},r.getOption=function(e){"use strict";return a[e]},r.getOptions=function(){"use strict";return a},r.resetOptions=function(){"use strict";a=e(!0)},r.setFlavor=function(e){"use strict";if(!u.hasOwnProperty(e))throw Error(e+" flavor was not found");r.resetOptions();var t=u[e];s=e;for(var n in t)t.hasOwnProperty(n)&&(a[n]=t[n])},r.getFlavor=function(){"use strict";return s},r.getFlavorOptions=function(e){"use strict";if(u.hasOwnProperty(e))return u[e]},r.getDefaultOptions=function(t){"use strict";return e(t)},r.subParser=function(e,t){"use strict";if(r.helper.isString(e)){if(void 0===t){if(i.hasOwnProperty(e))return i[e];throw Error("SubParser named "+e+" not registered!")}i[e]=t}},r.extension=function(e,n){"use strict";if(!r.helper.isString(e))throw Error("Extension 'name' must be a string");if(e=r.helper.stdExtName(e),r.helper.isUndefined(n)){if(!o.hasOwnProperty(e))throw Error("Extension named "+e+" is not registered!");return o[e]}"function"==typeof n&&(n=n()),r.helper.isArray(n)||(n=[n]);var i=t(n,e);if(!i.valid)throw Error(i.error);o[e]=n},r.getAllExtensions=function(){"use strict";return o},r.removeExtension=function(e){"use strict";delete o[e]},r.resetExtensions=function(){"use strict";o={}},r.validateExtension=function(e){"use strict";var n=t(e,null);return!!n.valid||(console.warn(n.error),!1)},r.hasOwnProperty("helper")||(r.helper={}),r.helper.isString=function(e){"use strict";return"string"==typeof e||e instanceof String},r.helper.isFunction=function(e){"use strict";var t={};return e&&"[object Function]"===t.toString.call(e)},r.helper.isArray=function(e){"use strict";return Array.isArray(e)},r.helper.isUndefined=function(e){"use strict";return void 0===e},r.helper.forEach=function(e,t){"use strict";if(r.helper.isUndefined(e))throw new Error("obj param is required");if(r.helper.isUndefined(t))throw new Error("callback param is required");if(!r.helper.isFunction(t))throw new Error("callback param must be a function/closure");if("function"==typeof e.forEach)e.forEach(t);else if(r.helper.isArray(e))for(var n=0;n<e.length;n++)t(e[n],n,e);else{if("object"!=typeof e)throw new Error("obj does not seem to be an array or an iterable object");for(var i in e)e.hasOwnProperty(i)&&t(e[i],i,e)}},r.helper.stdExtName=function(e){"use strict";return e.replace(/[_?*+\/\\.^-]/g,"").replace(/\s/g,"").toLowerCase()},r.helper.escapeCharactersCallback=n,r.helper.escapeCharacters=function(e,t,r){"use strict";var i="(["+t.replace(/([\[\]\\])/g,"\\$1")+"])";r&&(i="\\\\"+i);var o=new RegExp(i,"g");return e=e.replace(o,n)},r.helper.unescapeHTMLEntities=function(e){"use strict";return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")};var c=function(e,t,n,r){"use strict";var i,o,a,s,u,c=r||"",l=c.indexOf("g")>-1,h=new RegExp(t+"|"+n,"g"+c.replace(/g/g,"")),p=new RegExp(t,c.replace(/g/g,"")),f=[];do{for(i=0;a=h.exec(e);)if(p.test(a[0]))i++||(s=(o=h.lastIndex)-a[0].length);else if(i&&!--i){u=a.index+a[0].length;var d={left:{start:s,end:o},match:{start:o,end:a.index},right:{start:a.index,end:u},wholeMatch:{start:s,end:u}};if(f.push(d),!l)return f}}while(i&&(h.lastIndex=o));return f};r.helper.matchRecursiveRegExp=function(e,t,n,r){"use strict";for(var i=c(e,t,n,r),o=[],a=0;a<i.length;++a)o.push([e.slice(i[a].wholeMatch.start,i[a].wholeMatch.end),e.slice(i[a].match.start,i[a].match.end),e.slice(i[a].left.start,i[a].left.end),e.slice(i[a].right.start,i[a].right.end)]);return o},r.helper.replaceRecursiveRegExp=function(e,t,n,i,o){"use strict";if(!r.helper.isFunction(t)){var a=t;t=function(){return a}}var s=c(e,n,i,o),u=e,l=s.length;if(l>0){var h=[];0!==s[0].wholeMatch.start&&h.push(e.slice(0,s[0].wholeMatch.start));for(var p=0;p<l;++p)h.push(t(e.slice(s[p].wholeMatch.start,s[p].wholeMatch.end),e.slice(s[p].match.start,s[p].match.end),e.slice(s[p].left.start,s[p].left.end),e.slice(s[p].right.start,s[p].right.end))),p<l-1&&h.push(e.slice(s[p].wholeMatch.end,s[p+1].wholeMatch.start));s[l-1].wholeMatch.end<e.length&&h.push(e.slice(s[l-1].wholeMatch.end)),u=h.join("")}return u},r.helper.regexIndexOf=function(e,t,n){"use strict";if(!r.helper.isString(e))throw"InvalidArgumentError: first parameter of showdown.helper.regexIndexOf function must be a string";if(t instanceof RegExp==0)throw"InvalidArgumentError: second parameter of showdown.helper.regexIndexOf function must be an instance of RegExp";var i=e.substring(n||0).search(t);return i>=0?i+(n||0):i},r.helper.splitAtIndex=function(e,t){"use strict";if(!r.helper.isString(e))throw"InvalidArgumentError: first parameter of showdown.helper.regexIndexOf function must be a string";return[e.substring(0,t),e.substring(t)]},r.helper.encodeEmailAddress=function(e){"use strict";var t=[function(e){return"&#"+e.charCodeAt(0)+";"},function(e){return"&#x"+e.charCodeAt(0).toString(16)+";"},function(e){return e}];return e=e.replace(/./g,function(e){if("@"===e)e=t[Math.floor(2*Math.random())](e);else{var n=Math.random();e=n>.9?t[2](e):n>.45?t[1](e):t[0](e)}return e})},r.helper.padEnd=function(e,t,n){"use strict";return t>>=0,n=String(n||" "),e.length>t?String(e):((t-=e.length)>n.length&&(n+=n.repeat(t/n.length)),String(e)+n.slice(0,t))},"undefined"==typeof console&&(console={warn:function(e){"use strict";alert(e)},log:function(e){"use strict";alert(e)},error:function(e){"use strict";throw e}}),r.helper.regexes={asteriskDashAndColon:/([*_:~])/g},r.helper.emojis={"+1":"👍","-1":"👎",100:"💯",1234:"🔢","1st_place_medal":"🥇","2nd_place_medal":"🥈","3rd_place_medal":"🥉","8ball":"🎱",a:"🅰️",ab:"🆎",abc:"🔤",abcd:"🔡",accept:"🉑",aerial_tramway:"🚡",airplane:"✈️",alarm_clock:"⏰",alembic:"⚗️",alien:"👽",ambulance:"🚑",amphora:"🏺",anchor:"⚓️",angel:"👼",anger:"💢",angry:"😠",anguished:"😧",ant:"🐜",apple:"🍎",aquarius:"♒️",aries:"♈️",arrow_backward:"◀️",arrow_double_down:"⏬",arrow_double_up:"⏫",arrow_down:"⬇️",arrow_down_small:"🔽",arrow_forward:"▶️",arrow_heading_down:"⤵️",arrow_heading_up:"⤴️",arrow_left:"⬅️",arrow_lower_left:"↙️",arrow_lower_right:"↘️",arrow_right:"➡️",arrow_right_hook:"↪️",arrow_up:"⬆️",arrow_up_down:"↕️",arrow_up_small:"🔼",arrow_upper_left:"↖️",arrow_upper_right:"↗️",arrows_clockwise:"🔃",arrows_counterclockwise:"🔄",art:"🎨",articulated_lorry:"🚛",artificial_satellite:"🛰",astonished:"😲",athletic_shoe:"👟",atm:"🏧",atom_symbol:"⚛️",avocado:"🥑",b:"🅱️",baby:"👶",baby_bottle:"🍼",baby_chick:"🐤",baby_symbol:"🚼",back:"🔙",bacon:"🥓",badminton:"🏸",baggage_claim:"🛄",baguette_bread:"🥖",balance_scale:"⚖️",balloon:"🎈",ballot_box:"🗳",ballot_box_with_check:"☑️",bamboo:"🎍",banana:"🍌",bangbang:"‼️",bank:"🏦",bar_chart:"📊",barber:"💈",baseball:"⚾️",basketball:"🏀",basketball_man:"⛹️",basketball_woman:"⛹️&zwj;♀️",bat:"🦇",bath:"🛀",bathtub:"🛁",battery:"🔋",beach_umbrella:"🏖",bear:"🐻",bed:"🛏",bee:"🐝",beer:"🍺",beers:"🍻",beetle:"🐞",beginner:"🔰",bell:"🔔",bellhop_bell:"🛎",bento:"🍱",biking_man:"🚴",bike:"🚲",biking_woman:"🚴&zwj;♀️",bikini:"👙",biohazard:"☣️",bird:"🐦",birthday:"🎂",black_circle:"⚫️",black_flag:"🏴",black_heart:"🖤",black_joker:"🃏",black_large_square:"⬛️",black_medium_small_square:"◾️",black_medium_square:"◼️",black_nib:"✒️",black_small_square:"▪️",black_square_button:"🔲",blonde_man:"👱",blonde_woman:"👱&zwj;♀️",blossom:"🌼",blowfish:"🐡",blue_book:"📘",blue_car:"🚙",blue_heart:"💙",blush:"😊",boar:"🐗",boat:"⛵️",bomb:"💣",book:"📖",bookmark:"🔖",bookmark_tabs:"📑",books:"📚",boom:"💥",boot:"👢",bouquet:"💐",bowing_man:"🙇",bow_and_arrow:"🏹",bowing_woman:"🙇&zwj;♀️",bowling:"🎳",boxing_glove:"🥊",boy:"👦",bread:"🍞",bride_with_veil:"👰",bridge_at_night:"🌉",briefcase:"💼",broken_heart:"💔",bug:"🐛",building_construction:"🏗",bulb:"💡",bullettrain_front:"🚅",bullettrain_side:"🚄",burrito:"🌯",bus:"🚌",business_suit_levitating:"🕴",busstop:"🚏",bust_in_silhouette:"👤",busts_in_silhouette:"👥",butterfly:"🦋",cactus:"🌵",cake:"🍰",calendar:"📆",call_me_hand:"🤙",calling:"📲",camel:"🐫",camera:"📷",camera_flash:"📸",camping:"🏕",cancer:"♋️",candle:"🕯",candy:"🍬",canoe:"🛶",capital_abcd:"🔠",capricorn:"♑️",car:"🚗",card_file_box:"🗃",card_index:"📇",card_index_dividers:"🗂",carousel_horse:"🎠",carrot:"🥕",cat:"🐱",cat2:"🐈",cd:"💿",chains:"⛓",champagne:"🍾",chart:"💹",chart_with_downwards_trend:"📉",chart_with_upwards_trend:"📈",checkered_flag:"🏁",cheese:"🧀",cherries:"🍒",cherry_blossom:"🌸",chestnut:"🌰",chicken:"🐔",children_crossing:"🚸",chipmunk:"🐿",chocolate_bar:"🍫",christmas_tree:"🎄",church:"⛪️",cinema:"🎦",circus_tent:"🎪",city_sunrise:"🌇",city_sunset:"🌆",cityscape:"🏙",cl:"🆑",clamp:"🗜",clap:"👏",clapper:"🎬",classical_building:"🏛",clinking_glasses:"🥂",clipboard:"📋",clock1:"🕐",clock10:"🕙",clock1030:"🕥",clock11:"🕚",clock1130:"🕦",clock12:"🕛",clock1230:"🕧",clock130:"🕜",clock2:"🕑",clock230:"🕝",clock3:"🕒",clock330:"🕞",clock4:"🕓",clock430:"🕟",clock5:"🕔",clock530:"🕠",clock6:"🕕",clock630:"🕡",clock7:"🕖",clock730:"🕢",clock8:"🕗",clock830:"🕣",clock9:"🕘",clock930:"🕤",closed_book:"📕",closed_lock_with_key:"🔐",closed_umbrella:"🌂",cloud:"☁️",cloud_with_lightning:"🌩",cloud_with_lightning_and_rain:"⛈",cloud_with_rain:"🌧",cloud_with_snow:"🌨",clown_face:"🤡",clubs:"♣️",cocktail:"🍸",coffee:"☕️",coffin:"⚰️",cold_sweat:"😰",comet:"☄️",computer:"💻",computer_mouse:"🖱",confetti_ball:"🎊",confounded:"😖",confused:"😕",congratulations:"㊗️",construction:"🚧",construction_worker_man:"👷",construction_worker_woman:"👷&zwj;♀️",control_knobs:"🎛",convenience_store:"🏪",cookie:"🍪",cool:"🆒",policeman:"👮",copyright:"©️",corn:"🌽",couch_and_lamp:"🛋",couple:"👫",couple_with_heart_woman_man:"💑",couple_with_heart_man_man:"👨&zwj;❤️&zwj;👨",couple_with_heart_woman_woman:"👩&zwj;❤️&zwj;👩",couplekiss_man_man:"👨&zwj;❤️&zwj;💋&zwj;👨",couplekiss_man_woman:"💏",couplekiss_woman_woman:"👩&zwj;❤️&zwj;💋&zwj;👩",cow:"🐮",cow2:"🐄",cowboy_hat_face:"🤠",crab:"🦀",crayon:"🖍",credit_card:"💳",crescent_moon:"🌙",cricket:"🏏",crocodile:"🐊",croissant:"🥐",crossed_fingers:"🤞",crossed_flags:"🎌",crossed_swords:"⚔️",crown:"👑",cry:"😢",crying_cat_face:"😿",crystal_ball:"🔮",cucumber:"🥒",cupid:"💘",curly_loop:"➰",currency_exchange:"💱",curry:"🍛",custard:"🍮",customs:"🛃",cyclone:"🌀",dagger:"🗡",dancer:"💃",dancing_women:"👯",dancing_men:"👯&zwj;♂️",dango:"🍡",dark_sunglasses:"🕶",dart:"🎯",dash:"💨",date:"📅",deciduous_tree:"🌳",deer:"🦌",department_store:"🏬",derelict_house:"🏚",desert:"🏜",desert_island:"🏝",desktop_computer:"🖥",male_detective:"🕵️",diamond_shape_with_a_dot_inside:"💠",diamonds:"♦️",disappointed:"😞",disappointed_relieved:"😥",dizzy:"💫",dizzy_face:"😵",do_not_litter:"🚯",dog:"🐶",dog2:"🐕",dollar:"💵",dolls:"🎎",dolphin:"🐬",door:"🚪",doughnut:"🍩",dove:"🕊",dragon:"🐉",dragon_face:"🐲",dress:"👗",dromedary_camel:"🐪",drooling_face:"🤤",droplet:"💧",drum:"🥁",duck:"🦆",dvd:"📀","e-mail":"📧",eagle:"🦅",ear:"👂",ear_of_rice:"🌾",earth_africa:"🌍",earth_americas:"🌎",earth_asia:"🌏",egg:"🥚",eggplant:"🍆",eight_pointed_black_star:"✴️",eight_spoked_asterisk:"✳️",electric_plug:"🔌",elephant:"🐘",email:"✉️",end:"🔚",envelope_with_arrow:"📩",euro:"💶",european_castle:"🏰",european_post_office:"🏤",evergreen_tree:"🌲",exclamation:"❗️",expressionless:"😑",eye:"👁",eye_speech_bubble:"👁&zwj;🗨",eyeglasses:"👓",eyes:"👀",face_with_head_bandage:"🤕",face_with_thermometer:"🤒",fist_oncoming:"👊",factory:"🏭",fallen_leaf:"🍂",family_man_woman_boy:"👪",family_man_boy:"👨&zwj;👦",family_man_boy_boy:"👨&zwj;👦&zwj;👦",family_man_girl:"👨&zwj;👧",family_man_girl_boy:"👨&zwj;👧&zwj;👦",family_man_girl_girl:"👨&zwj;👧&zwj;👧",family_man_man_boy:"👨&zwj;👨&zwj;👦",family_man_man_boy_boy:"👨&zwj;👨&zwj;👦&zwj;👦",family_man_man_girl:"👨&zwj;👨&zwj;👧",family_man_man_girl_boy:"👨&zwj;👨&zwj;👧&zwj;👦",family_man_man_girl_girl:"👨&zwj;👨&zwj;👧&zwj;👧",family_man_woman_boy_boy:"👨&zwj;👩&zwj;👦&zwj;👦",family_man_woman_girl:"👨&zwj;👩&zwj;👧",family_man_woman_girl_boy:"👨&zwj;👩&zwj;👧&zwj;👦",family_man_woman_girl_girl:"👨&zwj;👩&zwj;👧&zwj;👧",family_woman_boy:"👩&zwj;👦",family_woman_boy_boy:"👩&zwj;👦&zwj;👦",family_woman_girl:"👩&zwj;👧",family_woman_girl_boy:"👩&zwj;👧&zwj;👦",family_woman_girl_girl:"👩&zwj;👧&zwj;👧",family_woman_woman_boy:"👩&zwj;👩&zwj;👦",family_woman_woman_boy_boy:"👩&zwj;👩&zwj;👦&zwj;👦",family_woman_woman_girl:"👩&zwj;👩&zwj;👧",family_woman_woman_girl_boy:"👩&zwj;👩&zwj;👧&zwj;👦",family_woman_woman_girl_girl:"👩&zwj;👩&zwj;👧&zwj;👧",fast_forward:"⏩",fax:"📠",fearful:"😨",feet:"🐾",female_detective:"🕵️&zwj;♀️",ferris_wheel:"🎡",ferry:"⛴",field_hockey:"🏑",file_cabinet:"🗄",file_folder:"📁",film_projector:"📽",film_strip:"🎞",fire:"🔥",fire_engine:"🚒",fireworks:"🎆",first_quarter_moon:"🌓",first_quarter_moon_with_face:"🌛",fish:"🐟",fish_cake:"🍥",fishing_pole_and_fish:"🎣",fist_raised:"✊",fist_left:"🤛",fist_right:"🤜",flags:"🎏",flashlight:"🔦",fleur_de_lis:"⚜️",flight_arrival:"🛬",flight_departure:"🛫",floppy_disk:"💾",flower_playing_cards:"🎴",flushed:"😳",fog:"🌫",foggy:"🌁",football:"🏈",footprints:"👣",fork_and_knife:"🍴",fountain:"⛲️",fountain_pen:"🖋",four_leaf_clover:"🍀",fox_face:"🦊",framed_picture:"🖼",free:"🆓",fried_egg:"🍳",fried_shrimp:"🍤",fries:"🍟",frog:"🐸",frowning:"😦",frowning_face:"☹️",frowning_man:"🙍&zwj;♂️",frowning_woman:"🙍",middle_finger:"🖕",fuelpump:"⛽️",full_moon:"🌕",full_moon_with_face:"🌝",funeral_urn:"⚱️",game_die:"🎲",gear:"⚙️",gem:"💎",gemini:"♊️",ghost:"👻",gift:"🎁",gift_heart:"💝",girl:"👧",globe_with_meridians:"🌐",goal_net:"🥅",goat:"🐐",golf:"⛳️",golfing_man:"🏌️",golfing_woman:"🏌️&zwj;♀️",gorilla:"🦍",grapes:"🍇",green_apple:"🍏",green_book:"📗",green_heart:"💚",green_salad:"🥗",grey_exclamation:"❕",grey_question:"❔",grimacing:"😬",grin:"😁",grinning:"😀",guardsman:"💂",guardswoman:"💂&zwj;♀️",guitar:"🎸",gun:"🔫",haircut_woman:"💇",haircut_man:"💇&zwj;♂️",hamburger:"🍔",hammer:"🔨",hammer_and_pick:"⚒",hammer_and_wrench:"🛠",hamster:"🐹",hand:"✋",handbag:"👜",handshake:"🤝",hankey:"💩",hatched_chick:"🐥",hatching_chick:"🐣",headphones:"🎧",hear_no_evil:"🙉",heart:"❤️",heart_decoration:"💟",heart_eyes:"😍",heart_eyes_cat:"😻",heartbeat:"💓",heartpulse:"💗",hearts:"♥️",heavy_check_mark:"✔️",heavy_division_sign:"➗",heavy_dollar_sign:"💲",heavy_heart_exclamation:"❣️",heavy_minus_sign:"➖",heavy_multiplication_x:"✖️",heavy_plus_sign:"➕",helicopter:"🚁",herb:"🌿",hibiscus:"🌺",high_brightness:"🔆",high_heel:"👠",hocho:"🔪",hole:"🕳",honey_pot:"🍯",horse:"🐴",horse_racing:"🏇",hospital:"🏥",hot_pepper:"🌶",hotdog:"🌭",hotel:"🏨",hotsprings:"♨️",hourglass:"⌛️",hourglass_flowing_sand:"⏳",house:"🏠",house_with_garden:"🏡",houses:"🏘",hugs:"🤗",hushed:"😯",ice_cream:"🍨",ice_hockey:"🏒",ice_skate:"⛸",icecream:"🍦",id:"🆔",ideograph_advantage:"🉐",imp:"👿",inbox_tray:"📥",incoming_envelope:"📨",tipping_hand_woman:"💁",information_source:"ℹ️",innocent:"😇",interrobang:"⁉️",iphone:"📱",izakaya_lantern:"🏮",jack_o_lantern:"🎃",japan:"🗾",japanese_castle:"🏯",japanese_goblin:"👺",japanese_ogre:"👹",jeans:"👖",joy:"😂",joy_cat:"😹",joystick:"🕹",kaaba:"🕋",key:"🔑",keyboard:"⌨️",keycap_ten:"🔟",kick_scooter:"🛴",kimono:"👘",kiss:"💋",kissing:"😗",kissing_cat:"😽",kissing_closed_eyes:"😚",kissing_heart:"😘",kissing_smiling_eyes:"😙",kiwi_fruit:"🥝",koala:"🐨",koko:"🈁",label:"🏷",large_blue_circle:"🔵",large_blue_diamond:"🔷",large_orange_diamond:"🔶",last_quarter_moon:"🌗",last_quarter_moon_with_face:"🌜",latin_cross:"✝️",laughing:"😆",leaves:"🍃",ledger:"📒",left_luggage:"🛅",left_right_arrow:"↔️",leftwards_arrow_with_hook:"↩️",lemon:"🍋",leo:"♌️",leopard:"🐆",level_slider:"🎚",libra:"♎️",light_rail:"🚈",link:"🔗",lion:"🦁",lips:"👄",lipstick:"💄",lizard:"🦎",lock:"🔒",lock_with_ink_pen:"🔏",lollipop:"🍭",loop:"➿",loud_sound:"🔊",loudspeaker:"📢",love_hotel:"🏩",love_letter:"💌",low_brightness:"🔅",lying_face:"🤥",m:"Ⓜ️",mag:"🔍",mag_right:"🔎",mahjong:"🀄️",mailbox:"📫",mailbox_closed:"📪",mailbox_with_mail:"📬",mailbox_with_no_mail:"📭",man:"👨",man_artist:"👨&zwj;🎨",man_astronaut:"👨&zwj;🚀",man_cartwheeling:"🤸&zwj;♂️",man_cook:"👨&zwj;🍳",man_dancing:"🕺",man_facepalming:"🤦&zwj;♂️",man_factory_worker:"👨&zwj;🏭",man_farmer:"👨&zwj;🌾",man_firefighter:"👨&zwj;🚒",man_health_worker:"👨&zwj;⚕️",man_in_tuxedo:"🤵",man_judge:"👨&zwj;⚖️",man_juggling:"🤹&zwj;♂️",man_mechanic:"👨&zwj;🔧",man_office_worker:"👨&zwj;💼",man_pilot:"👨&zwj;✈️",man_playing_handball:"🤾&zwj;♂️",man_playing_water_polo:"🤽&zwj;♂️",man_scientist:"👨&zwj;🔬",man_shrugging:"🤷&zwj;♂️",man_singer:"👨&zwj;🎤",man_student:"👨&zwj;🎓",man_teacher:"👨&zwj;🏫",man_technologist:"👨&zwj;💻",man_with_gua_pi_mao:"👲",man_with_turban:"👳",tangerine:"🍊",mans_shoe:"👞",mantelpiece_clock:"🕰",maple_leaf:"🍁",martial_arts_uniform:"🥋",mask:"😷",massage_woman:"💆",massage_man:"💆&zwj;♂️",meat_on_bone:"🍖",medal_military:"🎖",medal_sports:"🏅",mega:"📣",melon:"🍈",memo:"📝",men_wrestling:"🤼&zwj;♂️",menorah:"🕎",mens:"🚹",metal:"🤘",metro:"🚇",microphone:"🎤",microscope:"🔬",milk_glass:"🥛",milky_way:"🌌",minibus:"🚐",minidisc:"💽",mobile_phone_off:"📴",money_mouth_face:"🤑",money_with_wings:"💸",moneybag:"💰",monkey:"🐒",monkey_face:"🐵",monorail:"🚝",moon:"🌔",mortar_board:"🎓",mosque:"🕌",motor_boat:"🛥",motor_scooter:"🛵",motorcycle:"🏍",motorway:"🛣",mount_fuji:"🗻",mountain:"⛰",mountain_biking_man:"🚵",mountain_biking_woman:"🚵&zwj;♀️",mountain_cableway:"🚠",mountain_railway:"🚞",mountain_snow:"🏔",mouse:"🐭",mouse2:"🐁",movie_camera:"🎥",moyai:"🗿",mrs_claus:"🤶",muscle:"💪",mushroom:"🍄",musical_keyboard:"🎹",musical_note:"🎵",musical_score:"🎼",mute:"🔇",nail_care:"💅",name_badge:"📛",national_park:"🏞",nauseated_face:"🤢",necktie:"👔",negative_squared_cross_mark:"❎",nerd_face:"🤓",neutral_face:"😐",new:"🆕",new_moon:"🌑",new_moon_with_face:"🌚",newspaper:"📰",newspaper_roll:"🗞",next_track_button:"⏭",ng:"🆖",no_good_man:"🙅&zwj;♂️",no_good_woman:"🙅",night_with_stars:"🌃",no_bell:"🔕",no_bicycles:"🚳",no_entry:"⛔️",no_entry_sign:"🚫",no_mobile_phones:"📵",no_mouth:"😶",no_pedestrians:"🚷",no_smoking:"🚭","non-potable_water":"🚱",nose:"👃",notebook:"📓",notebook_with_decorative_cover:"📔",notes:"🎶",nut_and_bolt:"🔩",o:"⭕️",o2:"🅾️",ocean:"🌊",octopus:"🐙",oden:"🍢",office:"🏢",oil_drum:"🛢",ok:"🆗",ok_hand:"👌",ok_man:"🙆&zwj;♂️",ok_woman:"🙆",old_key:"🗝",older_man:"👴",older_woman:"👵",om:"🕉",on:"🔛",oncoming_automobile:"🚘",oncoming_bus:"🚍",oncoming_police_car:"🚔",oncoming_taxi:"🚖",open_file_folder:"📂",open_hands:"👐",open_mouth:"😮",open_umbrella:"☂️",ophiuchus:"⛎",orange_book:"📙",orthodox_cross:"☦️",outbox_tray:"📤",owl:"🦉",ox:"🐂",package:"📦",page_facing_up:"📄",page_with_curl:"📃",pager:"📟",paintbrush:"🖌",palm_tree:"🌴",pancakes:"🥞",panda_face:"🐼",paperclip:"📎",paperclips:"🖇",parasol_on_ground:"⛱",parking:"🅿️",part_alternation_mark:"〽️",partly_sunny:"⛅️",passenger_ship:"🛳",passport_control:"🛂",pause_button:"⏸",peace_symbol:"☮️",peach:"🍑",peanuts:"🥜",pear:"🍐",pen:"🖊",pencil2:"✏️",penguin:"🐧",pensive:"😔",performing_arts:"🎭",persevere:"😣",person_fencing:"🤺",pouting_woman:"🙎",phone:"☎️",pick:"⛏",pig:"🐷",pig2:"🐖",pig_nose:"🐽",pill:"💊",pineapple:"🍍",ping_pong:"🏓",pisces:"♓️",pizza:"🍕",place_of_worship:"🛐",plate_with_cutlery:"🍽",play_or_pause_button:"⏯",point_down:"👇",point_left:"👈",point_right:"👉",point_up:"☝️",point_up_2:"👆",police_car:"🚓",policewoman:"👮&zwj;♀️",poodle:"🐩",popcorn:"🍿",post_office:"🏣",postal_horn:"📯",postbox:"📮",potable_water:"🚰",potato:"🥔",pouch:"👝",poultry_leg:"🍗",pound:"💷",rage:"😡",pouting_cat:"😾",pouting_man:"🙎&zwj;♂️",pray:"🙏",prayer_beads:"📿",pregnant_woman:"🤰",previous_track_button:"⏮",prince:"🤴",princess:"👸",printer:"🖨",purple_heart:"💜",purse:"👛",pushpin:"📌",put_litter_in_its_place:"🚮",question:"❓",rabbit:"🐰",rabbit2:"🐇",racehorse:"🐎",racing_car:"🏎",radio:"📻",radio_button:"🔘",radioactive:"☢️",railway_car:"🚃",railway_track:"🛤",rainbow:"🌈",rainbow_flag:"🏳️&zwj;🌈",raised_back_of_hand:"🤚",raised_hand_with_fingers_splayed:"🖐",raised_hands:"🙌",raising_hand_woman:"🙋",raising_hand_man:"🙋&zwj;♂️",ram:"🐏",ramen:"🍜",rat:"🐀",record_button:"⏺",recycle:"♻️",red_circle:"🔴",registered:"®️",relaxed:"☺️",relieved:"😌",reminder_ribbon:"🎗",repeat:"🔁",repeat_one:"🔂",rescue_worker_helmet:"⛑",restroom:"🚻",revolving_hearts:"💞",rewind:"⏪",rhinoceros:"🦏",ribbon:"🎀",rice:"🍚",rice_ball:"🍙",rice_cracker:"🍘",rice_scene:"🎑",right_anger_bubble:"🗯",ring:"💍",robot:"🤖",rocket:"🚀",rofl:"🤣",roll_eyes:"🙄",roller_coaster:"🎢",rooster:"🐓",rose:"🌹",rosette:"🏵",rotating_light:"🚨",round_pushpin:"📍",rowing_man:"🚣",rowing_woman:"🚣&zwj;♀️",rugby_football:"🏉",running_man:"🏃",running_shirt_with_sash:"🎽",running_woman:"🏃&zwj;♀️",sa:"🈂️",sagittarius:"♐️",sake:"🍶",sandal:"👡",santa:"🎅",satellite:"📡",saxophone:"🎷",school:"🏫",school_satchel:"🎒",scissors:"✂️",scorpion:"🦂",scorpius:"♏️",scream:"😱",scream_cat:"🙀",scroll:"📜",seat:"💺",secret:"㊙️",see_no_evil:"🙈",seedling:"🌱",selfie:"🤳",shallow_pan_of_food:"🥘",shamrock:"☘️",shark:"🦈",shaved_ice:"🍧",sheep:"🐑",shell:"🐚",shield:"🛡",shinto_shrine:"⛩",ship:"🚢",shirt:"👕",shopping:"🛍",shopping_cart:"🛒",shower:"🚿",shrimp:"🦐",signal_strength:"📶",six_pointed_star:"🔯",ski:"🎿",skier:"⛷",skull:"💀",skull_and_crossbones:"☠️",sleeping:"😴",sleeping_bed:"🛌",sleepy:"😪",slightly_frowning_face:"🙁",slightly_smiling_face:"🙂",slot_machine:"🎰",small_airplane:"🛩",small_blue_diamond:"🔹",small_orange_diamond:"🔸",small_red_triangle:"🔺",small_red_triangle_down:"🔻",smile:"😄",smile_cat:"😸",smiley:"😃",smiley_cat:"😺",smiling_imp:"😈",smirk:"😏",smirk_cat:"😼",smoking:"🚬",snail:"🐌",snake:"🐍",sneezing_face:"🤧",snowboarder:"🏂",snowflake:"❄️",snowman:"⛄️",snowman_with_snow:"☃️",sob:"😭",soccer:"⚽️",soon:"🔜",sos:"🆘",sound:"🔉",space_invader:"👾",spades:"♠️",spaghetti:"🍝",sparkle:"❇️",sparkler:"🎇",sparkles:"✨",sparkling_heart:"💖",speak_no_evil:"🙊",speaker:"🔈",speaking_head:"🗣",speech_balloon:"💬",speedboat:"🚤",spider:"🕷",spider_web:"🕸",spiral_calendar:"🗓",spiral_notepad:"🗒",spoon:"🥄",squid:"🦑",stadium:"🏟",star:"⭐️",star2:"🌟",star_and_crescent:"☪️",star_of_david:"✡️",stars:"🌠",station:"🚉",statue_of_liberty:"🗽",steam_locomotive:"🚂",stew:"🍲",stop_button:"⏹",stop_sign:"🛑",stopwatch:"⏱",straight_ruler:"📏",strawberry:"🍓",stuck_out_tongue:"😛",stuck_out_tongue_closed_eyes:"😝",stuck_out_tongue_winking_eye:"😜",studio_microphone:"🎙",stuffed_flatbread:"🥙",sun_behind_large_cloud:"🌥",sun_behind_rain_cloud:"🌦",sun_behind_small_cloud:"🌤",sun_with_face:"🌞",sunflower:"🌻",sunglasses:"😎",sunny:"☀️",sunrise:"🌅",sunrise_over_mountains:"🌄",surfing_man:"🏄",surfing_woman:"🏄&zwj;♀️",sushi:"🍣",suspension_railway:"🚟",sweat:"😓",sweat_drops:"💦",sweat_smile:"😅",sweet_potato:"🍠",swimming_man:"🏊",swimming_woman:"🏊&zwj;♀️",symbols:"🔣",synagogue:"🕍",syringe:"💉",taco:"🌮",tada:"🎉",tanabata_tree:"🎋",taurus:"♉️",taxi:"🚕",tea:"🍵",telephone_receiver:"📞",telescope:"🔭",tennis:"🎾",tent:"⛺️",thermometer:"🌡",thinking:"🤔",thought_balloon:"💭",ticket:"🎫",tickets:"🎟",tiger:"🐯",tiger2:"🐅",timer_clock:"⏲",tipping_hand_man:"💁&zwj;♂️",tired_face:"😫",tm:"™️",toilet:"🚽",tokyo_tower:"🗼",tomato:"🍅",tongue:"👅",top:"🔝",tophat:"🎩",tornado:"🌪",trackball:"🖲",tractor:"🚜",traffic_light:"🚥",train:"🚋",train2:"🚆",tram:"🚊",triangular_flag_on_post:"🚩",triangular_ruler:"📐",trident:"🔱",triumph:"😤",trolleybus:"🚎",trophy:"🏆",tropical_drink:"🍹",tropical_fish:"🐠",truck:"🚚",trumpet:"🎺",tulip:"🌷",tumbler_glass:"🥃",turkey:"🦃",turtle:"🐢",tv:"📺",twisted_rightwards_arrows:"🔀",two_hearts:"💕",two_men_holding_hands:"👬",two_women_holding_hands:"👭",u5272:"🈹",u5408:"🈴",u55b6:"🈺",u6307:"🈯️",u6708:"🈷️",u6709:"🈶",u6e80:"🈵",u7121:"🈚️",u7533:"🈸",u7981:"🈲",u7a7a:"🈳",umbrella:"☔️",unamused:"😒",underage:"🔞",unicorn:"🦄",unlock:"🔓",up:"🆙",upside_down_face:"🙃",v:"✌️",vertical_traffic_light:"🚦",vhs:"📼",vibration_mode:"📳",video_camera:"📹",video_game:"🎮",violin:"🎻",virgo:"♍️",volcano:"🌋",volleyball:"🏐",vs:"🆚",vulcan_salute:"🖖",walking_man:"🚶",walking_woman:"🚶&zwj;♀️",waning_crescent_moon:"🌘",waning_gibbous_moon:"🌖",warning:"⚠️",wastebasket:"🗑",watch:"⌚️",water_buffalo:"🐃",watermelon:"🍉",wave:"👋",wavy_dash:"〰️",waxing_crescent_moon:"🌒",wc:"🚾",weary:"😩",wedding:"💒",weight_lifting_man:"🏋️",weight_lifting_woman:"🏋️&zwj;♀️",whale:"🐳",whale2:"🐋",wheel_of_dharma:"☸️",wheelchair:"♿️",white_check_mark:"✅",white_circle:"⚪️",white_flag:"🏳️",white_flower:"💮",white_large_square:"⬜️",white_medium_small_square:"◽️",white_medium_square:"◻️",white_small_square:"▫️",white_square_button:"🔳",wilted_flower:"🥀",wind_chime:"🎐",wind_face:"🌬",wine_glass:"🍷",wink:"😉",wolf:"🐺",woman:"👩",woman_artist:"👩&zwj;🎨",woman_astronaut:"👩&zwj;🚀",woman_cartwheeling:"🤸&zwj;♀️",woman_cook:"👩&zwj;🍳",woman_facepalming:"🤦&zwj;♀️",woman_factory_worker:"👩&zwj;🏭",woman_farmer:"👩&zwj;🌾",woman_firefighter:"👩&zwj;🚒",woman_health_worker:"👩&zwj;⚕️",woman_judge:"👩&zwj;⚖️",woman_juggling:"🤹&zwj;♀️",woman_mechanic:"👩&zwj;🔧",woman_office_worker:"👩&zwj;💼",woman_pilot:"👩&zwj;✈️",woman_playing_handball:"🤾&zwj;♀️",woman_playing_water_polo:"🤽&zwj;♀️",woman_scientist:"👩&zwj;🔬",woman_shrugging:"🤷&zwj;♀️",woman_singer:"👩&zwj;🎤",woman_student:"👩&zwj;🎓",woman_teacher:"👩&zwj;🏫",woman_technologist:"👩&zwj;💻",woman_with_turban:"👳&zwj;♀️",womans_clothes:"👚",womans_hat:"👒",women_wrestling:"🤼&zwj;♀️",womens:"🚺",world_map:"🗺",worried:"😟",wrench:"🔧",writing_hand:"✍️",x:"❌",yellow_heart:"💛",yen:"💴",yin_yang:"☯️",yum:"😋",zap:"⚡️",zipper_mouth_face:"🤐",zzz:"💤",octocat:'<img alt=":octocat:" height="20" width="20" align="absmiddle" src="https://assets-cdn.github.com/images/icons/emoji/octocat.png">',showdown:"<span style=\"font-family: 'Anonymous Pro', monospace; text-decoration: underline; text-decoration-style: dashed; text-decoration-color: #3e8b8a;text-underline-position: under;\">S</span>"},r.Converter=function(e){"use strict";function n(e,n){if(n=n||null,r.helper.isString(e)){if(e=r.helper.stdExtName(e),n=e,r.extensions[e])return console.warn("DEPRECATION WARNING: "+e+" is an old extension that uses a deprecated loading method.Please inform the developer that the extension should be updated!"),void i(r.extensions[e],e);if(r.helper.isUndefined(o[e]))throw Error('Extension "'+e+'" could not be loaded. It was either not found or is not a valid extension.');e=o[e]}"function"==typeof e&&(e=e()),r.helper.isArray(e)||(e=[e]);var a=t(e,n);if(!a.valid)throw Error(a.error);for(var s=0;s<e.length;++s){switch(e[s].type){case"lang":p.push(e[s]);break;case"output":f.push(e[s])}if(e[s].hasOwnProperty("listeners"))for(var u in e[s].listeners)e[s].listeners.hasOwnProperty(u)&&c(u,e[s].listeners[u])}}function i(e,n){"function"==typeof e&&(e=e(new r.Converter)),r.helper.isArray(e)||(e=[e]);var i=t(e,n);if(!i.valid)throw Error(i.error);for(var o=0;o<e.length;++o)switch(e[o].type){case"lang":p.push(e[o]);break;case"output":f.push(e[o]);break;default:throw Error("Extension loader error: Type unrecognized!!!")}}function c(e,t){if(!r.helper.isString(e))throw Error("Invalid argument in converter.listen() method: name must be a string, but "+typeof e+" given");if("function"!=typeof t)throw Error("Invalid argument in converter.listen() method: callback must be a function, but "+typeof t+" given");d.hasOwnProperty(e)||(d[e]=[]),d[e].push(t)}function l(e){var t=e.match(/^\s*/)[0].length,n=new RegExp("^\\s{0,"+t+"}","gm");return e.replace(n,"")}var h={},p=[],f=[],d={},m=s,g={parsed:{},raw:"",format:""};!function(){e=e||{};for(var t in a)a.hasOwnProperty(t)&&(h[t]=a[t]);if("object"!=typeof e)throw Error("Converter expects the passed parameter to be an object, but "+typeof e+" was passed instead.");for(var i in e)e.hasOwnProperty(i)&&(h[i]=e[i]);h.extensions&&r.helper.forEach(h.extensions,n)}(),this._dispatch=function(e,t,n,r){if(d.hasOwnProperty(e))for(var i=0;i<d[e].length;++i){var o=d[e][i](e,t,this,n,r);o&&void 0!==o&&(t=o)}return t},this.listen=function(e,t){return c(e,t),this},this.makeHtml=function(e){if(!e)return e;var t={gHtmlBlocks:[],gHtmlMdBlocks:[],gHtmlSpans:[],gUrls:{},gTitles:{},gDimensions:{},gListLevel:0,hashLinkCounts:{},langExtensions:p,outputModifiers:f,converter:this,ghCodeBlocks:[],metadata:{parsed:{},raw:"",format:""}};return e=e.replace(/¨/g,"¨T"),e=e.replace(/\$/g,"¨D"),e=e.replace(/\r\n/g,"\n"),e=e.replace(/\r/g,"\n"),e=e.replace(/\u00A0/g,"&nbsp;"),h.smartIndentationFix&&(e=l(e)),e="\n\n"+e+"\n\n",e=r.subParser("detab")(e,h,t),e=e.replace(/^[ \t]+$/gm,""),r.helper.forEach(p,function(n){e=r.subParser("runExtension")(n,e,h,t)}),e=r.subParser("metadata")(e,h,t),e=r.subParser("hashPreCodeTags")(e,h,t),e=r.subParser("githubCodeBlocks")(e,h,t),e=r.subParser("hashHTMLBlocks")(e,h,t),e=r.subParser("hashCodeTags")(e,h,t),e=r.subParser("stripLinkDefinitions")(e,h,t),e=r.subParser("blockGamut")(e,h,t),e=r.subParser("unhashHTMLSpans")(e,h,t),e=r.subParser("unescapeSpecialChars")(e,h,t),e=e.replace(/¨D/g,"$$"),e=e.replace(/¨T/g,"¨"),e=r.subParser("completeHTMLDocument")(e,h,t),r.helper.forEach(f,function(n){e=r.subParser("runExtension")(n,e,h,t)}),g=t.metadata,e},this.makeMarkdown=this.makeMd=function(e,t){function n(e){for(var t=0;t<e.childNodes.length;++t){var r=e.childNodes[t];3===r.nodeType?/\S/.test(r.nodeValue)?(r.nodeValue=r.nodeValue.split("\n").join(" "),r.nodeValue=r.nodeValue.replace(/(\s)+/g,"$1")):(e.removeChild(r),--t):1===r.nodeType&&n(r)}}if(e=e.replace(/\r\n/g,"\n"),e=e.replace(/\r/g,"\n"),e=e.replace(/>[ \t]+</,">¨NBSP;<"),!t){if(!window||!window.document)throw new Error("HTMLParser is undefined. If in a webworker or nodejs environment, you need to provide a WHATWG DOM and HTML such as JSDOM");t=window.document}var i=t.createElement("div");i.innerHTML=e;var o={preList:function(e){for(var t=e.querySelectorAll("pre"),n=[],i=0;i<t.length;++i)if(1===t[i].childElementCount&&"code"===t[i].firstChild.tagName.toLowerCase()){var o=t[i].firstChild.innerHTML.trim(),a=t[i].firstChild.getAttribute("data-language")||"";if(""===a)for(var s=t[i].firstChild.className.split(" "),u=0;u<s.length;++u){var c=s[u].match(/^language-(.+)$/);if(null!==c){a=c[1];break}}o=r.helper.unescapeHTMLEntities(o),n.push(o),t[i].outerHTML='<precode language="'+a+'" precodenum="'+i.toString()+'"></precode>'}else n.push(t[i].innerHTML),t[i].innerHTML="",t[i].setAttribute("prenum",i.toString());return n}(i)};n(i);for(var a=i.childNodes,s="",u=0;u<a.length;u++)s+=r.subParser("makeMarkdown.node")(a[u],o);return s},this.setOption=function(e,t){h[e]=t},this.getOption=function(e){return h[e]},this.getOptions=function(){return h},this.addExtension=function(e,t){n(e,t=t||null)},this.useExtension=function(e){n(e)},this.setFlavor=function(e){if(!u.hasOwnProperty(e))throw Error(e+" flavor was not found");var t=u[e];m=e;for(var n in t)t.hasOwnProperty(n)&&(h[n]=t[n])},this.getFlavor=function(){return m},this.removeExtension=function(e){r.helper.isArray(e)||(e=[e]);for(var t=0;t<e.length;++t){for(var n=e[t],i=0;i<p.length;++i)p[i]===n&&p[i].splice(i,1);for(;0<f.length;++i)f[0]===n&&f[0].splice(i,1)}},this.getAllExtensions=function(){return{language:p,output:f}},this.getMetadata=function(e){return e?g.raw:g.parsed},this.getMetadataFormat=function(){return g.format},this._setMetadataPair=function(e,t){g.parsed[e]=t},this._setMetadataFormat=function(e){g.format=e},this._setMetadataRaw=function(e){g.raw=e}},r.subParser("anchors",function(e,t,n){"use strict";var i=function(e,i,o,a,s,u,c){if(r.helper.isUndefined(c)&&(c=""),o=o.toLowerCase(),e.search(/\(<?\s*>? ?(['"].*['"])?\)$/m)>-1)a="";else if(!a){if(o||(o=i.toLowerCase().replace(/ ?\n/g," ")),a="#"+o,r.helper.isUndefined(n.gUrls[o]))return e;a=n.gUrls[o],r.helper.isUndefined(n.gTitles[o])||(c=n.gTitles[o])}var l='<a href="'+(a=a.replace(r.helper.regexes.asteriskDashAndColon,r.helper.escapeCharactersCallback))+'"';return""!==c&&null!==c&&(l+=' title="'+(c=(c=c.replace(/"/g,"&quot;")).replace(r.helper.regexes.asteriskDashAndColon,r.helper.escapeCharactersCallback))+'"'),t.openLinksInNewWindow&&!/^#/.test(a)&&(l+=' target="¨E95Eblank"'),l+=">"+i+"</a>"};return e=(e=n.converter._dispatch("anchors.before",e,t,n)).replace(/\[((?:\[[^\]]*]|[^\[\]])*)] ?(?:\n *)?\[(.*?)]()()()()/g,i),e=e.replace(/\[((?:\[[^\]]*]|[^\[\]])*)]()[ \t]*\([ \t]?<([^>]*)>(?:[ \t]*((["'])([^"]*?)\5))?[ \t]?\)/g,i),e=e.replace(/\[((?:\[[^\]]*]|[^\[\]])*)]()[ \t]*\([ \t]?<?([\S]+?(?:\([\S]*?\)[\S]*?)?)>?(?:[ \t]*((["'])([^"]*?)\5))?[ \t]?\)/g,i),e=e.replace(/\[([^\[\]]+)]()()()()()/g,i),t.ghMentions&&(e=e.replace(/(^|\s)(\\)?(@([a-z\d]+(?:[a-z\d.-]+?[a-z\d]+)*))/gim,function(e,n,i,o,a){if("\\"===i)return n+o;if(!r.helper.isString(t.ghMentionsLink))throw new Error("ghMentionsLink option must be a string");var s=t.ghMentionsLink.replace(/\{u}/g,a),u="";return t.openLinksInNewWindow&&(u=' target="¨E95Eblank"'),n+'<a href="'+s+'"'+u+">"+o+"</a>"})),e=n.converter._dispatch("anchors.after",e,t,n)});var l=/([*~_]+|\b)(((https?|ftp|dict):\/\/|www\.)[^'">\s]+?\.[^'">\s]+?)()(\1)?(?=\s|$)(?!["<>])/gi,h=/([*~_]+|\b)(((https?|ftp|dict):\/\/|www\.)[^'">\s]+\.[^'">\s]+?)([.!?,()\[\]])?(\1)?(?=\s|$)(?!["<>])/gi,p=/()<(((https?|ftp|dict):\/\/|www\.)[^'">\s]+)()>()/gi,f=/(^|\s)(?:mailto:)?([A-Za-z0-9!#$%&'*+-/=?^_`{|}~.]+@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)(?=$|\s)/gim,d=/<()(?:mailto:)?([-.\w]+@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)>/gi,m=function(e){"use strict";return function(t,n,i,o,a,s,u){var c=i=i.replace(r.helper.regexes.asteriskDashAndColon,r.helper.escapeCharactersCallback),l="",h="",p=n||"",f=u||"";return/^www\./i.test(i)&&(i=i.replace(/^www\./i,"http://www.")),e.excludeTrailingPunctuationFromURLs&&s&&(l=s),e.openLinksInNewWindow&&(h=' target="¨E95Eblank"'),p+'<a href="'+i+'"'+h+">"+c+"</a>"+l+f}},g=function(e,t){"use strict";return function(n,i,o){var a="mailto:";return i=i||"",o=r.subParser("unescapeSpecialChars")(o,e,t),e.encodeEmails?(a=r.helper.encodeEmailAddress(a+o),o=r.helper.encodeEmailAddress(o)):a+=o,i+'<a href="'+a+'">'+o+"</a>"}};r.subParser("autoLinks",function(e,t,n){"use strict";return e=n.converter._dispatch("autoLinks.before",e,t,n),e=e.replace(p,m(t)),e=e.replace(d,g(t,n)),e=n.converter._dispatch("autoLinks.after",e,t,n)}),r.subParser("simplifiedAutoLinks",function(e,t,n){"use strict";return t.simplifiedAutoLink?(e=n.converter._dispatch("simplifiedAutoLinks.before",e,t,n),e=t.excludeTrailingPunctuationFromURLs?e.replace(h,m(t)):e.replace(l,m(t)),e=e.replace(f,g(t,n)),e=n.converter._dispatch("simplifiedAutoLinks.after",e,t,n)):e}),r.subParser("blockGamut",function(e,t,n){"use strict";return e=n.converter._dispatch("blockGamut.before",e,t,n),e=r.subParser("blockQuotes")(e,t,n),e=r.subParser("headers")(e,t,n),e=r.subParser("horizontalRule")(e,t,n),e=r.subParser("lists")(e,t,n),e=r.subParser("codeBlocks")(e,t,n),e=r.subParser("tables")(e,t,n),e=r.subParser("hashHTMLBlocks")(e,t,n),e=r.subParser("paragraphs")(e,t,n),e=n.converter._dispatch("blockGamut.after",e,t,n)}),r.subParser("blockQuotes",function(e,t,n){"use strict";e=n.converter._dispatch("blockQuotes.before",e,t,n),e+="\n\n";var i=/(^ {0,3}>[ \t]?.+\n(.+\n)*\n*)+/gm;return t.splitAdjacentBlockquotes&&(i=/^ {0,3}>[\s\S]*?(?:\n\n)/gm),e=e.replace(i,function(e){return e=e.replace(/^[ \t]*>[ \t]?/gm,""),e=e.replace(/¨0/g,""),e=e.replace(/^[ \t]+$/gm,""),e=r.subParser("githubCodeBlocks")(e,t,n),e=r.subParser("blockGamut")(e,t,n),e=e.replace(/(^|\n)/g,"$1  "),e=e.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(e,t){var n=t;return n=n.replace(/^  /gm,"¨0"),n=n.replace(/¨0/g,"")}),r.subParser("hashBlock")("<blockquote>\n"+e+"\n</blockquote>",t,n)}),e=n.converter._dispatch("blockQuotes.after",e,t,n)}),r.subParser("codeBlocks",function(e,t,n){"use strict";e=n.converter._dispatch("codeBlocks.before",e,t,n);var i=/(?:\n\n|^)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=¨0))/g;return e=(e+="¨0").replace(i,function(e,i,o){var a=i,s=o,u="\n";return a=r.subParser("outdent")(a,t,n),a=r.subParser("encodeCode")(a,t,n),a=r.subParser("detab")(a,t,n),a=a.replace(/^\n+/g,""),a=a.replace(/\n+$/g,""),t.omitExtraWLInCodeBlocks&&(u=""),a="<pre><code>"+a+u+"</code></pre>",r.subParser("hashBlock")(a,t,n)+s}),e=e.replace(/¨0/,""),e=n.converter._dispatch("codeBlocks.after",e,t,n)}),r.subParser("codeSpans",function(e,t,n){"use strict";return void 0===(e=n.converter._dispatch("codeSpans.before",e,t,n))&&(e=""),e=e.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,function(e,i,o,a){var s=a;return s=s.replace(/^([ \t]*)/g,""),s=s.replace(/[ \t]*$/g,""),s=r.subParser("encodeCode")(s,t,n),s=i+"<code>"+s+"</code>",s=r.subParser("hashHTMLSpans")(s,t,n)}),e=n.converter._dispatch("codeSpans.after",e,t,n)}),r.subParser("completeHTMLDocument",function(e,t,n){"use strict";if(!t.completeHTMLDocument)return e;e=n.converter._dispatch("completeHTMLDocument.before",e,t,n);var r="html",i="<!DOCTYPE HTML>\n",o="",a='<meta charset="utf-8">\n',s="",u="";void 0!==n.metadata.parsed.doctype&&(i="<!DOCTYPE "+n.metadata.parsed.doctype+">\n","html"!==(r=n.metadata.parsed.doctype.toString().toLowerCase())&&"html5"!==r||(a='<meta charset="utf-8">'));for(var c in n.metadata.parsed)if(n.metadata.parsed.hasOwnProperty(c))switch(c.toLowerCase()){case"doctype":break;case"title":o="<title>"+n.metadata.parsed.title+"</title>\n";break;case"charset":a="html"===r||"html5"===r?'<meta charset="'+n.metadata.parsed.charset+'">\n':'<meta name="charset" content="'+n.metadata.parsed.charset+'">\n';break;case"language":case"lang":s=' lang="'+n.metadata.parsed[c]+'"',u+='<meta name="'+c+'" content="'+n.metadata.parsed[c]+'">\n';break;default:u+='<meta name="'+c+'" content="'+n.metadata.parsed[c]+'">\n'}return e=i+"<html"+s+">\n<head>\n"+o+a+u+"</head>\n<body>\n"+e.trim()+"\n</body>\n</html>",e=n.converter._dispatch("completeHTMLDocument.after",e,t,n)}),r.subParser("detab",function(e,t,n){"use strict";return e=n.converter._dispatch("detab.before",e,t,n),e=e.replace(/\t(?=\t)/g,"    "),e=e.replace(/\t/g,"¨A¨B"),e=e.replace(/¨B(.+?)¨A/g,function(e,t){for(var n=t,r=4-n.length%4,i=0;i<r;i++)n+=" ";return n}),e=e.replace(/¨A/g,"    "),e=e.replace(/¨B/g,""),e=n.converter._dispatch("detab.after",e,t,n)}),r.subParser("ellipsis",function(e,t,n){"use strict";return e=n.converter._dispatch("ellipsis.before",e,t,n),e=e.replace(/\.\.\./g,"…"),e=n.converter._dispatch("ellipsis.after",e,t,n)}),r.subParser("emoji",function(e,t,n){"use strict";if(!t.emoji)return e;var i=/:([\S]+?):/g;return e=(e=n.converter._dispatch("emoji.before",e,t,n)).replace(i,function(e,t){return r.helper.emojis.hasOwnProperty(t)?r.helper.emojis[t]:e}),e=n.converter._dispatch("emoji.after",e,t,n)}),r.subParser("encodeAmpsAndAngles",function(e,t,n){"use strict";return e=n.converter._dispatch("encodeAmpsAndAngles.before",e,t,n),e=e.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;"),e=e.replace(/<(?![a-z\/?$!])/gi,"&lt;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=n.converter._dispatch("encodeAmpsAndAngles.after",e,t,n)}),r.subParser("encodeBackslashEscapes",function(e,t,n){"use strict";return e=n.converter._dispatch("encodeBackslashEscapes.before",e,t,n),e=e.replace(/\\(\\)/g,r.helper.escapeCharactersCallback),e=e.replace(/\\([`*_{}\[\]()>#+.!~=|-])/g,r.helper.escapeCharactersCallback),e=n.converter._dispatch("encodeBackslashEscapes.after",e,t,n)}),r.subParser("encodeCode",function(e,t,n){"use strict";return e=n.converter._dispatch("encodeCode.before",e,t,n),e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/([*_{}\[\]\\=~-])/g,r.helper.escapeCharactersCallback),e=n.converter._dispatch("encodeCode.after",e,t,n)}),r.subParser("escapeSpecialCharsWithinTagAttributes",function(e,t,n){"use strict";var i=/<\/?[a-z\d_:-]+(?:[\s]+[\s\S]+?)?>/gi,o=/<!(--(?:(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>/gi;return e=(e=n.converter._dispatch("escapeSpecialCharsWithinTagAttributes.before",e,t,n)).replace(i,function(e){return e.replace(/(.)<\/?code>(?=.)/g,"$1`").replace(/([\\`*_~=|])/g,r.helper.escapeCharactersCallback)}),e=e.replace(o,function(e){return e.replace(/([\\`*_~=|])/g,r.helper.escapeCharactersCallback)}),e=n.converter._dispatch("escapeSpecialCharsWithinTagAttributes.after",e,t,n)}),r.subParser("githubCodeBlocks",function(e,t,n){"use strict";return t.ghCodeBlocks?(e=n.converter._dispatch("githubCodeBlocks.before",e,t,n),e+="¨0",e=e.replace(/(?:^|\n)(?: {0,3})(```+|~~~+)(?: *)([^\s`~]*)\n([\s\S]*?)\n(?: {0,3})\1/g,function(e,i,o,a){var s=t.omitExtraWLInCodeBlocks?"":"\n";return a=r.subParser("encodeCode")(a,t,n),a=r.subParser("detab")(a,t,n),a=a.replace(/^\n+/g,""),a=a.replace(/\n+$/g,""),a="<pre><code"+(o?' class="'+o+" language-"+o+'"':"")+">"+a+s+"</code></pre>",a=r.subParser("hashBlock")(a,t,n),"\n\n¨G"+(n.ghCodeBlocks.push({text:e,codeblock:a})-1)+"G\n\n"}),e=e.replace(/¨0/,""),n.converter._dispatch("githubCodeBlocks.after",e,t,n)):e}),r.subParser("hashBlock",function(e,t,n){"use strict";return e=n.converter._dispatch("hashBlock.before",e,t,n),e=e.replace(/(^\n+|\n+$)/g,""),e="\n\n¨K"+(n.gHtmlBlocks.push(e)-1)+"K\n\n",e=n.converter._dispatch("hashBlock.after",e,t,n)}),r.subParser("hashCodeTags",function(e,t,n){"use strict";return e=n.converter._dispatch("hashCodeTags.before",e,t,n),e=r.helper.replaceRecursiveRegExp(e,function(e,i,o,a){var s=o+r.subParser("encodeCode")(i,t,n)+a;return"¨C"+(n.gHtmlSpans.push(s)-1)+"C"},"<code\\b[^>]*>","</code>","gim"),e=n.converter._dispatch("hashCodeTags.after",e,t,n)}),r.subParser("hashElement",function(e,t,n){"use strict";return function(e,t){var r=t;return r=r.replace(/\n\n/g,"\n"),r=r.replace(/^\n/,""),r=r.replace(/\n+$/g,""),r="\n\n¨K"+(n.gHtmlBlocks.push(r)-1)+"K\n\n"}}),r.subParser("hashHTMLBlocks",function(e,t,n){"use strict";e=n.converter._dispatch("hashHTMLBlocks.before",e,t,n);var i=["pre","div","h1","h2","h3","h4","h5","h6","blockquote","table","dl","ol","ul","script","noscript","form","fieldset","iframe","math","style","section","header","footer","nav","article","aside","address","audio","canvas","figure","hgroup","output","video","p"];t.backslashEscapesHTMLTags&&(e=e.replace(/\\<(\/?[^>]+?)>/g,function(e,t){return"&lt;"+t+"&gt;"}));for(var o=0;o<i.length;++o)for(var a,s=new RegExp("^ {0,3}(<"+i[o]+"\\b[^>]*>)","im"),u="<"+i[o]+"\\b[^>]*>",c="</"+i[o]+">";-1!==(a=r.helper.regexIndexOf(e,s));){var l=r.helper.splitAtIndex(e,a),h=r.helper.replaceRecursiveRegExp(l[1],function(e,t,r,i){var o=e;return-1!==r.search(/\bmarkdown\b/)&&(o=r+n.converter.makeHtml(t)+i),"\n\n¨K"+(n.gHtmlBlocks.push(o)-1)+"K\n\n"},u,c,"im");if(h===l[1])break;e=l[0].concat(h)}return e=e.replace(/(\n {0,3}(<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,r.subParser("hashElement")(e,t,n)),e=r.helper.replaceRecursiveRegExp(e,function(e){return"\n\n¨K"+(n.gHtmlBlocks.push(e)-1)+"K\n\n"},"^ {0,3}\x3c!--","--\x3e","gm"),e=e.replace(/(?:\n\n)( {0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,r.subParser("hashElement")(e,t,n)),e=n.converter._dispatch("hashHTMLBlocks.after",e,t,n)}),r.subParser("hashHTMLSpans",function(e,t,n){"use strict";function r(e){return"¨C"+(n.gHtmlSpans.push(e)-1)+"C"}return e=n.converter._dispatch("hashHTMLSpans.before",e,t,n),e=e.replace(/<[^>]+?\/>/gi,function(e){return r(e)}),e=e.replace(/<([^>]+?)>[\s\S]*?<\/\1>/g,function(e){return r(e)}),e=e.replace(/<([^>]+?)\s[^>]+?>[\s\S]*?<\/\1>/g,function(e){return r(e)}),e=e.replace(/<[^>]+?>/gi,function(e){return r(e)}),e=n.converter._dispatch("hashHTMLSpans.after",e,t,n)}),r.subParser("unhashHTMLSpans",function(e,t,n){"use strict";e=n.converter._dispatch("unhashHTMLSpans.before",e,t,n);for(var r=0;r<n.gHtmlSpans.length;++r){for(var i=n.gHtmlSpans[r],o=0;/¨C(\d+)C/.test(i);){var a=RegExp.$1;if(i=i.replace("¨C"+a+"C",n.gHtmlSpans[a]),10===o){console.error("maximum nesting of 10 spans reached!!!");break}++o}e=e.replace("¨C"+r+"C",i)}return e=n.converter._dispatch("unhashHTMLSpans.after",e,t,n)}),r.subParser("hashPreCodeTags",function(e,t,n){"use strict";return e=n.converter._dispatch("hashPreCodeTags.before",e,t,n),e=r.helper.replaceRecursiveRegExp(e,function(e,i,o,a){var s=o+r.subParser("encodeCode")(i,t,n)+a;return"\n\n¨G"+(n.ghCodeBlocks.push({text:e,codeblock:s})-1)+"G\n\n"},"^ {0,3}<pre\\b[^>]*>\\s*<code\\b[^>]*>","^ {0,3}</code>\\s*</pre>","gim"),e=n.converter._dispatch("hashPreCodeTags.after",e,t,n)}),r.subParser("headers",function(e,t,n){"use strict";function i(e){var i,o;if(t.customizedHeaderId){var a=e.match(/\{([^{]+?)}\s*$/);a&&a[1]&&(e=a[1])}return i=e,o=r.helper.isString(t.prefixHeaderId)?t.prefixHeaderId:!0===t.prefixHeaderId?"section-":"",t.rawPrefixHeaderId||(i=o+i),i=t.ghCompatibleHeaderId?i.replace(/ /g,"-").replace(/&amp;/g,"").replace(/¨T/g,"").replace(/¨D/g,"").replace(/[&+$,\/:;=?@"#{}|^¨~\[\]`\\*)(%.!'<>]/g,"").toLowerCase():t.rawHeaderId?i.replace(/ /g,"-").replace(/&amp;/g,"&").replace(/¨T/g,"¨").replace(/¨D/g,"$").replace(/["']/g,"-").toLowerCase():i.replace(/[^\w]/g,"").toLowerCase(),t.rawPrefixHeaderId&&(i=o+i),n.hashLinkCounts[i]?i=i+"-"+n.hashLinkCounts[i]++:n.hashLinkCounts[i]=1,i}e=n.converter._dispatch("headers.before",e,t,n);var o=isNaN(parseInt(t.headerLevelStart))?1:parseInt(t.headerLevelStart),a=t.smoothLivePreview?/^(.+)[ \t]*\n={2,}[ \t]*\n+/gm:/^(.+)[ \t]*\n=+[ \t]*\n+/gm,s=t.smoothLivePreview?/^(.+)[ \t]*\n-{2,}[ \t]*\n+/gm:/^(.+)[ \t]*\n-+[ \t]*\n+/gm;e=(e=e.replace(a,function(e,a){var s=r.subParser("spanGamut")(a,t,n),u=t.noHeaderId?"":' id="'+i(a)+'"',c=o,l="<h"+c+u+">"+s+"</h"+c+">";return r.subParser("hashBlock")(l,t,n)})).replace(s,function(e,a){var s=r.subParser("spanGamut")(a,t,n),u=t.noHeaderId?"":' id="'+i(a)+'"',c=o+1,l="<h"+c+u+">"+s+"</h"+c+">";return r.subParser("hashBlock")(l,t,n)});var u=t.requireSpaceBeforeHeadingText?/^(#{1,6})[ \t]+(.+?)[ \t]*#*\n+/gm:/^(#{1,6})[ \t]*(.+?)[ \t]*#*\n+/gm;return e=e.replace(u,function(e,a,s){var u=s;t.customizedHeaderId&&(u=s.replace(/\s?\{([^{]+?)}\s*$/,""));var c=r.subParser("spanGamut")(u,t,n),l=t.noHeaderId?"":' id="'+i(s)+'"',h=o-1+a.length,p="<h"+h+l+">"+c+"</h"+h+">";return r.subParser("hashBlock")(p,t,n)}),e=n.converter._dispatch("headers.after",e,t,n)}),r.subParser("horizontalRule",function(e,t,n){"use strict";e=n.converter._dispatch("horizontalRule.before",e,t,n);var i=r.subParser("hashBlock")("<hr />",t,n);return e=e.replace(/^ {0,2}( ?-){3,}[ \t]*$/gm,i),e=e.replace(/^ {0,2}( ?\*){3,}[ \t]*$/gm,i),e=e.replace(/^ {0,2}( ?_){3,}[ \t]*$/gm,i),e=n.converter._dispatch("horizontalRule.after",e,t,n)}),r.subParser("images",function(e,t,n){"use strict";function i(e,t,i,o,a,s,u,c){var l=n.gUrls,h=n.gTitles,p=n.gDimensions;if(i=i.toLowerCase(),c||(c=""),e.search(/\(<?\s*>? ?(['"].*['"])?\)$/m)>-1)o="";else if(""===o||null===o){if(""!==i&&null!==i||(i=t.toLowerCase().replace(/ ?\n/g," ")),o="#"+i,r.helper.isUndefined(l[i]))return e;o=l[i],r.helper.isUndefined(h[i])||(c=h[i]),r.helper.isUndefined(p[i])||(a=p[i].width,s=p[i].height)}t=t.replace(/"/g,"&quot;").replace(r.helper.regexes.asteriskDashAndColon,r.helper.escapeCharactersCallback);var f='<img src="'+(o=o.replace(r.helper.regexes.asteriskDashAndColon,r.helper.escapeCharactersCallback))+'" alt="'+t+'"';return c&&r.helper.isString(c)&&(f+=' title="'+(c=c.replace(/"/g,"&quot;").replace(r.helper.regexes.asteriskDashAndColon,r.helper.escapeCharactersCallback))+'"'),a&&s&&(f+=' width="'+(a="*"===a?"auto":a)+'"',f+=' height="'+(s="*"===s?"auto":s)+'"'),f+=" />"}var o=/!\[([^\]]*?)][ \t]*()\([ \t]?<?([\S]+?(?:\([\S]*?\)[\S]*?)?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(["'])([^"]*?)\6)?[ \t]?\)/g,a=/!\[([^\]]*?)][ \t]*()\([ \t]?<([^>]*)>(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(?:(["'])([^"]*?)\6))?[ \t]?\)/g,s=/!\[([^\]]*?)][ \t]*()\([ \t]?<?(data:.+?\/.+?;base64,[A-Za-z0-9+/=\n]+?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(["'])([^"]*?)\6)?[ \t]?\)/g,u=/!\[([^\]]*?)] ?(?:\n *)?\[([\s\S]*?)]()()()()()/g,c=/!\[([^\[\]]+)]()()()()()/g;return e=(e=n.converter._dispatch("images.before",e,t,n)).replace(u,i),e=e.replace(s,function(e,t,n,r,o,a,s,u){return r=r.replace(/\s/g,""),i(e,t,n,r,o,a,0,u)}),e=e.replace(a,i),e=e.replace(o,i),e=e.replace(c,i),e=n.converter._dispatch("images.after",e,t,n)}),r.subParser("italicsAndBold",function(e,t,n){"use strict";function r(e,t,n){return t+e+n}return e=n.converter._dispatch("italicsAndBold.before",e,t,n),e=t.literalMidWordUnderscores?(e=(e=e.replace(/\b___(\S[\s\S]*?)___\b/g,function(e,t){return r(t,"<strong><em>","</em></strong>")})).replace(/\b__(\S[\s\S]*?)__\b/g,function(e,t){return r(t,"<strong>","</strong>")})).replace(/\b_(\S[\s\S]*?)_\b/g,function(e,t){return r(t,"<em>","</em>")}):(e=(e=e.replace(/___(\S[\s\S]*?)___/g,function(e,t){return/\S$/.test(t)?r(t,"<strong><em>","</em></strong>"):e})).replace(/__(\S[\s\S]*?)__/g,function(e,t){return/\S$/.test(t)?r(t,"<strong>","</strong>"):e})).replace(/_([^\s_][\s\S]*?)_/g,function(e,t){return/\S$/.test(t)?r(t,"<em>","</em>"):e}),e=t.literalMidWordAsterisks?(e=(e=e.replace(/([^*]|^)\B\*\*\*(\S[\s\S]*?)\*\*\*\B(?!\*)/g,function(e,t,n){return r(n,t+"<strong><em>","</em></strong>")})).replace(/([^*]|^)\B\*\*(\S[\s\S]*?)\*\*\B(?!\*)/g,function(e,t,n){return r(n,t+"<strong>","</strong>")})).replace(/([^*]|^)\B\*(\S[\s\S]*?)\*\B(?!\*)/g,function(e,t,n){return r(n,t+"<em>","</em>")}):(e=(e=e.replace(/\*\*\*(\S[\s\S]*?)\*\*\*/g,function(e,t){return/\S$/.test(t)?r(t,"<strong><em>","</em></strong>"):e})).replace(/\*\*(\S[\s\S]*?)\*\*/g,function(e,t){return/\S$/.test(t)?r(t,"<strong>","</strong>"):e})).replace(/\*([^\s*][\s\S]*?)\*/g,function(e,t){return/\S$/.test(t)?r(t,"<em>","</em>"):e}),e=n.converter._dispatch("italicsAndBold.after",e,t,n)}),r.subParser("lists",function(e,t,n){"use strict";function i(e,i){n.gListLevel++,e=e.replace(/\n{2,}$/,"\n"),e+="¨0";var o=/(\n)?(^ {0,3})([*+-]|\d+[.])[ \t]+((\[(x|X| )?])?[ \t]*[^\r]+?(\n{1,2}))(?=\n*(¨0| {0,3}([*+-]|\d+[.])[ \t]+))/gm,a=/\n[ \t]*\n(?!¨0)/.test(e);return t.disableForced4SpacesIndentedSublists&&(o=/(\n)?(^ {0,3})([*+-]|\d+[.])[ \t]+((\[(x|X| )?])?[ \t]*[^\r]+?(\n{1,2}))(?=\n*(¨0|\2([*+-]|\d+[.])[ \t]+))/gm),e=e.replace(o,function(e,i,o,s,u,c,l){l=l&&""!==l.trim();var h=r.subParser("outdent")(u,t,n),p="";return c&&t.tasklists&&(p=' class="task-list-item" style="list-style-type: none;"',h=h.replace(/^[ \t]*\[(x|X| )?]/m,function(){var e='<input type="checkbox" disabled style="margin: 0px 0.35em 0.25em -1.6em; vertical-align: middle;"';return l&&(e+=" checked"),e+=">"})),h=h.replace(/^([-*+]|\d\.)[ \t]+[\S\n ]*/g,function(e){return"¨A"+e}),i||h.search(/\n{2,}/)>-1?(h=r.subParser("githubCodeBlocks")(h,t,n),h=r.subParser("blockGamut")(h,t,n)):(h=(h=r.subParser("lists")(h,t,n)).replace(/\n$/,""),h=(h=r.subParser("hashHTMLBlocks")(h,t,n)).replace(/\n\n+/g,"\n\n"),h=a?r.subParser("paragraphs")(h,t,n):r.subParser("spanGamut")(h,t,n)),h=h.replace("¨A",""),h="<li"+p+">"+h+"</li>\n"}),e=e.replace(/¨0/g,""),n.gListLevel--,i&&(e=e.replace(/\s+$/,"")),e}function o(e,t){if("ol"===t){var n=e.match(/^ *(\d+)\./);if(n&&"1"!==n[1])return' start="'+n[1]+'"'}return""}function a(e,n,r){var a=t.disableForced4SpacesIndentedSublists?/^ ?\d+\.[ \t]/gm:/^ {0,3}\d+\.[ \t]/gm,s=t.disableForced4SpacesIndentedSublists?/^ ?[*+-][ \t]/gm:/^ {0,3}[*+-][ \t]/gm,u="ul"===n?a:s,c="";if(-1!==e.search(u))!function t(l){var h=l.search(u),p=o(e,n);-1!==h?(c+="\n\n<"+n+p+">\n"+i(l.slice(0,h),!!r)+"</"+n+">\n",u="ul"==(n="ul"===n?"ol":"ul")?a:s,t(l.slice(h))):c+="\n\n<"+n+p+">\n"+i(l,!!r)+"</"+n+">\n"}(e);else{var l=o(e,n);c="\n\n<"+n+l+">\n"+i(e,!!r)+"</"+n+">\n"}return c}return e=n.converter._dispatch("lists.before",e,t,n),e+="¨0",e=n.gListLevel?e.replace(/^(( {0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(¨0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm,function(e,t,n){return a(t,n.search(/[*+-]/g)>-1?"ul":"ol",!0)}):e.replace(/(\n\n|^\n?)(( {0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(¨0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm,function(e,t,n,r){return a(n,r.search(/[*+-]/g)>-1?"ul":"ol",!1)}),e=e.replace(/¨0/,""),e=n.converter._dispatch("lists.after",e,t,n)}),r.subParser("metadata",function(e,t,n){"use strict";function r(e){n.metadata.raw=e,(e=(e=e.replace(/&/g,"&amp;").replace(/"/g,"&quot;")).replace(/\n {4}/g," ")).replace(/^([\S ]+): +([\s\S]+?)$/gm,function(e,t,r){return n.metadata.parsed[t]=r,""})}return t.metadata?(e=n.converter._dispatch("metadata.before",e,t,n),e=e.replace(/^\s*«««+(\S*?)\n([\s\S]+?)\n»»»+\n/,function(e,t,n){return r(n),"¨M"}),e=e.replace(/^\s*---+(\S*?)\n([\s\S]+?)\n---+\n/,function(e,t,i){return t&&(n.metadata.format=t),r(i),"¨M"}),e=e.replace(/¨M/g,""),e=n.converter._dispatch("metadata.after",e,t,n)):e}),r.subParser("outdent",function(e,t,n){"use strict";return e=n.converter._dispatch("outdent.before",e,t,n),e=e.replace(/^(\t|[ ]{1,4})/gm,"¨0"),e=e.replace(/¨0/g,""),e=n.converter._dispatch("outdent.after",e,t,n)}),r.subParser("paragraphs",function(e,t,n){"use strict";for(var i=(e=(e=(e=n.converter._dispatch("paragraphs.before",e,t,n)).replace(/^\n+/g,"")).replace(/\n+$/g,"")).split(/\n{2,}/g),o=[],a=i.length,s=0;s<a;s++){var u=i[s];u.search(/¨(K|G)(\d+)\1/g)>=0?o.push(u):u.search(/\S/)>=0&&(u=(u=r.subParser("spanGamut")(u,t,n)).replace(/^([ \t]*)/g,"<p>"),u+="</p>",o.push(u))}for(a=o.length,s=0;s<a;s++){for(var c="",l=o[s],h=!1;/¨(K|G)(\d+)\1/.test(l);){var p=RegExp.$1,f=RegExp.$2;c=(c="K"===p?n.gHtmlBlocks[f]:h?r.subParser("encodeCode")(n.ghCodeBlocks[f].text,t,n):n.ghCodeBlocks[f].codeblock).replace(/\$/g,"$$$$"),l=l.replace(/(\n\n)?¨(K|G)\d+\2(\n\n)?/,c),/^<pre\b[^>]*>\s*<code\b[^>]*>/.test(l)&&(h=!0)}o[s]=l}return e=o.join("\n"),e=e.replace(/^\n+/g,""),e=e.replace(/\n+$/g,""),n.converter._dispatch("paragraphs.after",e,t,n)}),r.subParser("runExtension",function(e,t,n,r){"use strict";if(e.filter)t=e.filter(t,r.converter,n);else if(e.regex){var i=e.regex;i instanceof RegExp||(i=new RegExp(i,"g")),t=t.replace(i,e.replace)}return t}),r.subParser("spanGamut",function(e,t,n){"use strict";return e=n.converter._dispatch("spanGamut.before",e,t,n),e=r.subParser("codeSpans")(e,t,n),e=r.subParser("escapeSpecialCharsWithinTagAttributes")(e,t,n),e=r.subParser("encodeBackslashEscapes")(e,t,n),e=r.subParser("images")(e,t,n),e=r.subParser("anchors")(e,t,n),e=r.subParser("autoLinks")(e,t,n),e=r.subParser("simplifiedAutoLinks")(e,t,n),e=r.subParser("emoji")(e,t,n),e=r.subParser("underline")(e,t,n),e=r.subParser("italicsAndBold")(e,t,n),e=r.subParser("strikethrough")(e,t,n),e=r.subParser("ellipsis")(e,t,n),e=r.subParser("hashHTMLSpans")(e,t,n),e=r.subParser("encodeAmpsAndAngles")(e,t,n),t.simpleLineBreaks?/\n\n¨K/.test(e)||(e=e.replace(/\n+/g,"<br />\n")):e=e.replace(/  +\n/g,"<br />\n"),e=n.converter._dispatch("spanGamut.after",e,t,n)}),r.subParser("strikethrough",function(e,t,n){"use strict";function i(e){return t.simplifiedAutoLink&&(e=r.subParser("simplifiedAutoLinks")(e,t,n)),"<del>"+e+"</del>"}return t.strikethrough&&(e=(e=n.converter._dispatch("strikethrough.before",e,t,n)).replace(/(?:~){2}([\s\S]+?)(?:~){2}/g,function(e,t){return i(t)}),e=n.converter._dispatch("strikethrough.after",e,t,n)),e}),r.subParser("stripLinkDefinitions",function(e,t,n){"use strict";var i=/^ {0,3}\[(.+)]:[ \t]*\n?[ \t]*<?([^>\s]+)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*\n?[ \t]*(?:(\n*)["|'(](.+?)["|')][ \t]*)?(?:\n+|(?=¨0))/gm,o=/^ {0,3}\[(.+)]:[ \t]*\n?[ \t]*<?(data:.+?\/.+?;base64,[A-Za-z0-9+/=\n]+?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*\n?[ \t]*(?:(\n*)["|'(](.+?)["|')][ \t]*)?(?:\n\n|(?=¨0)|(?=\n\[))/gm,a=function(e,i,o,a,s,u,c){return i=i.toLowerCase(),o.match(/^data:.+?\/.+?;base64,/)?n.gUrls[i]=o.replace(/\s/g,""):n.gUrls[i]=r.subParser("encodeAmpsAndAngles")(o,t,n),u?u+c:(c&&(n.gTitles[i]=c.replace(/"|'/g,"&quot;")),t.parseImgDimensions&&a&&s&&(n.gDimensions[i]={width:a,height:s}),"")};return e=(e+="¨0").replace(o,a),e=e.replace(i,a),e=e.replace(/¨0/,"")}),r.subParser("tables",function(e,t,n){"use strict";function i(e){return/^:[ \t]*--*$/.test(e)?' style="text-align:left;"':/^--*[ \t]*:[ \t]*$/.test(e)?' style="text-align:right;"':/^:[ \t]*--*[ \t]*:$/.test(e)?' style="text-align:center;"':""}function o(e,i){var o="";return e=e.trim(),(t.tablesHeaderId||t.tableHeaderId)&&(o=' id="'+e.replace(/ /g,"_").toLowerCase()+'"'),e=r.subParser("spanGamut")(e,t,n),"<th"+o+i+">"+e+"</th>\n"}function a(e,i){return"<td"+i+">"+r.subParser("spanGamut")(e,t,n)+"</td>\n"}function s(e,t){for(var n="<table>\n<thead>\n<tr>\n",r=e.length,i=0;i<r;++i)n+=e[i];for(n+="</tr>\n</thead>\n<tbody>\n",i=0;i<t.length;++i){n+="<tr>\n";for(var o=0;o<r;++o)n+=t[i][o];n+="</tr>\n"}return n+="</tbody>\n</table>\n"}function u(e){var u,c=e.split("\n");for(u=0;u<c.length;++u)/^ {0,3}\|/.test(c[u])&&(c[u]=c[u].replace(/^ {0,3}\|/,"")),/\|[ \t]*$/.test(c[u])&&(c[u]=c[u].replace(/\|[ \t]*$/,"")),c[u]=r.subParser("codeSpans")(c[u],t,n);var l=c[0].split("|").map(function(e){return e.trim()}),h=c[1].split("|").map(function(e){return e.trim()}),p=[],f=[],d=[],m=[];for(c.shift(),c.shift(),u=0;u<c.length;++u)""!==c[u].trim()&&p.push(c[u].split("|").map(function(e){return e.trim()}));if(l.length<h.length)return e;for(u=0;u<h.length;++u)d.push(i(h[u]));for(u=0;u<l.length;++u)r.helper.isUndefined(d[u])&&(d[u]=""),f.push(o(l[u],d[u]));for(u=0;u<p.length;++u){for(var g=[],y=0;y<f.length;++y)r.helper.isUndefined(p[u][y]),g.push(a(p[u][y],d[y]));m.push(g)}return s(f,m)}if(!t.tables)return e;var c=/^ {0,3}\|?.+\|.+\n {0,3}\|?[ \t]*:?[ \t]*(?:[-=]){2,}[ \t]*:?[ \t]*\|[ \t]*:?[ \t]*(?:[-=]){2,}[\s\S]+?(?:\n\n|¨0)/gm,l=/^ {0,3}\|.+\|[ \t]*\n {0,3}\|[ \t]*:?[ \t]*(?:[-=]){2,}[ \t]*:?[ \t]*\|[ \t]*\n( {0,3}\|.+\|[ \t]*\n)*(?:\n|¨0)/gm;return e=n.converter._dispatch("tables.before",e,t,n),e=e.replace(/\\(\|)/g,r.helper.escapeCharactersCallback),e=e.replace(c,u),e=e.replace(l,u),e=n.converter._dispatch("tables.after",e,t,n)}),r.subParser("underline",function(e,t,n){"use strict";return t.underline?(e=n.converter._dispatch("underline.before",e,t,n),e=t.literalMidWordUnderscores?(e=e.replace(/\b___(\S[\s\S]*?)___\b/g,function(e,t){return"<u>"+t+"</u>"})).replace(/\b__(\S[\s\S]*?)__\b/g,function(e,t){return"<u>"+t+"</u>"}):(e=e.replace(/___(\S[\s\S]*?)___/g,function(e,t){return/\S$/.test(t)?"<u>"+t+"</u>":e})).replace(/__(\S[\s\S]*?)__/g,function(e,t){return/\S$/.test(t)?"<u>"+t+"</u>":e}),e=e.replace(/(_)/g,r.helper.escapeCharactersCallback),e=n.converter._dispatch("underline.after",e,t,n)):e}),r.subParser("unescapeSpecialChars",function(e,t,n){"use strict";return e=n.converter._dispatch("unescapeSpecialChars.before",e,t,n),e=e.replace(/¨E(\d+)E/g,function(e,t){var n=parseInt(t);return String.fromCharCode(n)}),e=n.converter._dispatch("unescapeSpecialChars.after",e,t,n)}),r.subParser("makeMarkdown.blockquote",function(e,t){"use strict";var n="";if(e.hasChildNodes())for(var i=e.childNodes,o=i.length,a=0;a<o;++a){var s=r.subParser("makeMarkdown.node")(i[a],t);""!==s&&(n+=s)}return n=n.trim(),n="> "+n.split("\n").join("\n> ")}),r.subParser("makeMarkdown.codeBlock",function(e,t){"use strict";var n=e.getAttribute("language"),r=e.getAttribute("precodenum");return"```"+n+"\n"+t.preList[r]+"\n```"}),r.subParser("makeMarkdown.codeSpan",function(e){"use strict";return"`"+e.innerHTML+"`"}),r.subParser("makeMarkdown.emphasis",function(e,t){"use strict";var n="";if(e.hasChildNodes()){n+="*";for(var i=e.childNodes,o=i.length,a=0;a<o;++a)n+=r.subParser("makeMarkdown.node")(i[a],t);n+="*"}return n}),r.subParser("makeMarkdown.header",function(e,t,n){"use strict";var i=new Array(n+1).join("#"),o="";if(e.hasChildNodes()){o=i+" ";for(var a=e.childNodes,s=a.length,u=0;u<s;++u)o+=r.subParser("makeMarkdown.node")(a[u],t)}return o}),r.subParser("makeMarkdown.hr",function(){"use strict";return"---"}),r.subParser("makeMarkdown.image",function(e){"use strict";var t="";return e.hasAttribute("src")&&(t+="!["+e.getAttribute("alt")+"](",t+="<"+e.getAttribute("src")+">",e.hasAttribute("width")&&e.hasAttribute("height")&&(t+=" ="+e.getAttribute("width")+"x"+e.getAttribute("height")),e.hasAttribute("title")&&(t+=' "'+e.getAttribute("title")+'"'),t+=")"),t}),r.subParser("makeMarkdown.links",function(e,t){"use strict";var n="";if(e.hasChildNodes()&&e.hasAttribute("href")){var i=e.childNodes,o=i.length;n="[";for(var a=0;a<o;++a)n+=r.subParser("makeMarkdown.node")(i[a],t);n+="](",n+="<"+e.getAttribute("href")+">",e.hasAttribute("title")&&(n+=' "'+e.getAttribute("title")+'"'),n+=")"}return n}),r.subParser("makeMarkdown.list",function(e,t,n){"use strict";var i="";if(!e.hasChildNodes())return"";for(var o=e.childNodes,a=o.length,s=e.getAttribute("start")||1,u=0;u<a;++u)void 0!==o[u].tagName&&"li"===o[u].tagName.toLowerCase()&&(i+=("ol"===n?s.toString()+". ":"- ")+r.subParser("makeMarkdown.listItem")(o[u],t),++s);return(i+="\n\x3c!-- --\x3e\n").trim()}),r.subParser("makeMarkdown.listItem",function(e,t){"use strict";for(var n="",i=e.childNodes,o=i.length,a=0;a<o;++a)n+=r.subParser("makeMarkdown.node")(i[a],t);return/\n$/.test(n)?n=n.split("\n").join("\n    ").replace(/^ {4}$/gm,"").replace(/\n\n+/g,"\n\n"):n+="\n",n}),r.subParser("makeMarkdown.node",function(e,t,n){"use strict";n=n||!1;var i="";if(3===e.nodeType)return r.subParser("makeMarkdown.txt")(e,t);if(8===e.nodeType)return"\x3c!--"+e.data+"--\x3e\n\n";if(1!==e.nodeType)return"";switch(e.tagName.toLowerCase()){case"h1":n||(i=r.subParser("makeMarkdown.header")(e,t,1)+"\n\n");break;case"h2":n||(i=r.subParser("makeMarkdown.header")(e,t,2)+"\n\n");break;case"h3":n||(i=r.subParser("makeMarkdown.header")(e,t,3)+"\n\n");break;case"h4":n||(i=r.subParser("makeMarkdown.header")(e,t,4)+"\n\n");break;case"h5":n||(i=r.subParser("makeMarkdown.header")(e,t,5)+"\n\n");break;case"h6":n||(i=r.subParser("makeMarkdown.header")(e,t,6)+"\n\n");break;case"p":n||(i=r.subParser("makeMarkdown.paragraph")(e,t)+"\n\n");break;case"blockquote":n||(i=r.subParser("makeMarkdown.blockquote")(e,t)+"\n\n");break;case"hr":n||(i=r.subParser("makeMarkdown.hr")(e,t)+"\n\n");break;case"ol":n||(i=r.subParser("makeMarkdown.list")(e,t,"ol")+"\n\n");break;case"ul":n||(i=r.subParser("makeMarkdown.list")(e,t,"ul")+"\n\n");break;case"precode":n||(i=r.subParser("makeMarkdown.codeBlock")(e,t)+"\n\n");break;case"pre":n||(i=r.subParser("makeMarkdown.pre")(e,t)+"\n\n");break;case"table":n||(i=r.subParser("makeMarkdown.table")(e,t)+"\n\n");break;case"code":i=r.subParser("makeMarkdown.codeSpan")(e,t);break;case"em":case"i":i=r.subParser("makeMarkdown.emphasis")(e,t);break;case"strong":case"b":i=r.subParser("makeMarkdown.strong")(e,t);break;case"del":i=r.subParser("makeMarkdown.strikethrough")(e,t);break;case"a":i=r.subParser("makeMarkdown.links")(e,t);break;case"img":i=r.subParser("makeMarkdown.image")(e,t);break;default:i=e.outerHTML+"\n\n"}return i}),r.subParser("makeMarkdown.paragraph",function(e,t){"use strict";var n="";if(e.hasChildNodes())for(var i=e.childNodes,o=i.length,a=0;a<o;++a)n+=r.subParser("makeMarkdown.node")(i[a],t);return n=n.trim()}),r.subParser("makeMarkdown.pre",function(e,t){"use strict";var n=e.getAttribute("prenum");return"<pre>"+t.preList[n]+"</pre>"}),r.subParser("makeMarkdown.strikethrough",function(e,t){"use strict";var n="";if(e.hasChildNodes()){n+="~~";for(var i=e.childNodes,o=i.length,a=0;a<o;++a)n+=r.subParser("makeMarkdown.node")(i[a],t);n+="~~"}return n}),r.subParser("makeMarkdown.strong",function(e,t){"use strict";var n="";if(e.hasChildNodes()){n+="**";for(var i=e.childNodes,o=i.length,a=0;a<o;++a)n+=r.subParser("makeMarkdown.node")(i[a],t);n+="**"}return n}),r.subParser("makeMarkdown.table",function(e,t){"use strict";var n,i,o="",a=[[],[]],s=e.querySelectorAll("thead>tr>th"),u=e.querySelectorAll("tbody>tr");for(n=0;n<s.length;++n){var c=r.subParser("makeMarkdown.tableCell")(s[n],t),l="---";if(s[n].hasAttribute("style"))switch(s[n].getAttribute("style").toLowerCase().replace(/\s/g,"")){case"text-align:left;":l=":---";break;case"text-align:right;":l="---:";break;case"text-align:center;":l=":---:"}a[0][n]=c.trim(),a[1][n]=l}for(n=0;n<u.length;++n){var h=a.push([])-1,p=u[n].getElementsByTagName("td");for(i=0;i<s.length;++i){var f=" ";void 0!==p[i]&&(f=r.subParser("makeMarkdown.tableCell")(p[i],t)),a[h].push(f)}}var d=3;for(n=0;n<a.length;++n)for(i=0;i<a[n].length;++i){var m=a[n][i].length;m>d&&(d=m)}for(n=0;n<a.length;++n){for(i=0;i<a[n].length;++i)1===n?":"===a[n][i].slice(-1)?a[n][i]=r.helper.padEnd(a[n][i].slice(-1),d-1,"-")+":":a[n][i]=r.helper.padEnd(a[n][i],d,"-"):a[n][i]=r.helper.padEnd(a[n][i],d);o+="| "+a[n].join(" | ")+" |\n"}return o.trim()}),r.subParser("makeMarkdown.tableCell",function(e,t){"use strict";var n="";if(!e.hasChildNodes())return"";for(var i=e.childNodes,o=i.length,a=0;a<o;++a)n+=r.subParser("makeMarkdown.node")(i[a],t,!0);return n.trim()}),r.subParser("makeMarkdown.txt",function(e){"use strict";var t=e.nodeValue;return t=t.replace(/ +/g," "),t=t.replace(/¨NBSP;/g," "),t=r.helper.unescapeHTMLEntities(t),t=t.replace(/([*_~|`])/g,"\\$1"),t=t.replace(/^(\s*)>/g,"\\$1>"),t=t.replace(/^#/gm,"\\#"),t=t.replace(/^(\s*)([-=]{3,})(\s*)$/,"$1\\$2$3"),t=t.replace(/^( {0,3}\d+)\./gm,"$1\\."),t=t.replace(/^( {0,3})([+-])/gm,"$1\\$2"),t=t.replace(/]([\s]*)\(/g,"\\]$1\\("),t=t.replace(/^ {0,3}\[([\S \t]*?)]:/gm,"\\[$1]:")});var y=this;"function"==typeof define&&define.amd?define("showdown@1.9.0#dist/showdown",function(){"use strict";return r}):"undefined"!=typeof module&&module.exports?module.exports=r:y.showdown=r}.call(this),define("whatwg-fetch@2.0.4#fetch",["module","@loader","require"],function(e,t,n){t.get("@@global-helpers").prepareGlobal({require:n,name:e.id,deps:[]});var r=t.global.define,n=t.global.require;return t.global.define=void 0,t.global.module=void 0,t.global.exports=void 0,t.__exec({source:'!function(t){"use strict";function e(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\\-#$%&\'*+.\\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function r(t){return"string"!=typeof t&&(t=String(t)),t}function o(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return m.iterable&&(e[Symbol.iterator]=function(){return e}),e}function n(t){this.map={},t instanceof n?t.forEach(function(t,e){this.append(e,t)},this):Array.isArray(t)?t.forEach(function(t){this.append(t[0],t[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function i(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function s(t){return new Promise(function(e,r){t.onload=function(){e(t.result)},t.onerror=function(){r(t.error)}})}function a(t){var e=new FileReader,r=s(e);return e.readAsArrayBuffer(t),r}function h(t){var e=new FileReader,r=s(e);return e.readAsText(t),r}function u(t){for(var e=new Uint8Array(t),r=new Array(e.length),o=0;o<e.length;o++)r[o]=String.fromCharCode(e[o]);return r.join("")}function f(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function d(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t,t)if("string"==typeof t)this._bodyText=t;else if(m.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(m.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(m.searchParams&&URLSearchParams.prototype.isPrototypeOf(t))this._bodyText=t.toString();else if(m.arrayBuffer&&m.blob&&v(t))this._bodyArrayBuffer=f(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!m.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(t)&&!B(t))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=f(t)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):m.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},m.blob&&(this.blob=function(){var t=i(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?i(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(a)}),this.text=function(){var t=i(this);if(t)return t;if(this._bodyBlob)return h(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(u(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},m.formData&&(this.formData=function(){return this.text().then(c)}),this.json=function(){return this.text().then(JSON.parse)},this}function y(t){var e=t.toUpperCase();return _.indexOf(e)>-1?e:t}function l(t,e){var r=(e=e||{}).body;if(t instanceof l){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new n(t.headers)),this.method=t.method,this.mode=t.mode,r||null==t._bodyInit||(r=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new n(e.headers)),this.method=y(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function c(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var r=t.split("="),o=r.shift().replace(/\\+/g," "),n=r.join("=").replace(/\\+/g," ");e.append(decodeURIComponent(o),decodeURIComponent(n))}}),e}function p(t){var e=new n;return t.replace(/\\r?\\n[\\t ]+/g," ").split(/\\r?\\n/).forEach(function(t){var r=t.split(":"),o=r.shift().trim();if(o){var n=r.join(":").trim();e.append(o,n)}}),e}function b(t,e){e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new n(e.headers),this.url=e.url||"",this._initBody(t)}if(!t.fetch){var m={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};if(m.arrayBuffer)var w=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],v=function(t){return t&&DataView.prototype.isPrototypeOf(t)},B=ArrayBuffer.isView||function(t){return t&&w.indexOf(Object.prototype.toString.call(t))>-1};n.prototype.append=function(t,o){t=e(t),o=r(o);var n=this.map[t];this.map[t]=n?n+","+o:o},n.prototype.delete=function(t){delete this.map[e(t)]},n.prototype.get=function(t){return t=e(t),this.has(t)?this.map[t]:null},n.prototype.has=function(t){return this.map.hasOwnProperty(e(t))},n.prototype.set=function(t,o){this.map[e(t)]=r(o)},n.prototype.forEach=function(t,e){for(var r in this.map)this.map.hasOwnProperty(r)&&t.call(e,this.map[r],r,this)},n.prototype.keys=function(){var t=[];return this.forEach(function(e,r){t.push(r)}),o(t)},n.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),o(t)},n.prototype.entries=function(){var t=[];return this.forEach(function(e,r){t.push([r,e])}),o(t)},m.iterable&&(n.prototype[Symbol.iterator]=n.prototype.entries);var _=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];l.prototype.clone=function(){return new l(this,{body:this._bodyInit})},d.call(l.prototype),d.call(b.prototype),b.prototype.clone=function(){return new b(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new n(this.headers),url:this.url})},b.error=function(){var t=new b(null,{status:0,statusText:""});return t.type="error",t};var A=[301,302,303,307,308];b.redirect=function(t,e){if(-1===A.indexOf(e))throw new RangeError("Invalid status code");return new b(null,{status:e,headers:{location:t}})},t.Headers=n,t.Request=l,t.Response=b,t.fetch=function(t,e){return new Promise(function(r,o){var n=new l(t,e),i=new XMLHttpRequest;i.onload=function(){var t={status:i.status,statusText:i.statusText,headers:p(i.getAllResponseHeaders()||"")};t.url="responseURL"in i?i.responseURL:t.headers.get("X-Request-URL");var e="response"in i?i.response:i.responseText;r(new b(e,t))},i.onerror=function(){o(new TypeError("Network request failed"))},i.ontimeout=function(){o(new TypeError("Network request failed"))},i.open(n.method,n.url,!0),"include"===n.credentials?i.withCredentials=!0:"omit"===n.credentials&&(i.withCredentials=!1),"responseType"in i&&m.blob&&(i.responseType="blob"),n.headers.forEach(function(t,e){i.setRequestHeader(e,t)}),i.send(void 0===n._bodyInit?null:n._bodyInit)})},t.fetch.polyfill=!0}}("undefined"!=typeof self?self:this);',address:e.uri}),t.global.require=n,t.global.define=r,t.get("@@global-helpers").retrieveGlobal(e.id,void 0)}),define("@firebase/polyfill@0.3.3#dist/index.cjs",["require","exports","module","whatwg-fetch"],function(e,t,n){!function(e,t,n,r){"use strict";function i(){}function o(e,t){return function(){e.apply(t,arguments)}}function a(e){if(!(this instanceof a))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],p(e,this)}function s(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,a._immediateFn(function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var r;try{r=n(e._value)}catch(e){return void c(t.promise,e)}u(t.promise,r)}else(1===e._state?u:c)(t.promise,e._value)})):e._deferreds.push(t)}function u(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof a)return e._state=3,e._value=t,void l(e);if("function"==typeof n)return void p(o(n,t),e)}e._state=1,e._value=t,l(e)}catch(t){c(e,t)}}function c(e,t){e._state=2,e._value=t,l(e)}function l(e){2===e._state&&0===e._deferreds.length&&a._immediateFn(function(){e._handled||a._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)s(e,e._deferreds[t]);e._deferreds=null}function h(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function p(e,t){var n=!1;try{e(function(e){n||(n=!0,u(t,e))},function(e){n||(n=!0,c(t,e))})}catch(e){if(n)return;n=!0,c(t,e)}}function f(e,t){return t={exports:{}},e(t,t.exports),t.exports}t("whatwg-fetch");var d=setTimeout;a.prototype.catch=function(e){return this.then(null,e)},a.prototype.then=function(e,t){var n=new this.constructor(i);return s(this,new h(e,t,n)),n},a.prototype.finally=function(e){var t=this.constructor;return this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){return t.reject(n)})})},a.all=function(e){return new a(function(t,n){function r(e,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,function(t){r(e,t)},n)}i[e]=a,0==--o&&t(i)}catch(e){n(e)}}if(!e||void 0===e.length)throw new TypeError("Promise.all accepts an array");var i=Array.prototype.slice.call(e);if(0===i.length)return t([]);for(var o=i.length,a=0;a<i.length;a++)r(a,i[a])})},a.resolve=function(e){return e&&"object"==typeof e&&e.constructor===a?e:new a(function(t){t(e)})},a.reject=function(e){return new a(function(t,n){n(e)})},a.race=function(e){return new a(function(t,n){for(var r=0,i=e.length;r<i;r++)e[r].then(t,n)})},a._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){d(e,0)},a._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};var m=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==e)return e;throw new Error("unable to locate global object")}();m.Promise||(m.Promise=a);var g=f(function(e){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)}),y=f(function(e){var t=e.exports={version:"2.5.5"};"number"==typeof __e&&(__e=t)}),v=(y.version,function(e){return"object"==typeof e?null!==e:"function"==typeof e}),b=function(e){if(!v(e))throw TypeError(e+" is not an object!");return e},_=function(e){try{return!!e()}catch(e){return!0}},w=!_(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),k=g.document,E=v(k)&&v(k.createElement),T=function(e){return E?k.createElement(e):{}},S=!w&&!_(function(){return 7!=Object.defineProperty(T("div"),"a",{get:function(){return 7}}).a}),C=function(e,t){if(!v(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!v(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!v(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!v(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")},I=Object.defineProperty,N={f:w?Object.defineProperty:function(e,t,n){if(b(e),t=C(t,!0),b(n),S)try{return I(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},D=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},A=w?function(e,t,n){return N.f(e,t,D(1,n))}:function(e,t,n){return e[t]=n,e},x={}.hasOwnProperty,O=function(e,t){return x.call(e,t)},P=0,R=Math.random(),L=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++P+R).toString(36))},M=f(function(e){var t=L("src"),n=Function.toString,r=(""+n).split("toString");y.inspectSource=function(e){return n.call(e)},(e.exports=function(e,n,i,o){var a="function"==typeof i;a&&(O(i,"name")||A(i,"name",n)),e[n]!==i&&(a&&(O(i,t)||A(i,t,e[n]?""+e[n]:r.join(String(n)))),e===g?e[n]=i:o?e[n]?e[n]=i:A(e,n,i):(delete e[n],A(e,n,i)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[t]||n.call(this)})}),V=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e},j=function(e,t,n){if(V(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}},U=function(e,t,n){var r,i,o,a,s=e&U.F,u=e&U.G,c=e&U.S,l=e&U.P,h=e&U.B,p=u?g:c?g[t]||(g[t]={}):(g[t]||{}).prototype,f=u?y:y[t]||(y[t]={}),d=f.prototype||(f.prototype={});u&&(n=t);for(r in n)o=((i=!s&&p&&void 0!==p[r])?p:n)[r],a=h&&i?j(o,g):l&&"function"==typeof o?j(Function.call,o):o,p&&M(p,r,o,e&U.U),f[r]!=o&&A(f,r,a),l&&d[r]!=o&&(d[r]=o)};g.core=y,U.F=1,U.G=2,U.S=4,U.P=8,U.B=16,U.W=32,U.U=64,U.R=128;var q=U,F={}.toString,B=function(e){return F.call(e).slice(8,-1)},K=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==B(e)?e.split(""):Object(e)},W=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e},H=function(e){return Object(W(e))},z=Math.ceil,Q=Math.floor,G=function(e){return isNaN(e=+e)?0:(e>0?Q:z)(e)},X=Math.min,Y=function(e){return e>0?X(G(e),9007199254740991):0},$=Array.isArray||function(e){return"Array"==B(e)},J=g["__core-js_shared__"]||(g["__core-js_shared__"]={}),Z=function(e){return J[e]||(J[e]={})},ee=f(function(e){var t=Z("wks"),n=g.Symbol,r="function"==typeof n;(e.exports=function(e){return t[e]||(t[e]=r&&n[e]||(r?n:L)("Symbol."+e))}).store=t}),te=ee("species"),ne=function(e){var t;return $(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!$(t.prototype)||(t=void 0),v(t)&&null===(t=t[te])&&(t=void 0)),void 0===t?Array:t},re=function(e,t){return new(ne(e))(t)},ie=function(e,t){var n=1==e,r=2==e,i=3==e,o=4==e,a=6==e,s=5==e||a,u=t||re;return function(t,c,l){for(var h,p,f=H(t),d=K(f),m=j(c,l,3),g=Y(d.length),y=0,v=n?u(t,g):r?u(t,0):void 0;g>y;y++)if((s||y in d)&&(h=d[y],p=m(h,y,f),e))if(n)v[y]=p;else if(p)switch(e){case 3:return!0;case 5:return h;case 6:return y;case 2:v.push(h)}else if(o)return!1;return a?-1:i||o?o:v}},oe=ee("unscopables"),ae=Array.prototype;void 0==ae[oe]&&A(ae,oe,{});var se=function(e){ae[oe][e]=!0},ue=ie(5),ce=!0;"find"in[]&&Array(1).find(function(){ce=!1}),q(q.P+q.F*ce,"Array",{find:function(e){return ue(this,e,arguments.length>1?arguments[1]:void 0)}}),se("find"),y.Array.find;var le=ie(6),he=!0;"findIndex"in[]&&Array(1).findIndex(function(){he=!1}),q(q.P+q.F*he,"Array",{findIndex:function(e){return le(this,e,arguments.length>1?arguments[1]:void 0)}}),se("findIndex"),y.Array.findIndex;var pe=function(e){return K(W(e))},fe=Math.max,de=Math.min,me=function(e,t){return(e=G(e))<0?fe(e+t,0):de(e,t)},ge=Z("keys"),ye=function(e){return ge[e]||(ge[e]=L(e))},ve=function(e,t,n){for(var r=pe(e),i=Y(r.length),o=me(n,i);i>o;o++)if(o in r&&r[o]===t)return o||0;return-1},be=ye("IE_PROTO"),_e=function(e,t){var n,r=pe(e),i=0,o=[];for(n in r)n!=be&&O(r,n)&&o.push(n);for(;t.length>i;)O(r,n=t[i++])&&(~ve(o,n)||o.push(n));return o},we="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),ke=Object.keys||function(e){return _e(e,we)},Ee={f:Object.getOwnPropertySymbols},Te={f:{}.propertyIsEnumerable},Se=Object.assign,Ce=!Se||_(function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach(function(e){t[e]=e}),7!=Se({},e)[n]||Object.keys(Se({},t)).join("")!=r})?function(e,t){for(var n=H(e),r=arguments.length,i=1,o=Ee.f,a=Te.f;r>i;)for(var s,u=K(arguments[i++]),c=o?ke(u).concat(o(u)):ke(u),l=c.length,h=0;l>h;)a.call(u,s=c[h++])&&(n[s]=u[s]);return n}:Se;q(q.S+q.F,"Object",{assign:Ce}),y.Object.assign;var Ie=ee("match"),Ne=function(e){var t;return v(e)&&(void 0!==(t=e[Ie])?!!t:"RegExp"==B(e))},De=function(e,t,n){if(Ne(t))throw TypeError("String#"+n+" doesn't accept regex!");return String(W(e))},Ae=ee("match"),xe="".startsWith;q(q.P+q.F*function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[Ae]=!1,!"/./"[e](t)}catch(e){}}return!0}("startsWith"),"String",{startsWith:function(e){var t=De(this,e,"startsWith"),n=Y(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),r=String(e);return xe?xe.call(t,r,n):t.slice(n,n+r.length)===r}}),y.String.startsWith,q(q.P,"String",{repeat:function(e){var t=String(W(this)),n="",r=G(e);if(r<0||r==1/0)throw RangeError("Count can't be negative");for(;r>0;(r>>>=1)&&(t+=t))1&r&&(n+=t);return n}}),y.String.repeat;var Oe=f(function(e){var t=L("meta"),n=N.f,r=0,i=Object.isExtensible||function(){return!0},o=!_(function(){return i(Object.preventExtensions({}))}),a=function(e){n(e,t,{value:{i:"O"+ ++r,w:{}}})},s=e.exports={KEY:t,NEED:!1,fastKey:function(e,n){if(!v(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!O(e,t)){if(!i(e))return"F";if(!n)return"E";a(e)}return e[t].i},getWeak:function(e,n){if(!O(e,t)){if(!i(e))return!0;if(!n)return!1;a(e)}return e[t].w},onFreeze:function(e){return o&&s.NEED&&i(e)&&!O(e,t)&&a(e),e}}}),Pe=(Oe.KEY,Oe.NEED,Oe.fastKey,Oe.getWeak,Oe.onFreeze,N.f),Re=ee("toStringTag"),Le=function(e,t,n){e&&!O(e=n?e:e.prototype,Re)&&Pe(e,Re,{configurable:!0,value:t})},Me={f:ee},Ve=N.f,je=function(e){var t=y.Symbol||(y.Symbol=g.Symbol||{});"_"==e.charAt(0)||e in t||Ve(t,e,{value:Me.f(e)})},Ue=function(e){var t=ke(e),n=Ee.f;if(n)for(var r,i=n(e),o=Te.f,a=0;i.length>a;)o.call(e,r=i[a++])&&t.push(r);return t},qe=w?Object.defineProperties:function(e,t){b(e);for(var n,r=ke(t),i=r.length,o=0;i>o;)N.f(e,n=r[o++],t[n]);return e},Fe=g.document,Be=Fe&&Fe.documentElement,Ke=ye("IE_PROTO"),We=function(){},He=function(){var e,t=T("iframe"),n=we.length;for(t.style.display="none",Be.appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),He=e.F;n--;)delete He.prototype[we[n]];return He()},ze=Object.create||function(e,t){var n;return null!==e?(We.prototype=b(e),n=new We,We.prototype=null,n[Ke]=e):n=He(),void 0===t?n:qe(n,t)},Qe=we.concat("length","prototype"),Ge={f:Object.getOwnPropertyNames||function(e){return _e(e,Qe)}},Xe=Ge.f,Ye={}.toString,$e="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Je=function(e){try{return Xe(e)}catch(e){return $e.slice()}},Ze={f:function(e){return $e&&"[object Window]"==Ye.call(e)?Je(e):Xe(pe(e))}},et=Object.getOwnPropertyDescriptor,tt={f:w?et:function(e,t){if(e=pe(e),t=C(t,!0),S)try{return et(e,t)}catch(e){}if(O(e,t))return D(!Te.f.call(e,t),e[t])}},nt=Oe.KEY,rt=tt.f,it=N.f,ot=Ze.f,at=g.Symbol,st=g.JSON,ut=st&&st.stringify,ct=ee("_hidden"),lt=ee("toPrimitive"),ht={}.propertyIsEnumerable,pt=Z("symbol-registry"),ft=Z("symbols"),dt=Z("op-symbols"),mt=Object.prototype,gt="function"==typeof at,yt=g.QObject,vt=!yt||!yt.prototype||!yt.prototype.findChild,bt=w&&_(function(){return 7!=ze(it({},"a",{get:function(){return it(this,"a",{value:7}).a}})).a})?function(e,t,n){var r=rt(mt,t);r&&delete mt[t],it(e,t,n),r&&e!==mt&&it(mt,t,r)}:it,_t=function(e){var t=ft[e]=ze(at.prototype);return t._k=e,t},wt=gt&&"symbol"==typeof at.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof at},kt=function(e,t,n){return e===mt&&kt(dt,t,n),b(e),t=C(t,!0),b(n),O(ft,t)?(n.enumerable?(O(e,ct)&&e[ct][t]&&(e[ct][t]=!1),n=ze(n,{enumerable:D(0,!1)})):(O(e,ct)||it(e,ct,D(1,{})),e[ct][t]=!0),bt(e,t,n)):it(e,t,n)},Et=function(e,t){b(e);for(var n,r=Ue(t=pe(t)),i=0,o=r.length;o>i;)kt(e,n=r[i++],t[n]);return e},Tt=function(e){var t=ht.call(this,e=C(e,!0));return!(this===mt&&O(ft,e)&&!O(dt,e))&&(!(t||!O(this,e)||!O(ft,e)||O(this,ct)&&this[ct][e])||t)},St=function(e,t){if(e=pe(e),t=C(t,!0),e!==mt||!O(ft,t)||O(dt,t)){var n=rt(e,t);return!n||!O(ft,t)||O(e,ct)&&e[ct][t]||(n.enumerable=!0),n}},Ct=function(e){for(var t,n=ot(pe(e)),r=[],i=0;n.length>i;)O(ft,t=n[i++])||t==ct||t==nt||r.push(t);return r},It=function(e){for(var t,n=e===mt,r=ot(n?dt:pe(e)),i=[],o=0;r.length>o;)!O(ft,t=r[o++])||n&&!O(mt,t)||i.push(ft[t]);return i};gt||(M((at=function(){if(this instanceof at)throw TypeError("Symbol is not a constructor!");var e=L(arguments.length>0?arguments[0]:void 0),t=function(n){this===mt&&t.call(dt,n),O(this,ct)&&O(this[ct],e)&&(this[ct][e]=!1),bt(this,e,D(1,n))};return w&&vt&&bt(mt,e,{configurable:!0,set:t}),_t(e)}).prototype,"toString",function(){return this._k}),tt.f=St,N.f=kt,Ge.f=Ze.f=Ct,Te.f=Tt,Ee.f=It,w&&M(mt,"propertyIsEnumerable",Tt,!0),Me.f=function(e){return _t(ee(e))}),q(q.G+q.W+q.F*!gt,{Symbol:at});for(var Nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),Dt=0;Nt.length>Dt;)ee(Nt[Dt++]);for(var At=ke(ee.store),xt=0;At.length>xt;)je(At[xt++]);q(q.S+q.F*!gt,"Symbol",{for:function(e){return O(pt,e+="")?pt[e]:pt[e]=at(e)},keyFor:function(e){if(!wt(e))throw TypeError(e+" is not a symbol!");for(var t in pt)if(pt[t]===e)return t},useSetter:function(){vt=!0},useSimple:function(){vt=!1}}),q(q.S+q.F*!gt,"Object",{create:function(e,t){return void 0===t?ze(e):Et(ze(e),t)},defineProperty:kt,defineProperties:Et,getOwnPropertyDescriptor:St,getOwnPropertyNames:Ct,getOwnPropertySymbols:It}),st&&q(q.S+q.F*(!gt||_(function(){var e=at();return"[null]"!=ut([e])||"{}"!=ut({a:e})||"{}"!=ut(Object(e))})),"JSON",{stringify:function(e){for(var t,n,r=[e],i=1;arguments.length>i;)r.push(arguments[i++]);if(n=t=r[1],(v(t)||void 0!==e)&&!wt(e))return $(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!wt(t))return t}),r[1]=t,ut.apply(st,r)}}),at.prototype[lt]||A(at.prototype,lt,at.prototype.valueOf),Le(at,"Symbol"),Le(Math,"Math",!0),Le(g.JSON,"JSON",!0);var Ot=ee("toStringTag"),Pt="Arguments"==B(function(){return arguments}()),Rt=function(e,t){try{return e[t]}catch(e){}},Lt=function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=Rt(t=Object(e),Ot))?n:Pt?B(t):"Object"==(r=B(t))&&"function"==typeof t.callee?"Arguments":r},Mt={};Mt[ee("toStringTag")]="z",Mt+""!="[object z]"&&M(Object.prototype,"toString",function(){return"[object "+Lt(this)+"]"},!0),je("asyncIterator"),je("observable"),y.Symbol;var Vt={},jt={};A(jt,ee("iterator"),function(){return this});var Ut=function(e,t,n){e.prototype=ze(jt,{next:D(1,n)}),Le(e,t+" Iterator")},qt=ye("IE_PROTO"),Ft=Object.prototype,Bt=Object.getPrototypeOf||function(e){return e=H(e),O(e,qt)?e[qt]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?Ft:null},Kt=ee("iterator"),Wt=!([].keys&&"next"in[].keys()),Ht=function(){return this},zt=function(e,t,n,r,i,o,a){Ut(n,t,r);var s,u,c,l=function(e){if(!Wt&&e in d)return d[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},h=t+" Iterator",p="values"==i,f=!1,d=e.prototype,m=d[Kt]||d["@@iterator"]||i&&d[i],g=m||l(i),y=i?p?l("entries"):g:void 0,v="Array"==t?d.entries||m:m;if(v&&(c=Bt(v.call(new e)))!==Object.prototype&&c.next&&(Le(c,h,!0),"function"!=typeof c[Kt]&&A(c,Kt,Ht)),p&&m&&"values"!==m.name&&(f=!0,g=function(){return m.call(this)}),(Wt||f||!d[Kt])&&A(d,Kt,g),Vt[t]=g,Vt[h]=Ht,i)if(s={values:p?g:l("values"),keys:o?g:l("keys"),entries:y},a)for(u in s)u in d||M(d,u,s[u]);else q(q.P+q.F*(Wt||f),t,s);return s},Qt=function(e,t){var n,r,i=String(W(e)),o=G(t),a=i.length;return o<0||o>=a?"":(n=i.charCodeAt(o))<55296||n>56319||o+1===a||(r=i.charCodeAt(o+1))<56320||r>57343?i.charAt(o):i.slice(o,o+2)};zt(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=Qt(t,n),this._i+=e.length,{value:e,done:!1})});var Gt=function(e,t){return{value:t,done:!!e}},Xt=zt(Array,"Array",function(e,t){this._t=pe(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,Gt(1)):"keys"==t?Gt(0,n):"values"==t?Gt(0,e[n]):Gt(0,[n,e[n]])},"values");Vt.Arguments=Vt.Array,se("keys"),se("values"),se("entries");for(var Yt=ee("iterator"),$t=ee("toStringTag"),Jt=Vt.Array,Zt={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},en=ke(Zt),tn=0;tn<en.length;tn++){var nn,rn=en[tn],on=Zt[rn],an=g[rn],sn=an&&an.prototype;if(sn&&(sn[Yt]||A(sn,Yt,Jt),sn[$t]||A(sn,$t,rn),Vt[rn]=Jt,on))for(nn in Xt)sn[nn]||M(sn,nn,Xt[nn],!0)}Me.f("iterator")}(function(){return this}(),e)});var __extends,__assign,__rest,__decorate,__param,__metadata,__awaiter,__generator,__exportStar,__values,__read,__spread,__await,__asyncGenerator,__asyncDelegator,__asyncValues,__makeTemplateObject,__importStar,__importDefault;!function(e){function t(e,t){return e!==n&&("function"==typeof Object.create?Object.defineProperty(e,"__esModule",{value:!0}):e.__esModule=!0),function(n,r){return e[n]=t?t(n,r):r}}var n="object"==typeof global?global:"object"==typeof self?self:"object"==typeof this?this:{};"function"==typeof define&&define.amd?define("tslib@1.9.0#tslib",["exports"],function(r){e(t(n,t(r)))}):e("object"==typeof module&&"object"==typeof module.exports?t(n,t(module.exports)):t(n))}(function(e){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};__extends=function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)},__assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},__rest=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&(n[r[i]]=e[r[i]]);return n},__decorate=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},__param=function(e,t){return function(n,r){t(n,r,e)}},__metadata=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},__generator=function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(a=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,o=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(a=u.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=t.call(e,u)}catch(e){n=[6,e],o=0}finally{i=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,a,s,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},__exportStar=function(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])},__values=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}},__read=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},__spread=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(__read(arguments[t]));return e},__await=function(e){return this instanceof __await?(this.v=e,this):new __await(e)},__asyncGenerator=function(e,t,n){function r(e){l[e]&&(c[e]=function(t){return new Promise(function(n,r){h.push([e,t,n,r])>1||i(e,t)})})}function i(e,t){try{o(l[e](t))}catch(e){u(h[0][3],e)}}function o(e){e.value instanceof __await?Promise.resolve(e.value.v).then(a,s):u(h[0][2],e)}function a(e){i("next",e)}function s(e){i("throw",e)}function u(e,t){e(t),h.shift(),h.length&&i(h[0][0],h[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var c,l=n.apply(e,t||[]),h=[];return c={},r("next"),r("throw"),r("return"),c[Symbol.asyncIterator]=function(){return this},c},__asyncDelegator=function(e){function t(t,i){e[t]&&(n[t]=function(n){return(r=!r)?{value:__await(e[t](n)),done:"return"===t}:i?i(n):n})}var n,r;return n={},t("next"),t("throw",function(e){throw e}),t("return"),n[Symbol.iterator]=function(){return this},n},__asyncValues=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator];return t?t.call(e):"function"==typeof __values?__values(e):e[Symbol.iterator]()},__makeTemplateObject=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},__importStar=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},__importDefault=function(e){return e&&e.__esModule?e:{default:e}},e("__extends",__extends),e("__assign",__assign),e("__rest",__rest),e("__decorate",__decorate),e("__param",__param),e("__metadata",__metadata),e("__awaiter",__awaiter),e("__generator",__generator),e("__exportStar",__exportStar),e("__values",__values),e("__read",__read),e("__spread",__spread),e("__await",__await),e("__asyncGenerator",__asyncGenerator),e("__asyncDelegator",__asyncDelegator),e("__asyncValues",__asyncValues),e("__makeTemplateObject",__makeTemplateObject),e("__importStar",__importStar),e("__importDefault",__importDefault)}),define("@firebase/util@0.2.3#dist/index.cjs",["require","exports","module","tslib"],function(e,t,n){!function(e,t,n,r){"use strict";function i(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:var n=t;return new Date(n.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var r in t)t.hasOwnProperty(r)&&(e[r]=i(e[r],t[r]));return e}function o(e){return JSON.parse(e)}function a(e,t){if("object"!=typeof e||null===e)return!1;for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i in e&&"function"==typeof e[i])return!0}return!1}function s(){}function u(e,t,n){var r="";switch(t){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}var i=e+" failed: ";return i+=r+" argument "}Object.defineProperty(n,"__esModule",{value:!0});var c=t("tslib"),l={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},h=function(e,t){if(!e)throw p(t)},p=function(e){return new Error("Firebase Database ("+l.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},f=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},d=function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224)a=e[n++],t[r++]=String.fromCharCode((31&i)<<6|63&a);else if(i>239&&i<365){var o=((7&i)<<18|(63&(a=e[n++]))<<12|(63&(s=e[n++]))<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{var a=e[n++],s=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&a)<<6|63&s)}}return t.join("")},m={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var o=e[i],a=i+1<e.length,s=a?e[i+1]:0,u=i+2<e.length,c=u?e[i+2]:0,l=o>>2,h=(3&o)<<4|s>>4,p=(15&s)<<2|c>>6,f=63&c;u||(f=64,a||(p=64)),r.push(n[l],n[h],n[p],n[f])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(f(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):d(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var o=n[e.charAt(i++)],a=i<e.length?n[e.charAt(i)]:0,s=++i<e.length?n[e.charAt(i)]:64,u=++i<e.length?n[e.charAt(i)]:64;if(++i,null==o||null==a||null==s||null==u)throw Error();var c=o<<2|a>>4;if(r.push(c),64!=s){var l=a<<4&240|s>>2;if(r.push(l),64!=u){var h=s<<6&192|u;r.push(h)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},g=function(e){try{return m.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null},y=function(){function e(){var e=this;this.promise=new Promise(function(t,n){e.resolve=t,e.reject=n})}return e.prototype.wrapCallback=function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"==typeof e&&(t.promise.catch(function(){}),1===e.length?e(n):e(n,r))}},e}(),v=function(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""},b="FirebaseError",_=Error.captureStackTrace,w=function(e,t){if(this.code=e,this.message=t,_)_(this,k.prototype.create);else try{throw Error.apply(this,arguments)}catch(e){this.name=b,Object.defineProperty(this,"stack",{get:function(){return e.stack}})}};w.prototype=Object.create(Error.prototype),w.prototype.constructor=w,w.prototype.name=b;var k=function(){function e(e,t,n){this.service=e,this.serviceName=t,this.errors=n,this.pattern=/\{\$([^}]+)}/g}return e.prototype.create=function(e,t){void 0===t&&(t={});var n,r=this.errors[e],i=this.service+"/"+e;n=void 0===r?"Error":r.replace(this.pattern,function(e,n){var r=t[n];return void 0!==r?r.toString():"<"+n+"?>"}),n=this.serviceName+": "+n+" ("+i+").";var o=new w(i,n);for(var a in t)t.hasOwnProperty(a)&&"_"!==a.slice(-1)&&(o[a]=t[a]);return o},e}(),E=function(e){var t={},n={},r={},i="";try{var a=e.split(".");t=o(g(a[0])||""),n=o(g(a[1])||""),i=a[2],r=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}},T=function(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])},S=function(e,t){return T(t,function(t,n){e[t]=n}),e},C=function(e,t,n){for(var r in e)if(t.call(n,e[r],r,e))return r},I=function(e){function t(){var t=e.call(this)||this;t.chain_=[],t.buf_=[],t.W_=[],t.pad_=[],t.inbuf_=0,t.total_=0,t.blockSize=64,t.pad_[0]=128;for(var n=1;n<t.blockSize;++n)t.pad_[n]=0;return t.reset(),t}return c.__extends(t,e),t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(e,t){t||(t=0);var n=this.W_;if("string"==typeof e)for(l=0;l<16;l++)n[l]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(l=0;l<16;l++)n[l]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(l=16;l<80;l++)h=n[l-3]^n[l-8]^n[l-14]^n[l-16],n[l]=4294967295&(h<<1|h>>>31);for(var r,i,o=this.chain_[0],a=this.chain_[1],s=this.chain_[2],u=this.chain_[3],c=this.chain_[4],l=0;l<80;l++){l<40?l<20?(r=u^a&(s^u),i=1518500249):(r=a^s^u,i=1859775393):l<60?(r=a&s|u&(a|s),i=2400959708):(r=a^s^u,i=3395469782);var h=(o<<5|o>>>27)+r+c+i+n[l]&4294967295;c=u,u=s,s=4294967295&(a<<30|a>>>2),a=o,o=h}this.chain_[0]=this.chain_[0]+o&4294967295,this.chain_[1]=this.chain_[1]+a&4294967295,this.chain_[2]=this.chain_[2]+s&4294967295,this.chain_[3]=this.chain_[3]+u&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295},t.prototype.update=function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<t;){if(0==o)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[o]=e.charCodeAt(r),++o,++r,o==this.blockSize){this.compress_(i),o=0;break}}else for(;r<t;)if(i[o]=e[r],++o,++r,o==this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=t}},t.prototype.digest=function(){var e=[],t=8*this.total_;for(this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56)),r=this.blockSize-1;r>=56;r--)this.buf_[r]=255&t,t/=256;this.compress_(this.buf_);for(var n=0,r=0;r<5;r++)for(var i=24;i>=0;i-=8)e[n]=this.chain_[r]>>i&255,++n;return e},t}(function(){this.blockSize=-1}),N=function(){function e(e,t){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(function(){e(n)}).catch(function(e){n.error(e)})}return e.prototype.next=function(e){this.forEachObserver(function(t){t.next(e)})},e.prototype.error=function(e){this.forEachObserver(function(t){t.error(e)}),this.close(e)},e.prototype.complete=function(){this.forEachObserver(function(e){e.complete()}),this.close()},e.prototype.subscribe=function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=a(e,["next","error","complete"])?e:{next:e,error:t,complete:n}).next&&(r.next=s),void 0===r.error&&(r.error=s),void 0===r.complete&&(r.complete=s);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}}),this.observers.push(r),o},e.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},e.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},e.prototype.sendOne=function(e,t){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}})},e.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(function(){t.observers=void 0,t.onNoObservers=void 0}))},e}();n.assert=h,n.assertionError=p,n.base64=m,n.base64Decode=g,n.base64Encode=function(e){var t=f(e);return m.encodeByteArray(t,!0)},n.CONSTANTS=l,n.deepCopy=function(e){return i(void 0,e)},n.deepExtend=i,n.patchProperty=function(e,t,n){e[t]=n},n.Deferred=y,n.getUA=v,n.isMobileCordova=function(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(v())},n.isNodeSdk=function(){return!0===l.NODE_CLIENT||!0===l.NODE_ADMIN},n.isReactNative=function(){return"object"==typeof navigator&&"ReactNative"===navigator.product},n.ErrorFactory=k,n.FirebaseError=w,n.patchCapture=function(e){var t=_;return _=e,t},n.jsonEval=o,n.stringify=function(e){return JSON.stringify(e)},n.decode=E,n.isAdmin=function(e){var t=E(e).claims;return"object"==typeof t&&!0===t.admin},n.issuedAtTime=function(e){var t=E(e).claims;return"object"==typeof t&&t.hasOwnProperty("iat")?t.iat:null},n.isValidFormat=function(e){var t=E(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")},n.isValidTimestamp=function(e){var t,n,r=E(e).claims,i=Math.floor((new Date).getTime()/1e3);return"object"==typeof r&&(r.hasOwnProperty("nbf")?t=r.nbf:r.hasOwnProperty("iat")&&(t=r.iat),n=r.hasOwnProperty("exp")?r.exp:t+86400),i&&t&&n&&i>=t&&i<=n},n.clone=function(e){return S({},e)},n.contains=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.every=function(e,t){for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&!t(n,e[n]))return!1;return!0},n.extend=S,n.findKey=C,n.findValue=function(e,t,n){var r=C(e,t,n);return r&&e[r]},n.forEach=T,n.getAnyKey=function(e){for(var t in e)return t},n.getCount=function(e){var t=0;for(var n in e)t++;return t},n.getValues=function(e){var t=[],n=0;for(var r in e)t[n++]=e[r];return t},n.isEmpty=function(e){for(var t in e)return!1;return!0},n.isNonNullObject=function(e){return"object"==typeof e&&null!==e},n.map=function(e,t,n){var r={};for(var i in e)r[i]=t.call(n,e[i],i,e);return r},n.safeGet=function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]},n.querystring=function(e){var t=[];return T(e,function(e,n){Array.isArray(n)?n.forEach(function(n){t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))}),t.length?"&"+t.join("&"):""},n.querystringDecode=function(e){var t={};return e.replace(/^\?/,"").split("&").forEach(function(e){if(e){var n=e.split("=");t[n[0]]=n[1]}}),t},n.Sha1=I,n.async=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Promise.resolve(!0).then(function(){e.apply(void 0,n)}).catch(function(e){t&&t(e)})}},n.createSubscribe=function(e,t){var n=new N(e,t);return n.subscribe.bind(n)},n.errorPrefix=u,n.validateArgCount=function(e,t,n,r){var i;if(r<t?i="at least "+t:r>n&&(i=0===n?"none":"no more than "+n),i){var o=e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".";throw new Error(o)}},n.validateCallback=function(e,t,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(u(e,t,r)+"must be a valid function.")},n.validateContextObject=function(e,t,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(u(e,t,r)+"must be a valid context object.")},n.validateNamespace=function(e,t,n,r){if((!r||n)&&"string"!=typeof n)throw new Error(u(e,t,r)+"must be a valid firebase namespace.")},n.stringLength=function(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t},n.stringToByteArray=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);if(i>=55296&&i<=56319){var o=i-55296;h(++r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(o<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t}}(0,e,t)}),define("@firebase/app@0.3.5#dist/index.cjs",["require","exports","module","@firebase/util"],function(e,t,n){!function(e,t,n,r){"use strict";function i(){function e(e){return e=e||u,s(c,e)||o("no-app",{name:e}),c[e]}function t(){return Object.keys(c).map(function(e){return c[e]})}function n(e,t){Object.keys(h).forEach(function(n){var i=r(e,n);null!==i&&p[i]&&p[i](t,e)})}function r(e,t){if("serverAuth"===t)return null;var n=t;return e.options,n}var c={},h={},p={},f={__esModule:!0,initializeApp:function(e,t){void 0===t&&(t={}),"object"==typeof t&&null!==t||(t={name:t});var r=t;void 0===r.name&&(r.name=u);var i=r.name;"string"==typeof i&&i||o("bad-app-name",{name:i+""}),s(c,i)&&o("duplicate-app",{name:i});var a=new l(e,r,f);return c[i]=a,n(a,"create"),a},app:e,apps:null,Promise:Promise,SDK_VERSION:"5.5.9",INTERNAL:{registerService:function(n,r,i,s,u){h[n]&&o("duplicate-service",{name:n}),h[n]=r,s&&(p[n]=s,t().forEach(function(e){s("create",e)}));var c=function(t){return void 0===t&&(t=e()),"function"!=typeof t[n]&&o("invalid-app-argument",{name:n}),t[n]()};return void 0!==i&&a.deepExtend(c,i),f[n]=c,l.prototype[n]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._getService.bind(this,n).apply(this,u?e:[])},c},createFirebaseNamespace:i,extendNamespace:function(e){a.deepExtend(f,e)},createSubscribe:a.createSubscribe,ErrorFactory:a.ErrorFactory,removeApp:function(e){n(c[e],"delete"),delete c[e]},factories:h,useAsService:r,Promise:Promise,deepExtend:a.deepExtend}};return a.patchProperty(f,"default",f),Object.defineProperty(f,"apps",{get:t}),a.patchProperty(e,"App",l),f}function o(e,t){throw p.create(e,t)}Object.defineProperty(n,"__esModule",{value:!0});var a=t("@firebase/util"),s=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},u="[DEFAULT]",c=[],l=function(){function e(e,t,n){this.firebase_=n,this.isDeleted_=!1,this.services_={},this.name_=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled||!1,this.options_=a.deepCopy(e),this.INTERNAL={getUid:function(){return null},getToken:function(){return Promise.resolve(null)},addAuthTokenListener:function(e){c.push(e),setTimeout(function(){return e(null)},0)},removeAuthTokenListener:function(e){c=c.filter(function(t){return t!==e})}}}return Object.defineProperty(e.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed_(),this._automaticDataCollectionEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),e.prototype.delete=function(){var e=this;return new Promise(function(t){e.checkDestroyed_(),t()}).then(function(){e.firebase_.INTERNAL.removeApp(e.name_);var t=[];return Object.keys(e.services_).forEach(function(n){Object.keys(e.services_[n]).forEach(function(r){t.push(e.services_[n][r])})}),Promise.all(t.map(function(e){return e.INTERNAL.delete()}))}).then(function(){e.isDeleted_=!0,e.services_={}})},e.prototype._getService=function(e,t){if(void 0===t&&(t=u),this.checkDestroyed_(),this.services_[e]||(this.services_[e]={}),!this.services_[e][t]){var n=t!==u?t:void 0,r=this.firebase_.INTERNAL.factories[e](this,this.extendApp.bind(this),n);this.services_[e][t]=r}return this.services_[e][t]},e.prototype.extendApp=function(e){var t=this;a.deepExtend(this,e),e.INTERNAL&&e.INTERNAL.addAuthTokenListener&&(c.forEach(function(e){t.INTERNAL.addAuthTokenListener(e)}),c=[])},e.prototype.checkDestroyed_=function(){this.isDeleted_&&o("app-deleted",{name:this.name_})},e}();l.prototype.name&&l.prototype.options||l.prototype.delete||console.log("dc");var h={"no-app":"No Firebase App '{$name}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$name}","duplicate-app":"Firebase App named '{$name}' already exists","app-deleted":"Firebase App named '{$name}' already deleted","duplicate-service":"Firebase service named '{$name}' already registered","sa-not-supported":"Initializing the Firebase SDK with a service account is only allowed in a Node.js environment. On client devices, you should instead initialize the SDK with an api key and auth domain","invalid-app-argument":"firebase.{$name}() takes either no argument or a Firebase App instance."},p=new a.ErrorFactory("app","Firebase",h),f=i();n.firebase=f,n.default=f}(0,e,t)}),define("@firebase/auth@0.8.0#dist/auth",["require","exports","module","@firebase/app"],function(e,t,n){!function(e,t,n,r){(function(){function e(e){return"string"==typeof e}function n(e){return"boolean"==typeof e}function r(){}function i(e){var t=typeof e;if("object"==t){if(!e)return"null";if(e instanceof Array)return"array";if(e instanceof Object)return t;var n=Object.prototype.toString.call(e);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof e.length&&void 0!==e.splice&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==e.call&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("call"))return"function"}else if("function"==t&&void 0===e.call)return"object";return t}function o(e){return null===e}function a(e){return"array"==i(e)}function s(e){var t=i(e);return"array"==t||"object"==t&&"number"==typeof e.length}function u(e){return"function"==i(e)}function c(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function l(e,t,n){return e.call.apply(e.bind,arguments)}function h(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function p(e,t,n){return(p=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?l:h).apply(null,arguments)}function f(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function d(e,t){function n(){}n.prototype=t.prototype,e.nb=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.dd=function(e,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return t.prototype[n].apply(e,i)}}function m(e){e.prototype.then=e.prototype.then,e.prototype.$goog_Thenable=!0}function g(e){if(!e)return!1;try{return!!e.$goog_Thenable}catch(e){return!1}}function y(e){if(Error.captureStackTrace)Error.captureStackTrace(this,y);else{var t=Error().stack;t&&(this.stack=t)}e&&(this.message=String(e))}function v(e,t){for(var n="",r=(e=e.split("%s")).length-1,i=0;i<r;i++)n+=e[i]+(i<t.length?t[i]:"%s");y.call(this,n+e[r])}function b(e,t){throw new v("Failure"+(e?": "+e:""),Array.prototype.slice.call(arguments,1))}function _(e,t){this.c=e,this.f=t,this.b=0,this.a=null}function w(e,t){e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}function k(){this.b=this.a=null}function E(){var e=oc,t=null;return e.a&&(t=e.a,e.a=e.a.next,e.a||(e.b=null),t.next=null),t}function T(){this.next=this.b=this.a=null}function S(t,n){var r=t.length,i=e(t)?t.split(""):t;for(--r;0<=r;--r)r in i&&n.call(void 0,i[r],r,t)}function C(t){e:{for(var n=Qr,r=t.length,i=e(t)?t.split(""):t,o=0;o<r;o++)if(o in i&&n.call(void 0,i[o],o,t)){n=o;break e}n=-1}return 0>n?null:e(t)?t.charAt(n):t[n]}function I(e,t){return 0<=Fu(e,t)}function N(e,t){var n;return(n=0<=(t=Fu(e,t)))&&Array.prototype.splice.call(e,t,1),n}function D(e,t){var n=0;S(e,function(r,i){t.call(void 0,r,i,e)&&1==Array.prototype.splice.call(e,i,1).length&&n++})}function A(e){return Array.prototype.concat.apply([],arguments)}function x(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function O(e,t){for(var n=e.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function P(e){return Ju.test(e)?(-1!=e.indexOf("&")&&(e=e.replace(zu,"&amp;")),-1!=e.indexOf("<")&&(e=e.replace(Qu,"&lt;")),-1!=e.indexOf(">")&&(e=e.replace(Gu,"&gt;")),-1!=e.indexOf('"')&&(e=e.replace(Xu,"&quot;")),-1!=e.indexOf("'")&&(e=e.replace(Yu,"&#39;")),-1!=e.indexOf("\0")&&(e=e.replace($u,"&#0;")),e):e}function R(e,t){return-1!=e.indexOf(t)}function L(e,t){return e<t?-1:e>t?1:0}function M(e){return R(qu,e)}function V(e,t){for(var n in e)t.call(void 0,e[n],n,e)}function j(e){for(var t in e)return!1;return!0}function U(e){var t,n={};for(t in e)n[t]=e[t];return n}function q(e,t){for(var n,r,i=1;i<arguments.length;i++){r=arguments[i];for(n in r)e[n]=r[n];for(var o=0;o<rc.length;o++)n=rc[o],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function F(e){Lu.setTimeout(function(){throw e},0)}function B(){var e=Lu.MessageChannel;if(void 0===e&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!M("Presto")&&(e=function(){var e=document.createElement("IFRAME");e.style.display="none",e.src="",document.documentElement.appendChild(e);var t=e.contentWindow;(e=t.document).open(),e.write(""),e.close();var n="callImmediate"+Math.random(),r="file:"==t.location.protocol?"*":t.location.protocol+"//"+t.location.host;e=p(function(e){"*"!=r&&e.origin!=r||e.data!=n||this.port1.onmessage()},this),t.addEventListener("message",e,!1),this.port1={},this.port2={postMessage:function(){t.postMessage(n,r)}}}),void 0!==e&&!M("Trident")&&!M("MSIE")){var t=new e,n={},r=n;return t.port1.onmessage=function(){if(void 0!==n.next){var e=(n=n.next).vb;n.vb=null,e()}},function(e){r.next={vb:e},r=r.next,t.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(e){var t=document.createElement("SCRIPT");t.onreadystatechange=function(){t.onreadystatechange=null,t.parentNode.removeChild(t),t=null,e(),e=null},document.documentElement.appendChild(t)}:function(e){Lu.setTimeout(e,0)}}function K(e,t){nc||W(),ic||(nc(),ic=!0),oc.add(e,t)}function W(){if(Lu.Promise&&Lu.Promise.resolve){var e=Lu.Promise.resolve(void 0);nc=function(){e.then(H)}}else nc=function(){var e=H;!u(Lu.setImmediate)||Lu.Window&&Lu.Window.prototype&&!M("Edge")&&Lu.Window.prototype.setImmediate==Lu.setImmediate?(tc||(tc=B()),tc(e)):Lu.setImmediate(e)}}function H(){for(var e;e=E();){try{e.a.call(e.b)}catch(e){F(e)}w(Uu,e)}ic=!1}function z(e,t){if(this.a=ac,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,e!=r)try{var n=this;e.call(t,function(e){re(n,sc,e)},function(e){if(!(e instanceof he))try{if(e instanceof Error)throw e;throw Error("Promise rejected.")}catch(e){}re(n,uc,e)})}catch(e){re(this,uc,e)}}function Q(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}function G(e,t,n){var r=cc.get();return r.g=e,r.b=t,r.f=n,r}function X(e){if(e instanceof z)return e;var t=new z(r);return re(t,sc,e),t}function Y(e){return new z(function(t,n){n(e)})}function $(e,t,n){ie(e,t,n,null)||K(f(t,e))}function J(e){return new z(function(t,n){var r=e.length,i=[];if(r)for(var o,a=function(e,n){r--,i[e]=n,0==r&&t(i)},s=function(e){n(e)},u=0;u<e.length;u++)o=e[u],$(o,f(a,u),s);else t(i)})}function Z(e){return new z(function(t){var n=e.length,r=[];if(n)for(var i,o=function(e,i,o){n--,r[e]=i?{Cb:!0,value:o}:{Cb:!1,reason:o},0==n&&t(r)},a=0;a<e.length;a++)i=e[a],$(i,f(o,a,!0),f(o,a,!1));else t(r)})}function ee(e,t){if(e.a==ac)if(e.c){var n=e.c;if(n.b){for(var r=0,i=null,o=null,a=n.b;a&&(a.c||(r++,a.a==e&&(i=a),!(i&&1<r)));a=a.next)i||(o=a);i&&(n.a==ac&&1==r?ee(n,t):(o?((r=o).next==n.f&&(n.f=r),r.next=r.next.next):se(n),ue(n,i,uc,t)))}e.c=null}else re(e,uc,t)}function te(e,t){e.b||e.a!=sc&&e.a!=uc||ae(e),e.f?e.f.next=t:e.b=t,e.f=t}function ne(e,t,n,r){var i=G(null,null,null);return i.a=new z(function(e,o){i.g=t?function(n){try{var i=t.call(r,n);e(i)}catch(e){o(e)}}:e,i.b=n?function(t){try{var i=n.call(r,t);void 0===i&&t instanceof he?o(t):e(i)}catch(e){o(e)}}:o}),i.a.c=e,te(e,i),i.a}function re(e,t,n){e.a==ac&&(e===n&&(t=uc,n=new TypeError("Promise cannot resolve to itself")),e.a=1,ie(n,e.Mc,e.Nc,e)||(e.i=n,e.a=t,e.c=null,ae(e),t!=uc||n instanceof he||le(e,n)))}function ie(e,t,n,i){if(e instanceof z)return te(e,G(t||r,n||null,i)),!0;if(g(e))return e.then(t,n,i),!0;if(c(e))try{var o=e.then;if(u(o))return oe(e,o,t,n,i),!0}catch(e){return n.call(i,e),!0}return!1}function oe(e,t,n,r,i){function o(e){a||(a=!0,r.call(i,e))}var a=!1;try{t.call(e,function(e){a||(a=!0,n.call(i,e))},o)}catch(e){o(e)}}function ae(e){e.h||(e.h=!0,K(e.Xb,e))}function se(e){var t=null;return e.b&&(t=e.b,e.b=t.next,t.next=null),e.b||(e.f=null),t}function ue(e,t,n,r){if(n==uc&&t.b&&!t.c)for(;e&&e.g;e=e.c)e.g=!1;if(t.a)t.a.c=null,ce(t,n,r);else try{t.c?t.g.call(t.f):ce(t,n,r)}catch(e){lc.call(null,e)}w(cc,t)}function ce(e,t,n){t==sc?e.g.call(e.f,n):e.b&&e.b.call(e.f,n)}function le(e,t){e.g=!0,K(function(){e.g&&lc.call(null,t)})}function he(e){y.call(this,e)}function pe(){0!=hc&&(pc[this[Mu]||(this[Mu]=++Vu)]=this),this.pa=this.pa,this.ja=this.ja}function fe(e){if(!e.pa&&(e.pa=!0,e.ua(),0!=hc)){var t=e[Mu]||(e[Mu]=++Vu);if(0!=hc&&e.ja&&0<e.ja.length)throw Error(e+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete pc[t]}}function de(e){return de[" "](e),e}function me(e,t){var n=Tc;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}function ge(){var e=Lu.document;return e?e.documentMode:void 0}function ye(e){return me(e,function(){for(var t=0,n=Hu(String(fc)).split("."),r=Hu(String(e)).split("."),i=Math.max(n.length,r.length),o=0;0==t&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;t=L(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||L(0==a[2].length,0==s[2].length)||L(a[2],s[2]),a=a[3],s=s[3]}while(0==t)}return 0<=t})}function ve(e,t){this.type=e,this.b=this.target=t,this.Jb=!0}function be(t,n){if(ve.call(this,t?t.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,t){var r=this.type=t.type,i=t.changedTouches?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.b=n,n=t.relatedTarget){if(vc){e:{try{de(n.nodeName);var o=!0;break e}catch(e){}o=!1}o||(n=null)}}else"mouseover"==r?n=t.fromElement:"mouseout"==r&&(n=t.toElement);this.relatedTarget=n,null===i?(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0):(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=e(t.pointerType)?t.pointerType:Ac[t.pointerType]||"",this.a=t,t.defaultPrevented&&this.preventDefault()}}function _e(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.La=i,this.key=++Oc,this.na=this.Ia=!1}function we(e){e.na=!0,e.listener=null,e.proxy=null,e.src=null,e.La=null}function ke(e){this.src=e,this.a={},this.b=0}function Ee(e,t){var n=t.type;n in e.a&&N(e.a[n],t)&&(we(t),0==e.a[n].length&&(delete e.a[n],e.b--))}function Te(e,t,n,r){for(var i=0;i<e.length;++i){var o=e[i];if(!o.na&&o.listener==t&&o.capture==!!n&&o.La==r)return i}return-1}function Se(e,t,n,r,i){if(r&&r.once)Ne(e,t,n,r,i);else if(a(t))for(var o=0;o<t.length;o++)Se(e,t[o],n,r,i);else n=Me(n),e&&e[xc]?je(e,t,n,c(r)?!!r.capture:!!r,i):Ce(e,t,n,!1,r,i)}function Ce(e,t,n,r,i,o){if(!t)throw Error("Invalid event type");var a=c(i)?!!i.capture:!!i,s=Le(e);if(s||(e[Pc]=s=new ke(e)),!(n=s.add(t,n,r,a,o)).proxy){if(r=Ie(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)Dc||(i=a),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(xe(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}Lc++}}function Ie(){var e=Re,t=Ic?function(n){return e.call(t.src,t.listener,n)}:function(n){if(!(n=e.call(t.src,t.listener,n)))return n};return t}function Ne(e,t,n,r,i){if(a(t))for(var o=0;o<t.length;o++)Ne(e,t[o],n,r,i);else n=Me(n),e&&e[xc]?Ue(e,t,n,c(r)?!!r.capture:!!r,i):Ce(e,t,n,!0,r,i)}function De(e,t,n,r,i){if(a(t))for(var o=0;o<t.length;o++)De(e,t[o],n,r,i);else r=c(r)?!!r.capture:!!r,n=Me(n),e&&e[xc]?(e=e.l,(t=String(t).toString())in e.a&&(o=e.a[t],-1<(n=Te(o,n,r,i))&&(we(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete e.a[t],e.b--)))):e&&(e=Le(e))&&(t=e.a[t.toString()],e=-1,t&&(e=Te(t,n,r,i)),(n=-1<e?t[e]:null)&&Ae(n))}function Ae(e){if("number"!=typeof e&&e&&!e.na){var t=e.src;if(t&&t[xc])Ee(t.l,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(xe(n),r):t.addListener&&t.removeListener&&t.removeListener(r),Lc--,(n=Le(t))?(Ee(n,e),0==n.b&&(n.src=null,t[Pc]=null)):we(e)}}}function xe(e){return e in Rc?Rc[e]:Rc[e]="on"+e}function Oe(e,t,n,r){var i=!0;if((e=Le(e))&&(t=e.a[t.toString()]))for(t=t.concat(),e=0;e<t.length;e++){var o=t[e];o&&o.capture==n&&!o.na&&(o=Pe(o,r),i=i&&!1!==o)}return i}function Pe(e,t){var n=e.listener,r=e.La||e.src;return e.Ia&&Ae(e),n.call(r,t)}function Re(e,t){if(e.na)return!0;if(!Ic){if(!t)e:{t=["window","event"];for(var n=Lu,r=0;r<t.length;r++)if(null==(n=n[t[r]])){t=null;break e}t=n}if(r=t,t=new be(r,this),n=!0,!(0>r.keyCode||void 0!=r.returnValue)){e:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break e}catch(e){i=!0}(i||void 0==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=t.b;i;i=i.parentNode)r.push(i);for(e=e.type,i=r.length-1;0<=i;i--){t.b=r[i];var o=Oe(r[i],e,!0,t);n=n&&o}for(i=0;i<r.length;i++)t.b=r[i],o=Oe(r[i],e,!1,t),n=n&&o}return n}return Pe(e,new be(t,this))}function Le(e){return(e=e[Pc])instanceof ke?e:null}function Me(e){return u(e)?e:(e[Mc]||(e[Mc]=function(t){return e.handleEvent(t)}),e[Mc])}function Ve(){pe.call(this),this.l=new ke(this),this.Qb=this,this.Ua=null}function je(e,t,n,r,i){e.l.add(String(t),n,!1,r,i)}function Ue(e,t,n,r,i){e.l.add(String(t),n,!0,r,i)}function qe(e,t,n,r){if(!(t=e.l.a[String(t)]))return!0;t=t.concat();for(var i=!0,o=0;o<t.length;++o){var a=t[o];if(a&&!a.na&&a.capture==n){var s=a.listener,u=a.La||a.src;a.Ia&&Ee(e.l,a),i=!1!==s.call(u,r)&&i}}return i&&0!=r.Jb}function Fe(e,t,n){if(u(e))n&&(e=p(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=p(e.handleEvent,e)}return 2147483647<Number(t)?-1:Lu.setTimeout(e,t||0)}function Be(e){var t=null;return new z(function(n,r){-1==(t=Fe(function(){n(void 0)},e))&&r(Error("Failed to schedule timer."))}).s(function(e){throw Lu.clearTimeout(t),e})}function Ke(t){if(t.S&&"function"==typeof t.S)return t.S();if(e(t))return t.split("");if(s(t)){for(var n=[],r=t.length,i=0;i<r;i++)n.push(t[i]);return n}n=[],r=0;for(i in t)n[r++]=t[i];return n}function We(t){if(t.U&&"function"==typeof t.U)return t.U();if(!t.S||"function"!=typeof t.S){if(s(t)||e(t)){var n=[];t=t.length;for(var r=0;r<t;r++)n.push(r);return n}n=[],r=0;for(var i in t)n[r++]=i;return n}}function He(t,n){if(t.forEach&&"function"==typeof t.forEach)t.forEach(n,void 0);else if(s(t)||e(t))Bu(t,n,void 0);else for(var r=We(t),i=Ke(t),o=i.length,a=0;a<o;a++)n.call(void 0,i[a],r&&r[a],t)}function ze(e,t){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof ze)for(n=e.U(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function Qe(e){if(e.c!=e.a.length){for(var t=0,n=0;t<e.a.length;){var r=e.a[t];Ge(e.b,r)&&(e.a[n++]=r),t++}e.a.length=n}if(e.c!=e.a.length){var i={};for(n=t=0;t<e.a.length;)r=e.a[t],Ge(i,r)||(e.a[n++]=r,i[r]=1),t++;e.a.length=n}}function Ge(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Xe(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var o=e[n].substring(0,r);i=e[n].substring(r+1)}else o=e[n];t(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Ye(e,t){if(this.b=this.l=this.c="",this.i=null,this.h=this.g="",this.f=!1,e instanceof Ye){this.f=void 0!==t?t:e.f,$e(this,e.c),this.l=e.l,this.b=e.b,Je(this,e.i),this.g=e.g,t=e.a;var n=new st;n.c=t.c,t.a&&(n.a=new ze(t.a),n.b=t.b),Ze(this,n),this.h=e.h}else e&&(n=String(e).match(Vc))?(this.f=!!t,$e(this,n[1]||"",!0),this.l=it(n[2]||""),this.b=it(n[3]||"",!0),Je(this,n[4]),this.g=it(n[5]||"",!0),Ze(this,n[6]||"",!0),this.h=it(n[7]||"")):(this.f=!!t,this.a=new st(null,this.f))}function $e(e,t,n){e.c=n?it(t,!0):t,e.c&&(e.c=e.c.replace(/:$/,""))}function Je(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.i=t}else e.i=null}function Ze(e,t,n){t instanceof st?(e.a=t,dt(e.a,e.f)):(n||(t=ot(t,Fc)),e.a=new st(t,e.f))}function et(e,t,n){e.a.set(t,n)}function tt(e,t){return e.a.get(t)}function nt(e){return e instanceof Ye?new Ye(e):new Ye(e,void 0)}function rt(e,t){var n=new Ye(null,void 0);return $e(n,"https"),e&&(n.b=e),t&&(n.g=t),n}function it(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function ot(t,n,r){return e(t)?(t=encodeURI(t).replace(n,at),r&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function at(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}function st(e,t){this.b=this.a=null,this.c=e||null,this.f=!!t}function ut(e){e.a||(e.a=new ze,e.b=0,e.c&&Xe(e.c,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function ct(e){var t=We(e);if(void 0===t)throw Error("Keys are undefined");var n=new st(null,void 0);e=Ke(e);for(var r=0;r<t.length;r++){var i=t[r],o=e[r];a(o)?pt(n,i,o):n.add(i,o)}return n}function lt(e,t){ut(e),t=ft(e,t),Ge(e.a.b,t)&&(e.c=null,e.b-=e.a.get(t).length,e=e.a,Ge(e.b,t)&&(delete e.b[t],e.c--,e.a.length>2*e.c&&Qe(e)))}function ht(e,t){return ut(e),t=ft(e,t),Ge(e.a.b,t)}function pt(e,t,n){lt(e,t),0<n.length&&(e.c=null,e.a.set(ft(e,t),x(n)),e.b+=n.length)}function ft(e,t){return t=String(t),e.f&&(t=t.toLowerCase()),t}function dt(e,t){t&&!e.f&&(ut(e),e.c=null,e.a.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(lt(this,t),pt(this,n,e))},e)),e.f=t}function mt(){this.a="",this.b=Wc}function gt(e){return e instanceof mt&&e.constructor===mt&&e.b===Wc?e.a:(b("expected object of type Const, got '"+e+"'"),"type_error:Const")}function yt(e){var t=new mt;return t.a=e,t}function vt(){this.a="",this.b=Qc}function bt(e){return e instanceof vt&&e.constructor===vt&&e.b===Qc?e.a:(b("expected object of type TrustedResourceUrl, got '"+e+"' of type "+i(e)),"type_error:TrustedResourceUrl")}function _t(e,t){var n=gt(e);if(!zc.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return e=n.replace(Hc,function(e,r){if(!Object.prototype.hasOwnProperty.call(t,r))throw Error('Found marker, "'+r+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(t));return(e=t[r])instanceof mt?gt(e):encodeURIComponent(String(e))}),wt(e)}function wt(e){var t=new vt;return t.a=e,t}function kt(){this.a="",this.b=Xc}function Et(e){return e instanceof kt&&e.constructor===kt&&e.b===Xc?e.a:(b("expected object of type SafeUrl, got '"+e+"' of type "+i(e)),"type_error:SafeUrl")}function Tt(e){return e instanceof kt?e:(e=e.ma?e.la():String(e),Gc.test(e)||(e="about:invalid#zClosurez"),St(e))}function St(e){var t=new kt;return t.a=e,t}function Ct(){this.a="",this.b=Yc}function It(e){return e instanceof Ct&&e.constructor===Ct&&e.b===Yc?e.a:(b("expected object of type SafeHtml, got '"+e+"' of type "+i(e)),"type_error:SafeHtml")}function Nt(e){var t=new Ct;return t.a=e,t}function Dt(t){var n=document;return e(t)?n.getElementById(t):t}function At(e,t){V(t,function(t,n){t&&t.ma&&(t=t.la()),"style"==n?e.style.cssText=t:"class"==n?e.className=t:"for"==n?e.htmlFor=t:$c.hasOwnProperty(n)?e.setAttribute($c[n],t):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?e.setAttribute(n,t):e[n]=t})}function xt(t,n,r){var i=arguments,o=document,s=String(i[0]),u=i[1];if(!Kc&&u&&(u.name||u.type)){if(s=["<",s],u.name&&s.push(' name="',P(u.name),'"'),u.type){s.push(' type="',P(u.type),'"');var c={};q(c,u),delete c.type,u=c}s.push(">"),s=s.join("")}return s=o.createElement(s),u&&(e(u)?s.className=u:a(u)?s.className=u.join(" "):At(s,u)),2<i.length&&Ot(o,s,i),s}function Ot(t,n,r){function i(r){r&&n.appendChild(e(r)?t.createTextNode(r):r)}for(var o=2;o<r.length;o++){var a=r[o];!s(a)||c(a)&&0<a.nodeType?i(a):Bu(Pt(a)?x(a):a,i)}}function Pt(e){if(e&&"number"==typeof e.length){if(c(e))return"function"==typeof e.item||"string"==typeof e.item;if(u(e))return"function"==typeof e.item}return!1}function Rt(e){var t=[];return Mt(new Lt,e,t),t.join("")}function Lt(){}function Mt(e,t,n){if(null==t)n.push("null");else{if("object"==typeof t){if(a(t)){var r=t;t=r.length,n.push("[");for(var i="",o=0;o<t;o++)n.push(i),Mt(e,r[o],n),i=",";return void n.push("]")}if(!(t instanceof String||t instanceof Number||t instanceof Boolean)){n.push("{"),i="";for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&"function"!=typeof(o=t[r])&&(n.push(i),Vt(r,n),n.push(":"),Mt(e,o,n),i=",");return void n.push("}")}t=t.valueOf()}switch(typeof t){case"string":Vt(t,n);break;case"number":n.push(isFinite(t)&&!isNaN(t)?String(t):"null");break;case"boolean":n.push(String(t));break;case"function":n.push("null");break;default:throw Error("Unknown type: "+typeof t)}}}function Vt(e,t){t.push('"',e.replace(Zc,function(e){var t=Jc[e];return t||(t="\\u"+(65536|e.charCodeAt(0)).toString(16).substr(1),Jc[e]=t),t}),'"')}function jt(){var e=rn();return mc&&!!Ec&&11==Ec||/Edge\/\d+/.test(e)}function Ut(){return Lu.window&&Lu.window.location.href||self&&self.location&&self.location.href||""}function qt(e,t){t=t||Lu.window;var n="about:blank";e&&(n=Et(Tt(e))),t.location.href=n}function Ft(e,t){var n,r=[];for(n in e)n in t?typeof e[n]!=typeof t[n]?r.push(n):"object"==typeof e[n]&&null!=e[n]&&null!=t[n]?0<Ft(e[n],t[n]).length&&r.push(n):e[n]!==t[n]&&r.push(n):r.push(n);for(n in t)n in e||r.push(n);return r}function Bt(){var e=rn();return!((e=tn(e)!=nl?null:(e=e.match(/\sChrome\/(\d+)/i))&&2==e.length?parseInt(e[1],10):null)&&30>e||mc&&Ec&&!(9<Ec))}function Kt(e){return!!((e=(e||rn()).toLowerCase()).match(/android/)||e.match(/webos/)||e.match(/iphone|ipad|ipod/)||e.match(/blackberry/)||e.match(/windows phone/)||e.match(/iemobile/))}function Wt(e){e=e||Lu.window;try{e.close()}catch(e){}}function Ht(e,t,n){var r=Math.floor(1e9*Math.random()).toString();t=t||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-t)/2;t={width:t,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=rn().toLowerCase(),r&&(t.target=r,R(n,"crios/")&&(t.target="_blank")),tn(rn())==tl&&(e=e||"http://localhost",t.scrollbars=!0),n=e||"",(e=t)||(e={}),r=window,t=n instanceof kt?n:Tt(void 0!==n.href?n.href:String(n)),n=e.target||n.target,i=[];for(a in e)switch(a){case"width":case"height":case"top":case"left":i.push(a+"="+e[a]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(a+"="+(e[a]?1:0))}var a=i.join(",");if((M("iPhone")&&!M("iPod")&&!M("iPad")||M("iPad")||M("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(a=r.document.createElement("A"),t instanceof kt||t instanceof kt||(t=t.ma?t.la():String(t),Gc.test(t)||(t="about:invalid#zClosurez"),t=St(t)),a.href=Et(t),a.setAttribute("target",n),e.noreferrer&&a.setAttribute("rel","noreferrer"),(e=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,r,1),a.dispatchEvent(e),a={}):e.noreferrer?(a=r.open("",n,a),e=Et(t),a&&(yc&&R(e,";")&&(e="'"+e.replace(/'/g,"%27")+"'"),a.opener=null,yt("b/12014412, meta tag with sanitized URL"),e='<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+P(e)+'">',e=Nt(e),a.document.write(It(e)),a.document.close())):(a=r.open(Et(t),n,a))&&e.noopener&&(a.opener=null),a)try{a.focus()}catch(e){}return a}function zt(e){return new z(function(t){function n(){Be(2e3).then(function(){if(e&&!e.closed)return n();t()})}return n()})}function Qt(){var e=null;return new z(function(t){"complete"==Lu.document.readyState?t():(e=function(){t()},Ne(window,"load",e))}).s(function(t){throw De(window,"load",e),t})}function Gt(){return Xt(void 0)?Qt().then(function(){return new z(function(e,t){var n=Lu.document,r=setTimeout(function(){t(Error("Cordova framework is not ready."))},1e3);n.addEventListener("deviceready",function(){clearTimeout(r),e()},!1)})}):Y(Error("Cordova must run in an Android or iOS file scheme."))}function Xt(e){return e=e||rn(),!("file:"!==cn()||!e.toLowerCase().match(/iphone|ipad|ipod|android/))}function Yt(){var e=Lu.window;try{return!(!e||e==e.top)}catch(e){return!1}}function $t(){return"object"!=typeof Lu.window&&"function"==typeof Lu.importScripts}function Jt(){return Pu.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":Pu.INTERNAL.hasOwnProperty("node")?"Node":$t()?"Worker":"Browser"}function Zt(){var e=Jt();return"ReactNative"===e||"Node"===e}function en(){for(var e=50,t=[];0<e;)t.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),e--;return t.join("")}function tn(e){var t=e.toLowerCase();return R(t,"opera/")||R(t,"opr/")||R(t,"opios/")?"Opera":R(t,"iemobile")?"IEMobile":R(t,"msie")||R(t,"trident/")?"IE":R(t,"edge/")?"Edge":R(t,"firefox/")?tl:R(t,"silk/")?"Silk":R(t,"blackberry")?"Blackberry":R(t,"webos")?"Webos":!R(t,"safari/")||R(t,"chrome/")||R(t,"crios/")||R(t,"android")?!R(t,"chrome/")&&!R(t,"crios/")||R(t,"edge/")?R(t,"android")?"Android":(e=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==e.length?e[1]:"Other":nl:"Safari"}function nn(e,t){t=t||[];var n,r=[],i={};for(n in rl)i[rl[n]]=!0;for(n=0;n<t.length;n++)void 0!==i[t[n]]&&(delete i[t[n]],r.push(t[n]));return r.sort(),(t=r).length||(t=["FirebaseCore-web"]),"Browser"===(r=Jt())?(i=rn(),r=tn(i)):"Worker"===r&&(i=rn(),r=tn(i)+"-"+r),r+"/JsCore/"+e+"/"+t.join(",")}function rn(){return Lu.navigator&&Lu.navigator.userAgent||""}function on(e,t){e=e.split("."),t=t||Lu;for(var n=0;n<e.length&&"object"==typeof t&&null!=t;n++)t=t[e[n]];return n!=e.length&&(t=void 0),t}function an(){try{var e=Lu.localStorage,t=dn();if(e)return e.setItem(t,"1"),e.removeItem(t),!jt()||!!Lu.indexedDB}catch(e){return $t()&&!!Lu.indexedDB}return!1}function sn(){return(un()||"chrome-extension:"===cn()||Xt())&&!Zt()&&an()&&!$t()}function un(){return"http:"===cn()||"https:"===cn()}function cn(){return Lu.location&&Lu.location.protocol||null}function ln(e){return e=e||rn(),!Kt(e)&&tn(e)!=tl}function hn(e){return void 0===e?null:Rt(e)}function pn(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&null!==e[t]&&void 0!==e[t]&&(n[t]=e[t]);return n}function fn(e){if(null!==e)return JSON.parse(e)}function dn(e){return e||Math.floor(1e9*Math.random()).toString()}function mn(e){return e=e||rn(),"Safari"!=tn(e)&&!e.toLowerCase().match(/iphone|ipad|ipod/)}function gn(){var e=Lu.___jsl;if(e&&e.H)for(var t in e.H)if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=e.H[t].L.concat(),e.CP)for(var n=0;n<e.CP.length;n++)e.CP[n]=null}function yn(e,t){if(e>t)throw Error("Short delay should be less than long delay!");this.a=e,this.c=t,e=rn(),t=Jt(),this.b=Kt(e)||"ReactNative"===t}function vn(){var e=Lu.document;return!e||void 0===e.visibilityState||"visible"==e.visibilityState}function bn(){var e=Lu.document,t=null;return vn()||!e?X():new z(function(n){t=function(){vn()&&(e.removeEventListener("visibilitychange",t,!1),n())},e.addEventListener("visibilitychange",t,!1)}).s(function(n){throw e.removeEventListener("visibilitychange",t,!1),n})}function _n(e){try{var t=new Date(parseInt(e,10));if(!isNaN(t.getTime())&&!/[^0-9]/.test(e))return t.toUTCString()}catch(e){}return null}function wn(){return!(!on("fireauth.oauthhelper",Lu)&&!on("fireauth.iframe",Lu))}function kn(){var e=Lu.navigator;return e&&e.serviceWorker&&e.serviceWorker.controller||null}function En(){var e=Lu.navigator;return e&&e.serviceWorker?X().then(function(){return e.serviceWorker.ready}).then(function(e){return e.active||null}).s(function(){return null}):X(null)}function Tn(e){ol[e]||(ol[e]=!0,"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(e))}function Sn(e,t,n){il?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,value:n}):e[t]=n}function Cn(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&Sn(e,n,t[n])}function In(e){var t={};return Cn(t,e),t}function Nn(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}function Dn(e,t){if(!t||!t.length)return!0;if(!e)return!1;for(var n=0;n<t.length;n++){var r=e[t[n]];if(void 0===r||null===r||""===r)return!1}return!0}function An(e){var t=e;if("object"==typeof e&&null!=e){t="length"in e?[]:{};for(var n in e)Sn(t,n,An(e[n]))}return t}function xn(e){var t={},n=e[ul],r=e[cl];if(!(e=e[ll])||e!=sl&&!n)throw Error("Invalid provider user info!");t[pl]=r||null,t[hl]=n||null,Sn(this,dl,e),Sn(this,fl,An(t))}function On(e,t){this.code=ml+e,this.message=t||gl[e]||""}function Pn(e){var t=e&&e.code;return t?new On(t.substring(ml.length),e.message):null}function Rn(e){var t=e[wl];if(void 0===t)throw new On("missing-continue-uri");if("string"!=typeof t||"string"==typeof t&&!t.length)throw new On("invalid-continue-uri");this.h=t,this.b=this.a=null,this.g=!1;var n=e[yl];if(n&&"object"==typeof n){t=n[Tl];var r=n[kl];if(n=n[El],"string"==typeof t&&t.length){if(this.a=t,void 0!==r&&"boolean"!=typeof r)throw new On("argument-error",kl+" property must be a boolean when specified.");if(this.g=!!r,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new On("argument-error",El+" property must be a non empty string when specified.");this.b=n||null}else{if(void 0!==t)throw new On("argument-error",Tl+" property must be a non empty string when specified.");if(void 0!==r||void 0!==n)throw new On("missing-android-pkg-name")}}else if(void 0!==n)throw new On("argument-error",yl+" property must be a non null object when specified.");if(this.f=null,(t=e[_l])&&"object"==typeof t){if("string"==typeof(t=t[Sl])&&t.length)this.f=t;else if(void 0!==t)throw new On("argument-error",Sl+" property must be a non empty string when specified.")}else if(void 0!==t)throw new On("argument-error",_l+" property must be a non null object when specified.");if(void 0!==(t=e[bl])&&"boolean"!=typeof t)throw new On("argument-error",bl+" property must be a boolean when specified.");if(this.c=!!t,void 0!==(e=e[vl])&&("string"!=typeof e||"string"==typeof e&&!e.length))throw new On("argument-error",vl+" property must be a non empty string when specified.");this.i=e||null}function Ln(e){var t={};t.continueUrl=e.h,t.canHandleCodeInApp=e.c,(t.androidPackageName=e.a)&&(t.androidMinimumVersion=e.b,t.androidInstallApp=e.g),t.iOSBundleId=e.f,t.dynamicLinkDomain=e.i;for(var n in t)null===t[n]&&delete t[n];return t}function Mn(e){return Ku(e,function(e){return 1<(e=e.toString(16)).length?e:"0"+e}).join("")}function Vn(e){var t="";return jn(e,function(e){t+=String.fromCharCode(e)}),t}function jn(e,t){function n(t){for(;r<e.length;){var n=e.charAt(r++),i=Il[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return t}Un();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;t(i<<2|o>>4),64!=a&&(t(o<<4&240|a>>2),64!=s&&t(a<<6&192|s))}}function Un(){if(!Cl){Cl={},Il={};for(var e=0;65>e;e++)Cl[e]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e),Il[Cl[e]]=e,62<=e&&(Il["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(e)]=e)}}function qn(e){this.c=e.sub,ju(),this.a=e.provider_id||e.firebase&&e.firebase.sign_in_provider||null,this.b=!!e.is_anonymous||"anonymous"==this.a}function Fn(e){return(e=Bn(e))&&e.sub&&e.iss&&e.aud&&e.exp?new qn(e):null}function Bn(e){if(!e)return null;if(3!=(e=e.split(".")).length)return null;for(var t=(4-(e=e[1]).length%4)%4,n=0;n<t;n++)e+=".";try{return JSON.parse(Vn(e))}catch(e){}return null}function Kn(e){for(var t in Al)if(Al[t].Na==e)return Al[t];return null}function Wn(e){var t={};t["facebook.com"]=Qn,t["google.com"]=Xn,t["github.com"]=Gn,t["twitter.com"]=Yn;var n=e&&e[Ol];try{if(n)return t[n]?new t[n](e):new zn(e);if(void 0!==e[xl])return new Hn(e)}catch(e){}return null}function Hn(e){var t=e[Ol];if(!t&&e[xl]){var n=Fn(e[xl]);n&&n.a&&(t=n.a)}if(!t)throw Error("Invalid additional user info!");"anonymous"!=t&&"custom"!=t||(t=null),n=!1,void 0!==e.isNewUser?n=!!e.isNewUser:"identitytoolkit#SignupNewUserResponse"===e.kind&&(n=!0),Sn(this,"providerId",t),Sn(this,"isNewUser",n)}function zn(e){Hn.call(this,e),Sn(this,"profile",An((e=fn(e.rawUserInfo||"{}"))||{}))}function Qn(e){if(zn.call(this,e),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function Gn(e){if(zn.call(this,e),"github.com"!=this.providerId)throw Error("Invalid provider ID!");Sn(this,"username",this.profile&&this.profile.login||null)}function Xn(e){if(zn.call(this,e),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function Yn(e){if(zn.call(this,e),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");Sn(this,"username",e.screenName||null)}function $n(e){this.a=nt(e)}function Jn(e){var t=nt(e),n=tt(t,"link"),r=tt(nt(n),"link");return t=tt(t,"deep_link_id"),tt(nt(t),"link")||t||r||n||e}function Zn(e,t){return e.then(function(e){if(e[$l]){var n=Fn(e[$l]);if(!n||t!=n.c)throw new On("user-mismatch");return e}throw new On("user-mismatch")}).s(function(e){throw e&&e.code&&e.code==ml+"user-not-found"?new On("user-mismatch"):e})}function er(e,t,n){if(t.idToken||t.accessToken)t.idToken&&Sn(this,"idToken",t.idToken),t.accessToken&&Sn(this,"accessToken",t.accessToken);else{if(!t.oauthToken||!t.oauthTokenSecret)throw new On("internal-error","failed to construct a credential");Sn(this,"accessToken",t.oauthToken),Sn(this,"secret",t.oauthTokenSecret)}Sn(this,"providerId",e),Sn(this,"signInMethod",n)}function tr(e){var t={};return e.idToken&&(t.id_token=e.idToken),e.accessToken&&(t.access_token=e.accessToken),e.secret&&(t.oauth_token_secret=e.secret),t.providerId=e.providerId,{postBody:ct(t).toString(),requestUri:"http://localhost"}}function nr(e,t){this.Cc=t||[],Cn(this,{providerId:e,isOAuthProvider:!0}),this.xb={},this.bb=(Kn(e)||{}).Ma||null,this.Za=null}function rr(e){nr.call(this,e,Dl),this.a=[]}function ir(){rr.call(this,"facebook.com")}function or(e){if(!e)throw new On("argument-error","credential failed: expected 1 argument (the OAuth access token).");var t=e;return c(e)&&(t=e.accessToken),(new ir).credential(null,t)}function ar(){rr.call(this,"github.com")}function sr(e){if(!e)throw new On("argument-error","credential failed: expected 1 argument (the OAuth access token).");var t=e;return c(e)&&(t=e.accessToken),(new ar).credential(null,t)}function ur(){rr.call(this,"google.com"),this.ta("profile")}function cr(e,t){var n=e;return c(e)&&(n=e.idToken,t=e.accessToken),(new ur).credential(n,t)}function lr(){nr.call(this,"twitter.com",Nl)}function hr(e,t){var n=e;if(c(n)||(n={oauthToken:e,oauthTokenSecret:t}),!n.oauthToken||!n.oauthTokenSecret)throw new On("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new er("twitter.com",n,"twitter.com")}function pr(e,t,n){this.a=e,this.b=t,Sn(this,"providerId","password"),Sn(this,"signInMethod",n===fr.EMAIL_LINK_SIGN_IN_METHOD?fr.EMAIL_LINK_SIGN_IN_METHOD:fr.EMAIL_PASSWORD_SIGN_IN_METHOD)}function fr(){Cn(this,{providerId:"password",isOAuthProvider:!1})}function dr(e,t){if(!(t=mr(t)))throw new On("argument-error","Invalid email link!");return new pr(e,t,fr.EMAIL_LINK_SIGN_IN_METHOD)}function mr(e){var t=tt((e=new $n(e=Jn(e))).a,"oobCode")||null;return"signIn"===(tt(e.a,"mode")||null)&&t?t:null}function gr(e){if(!(e.Sa&&e.Ra||e.Fa&&e.$))throw new On("internal-error");this.a=e,Sn(this,"providerId","phone"),Sn(this,"signInMethod","phone")}function yr(e){return e.a.Fa&&e.a.$?{temporaryProof:e.a.Fa,phoneNumber:e.a.$}:{sessionInfo:e.a.Sa,code:e.a.Ra}}function vr(e){try{this.a=e||Pu.auth()}catch(e){throw new On("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}Cn(this,{providerId:"phone",isOAuthProvider:!1})}function br(e,t){if(!e)throw new On("missing-verification-id");if(!t)throw new On("missing-verification-code");return new gr({Sa:e,Ra:t})}function _r(e){if(e.temporaryProof&&e.phoneNumber)return new gr({Fa:e.temporaryProof,$:e.phoneNumber});var t=e&&e.providerId;if(!t||"password"===t)return null;var n=e&&e.oauthAccessToken,r=e&&e.oauthTokenSecret;e=e&&e.oauthIdToken;try{switch(t){case"google.com":return cr(e,n);case"facebook.com":return or(n);case"github.com":return sr(n);case"twitter.com":return hr(n,r);default:return new rr(t).credential(e,n)}}catch(e){return null}}function wr(e){if(!e.isOAuthProvider)throw new On("invalid-oauth-provider")}function kr(e,t,n,r,i){if(this.b=e,this.c=t||null,this.f=n||null,this.g=r||null,this.a=i||null,!this.f&&!this.a)throw new On("invalid-auth-event");if(this.f&&this.a)throw new On("invalid-auth-event");if(this.f&&!this.g)throw new On("invalid-auth-event")}function Er(e){return(e=e||{}).type?new kr(e.type,e.eventId,e.urlResponse,e.sessionId,e.error&&Pn(e.error)):null}function Tr(){this.b=null,this.a=[]}function Sr(e){var t="unauthorized-domain",n=void 0,r=nt(e);e=r.b,"chrome-extension"==(r=r.c)?n=O("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",e):"http"==r||"https"==r?n=O("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",e):t="operation-not-supported-in-this-environment",On.call(this,t,n)}function Cr(e,t,n){On.call(this,e,n),(e=t||{}).yb&&Sn(this,"email",e.yb),e.$&&Sn(this,"phoneNumber",e.$),e.credential&&Sn(this,"credential",e.credential)}function Ir(e){if(e.code){var t=e.code||"";0==t.indexOf(ml)&&(t=t.substring(ml.length));var n={credential:_r(e)};if(e.email)n.yb=e.email;else if(e.phoneNumber)n.$=e.phoneNumber;else if(!n.credential)return new On(t,e.message||void 0);return new Cr(t,n,e.message)}return null}function Nr(){}function Dr(e){return e.c||(e.c=e.b())}function Ar(){}function xr(e){if(!e.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var t=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<t.length;n++){var r=t[n];try{return new ActiveXObject(r),e.f=r}catch(e){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return e.f}function Or(){}function Pr(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseText="",this.status=-1,this.statusText="",this.a.onload=p(this.dc,this),this.a.onerror=p(this.Eb,this),this.a.onprogress=p(this.ec,this),this.a.ontimeout=p(this.hc,this)}function Rr(e,t){e.readyState=t,e.onreadystatechange&&e.onreadystatechange()}function Lr(e,t,n){this.reset(e,t,n,void 0,void 0)}function Mr(e){this.f=e,this.b=this.c=this.a=null}function Vr(e,t){this.name=e,this.value=t}function jr(e){return e.c?e.c:e.a?jr(e.a):(b("Root logger has no level set."),null)}function Ur(e){Bl||(Bl=new Mr(""),Fl[""]=Bl,Bl.c=Ul);var t;if(!(t=Fl[e])){t=new Mr(e);var n=e.lastIndexOf("."),r=e.substr(n+1);(n=Ur(e.substr(0,n))).b||(n.b={}),n.b[r]=t,t.a=n,Fl[e]=t}return t}function qr(e,t){e&&e.log(ql,t,void 0)}function Fr(e){this.f=e}function Br(e){Ve.call(this),this.i=e,this.readyState=Kl,this.status=0,this.responseText=this.statusText="",this.onreadystatechange=null,this.g=new Headers,this.b=null,this.h="GET",this.c="",this.a=!1,this.f=Ur("goog.net.FetchXmlHttp")}function Kr(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Wr(e){Ve.call(this),this.headers=new ze,this.C=e||null,this.c=!1,this.w=this.a=null,this.h=this.N=this.m="",this.f=this.I=this.i=this.G=!1,this.g=0,this.u=null,this.o=Wl,this.v=this.O=!1}function Hr(e,t,n,r,i){if(e.a)throw Error("[goog.net.XhrIo] Object is active with another request="+e.m+"; newUri="+t);n=n?n.toUpperCase():"GET",e.m=t,e.h="",e.N=n,e.G=!1,e.c=!0,e.a=e.C?e.C.a():Ll.a(),e.w=Dr(e.C?e.C:Ll),e.a.onreadystatechange=p(e.Ib,e);try{qr(e.b,ni(e,"Opening Xhr")),e.I=!0,e.a.open(n,String(t),!0),e.I=!1}catch(t){return qr(e.b,ni(e,"Error opening Xhr: "+t.message)),void Gr(e,t)}t=r||"";var o=new ze(e.headers);i&&He(i,function(e,t){o.set(t,e)}),i=C(o.U()),r=Lu.FormData&&t instanceof Lu.FormData,!I(zl,n)||i||r||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(e,t){this.a.setRequestHeader(t,e)},e),e.o&&(e.a.responseType=e.o),"withCredentials"in e.a&&e.a.withCredentials!==e.O&&(e.a.withCredentials=e.O);try{Jr(e),0<e.g&&(e.v=zr(e.a),qr(e.b,ni(e,"Will abort after "+e.g+"ms if incomplete, xhr2 "+e.v)),e.v?(e.a.timeout=e.g,e.a.ontimeout=p(e.Ga,e)):e.u=Fe(e.Ga,e.g,e)),qr(e.b,ni(e,"Sending request")),e.i=!0,e.a.send(t),e.i=!1}catch(t){qr(e.b,ni(e,"Send error: "+t.message)),Gr(e,t)}}function zr(e){return mc&&ye(9)&&"number"==typeof e.timeout&&void 0!==e.ontimeout}function Qr(e){return"content-type"==e.toLowerCase()}function Gr(e,t){e.c=!1,e.a&&(e.f=!0,e.a.abort(),e.f=!1),e.h=t,Xr(e),$r(e)}function Xr(e){e.G||(e.G=!0,e.dispatchEvent("complete"),e.dispatchEvent("error"))}function Yr(e){if(e.c&&void 0!==Ru)if(e.w[1]&&4==Zr(e)&&2==ei(e))qr(e.b,ni(e,"Local request error detected and ignored"));else if(e.i&&4==Zr(e))Fe(e.Ib,0,e);else if(e.dispatchEvent("readystatechange"),4==Zr(e)){qr(e.b,ni(e,"Request complete")),e.c=!1;try{var t=ei(e);e:switch(t){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var n=!0;break e;default:n=!1}var r;if(!(r=n)){var i;if(i=0===t){var o=String(e.m).match(Vc)[1]||null;if(!o&&Lu.self&&Lu.self.location){var a=Lu.self.location.protocol;o=a.substr(0,a.length-1)}i=!Hl.test(o?o.toLowerCase():"")}r=i}if(r)e.dispatchEvent("complete"),e.dispatchEvent("success");else{try{var s=2<Zr(e)?e.a.statusText:""}catch(t){qr(e.b,"Can not get status: "+t.message),s=""}e.h=s+" ["+ei(e)+"]",Xr(e)}}finally{$r(e)}}}function $r(e,t){if(e.a){Jr(e);var n=e.a,i=e.w[0]?r:null;e.a=null,e.w=null,t||e.dispatchEvent("ready");try{n.onreadystatechange=i}catch(t){(e=e.b)&&e.log(Vl,"Problem encountered resetting onreadystatechange: "+t.message,void 0)}}}function Jr(e){e.a&&e.v&&(e.a.ontimeout=null),e.u&&(Lu.clearTimeout(e.u),e.u=null)}function Zr(e){return e.a?e.a.readyState:0}function ei(e){try{return 2<Zr(e)?e.a.status:-1}catch(e){return-1}}function ti(e){try{return e.a?e.a.responseText:""}catch(t){return qr(e.b,"Can not get responseText: "+t.message),""}}function ni(e,t){return t+" ["+e.N+" "+e.m+" "+ei(e)+"]"}function ri(e,t){this.g=[],this.v=e,this.u=t||null,this.f=this.a=!1,this.c=void 0,this.m=this.w=this.i=!1,this.h=0,this.b=null,this.l=0}function ii(e,t,n){e.a=!0,e.c=n,e.f=!t,ci(e)}function oi(e){if(e.a){if(!e.m)throw new li(e);e.m=!1}}function ai(e,t){si(e,null,t,void 0)}function si(e,t,n,r){e.g.push([t,n,r]),e.a&&ci(e)}function ui(e){return Wu(e.g,function(e){return u(e[1])})}function ci(e){if(e.h&&e.a&&ui(e)){var t=e.h,n=Ql[t];n&&(Lu.clearTimeout(n.a),delete Ql[t]),e.h=0}e.b&&(e.b.l--,delete e.b),t=e.c;for(var r=n=!1;e.g.length&&!e.i;){var i=e.g.shift(),o=i[0],a=i[1];if(i=i[2],o=e.f?a:o)try{var s=o.call(i||e.u,t);void 0!==s&&(e.f=e.f&&(s==t||s instanceof Error),e.c=t=s),(g(t)||"function"==typeof Lu.Promise&&t instanceof Lu.Promise)&&(r=!0,e.i=!0)}catch(r){t=r,e.f=!0,ui(e)||(n=!0)}}e.c=t,r&&(s=p(e.o,e,!0),r=p(e.o,e,!1),t instanceof ri?(si(t,s,r),t.w=!0):t.then(s,r)),n&&(t=new pi(t),Ql[t.a]=t,e.h=t.a)}function li(){y.call(this)}function hi(){y.call(this)}function pi(e){this.a=Lu.setTimeout(p(this.c,this),0),this.b=e}function fi(e){var t={},n=t.document||document,r=bt(e),i=document.createElement("SCRIPT"),o={Kb:i,Ga:void 0},a=new ri(mi,o),s=null,u=null!=t.timeout?t.timeout:5e3;return 0<u&&(s=window.setTimeout(function(){gi(i,!0);var e=new yi(Xl,"Timeout reached for loading script "+r);oi(a),ii(a,!1,e)},u),o.Ga=s),i.onload=i.onreadystatechange=function(){i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(gi(i,t.ed||!1,s),a.C())},i.onerror=function(){gi(i,!0,s);var e=new yi(Gl,"Error while loading script "+r);oi(a),ii(a,!1,e)},o=t.attributes||{},q(o,{type:"text/javascript",charset:"UTF-8"}),At(i,o),i.src=bt(e),di(n).appendChild(i),a}function di(e){var t;return(t=(e||document).getElementsByTagName("HEAD"))&&0!=t.length?t[0]:e.documentElement}function mi(){if(this&&this.Kb){var e=this.Kb;e&&"SCRIPT"==e.tagName&&gi(e,!0,this.Ga)}}function gi(e,t,n){null!=n&&Lu.clearTimeout(n),e.onload=r,e.onerror=r,e.onreadystatechange=r,t&&window.setTimeout(function(){e&&e.parentNode&&e.parentNode.removeChild(e)},0)}function yi(e,t){var n="Jsloader error (code #"+e+")";t&&(n+=": "+t),y.call(this,n),this.code=e}function vi(e){this.f=e}function bi(e,t,n){if(this.b=e,e=t||{},this.i=e.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.l=e.secureTokenTimeout||Jl,this.f=U(e.secureTokenHeaders||Zl),this.g=e.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.h=e.firebaseTimeout||eh,this.a=U(e.firebaseHeaders||th),n&&(this.a["X-Client-Version"]=n,this.f["X-Client-Version"]=n),n="Node"==Jt(),!(n=Lu.XMLHttpRequest||n&&Pu.INTERNAL.node&&Pu.INTERNAL.node.XMLHttpRequest)&&!$t())throw new On("internal-error","The XMLHttpRequest compatibility library was not found.");this.c=void 0,$t()?this.c=new Fr(self):Zt()?this.c=new vi(n):this.c=new Or}function _i(e,t){t?e.a["X-Firebase-Locale"]=t:delete e.a["X-Firebase-Locale"]}function wi(e,t){t?(e.a["X-Client-Version"]=t,e.f["X-Client-Version"]=t):(delete e.a["X-Client-Version"],delete e.f["X-Client-Version"])}function ki(e,t,n,r,i,o,a){Bt()||$t()?e=p(e.o,e):(Yl||(Yl=new z(function(e,t){Ei(e,t)})),e=p(e.m,e)),e(t,n,r,i,o,a)}function Ei(e,t){((window.gapi||{}).client||{}).request?e():(Lu[rh]=function(){((window.gapi||{}).client||{}).request?e():t(Error("CORS_UNSUPPORTED"))},ai(fi(_t(nh,{onload:rh})),function(){t(Error("CORS_UNSUPPORTED"))}))}function Ti(e,t){return new z(function(n,r){"refresh_token"==t.grant_type&&t.refresh_token||"authorization_code"==t.grant_type&&t.code?ki(e,e.i+"?key="+encodeURIComponent(e.b),function(e){e?e.error?r(Ki(e)):e.access_token&&e.refresh_token?n(e):r(new On("internal-error")):r(new On("network-request-failed"))},"POST",ct(t).toString(),e.f,e.l.get()):r(new On("internal-error"))})}function Si(e,t,n,r,i,o){var a=nt(e.g+t);et(a,"key",e.b),o&&et(a,"cb",ju().toString());var s="GET"==n;if(s)for(var u in r)r.hasOwnProperty(u)&&et(a,u,r[u]);return new z(function(t,o){ki(e,a.toString(),function(e){e?e.error?o(Ki(e,i||{})):t(e):o(new On("network-request-failed"))},n,s?void 0:Rt(pn(r)),e.a,e.h.get())})}function Ci(e){if(!Rl.test(e.email))throw new On("invalid-email")}function Ii(e){"email"in e&&Ci(e)}function Ni(e,t){return Fi(e,ch,{identifier:t,continueUri:un()?Ut():"http://localhost"}).then(function(e){return e.allProviders||[]})}function Di(e,t){return Fi(e,ch,{identifier:t,continueUri:un()?Ut():"http://localhost"}).then(function(e){return e.signinMethods||[]})}function Ai(e){return Fi(e,vh,{}).then(function(e){return e.authorizedDomains||[]})}function xi(e){if(!e[$l])throw new On("internal-error")}function Oi(e){if(e.phoneNumber||e.temporaryProof){if(!e.phoneNumber||!e.temporaryProof)throw new On("internal-error")}else{if(!e.sessionInfo)throw new On("missing-verification-id");if(!e.code)throw new On("missing-verification-code")}}function Pi(e,t){return Fi(e,wh,t)}function Ri(e,t,n){return Fi(e,hh,{idToken:t,deleteProvider:n})}function Li(e){if(!e.requestUri||!e.sessionId&&!e.postBody)throw new On("internal-error")}function Mi(e){var t=null;if(e.needConfirmation?(e.code="account-exists-with-different-credential",t=Ir(e)):"FEDERATED_USER_ID_ALREADY_LINKED"==e.errorMessage?(e.code="credential-already-in-use",t=Ir(e)):"EMAIL_EXISTS"==e.errorMessage?(e.code="email-already-in-use",t=Ir(e)):e.errorMessage&&(t=Bi(e.errorMessage)),t)throw t;if(!e[$l])throw new On("internal-error")}function Vi(e,t){return t.returnIdpCredential=!0,Fi(e,Sh,t)}function ji(e,t){return t.returnIdpCredential=!0,Fi(e,Ih,t)}function Ui(e,t){return t.returnIdpCredential=!0,t.autoCreate=!1,Fi(e,Ch,t)}function qi(e){if(!e.oobCode)throw new On("invalid-action-code")}function Fi(e,t,n){if(!Dn(n,t.T))return Y(new On("internal-error"));var r,i=t.Hb||"POST";return X(n).then(t.B).then(function(){return t.R&&(n.returnSecureToken=!0),Si(e,t.endpoint,i,n,t.Wb,t.tb||!1)}).then(function(e){return r=e}).then(t.J).then(function(){if(!t.da)return r;if(!(t.da in r))throw new On("internal-error");return r[t.da]})}function Bi(e){return Ki({error:{errors:[{message:e}],code:400,message:e}})}function Ki(e,t){var n=(e.error&&e.error.errors&&e.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new On(r[n]):null)return n;n=e.error&&e.error.message||"",q(r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash"},t||{}),t=(t=n.match(/^[^\s]+\s*:\s*(.*)$/))&&1<t.length?t[1]:void 0;for(var i in r)if(0===n.indexOf(i))return new On(r[i],t);return!t&&e&&(t=hn(e)),new On("internal-error",t)}function Wi(e){for(var t in Ph)if(Ph[t].id===e)return e=Ph[t],{firebaseEndpoint:e.$a,secureTokenEndpoint:e.hb};return null}function Hi(e){this.b=e,this.a=null,this.eb=zi(this)}function zi(e){return Xi().then(function(){return new z(function(t,n){on("gapi.iframes.getContext")().open({where:document.body,url:e.b,messageHandlersFilter:on("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},function(r){function i(){clearTimeout(o),t()}e.a=r,e.a.restyle({setHideOnLeave:!1});var o=setTimeout(function(){n(Error("Network Error"))},Mh.get());r.ping(i).then(i,function(){n(Error("Network Error"))})})})})}function Qi(e,t){return e.eb.then(function(){return new z(function(n){e.a.send(t.type,t,n,on("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})})}function Gi(e,t){e.eb.then(function(){e.a.register("authEvent",t,on("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})}function Xi(){return Vh||(Vh=new z(function(e,t){function n(){gn(),on("gapi.load")("gapi.iframes",{callback:e,ontimeout:function(){gn(),t(Error("Network Error"))},timeout:Lh.get()})}if(on("gapi.iframes.Iframe"))e();else if(on("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();Lu[r]=function(){on("gapi.load")?n():t(Error("Network Error"))},X(fi(r=_t(Rh,{onload:r}))).s(function(){t(Error("Network Error"))})}}).s(function(e){throw Vh=null,e}))}function Yi(e,t,n){this.i=e,this.g=t,this.h=n,this.f=null,this.a=rt(this.i,"/__/auth/iframe"),et(this.a,"apiKey",this.g),et(this.a,"appName",this.h),this.b=null,this.c=[]}function $i(e,t,n,r,i){this.o=e,this.m=t,this.c=n,this.l=r,this.h=this.g=this.i=null,this.a=i,this.f=null}function Ji(e){try{return Pu.app(e).auth().xa()}catch(e){return[]}}function Zi(e,t,n,r,i){this.m=e,this.f=t,this.b=n,this.c=r||null,this.h=i||null,this.o=this.u=this.v=null,this.g=[],this.l=this.a=null}function eo(e){var t=Ut();return Ai(e).then(function(e){e:{var n=nt(t),r=n.c;n=n.b;for(var i=0;i<e.length;i++){var o=e[i],a=n,s=r;if(0==o.indexOf("chrome-extension://")?a=nt(o).b==a&&"chrome-extension"==s:"http"!=s&&"https"!=s?a=!1:el.test(o)?a=a==o:(o=o.split(".").join("\\."),a=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)),a){e=!0;break e}}e=!1}if(!e)throw new Sr(Ut())})}function to(e){return e.l?e.l:(e.l=Qt().then(function(){if(!e.u){var t=e.c,n=e.h,r=Ji(e.b),i=new Yi(e.m,e.f,e.b);i.f=t,i.b=n,i.c=x(r||[]),e.u=i.toString()}e.i=new Hi(e.u),io(e)}),e.l)}function no(e){return e.o||(e.v=e.c?nn(e.c,Ji(e.b)):null,e.o=new bi(e.f,Wi(e.h),e.v)),e.o}function ro(e,t,n,r,i,o,a,s,u,c){return e=new $i(e,t,n,r,i),e.i=o,e.g=a,e.h=s,e.b=U(u||null),e.f=c,e.toString()}function io(e){if(!e.i)throw Error("IfcHandler must be initialized!");Gi(e.i,function(t){var n={};if(t&&t.authEvent){var r=!1;for(t=Er(t.authEvent),n=0;n<e.g.length;n++)r=e.g[n](t)||r;return n={},n.status=r?"ACK":"ERROR",X(n)}return n.status="ERROR",X(n)})}function oo(e){var t={type:"webStorageSupport"};return to(e).then(function(){return Qi(e.i,t)}).then(function(e){if(e&&e.length&&void 0!==e[0].webStorageSupport)return e[0].webStorageSupport;throw Error()})}function ao(e){if(this.a=e||Pu.INTERNAL.reactNative&&Pu.INTERNAL.reactNative.AsyncStorage,!this.a)throw new On("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function so(e){this.b=e,this.a={},this.c=p(this.f,this)}function uo(){var e=$t()?self:null;if(Bu(jh,function(n){n.b==e&&(t=n)}),!t){var t=new so(e);jh.push(t)}return t}function co(e){this.a=e}function lo(e){this.c=e,this.b=!1,this.a=[]}function ho(e,t,n,r){var i,o,a,s,u=n||{},c=null;if(e.b)return Y(Error("connection_unavailable"));var l=r?800:50,h="undefined"!=typeof MessageChannel?new MessageChannel:null;return new z(function(n,r){h?(i=Math.floor(Math.random()*Math.pow(10,20)).toString(),h.port1.start(),a=setTimeout(function(){r(Error("unsupported_event"))},l),o=function(e){e.data.eventId===i&&("ack"===e.data.status?(clearTimeout(a),s=setTimeout(function(){r(Error("timeout"))},3e3)):"done"===e.data.status?(clearTimeout(s),void 0!==e.data.response?n(e.data.response):r(Error("unknown_error"))):(clearTimeout(a),clearTimeout(s),r(Error("invalid_response"))))},c={messageChannel:h,onMessage:o},e.a.push(c),h.port1.addEventListener("message",o),e.c.postMessage({eventType:t,eventId:i,data:u},[h.port2])):r(Error("connection_unavailable"))}).then(function(t){return po(e,c),t}).s(function(t){throw po(e,c),t})}function po(e,t){if(t){var n=t.messageChannel,r=t.onMessage;n&&(n.port1.removeEventListener("message",r),n.port1.close()),D(e.a,function(e){return e==t})}}function fo(){if(!vo())throw new On("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.m=Lu.indexedDB,this.type="indexedDB",this.g=this.l=this.f=this.i=null,this.u=!1,this.h=null;var e=this;$t()&&self?(this.l=uo(),this.l.subscribe("keyChanged",function(t,n){return Eo(e).then(function(t){return 0<t.length&&Bu(e.a,function(e){e(t)}),{keyProcessed:I(t,n.key)}})}),this.l.subscribe("ping",function(){return X(["keyChanged"])})):En().then(function(t){(e.h=t)&&(e.g=new lo(new co(t)),ho(e.g,"ping",null,!0).then(function(t){t[0].fulfilled&&I(t[0].value,"keyChanged")&&(e.u=!0)}).s(function(){}))})}function mo(e){return new z(function(t,n){var r=e.m.deleteDatabase("firebaseLocalStorageDb");r.onsuccess=function(){t()},r.onerror=function(e){n(Error(e.target.error))}})}function go(e){return new z(function(t,n){var r=e.m.open("firebaseLocalStorageDb",1);r.onerror=function(e){try{e.preventDefault()}catch(e){}n(Error(e.target.error))},r.onupgradeneeded=function(e){e=e.target.result;try{e.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(e){n(e)}},r.onsuccess=function(r){(r=r.target.result).objectStoreNames.contains("firebaseLocalStorage")?t(r):mo(e).then(function(){return go(e)}).then(function(e){t(e)}).s(function(e){n(e)})}})}function yo(e){return e.o||(e.o=go(e)),e.o}function vo(){try{return!!Lu.indexedDB}catch(e){return!1}}function bo(e){return e.objectStore("firebaseLocalStorage")}function _o(e,t){return e.transaction(["firebaseLocalStorage"],t?"readwrite":"readonly")}function wo(e){return new z(function(t,n){e.onsuccess=function(e){e&&e.target?t(e.target.result):t()},e.onerror=function(e){n(e.target.error)}})}function ko(e,t){return e.g&&e.h&&kn()===e.h?ho(e.g,"keyChanged",{key:t},e.u).then(function(){}).s(function(){}):X()}function Eo(e){return yo(e).then(function(e){var t=bo(_o(e,!1));return t.getAll?wo(t.getAll()):new z(function(e,n){var r=[],i=t.openCursor();i.onsuccess=function(t){(t=t.target.result)?(r.push(t.value),t.continue()):e(r)},i.onerror=function(e){n(e.target.error)}})}).then(function(t){var n={},r=[];if(0==e.b){for(r=0;r<t.length;r++)n[t[r].fbase_key]=t[r].value;r=Ft(e.c,n),e.c=n}return r})}function To(e){function t(){e.f=setTimeout(function(){e.i=Eo(e).then(function(t){0<t.length&&Bu(e.a,function(e){e(t)})}).then(function(){t()}).s(function(e){"STOP_EVENT"!=e.message&&t()})},800)}So(e),t()}function So(e){e.i&&e.i.cancel("STOP_EVENT"),e.f&&(clearTimeout(e.f),e.f=null)}function Co(e){var t=this,n=null;this.a=[],this.type="indexedDB",this.c=e,this.b=X().then(function(){if(vo()){var e=dn(),r="__sak"+e;return Uh||(Uh=new fo),(n=Uh).set(r,e).then(function(){return n.get(r)}).then(function(t){if(t!==e)throw Error("indexedDB not supported!");return n.P(r)}).then(function(){return n}).s(function(){return t.c})}return t.c}).then(function(e){return t.type=e.type,e.Y(function(e){Bu(t.a,function(t){t(e)})}),e})}function Io(){this.a={},this.type="inMemory"}function No(){if(!Ao()){if("Node"==Jt())throw new On("internal-error","The LocalStorage compatibility library was not found.");throw new On("web-storage-unsupported")}this.a=Do()||Pu.INTERNAL.node.localStorage,this.type="localStorage"}function Do(){try{var e=Lu.localStorage,t=dn();return e&&(e.setItem(t,"1"),e.removeItem(t)),e}catch(e){return null}}function Ao(){var e="Node"==Jt();if(!(e=Do()||e&&Pu.INTERNAL.node&&Pu.INTERNAL.node.localStorage))return!1;try{return e.setItem("__sak","1"),e.removeItem("__sak"),!0}catch(e){return!1}}function xo(){this.type="nullStorage"}function Oo(){if(!Ro()){if("Node"==Jt())throw new On("internal-error","The SessionStorage compatibility library was not found.");throw new On("web-storage-unsupported")}this.a=Po()||Pu.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function Po(){try{var e=Lu.sessionStorage,t=dn();return e&&(e.setItem(t,"1"),e.removeItem(t)),e}catch(e){return null}}function Ro(){var e="Node"==Jt();if(!(e=Po()||e&&Pu.INTERNAL.node&&Pu.INTERNAL.node.sessionStorage))return!1;try{return e.setItem("__sak","1"),e.removeItem("__sak"),!0}catch(e){return!1}}function Lo(){var e={};e.Browser=Bh,e.Node=Kh,e.ReactNative=Wh,e.Worker=Hh,this.a=e[Jt()]}function Mo(e){var t=new On("invalid-persistence-type"),n=new On("unsupported-persistence-type");e:{for(r in zh)if(zh[r]==e){var r=!0;break e}r=!1}if(!r||"string"!=typeof e)throw t;switch(Jt()){case"ReactNative":if("session"===e)throw n;break;case"Node":if("none"!==e)throw n;break;default:if(!an()&&"none"!==e)throw n}}function Vo(){var e=!(mn(rn())||!Yt()),t=ln(),n=an();this.o=e,this.h=t,this.l=n,this.a={},qh||(qh=new Lo),e=qh;try{this.g=!jt()&&wn()||!Lu.indexedDB?new e.a.A:new Co($t()?new Io:new e.a.A)}catch(e){this.g=new Io,this.h=!0}try{this.i=new e.a.Qa}catch(e){this.i=new Io}this.m=new Io,this.f=p(this.Ob,this),this.b={}}function jo(){return Fh||(Fh=new Vo),Fh}function Uo(e,t){switch(t){case"session":return e.i;case"none":return e.m;default:return e.g}}function qo(e,t){return"firebase:"+e.name+(t?":"+t:"")}function Fo(e,t,n){var r=qo(t,n),i=Uo(e,t.A);return e.get(t,n).then(function(o){var a=null;try{a=fn(Lu.localStorage.getItem(r))}catch(e){}if(a&&!o)return Lu.localStorage.removeItem(r),e.set(t,a,n);a&&o&&"localStorage"!=i.type&&Lu.localStorage.removeItem(r)})}function Bo(e,t,n){return n=qo(t,n),"local"==t.A&&(e.b[n]=null),Uo(e,t.A).P(n)}function Ko(e){Wo(e),e.c=setInterval(function(){for(var t in e.a){var n=Lu.localStorage.getItem(t),r=e.b[t];n!=r&&(e.b[t]=n,n=new be({type:"storage",key:t,target:window,oldValue:r,newValue:n,a:!0}),e.Ob(n))}},1e3)}function Wo(e){e.c&&(clearInterval(e.c),e.c=null)}function Ho(e){this.a=e,this.b=jo()}function zo(e){return e.b.get(Gh,e.a).then(function(e){return Er(e)})}function Qo(){this.a=jo()}function Go(e,t){this.b=Xh,this.f=Lu.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=e,this.h=t,this.l=Lu.Int32Array?new Int32Array(64):Array(64),void 0!==Qh||(Qh=Lu.Int32Array?new Int32Array(ep):ep),this.reset()}function Xo(e){for(var t=e.f,n=e.l,r=0,i=0;i<t.length;)n[r++]=t[i]<<24|t[i+1]<<16|t[i+2]<<8|t[i+3],i=4*r;for(t=16;64>t;t++){i=0|n[t-15],r=0|n[t-2];var o=(0|n[t-16])+((i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,a=(0|n[t-7])+((r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[t]=o+a|0}r=0|e.a[0],i=0|e.a[1];var s=0|e.a[2],u=0|e.a[3],c=0|e.a[4],l=0|e.a[5],h=0|e.a[6];for(o=0|e.a[7],t=0;64>t;t++){var p=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&s^i&s)|0;a=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((a=(a=c&l^~c&h)+(0|Qh[t])|0)+(0|n[t])|0)|0,o=h,h=l,l=c,c=u+a|0,u=s,s=i,i=r,r=a+p|0}e.a[0]=e.a[0]+r|0,e.a[1]=e.a[1]+i|0,e.a[2]=e.a[2]+s|0,e.a[3]=e.a[3]+u|0,e.a[4]=e.a[4]+c|0,e.a[5]=e.a[5]+l|0,e.a[6]=e.a[6]+h|0,e.a[7]=e.a[7]+o|0}function Yo(t,n,r){void 0===r&&(r=n.length);var i=0,o=t.c;if(e(n))for(;i<r;)t.f[o++]=n.charCodeAt(i++),o==t.b&&(Xo(t),o=0);else{if(!s(n))throw Error("message must be string or array");for(;i<r;){var a=n[i++];if(!("number"==typeof a&&0<=a&&255>=a&&a==(0|a)))throw Error("message must be a byte array");t.f[o++]=a,o==t.b&&(Xo(t),o=0)}}t.c=o,t.g+=r}function $o(){Go.call(this,8,tp)}function Jo(e,t,n,r,i){this.m=e,this.i=t,this.l=n,this.o=r||null,this.u=i||null,this.h=t+":"+n,this.v=new Qo,this.g=new Ho(this.h),this.f=null,this.b=[],this.a=this.c=null}function Zo(e){return new On("invalid-cordova-configuration",e)}function ea(){for(var e=20,t=[];0<e;)t.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),e--;return t.join("")}function ta(e){var t=new $o;Yo(t,e),e=[];var n=8*t.g;56>t.c?Yo(t,Zh,56-t.c):Yo(t,Zh,t.b-(t.c-56));for(var r=63;56<=r;r--)t.f[r]=255&n,n/=256;for(Xo(t),r=n=0;r<t.i;r++)for(var i=24;0<=i;i-=8)e[n++]=t.a[r]>>i&255;return Mn(e)}function na(e,t,n,r){var i=ea(),o=new kr(t,r,null,i,new On("no-auth-event")),a=on("BuildInfo.packageName",Lu);if("string"!=typeof a)throw new On("invalid-cordova-configuration");var s=on("BuildInfo.displayName",Lu),u={};if(rn().toLowerCase().match(/iphone|ipad|ipod/))u.ibi=a;else{if(!rn().toLowerCase().match(/android/))return Y(new On("operation-not-supported-in-this-environment"));u.apn=a}s&&(u.appDisplayName=s),i=ta(i),u.sessionId=i;var c=ro(e.m,e.i,e.l,t,n,null,r,e.o,u,e.u);return e.ga().then(function(){var t=e.h;return e.v.a.set(Gh,o.D(),t)}).then(function(){var t=on("cordova.plugins.browsertab.isAvailable",Lu);if("function"!=typeof t)throw new On("invalid-cordova-configuration");var n=null;t(function(t){if(t){if("function"!=typeof(n=on("cordova.plugins.browsertab.openUrl",Lu)))throw new On("invalid-cordova-configuration");n(c)}else{if("function"!=typeof(n=on("cordova.InAppBrowser.open",Lu)))throw new On("invalid-cordova-configuration");t=!(!(t=rn()).match(/(iPad|iPhone|iPod).*OS 7_\d/i)&&!t.match(/(iPad|iPhone|iPod).*OS 8_\d/i)),e.a=n(c,t?"_blank":"_system","location=yes")}})})}function ra(e,t){for(var n=0;n<e.b.length;n++)try{e.b[n](t)}catch(e){}}function ia(e){return e.f||(e.f=e.ga().then(function(){return new z(function(t){function n(r){return t(r),e.Ka(n),!1}e.va(n),aa(e)})})),e.f}function oa(e){var t=null;return zo(e.g).then(function(n){return t=n,n=e.g,Bo(n.b,Gh,n.a)}).then(function(){return t})}function aa(e){function t(t){r=!0,i&&i.cancel(),oa(e).then(function(r){var i=n;if(r&&t&&t.url){var o=null;-1!=(i=Jn(t.url)).indexOf("/__/auth/callback")&&(o=nt(i),o=fn(tt(o,"firebaseError")||null),o=(o="object"==typeof o?Pn(o):null)?new kr(r.b,r.c,null,null,o):new kr(r.b,r.c,i,r.g)),i=o||n}ra(e,i)})}var n=new kr("unknown",null,null,null,new On("no-auth-event")),r=!1,i=Be(500).then(function(){return oa(e).then(function(){r||ra(e,n)})}),o=Lu.handleOpenURL;Lu.handleOpenURL=function(e){if(0==e.toLowerCase().indexOf(on("BuildInfo.packageName",Lu).toLowerCase()+"://")&&t({url:e}),"function"==typeof o)try{o(e)}catch(e){console.error(e)}},Pl||(Pl=new Tr),Pl.subscribe(t)}function sa(e){this.a=e,this.b=jo()}function ua(e){return e.b.set(np,"pending",e.a)}function ca(e){return Bo(e.b,np,e.a)}function la(e){return e.b.get(np,e.a).then(function(e){return"pending"==e})}function ha(e,t,n){this.u=e,this.l=t,this.m=n,this.h=[],this.f=!1,this.i=p(this.ab,this),this.b=new va,this.o=new Sa,this.g=new sa(this.l+":"+this.m),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.o,this.c.linkViaPopup=this.o,this.c.reauthViaPopup=this.o,this.a=pa(this.u,this.l,this.m,oh)}function pa(e,t,n,r){var i=Pu.SDK_VERSION||null;return Xt()?new Jo(e,t,n,i,r):new Zi(e,t,n,i,r)}function fa(e){e.f||(e.f=!0,e.a.va(e.i));var t=e.a;return e.a.ga().s(function(n){throw e.a==t&&e.reset(),n})}function da(e){e.a.Lb()&&fa(e).s(function(t){var n=new kr("unknown",null,null,null,new On("operation-not-supported-in-this-environment"));ga(t)&&e.ab(n)}),e.a.Gb()||ba(e.b)}function ma(e,t,n,r,i,o){return e.a.Bb(t,n,r,function(){e.f||(e.f=!0,e.a.va(e.i))},function(){e.reset()},i,o)}function ga(e){return!(!e||"auth/cordova-not-ready"!=e.code)}function ya(e,t,n){var r=t+":"+n;return op[r]||(op[r]=new ha(e,t,n)),op[r]}function va(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function ba(e){e.g||(e.g=!0,Ea(e,!1,null,null))}function _a(e,t,n){n=n.wa(t.b,t.c);var r=t.f,i=t.g,o=!!t.b.match(/Redirect$/);n(r,i).then(function(t){Ea(e,o,t,null)}).s(function(t){Ea(e,o,null,t)})}function wa(e,t){if(e.b=function(){return Y(t)},e.c.length)for(var n=0;n<e.c.length;n++)e.c[n](t)}function ka(e,t){if(e.b=function(){return X(t)},e.f.length)for(var n=0;n<e.f.length;n++)e.f[n](t)}function Ea(e,t,n,r){t?r?wa(e,r):ka(e,n):ka(e,{user:null}),e.f=[],e.c=[]}function Ta(e){var t=new On("timeout");e.a&&e.a.cancel(),e.a=Be(ip.get()).then(function(){e.b||(e.g=!0,Ea(e,!0,null,t))})}function Sa(){}function Ca(e,t){var n=e.c,r=e.b;t.wa(r,n)(e.f,e.g).then(function(e){t.ha(r,e,null,n)}).s(function(e){t.ha(r,null,e,n)})}function Ia(){this.rb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.rb},set:function(e){this.rb=e},enumerable:!1})}function Na(e,t){this.a=t,Sn(this,"verificationId",e)}function Da(e,t,n,r){return new vr(e).Ta(t,n).then(function(e){return new Na(e,r)})}function Aa(e){var t=Bn(e);if(!(t&&t.exp&&t.auth_time&&t.iat))throw new On("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");Cn(this,{token:e,expirationTime:_n(1e3*t.exp),authTime:_n(1e3*t.auth_time),issuedAtTime:_n(1e3*t.iat),signInProvider:t.firebase&&t.firebase.sign_in_provider?t.firebase.sign_in_provider:null,claims:t})}function xa(e,t,n){if(this.h=e,this.i=t,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function Oa(e,t){return t?(e.a=e.c,e.g()):(t=e.a,e.a*=2,e.a>e.f&&(e.a=e.f),t)}function Pa(e,t){e.stop(),e.b=Be(Oa(e,t)).then(function(){return bn()}).then(function(){return e.h()}).then(function(){Pa(e,!0)}).s(function(t){e.i(t)&&Pa(e,!1)})}function Ra(e){this.f=e,this.b=this.a=null,this.c=0}function La(e,t){var n=t[$l],r=t.refreshToken;t=Va(t.expiresIn),e.b=n,e.c=t,e.a=r}function Ma(e,t){e.b=t.b,e.a=t.a,e.c=t.c}function Va(e){return ju()+1e3*parseInt(e,10)}function ja(e,t){return Ti(e.f,t).then(function(t){return e.b=t.access_token,e.c=Va(t.expires_in),e.a=t.refresh_token,{accessToken:e.b,expirationTime:e.c,refreshToken:e.a}}).s(function(t){throw"auth/user-token-expired"==t.code&&(e.a=null),t})}function Ua(e,t){this.a=e||null,this.b=t||null,Cn(this,{lastSignInTime:_n(t||null),creationTime:_n(e||null)})}function qa(e){return new Ua(e.a,e.b)}function Fa(e,t,n,r,i,o){Cn(this,{uid:e,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:t})}function Ba(e,t){ve.call(this,e);for(var n in t)this[n]=t[n]}function Ka(e,t,n){this.G=[],this.m=e.apiKey,this.o=e.appName,this.u=e.authDomain||null,e=Pu.SDK_VERSION?nn(Pu.SDK_VERSION):null,this.b=new bi(this.m,Wi(oh),e),this.h=new Ra(this.b),$a(this,t[$l]),La(this.h,t),Sn(this,"refreshToken",this.h.a),ts(this,n||{}),Ve.call(this),this.I=!1,this.u&&sn()&&(this.a=ya(this.u,this.m,this.o)),this.N=[],this.i=null,this.w=Ga(this),this.V=p(this.Ha,this);var r=this;this.ka=null,this.sa=function(e){r.oa(e.g)},this.X=null,this.O=[],this.ra=function(e){Ha(r,e.c)},this.W=null}function Wa(e,t){e.X&&De(e.X,"languageCodeChanged",e.sa),(e.X=t)&&Se(t,"languageCodeChanged",e.sa)}function Ha(e,t){e.O=t,wi(e.b,Pu.SDK_VERSION?nn(Pu.SDK_VERSION,e.O):null)}function za(e,t){e.W&&De(e.W,"frameworkChanged",e.ra),(e.W=t)&&Se(t,"frameworkChanged",e.ra)}function Qa(e){try{return Pu.app(e.o).auth()}catch(t){throw new On("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+e.o+"'!")}}function Ga(e){return new xa(function(){return e.F(!0)},function(e){return!(!e||"auth/network-request-failed"!=e.code)},function(){var t=e.h.c-ju()-3e5;return 0<t?t:0})}function Xa(e){e.C||e.w.b||(e.w.start(),De(e,"tokenChanged",e.V),Se(e,"tokenChanged",e.V))}function Ya(e){De(e,"tokenChanged",e.V),e.w.stop()}function $a(e,t){e.qa=t,Sn(e,"_lat",t)}function Ja(e,t){D(e.N,function(e){return e==t})}function Za(e){for(var t=[],n=0;n<e.N.length;n++)t.push(e.N[n](e));return Z(t).then(function(){return e})}function es(e){e.a&&!e.I&&(e.I=!0,e.a.subscribe(e))}function ts(e,t){Cn(e,{uid:t.uid,displayName:t.displayName||null,photoURL:t.photoURL||null,email:t.email||null,emailVerified:t.emailVerified||!1,phoneNumber:t.phoneNumber||null,isAnonymous:t.isAnonymous||!1,metadata:new Ua(t.createdAt,t.lastLoginAt),providerData:[]})}function ns(){}function rs(e){return X().then(function(){if(e.C)throw new On("app-deleted")})}function is(e){return Ku(e.providerData,function(e){return e.providerId})}function os(e,t){t&&(as(e,t.providerId),e.providerData.push(t))}function as(e,t){D(e.providerData,function(e){return e.providerId==t})}function ss(e,t,n){("uid"!=t||n)&&e.hasOwnProperty(t)&&Sn(e,t,n)}function us(e,t){e!=t&&(Cn(e,{uid:t.uid,displayName:t.displayName,photoURL:t.photoURL,email:t.email,emailVerified:t.emailVerified,phoneNumber:t.phoneNumber,isAnonymous:t.isAnonymous,providerData:[]}),t.metadata?Sn(e,"metadata",qa(t.metadata)):Sn(e,"metadata",new Ua),Bu(t.providerData,function(t){os(e,t)}),Ma(e.h,t.h),Sn(e,"refreshToken",e.h.a))}function cs(e){return e.F().then(function(t){var n=e.isAnonymous;return hs(e,t).then(function(){return n||ss(e,"isAnonymous",!1),t})})}function ls(e,t){t[$l]&&e.qa!=t[$l]&&(La(e.h,t),e.dispatchEvent(new Ba("tokenChanged")),$a(e,t[$l]),ss(e,"refreshToken",e.h.a))}function hs(e,t){return Fi(e.b,dh,{idToken:t}).then(p(e.wc,e))}function ps(e){return(e=e.providerUserInfo)&&e.length?Ku(e,function(e){return new Fa(e.rawId,e.providerId,e.email,e.displayName,e.photoUrl,e.phoneNumber)}):[]}function fs(e,t){return cs(e).then(function(){if(I(is(e),t))return Za(e).then(function(){throw new On("provider-already-linked")})})}function ds(e,t,n){var r=_r(t);return t=Wn(t),In({user:e,credential:r,additionalUserInfo:t,operationType:n})}function ms(e,t){return ls(e,t),e.reload().then(function(){return e})}function gs(e,t,n,r,i){if(!sn())return Y(new On("operation-not-supported-in-this-environment"));if(e.i&&!i)return Y(e.i);var o=Kn(n.providerId),a=dn(e.uid+":::"),s=null;(!ln()||Yt())&&e.u&&n.isOAuthProvider&&(s=ro(e.u,e.m,e.o,t,n,null,a,Pu.SDK_VERSION||null));var u=Ht(s,o&&o.Ba,o&&o.Aa);return r=r().then(function(){if(vs(e),!i)return e.F().then(function(){})}).then(function(){return ma(e.a,u,t,n,a,!!s)}).then(function(){return new z(function(n,r){e.ha(t,null,new On("cancelled-popup-request"),e.g||null),e.f=n,e.v=r,e.g=a,e.c=e.a.Ea(e,t,u,a)})}).then(function(e){return u&&Wt(u),e?In(e):null}).s(function(e){throw u&&Wt(u),e}),bs(e,r,i)}function ys(e,t,n,r,i){if(!sn())return Y(new On("operation-not-supported-in-this-environment"));if(e.i&&!i)return Y(e.i);var o=null,a=dn(e.uid+":::");return r=r().then(function(){if(vs(e),!i)return e.F().then(function(){})}).then(function(){return e.aa=a,Za(e)}).then(function(t){return e.ba&&(t=e.ba,t=t.b.set(ap,e.D(),t.a)),t}).then(function(){return e.a.Ca(t,n,a)}).s(function(t){if(o=t,e.ba)return Ss(e.ba);throw o}).then(function(){if(o)throw o}),bs(e,r,i)}function vs(e){if(!e.a||!e.I){if(e.a&&!e.I)throw new On("internal-error");throw new On("auth-domain-config-required")}}function bs(e,t,n){var r=_s(e,t,n);return e.G.push(r),r.ia(function(){N(e.G,r)}),r}function _s(e,t,n){return e.i&&!n?(t.cancel(),Y(e.i)):t.s(function(t){throw!t||"auth/user-disabled"!=t.code&&"auth/user-token-expired"!=t.code||(e.i||e.dispatchEvent(new Ba("userInvalidated")),e.i=t),t})}function ws(e){if(!e.apiKey)return null;var t={apiKey:e.apiKey,authDomain:e.authDomain,appName:e.appName},n={};if(!(e.stsTokenManager&&e.stsTokenManager.accessToken&&e.stsTokenManager.expirationTime))return null;n[$l]=e.stsTokenManager.accessToken,n.refreshToken=e.stsTokenManager.refreshToken||null,n.expiresIn=(e.stsTokenManager.expirationTime-ju())/1e3;var r=new Ka(t,n,e);return e.providerData&&Bu(e.providerData,function(e){e&&os(r,In(e))}),e.redirectEventId&&(r.aa=e.redirectEventId),r}function ks(e,t,n,r){var i=new Ka(e,t);return n&&(i.ba=n),r&&Ha(i,r),i.reload().then(function(){return i})}function Es(e,t,n,r){t=t||{apiKey:e.m,authDomain:e.u,appName:e.o};var i=e.h,o={};return o[$l]=i.b,o.refreshToken=i.a,o.expiresIn=(i.c-ju())/1e3,t=new Ka(t,o),n&&(t.ba=n),r&&Ha(t,r),us(t,e),t}function Ts(e){this.a=e,this.b=jo()}function Ss(e){return Bo(e.b,ap,e.a)}function Cs(e,t){return e.b.get(ap,e.a).then(function(e){return e&&t&&(e.authDomain=t),ws(e||{})})}function Is(e){this.a=e,this.b=jo(),this.c=null,this.f=Ds(this),this.b.addListener(As("local"),this.a,p(this.g,this))}function Ns(e,t){var n,r=[];for(n in zh)zh[n]!==t&&r.push(Bo(e.b,As(zh[n]),e.a));return r.push(Bo(e.b,sp,e.a)),J(r)}function Ds(e){var t=As("local"),n=As("session"),r=As("none");return Fo(e.b,t,e.a).then(function(){return e.b.get(n,e.a)}).then(function(i){return i?n:e.b.get(r,e.a).then(function(n){return n?r:e.b.get(t,e.a).then(function(n){return n?t:e.b.get(sp,e.a).then(function(e){return e?As(e):t})})})}).then(function(t){return e.c=t,Ns(e,t.A)}).s(function(){e.c||(e.c=t)})}function As(e){return{name:"authUser",A:e}}function xs(e){return Ls(e,function(){return e.b.set(sp,e.c.A,e.a)})}function Os(e,t){return Ls(e,function(){return e.b.set(e.c,t.D(),e.a)})}function Ps(e){return Ls(e,function(){return Bo(e.b,e.c,e.a)})}function Rs(e,t){return Ls(e,function(){return e.b.get(e.c,e.a).then(function(e){return e&&t&&(e.authDomain=t),ws(e||{})})})}function Ls(e,t){return e.f=e.f.then(t,t),e.f}function Ms(e){if(this.m=!1,Sn(this,"settings",new Ia),Sn(this,"app",e),!Gs(this).options||!Gs(this).options.apiKey)throw new On("invalid-api-key");e=Pu.SDK_VERSION?nn(Pu.SDK_VERSION):null,this.b=new bi(Gs(this).options&&Gs(this).options.apiKey,Wi(oh),e),this.N=[],this.o=[],this.I=[],this.Sb=Pu.INTERNAL.createSubscribe(p(this.kc,this)),this.O=void 0,this.Tb=Pu.INTERNAL.createSubscribe(p(this.mc,this)),Ks(this,null),this.h=new Is(Gs(this).options.apiKey+":"+Gs(this).name),this.w=new Ts(Gs(this).options.apiKey+":"+Gs(this).name),this.V=Zs(this,Hs(this)),this.i=Zs(this,zs(this)),this.X=!1,this.ka=p(this.Lc,this),this.Ha=p(this.Z,this),this.qa=p(this.ac,this),this.ra=p(this.ic,this),this.sa=p(this.jc,this),Fs(this),this.INTERNAL={},this.INTERNAL.delete=p(this.delete,this),this.INTERNAL.logFramework=p(this.sc,this),this.u=0,Ve.call(this),Us(this),this.G=[]}function Vs(e){ve.call(this,"languageCodeChanged"),this.g=e}function js(e){ve.call(this,"frameworkChanged"),this.c=e}function Us(e){Object.defineProperty(e,"lc",{get:function(){return this.ea()},set:function(e){this.oa(e)},enumerable:!1}),e.W=null}function qs(e){return e.Rb||Y(new On("auth-domain-config-required"))}function Fs(e){var t=Gs(e).options.authDomain,n=Gs(e).options.apiKey;t&&sn()&&(e.Rb=e.V.then(function(){if(!e.m){if(e.a=ya(t,n,Gs(e).name),e.a.subscribe(e),Xs(e)&&es(Xs(e)),e.C){es(e.C);var r=e.C;r.oa(e.ea()),Wa(r,e),Ha(r=e.C,e.G),za(r,e),e.C=null}return e.a}}))}function Bs(e,t){var n={};return n.apiKey=Gs(e).options.apiKey,n.authDomain=Gs(e).options.authDomain,n.appName=Gs(e).name,e.V.then(function(){return ks(n,t,e.w,e.xa())}).then(function(t){return Xs(e)&&t.uid==Xs(e).uid?(us(Xs(e),t),e.Z(t)):(Ks(e,t),es(t),e.Z(t))}).then(function(){$s(e)})}function Ks(e,t){Xs(e)&&(Ja(Xs(e),e.Ha),De(Xs(e),"tokenChanged",e.qa),De(Xs(e),"userDeleted",e.ra),De(Xs(e),"userInvalidated",e.sa),Ya(Xs(e))),t&&(t.N.push(e.Ha),Se(t,"tokenChanged",e.qa),Se(t,"userDeleted",e.ra),Se(t,"userInvalidated",e.sa),0<e.u&&Xa(t)),Sn(e,"currentUser",t),t&&(t.oa(e.ea()),Wa(t,e),Ha(t,e.G),za(t,e))}function Ws(e){var t=Cs(e.w,Gs(e).options.authDomain).then(function(t){return(e.C=t)&&(t.ba=e.w),Ss(e.w)});return Zs(e,t)}function Hs(e){var t=Gs(e).options.authDomain,n=Ws(e).then(function(){return Rs(e.h,t)}).then(function(t){return t?(t.ba=e.w,e.C&&(e.C.aa||null)==(t.aa||null)?t:t.reload().then(function(){return Os(e.h,t).then(function(){return t})}).s(function(n){return"auth/network-request-failed"==n.code?t:Ps(e.h)})):null}).then(function(t){Ks(e,t||null)});return Zs(e,n)}function zs(e){return e.V.then(function(){return e.fa()}).s(function(){}).then(function(){if(!e.m)return e.ka()}).s(function(){}).then(function(){if(!e.m){e.X=!0;var t=e.h;t.b.addListener(As("local"),t.a,e.ka)}})}function Qs(e,t){var n=null,r=null;return Zs(e,t.then(function(t){return n=_r(t),r=Wn(t),Bs(e,t)}).then(function(){return In({user:Xs(e),credential:n,additionalUserInfo:r,operationType:"signIn"})}))}function Gs(e){return e.app}function Xs(e){return e.currentUser}function Ys(e){return Xs(e)&&Xs(e)._lat||null}function $s(e){if(e.X){for(var t=0;t<e.o.length;t++)e.o[t]&&e.o[t](Ys(e));if(e.O!==e.getUid()&&e.I.length)for(e.O=e.getUid(),t=0;t<e.I.length;t++)e.I[t]&&e.I[t](Ys(e))}}function Js(e,t){e.I.push(t),Zs(e,e.i.then(function(){!e.m&&I(e.I,t)&&e.O!==e.getUid()&&(e.O=e.getUid(),t(Ys(e)))}))}function Zs(e,t){return e.N.push(t),t.ia(function(){N(e.N,t)}),t}function eu(){}function tu(){this.a={},this.b=1e12}function nu(e,t){return(t=ru(t))?e.a[t]||null:null}function ru(e){return(e=void 0===e?1e12:e)?e.toString():null}function iu(e,t){this.g=!1,this.c=t,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=Dt(e);var n=this;this.i=function(){n.execute()},this.h?this.execute():Se(this.f,"click",this.i)}function ou(e){if(e.g)throw Error("reCAPTCHA mock was already deleted!")}function au(){}function su(){this.b=Lu.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}function uu(e,t,n,r,i,o,a){if(Sn(this,"type","recaptcha"),this.c=this.f=null,this.C=!1,this.m=t,this.g=null,a?(cp||(cp=new au),a=cp):(pp||(pp=new su),a=pp),this.o=a,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[mp])throw new On("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[gp],!Lu.document)throw new On("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!Dt(t)||!this.i&&Dt(t).hasChildNodes())throw new On("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.u=new bi(e,o||null,i||null),this.v=r||function(){return null};var s=this;this.l=[];var u=this.a[fp];this.a[fp]=function(e){if(cu(s,e),"function"==typeof u)u(e);else if("string"==typeof u){var t=on(u,Lu);"function"==typeof t&&t(e)}};var c=this.a[dp];this.a[dp]=function(){if(cu(s,null),"function"==typeof c)c();else if("string"==typeof c){var e=on(c,Lu);"function"==typeof e&&e()}}}function cu(e,t){for(var n=0;n<e.l.length;n++)try{e.l[n](t)}catch(e){}}function lu(e,t){D(e.l,function(e){return e==t})}function hu(e,t){return e.h.push(t),t.ia(function(){N(e.h,t)}),t}function pu(e){if(e.C)throw new On("internal-error","RecaptchaVerifier instance has been destroyed.")}function fu(e,t,n){var r=!1;try{this.b=n||Pu.app()}catch(e){throw new On("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new On("invalid-api-key");n=this.b.options.apiKey;var i=this,o=null;try{o=this.b.auth().xa()}catch(e){}try{r=this.b.auth().settings.appVerificationDisabledForTesting}catch(e){}o=Pu.SDK_VERSION?nn(Pu.SDK_VERSION,o):null,uu.call(this,n,e,t,function(){try{var e=i.b.auth().ea()}catch(t){e=null}return e},o,Wi(oh),r)}function du(e,t,n,r){e:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,a=0;a<t.length;a++)if(t[a].optional)o=!0;else{if(o)throw new On("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=t.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=t[i].optional&&void 0===n[i],!t[i].M(n[i])&&!o){if(t=t[i],0>i||i>=yp.length)throw new On("internal-error","Argument validator received an unsupported number of arguments.");n=yp[i],r=(r?"":n+" argument ")+(t.name?'"'+t.name+'" ':"")+"must be "+t.K+".";break e}r=null}}if(r)throw new On("argument-error",e+" failed: "+r)}function mu(t,n){return{name:t||"",K:"a valid string",optional:!!n,M:e}}function gu(e,t){return{name:e||"",K:"a boolean",optional:!!t,M:n}}function yu(e,t){return{name:e||"",K:"a valid object",optional:!!t,M:c}}function vu(e,t){return{name:e||"",K:"a function",optional:!!t,M:u}}function bu(e,t){return{name:e||"",K:"null",optional:!!t,M:o}}function _u(){return{name:"",K:"an HTML element",optional:!1,M:function(e){return!!(e&&e instanceof Element)}}}function wu(){return{name:"auth",K:"an instance of Firebase Auth",optional:!0,M:function(e){return!!(e&&e instanceof Ms)}}}function ku(){return{name:"app",K:"an instance of Firebase App",optional:!0,M:function(e){return!!(e&&e instanceof Pu.app.App)}}}function Eu(e){return{name:e?e+"Credential":"credential",K:e?"a valid "+e+" credential":"a valid credential",optional:!1,M:function(t){if(!t)return!1;var n=!e||t.providerId===e;return!(!t.ya||!n)}}}function Tu(){return{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}}function Su(){return{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!!(t&&e(t.type)&&u(t.verify))}}}function Cu(e,t,n,r){return{name:n||"",K:e.K+" or "+t.K,optional:!!r,M:function(n){return e.M(n)||t.M(n)}}}function Iu(e,t){for(var n in t){var r=t[n].name;e[r]=Au(r,e[n],t[n].j)}}function Nu(e,t){for(var n in t){var r=t[n].name;r!==n&&Object.defineProperty(e,r,{get:f(function(e){return this[e]},n),set:f(function(e,t,n,r){du(e,[n],[r],!0),this[t]=r},r,n,t[n].sb),enumerable:!0})}}function Du(e,t,n,r){e[t]=Au(t,n,r)}function Au(e,t,n){function r(){var e=Array.prototype.slice.call(arguments);return du(o,n,e),t.apply(this,e)}if(!n)return t;var i,o=xu(e);for(i in t)r[i]=t[i];for(i in t.prototype)r.prototype[i]=t.prototype[i];return r}function xu(e){return(e=e.split("."))[e.length-1]}var Ou,Pu=t("@firebase/app").default,Ru=Ru||{},Lu=this,Mu="closure_uid_"+(1e9*Math.random()>>>0),Vu=0,ju=Date.now||function(){return+new Date};d(y,Error),y.prototype.name="CustomError",d(v,y),v.prototype.name="AssertionError",_.prototype.get=function(){if(0<this.b){this.b--;var e=this.a;this.a=e.next,e.next=null}else e=this.c();return e};var Uu=new _(function(){return new T},function(e){e.reset()});k.prototype.add=function(e,t){var n=Uu.get();n.set(e,t),this.b?this.b.next=n:this.a=n,this.b=n},T.prototype.set=function(e,t){this.a=e,this.b=t,this.next=null},T.prototype.reset=function(){this.next=this.b=this.a=null};var qu,Fu=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(t,n){if(e(t))return e(n)&&1==n.length?t.indexOf(n,0):-1;for(var r=0;r<t.length;r++)if(r in t&&t[r]===n)return r;return-1},Bu=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(t,n,r){for(var i=t.length,o=e(t)?t.split(""):t,a=0;a<i;a++)a in o&&n.call(r,o[a],a,t)},Ku=Array.prototype.map?function(e,t){return Array.prototype.map.call(e,t,void 0)}:function(t,n){for(var r=t.length,i=Array(r),o=e(t)?t.split(""):t,a=0;a<r;a++)a in o&&(i[a]=n.call(void 0,o[a],a,t));return i},Wu=Array.prototype.some?function(e,t){return Array.prototype.some.call(e,t,void 0)}:function(t,n){for(var r=t.length,i=e(t)?t.split(""):t,o=0;o<r;o++)if(o in i&&n.call(void 0,i[o],o,t))return!0;return!1},Hu=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]},zu=/&/g,Qu=/</g,Gu=/>/g,Xu=/"/g,Yu=/'/g,$u=/\x00/g,Ju=/[\x00&<>"']/;e:{var Zu=Lu.navigator;if(Zu){var ec=Zu.userAgent;if(ec){qu=ec;break e}}qu=""}var tc,nc,rc="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),ic=!1,oc=new k,ac=0,sc=2,uc=3;Q.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var cc=new _(function(){return new Q},function(e){e.reset()});z.prototype.then=function(e,t,n){return ne(this,u(e)?e:null,u(t)?t:null,n)},m(z),(Ou=z.prototype).ia=function(e,t){return e=G(e,e,t),e.c=!0,te(this,e),this},Ou.s=function(e,t){return ne(this,null,e,t)},Ou.cancel=function(e){this.a==ac&&K(function(){ee(this,new he(e))},this)},Ou.Mc=function(e){this.a=ac,re(this,sc,e)},Ou.Nc=function(e){this.a=ac,re(this,uc,e)},Ou.Xb=function(){for(var e;e=se(this);)ue(this,e,this.a,this.i);this.h=!1};var lc=F;d(he,y),he.prototype.name="cancel";var hc=0,pc={};pe.prototype.pa=!1,pe.prototype.ua=function(){if(this.ja)for(;this.ja.length;)this.ja.shift()()},de[" "]=r;var fc,dc=M("Opera"),mc=M("Trident")||M("MSIE"),gc=M("Edge"),yc=gc||mc,vc=M("Gecko")&&!(R(qu.toLowerCase(),"webkit")&&!M("Edge"))&&!(M("Trident")||M("MSIE"))&&!M("Edge"),bc=R(qu.toLowerCase(),"webkit")&&!M("Edge");e:{var _c="",wc=function(){var e=qu;return vc?/rv:([^\);]+)(\)|;)/.exec(e):gc?/Edge\/([\d\.]+)/.exec(e):mc?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):bc?/WebKit\/(\S+)/.exec(e):dc?/(?:Version)[ \/]?(\S+)/.exec(e):void 0}();if(wc&&(_c=wc?wc[1]:""),mc){var kc=ge();if(null!=kc&&kc>parseFloat(_c)){fc=String(kc);break e}}fc=_c}var Ec,Tc={},Sc=Lu.document;Ec=Sc&&mc?ge()||("CSS1Compat"==Sc.compatMode?parseInt(fc,10):5):void 0;var Cc=Object.freeze||function(e){return e},Ic=!mc||9<=Number(Ec),Nc=mc&&!ye("9"),Dc=function(){if(!Lu.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});return Lu.addEventListener("test",r,t),Lu.removeEventListener("test",r,t),e}();ve.prototype.preventDefault=function(){this.Jb=!1},d(be,ve);var Ac=Cc({2:"touch",3:"pen",4:"mouse"});be.prototype.preventDefault=function(){be.nb.preventDefault.call(this);var e=this.a;if(e.preventDefault)e.preventDefault();else if(e.returnValue=!1,Nc)try{(e.ctrlKey||112<=e.keyCode&&123>=e.keyCode)&&(e.keyCode=-1)}catch(e){}},be.prototype.f=function(){return this.a};var xc="closure_listenable_"+(1e6*Math.random()|0),Oc=0;ke.prototype.add=function(e,t,n,r,i){var o=e.toString();(e=this.a[o])||(e=this.a[o]=[],this.b++);var a=Te(e,t,r,i);return-1<a?(t=e[a],n||(t.Ia=!1)):(t=new _e(t,this.src,o,!!r,i),t.Ia=n,e.push(t)),t};var Pc="closure_lm_"+(1e6*Math.random()|0),Rc={},Lc=0,Mc="__closure_events_fn_"+(1e9*Math.random()>>>0);d(Ve,pe),Ve.prototype[xc]=!0,Ve.prototype.addEventListener=function(e,t,n,r){Se(this,e,t,n,r)},Ve.prototype.removeEventListener=function(e,t,n,r){De(this,e,t,n,r)},Ve.prototype.dispatchEvent=function(t){var n,r=this.Ua;if(r)for(n=[];r;r=r.Ua)n.push(r);r=this.Qb;var i=t.type||t;if(e(t))t=new ve(t,r);else if(t instanceof ve)t.target=t.target||r;else{var o=t;q(t=new ve(i,r),o)}if(o=!0,n)for(var a=n.length-1;0<=a;a--){var s=t.b=n[a];o=qe(s,i,!0,t)&&o}if(s=t.b=r,o=qe(s,i,!0,t)&&o,o=qe(s,i,!1,t)&&o,n)for(a=0;a<n.length;a++)s=t.b=n[a],o=qe(s,i,!1,t)&&o;return o},Ve.prototype.ua=function(){if(Ve.nb.ua.call(this),this.l){var e,t=this.l;for(e in t.a){for(var n=t.a[e],r=0;r<n.length;r++)we(n[r]);delete t.a[e],t.b--}}this.Ua=null},(Ou=ze.prototype).S=function(){Qe(this);for(var e=[],t=0;t<this.a.length;t++)e.push(this.b[this.a[t]]);return e},Ou.U=function(){return Qe(this),this.a.concat()},Ou.clear=function(){this.b={},this.c=this.a.length=0},Ou.get=function(e,t){return Ge(this.b,e)?this.b[e]:t},Ou.set=function(e,t){Ge(this.b,e)||(this.c++,this.a.push(e)),this.b[e]=t},Ou.forEach=function(e,t){for(var n=this.U(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);e.call(t,o,i,this)}};var Vc=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;Ye.prototype.toString=function(){var e=[],t=this.c;t&&e.push(ot(t,jc,!0),":");var n=this.b;return(n||"file"==t)&&(e.push("//"),(t=this.l)&&e.push(ot(t,jc,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.i)&&e.push(":",String(n))),(n=this.g)&&(this.b&&"/"!=n.charAt(0)&&e.push("/"),e.push(ot(n,"/"==n.charAt(0)?qc:Uc,!0))),(n=this.a.toString())&&e.push("?",n),(n=this.h)&&e.push("#",ot(n,Bc)),e.join("")};var jc=/[#\/\?@]/g,Uc=/[#\?:]/g,qc=/[#\?]/g,Fc=/[#\?@]/g,Bc=/#/g;(Ou=st.prototype).add=function(e,t){ut(this),this.c=null,e=ft(this,e);var n=this.a.get(e);return n||this.a.set(e,n=[]),n.push(t),this.b+=1,this},Ou.clear=function(){this.a=this.c=null,this.b=0},Ou.forEach=function(e,t){ut(this),this.a.forEach(function(n,r){Bu(n,function(n){e.call(t,n,r,this)},this)},this)},Ou.U=function(){ut(this);for(var e=this.a.S(),t=this.a.U(),n=[],r=0;r<t.length;r++)for(var i=e[r],o=0;o<i.length;o++)n.push(t[r]);return n},Ou.S=function(t){ut(this);var n=[];if(e(t))ht(this,t)&&(n=A(n,this.a.get(ft(this,t))));else{t=this.a.S();for(var r=0;r<t.length;r++)n=A(n,t[r])}return n},Ou.set=function(e,t){return ut(this),this.c=null,e=ft(this,e),ht(this,e)&&(this.b-=this.a.get(e).length),this.a.set(e,[t]),this.b+=1,this},Ou.get=function(e,t){return 0<(e=e?this.S(e):[]).length?String(e[0]):t},Ou.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var e=[],t=this.a.U(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.S(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),e.push(a)}}return this.c=e.join("&")};var Kc=!mc||9<=Number(Ec);mt.prototype.ma=!0,mt.prototype.la=function(){return this.a},mt.prototype.toString=function(){return"Const{"+this.a+"}"};var Wc={};yt(""),vt.prototype.ma=!0,vt.prototype.la=function(){return this.a},vt.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var Hc=/%{(\w+)}/g,zc=/^(?:https:)?\/\/[0-9a-z.:[\]-]+\/|^\/[^\/\\]|^about:blank#/i,Qc={};kt.prototype.ma=!0,kt.prototype.la=function(){return this.a},kt.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var Gc=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i,Xc={};St("about:blank"),Ct.prototype.ma=!0,Ct.prototype.la=function(){return this.a},Ct.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Yc={};Nt("<!DOCTYPE html>"),Nt(""),Nt("<br>");var $c={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"},Jc={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},Zc=/\uffff/.test("￿")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g,el=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,tl="Firefox",nl="Chrome",rl={Tc:"FirebaseCore-web",Vc:"FirebaseUI-web"};yn.prototype.get=function(){var e=Lu.navigator;return(e&&"boolean"==typeof e.onLine&&(un()||"chrome-extension:"===cn()||void 0!==e.connection)?e.onLine:1)?this.b?this.c:this.a:Math.min(5e3,this.a)};var il,ol={};try{var al={};Object.defineProperty(al,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(al,"abcd",{configurable:!0,enumerable:!0,value:2}),il=2==al.abcd}catch(e){il=!1}var sl="EMAIL_SIGNIN",ul="email",cl="newEmail",ll="requestType",hl="email",pl="fromEmail",fl="data",dl="operation";d(On,Error),On.prototype.D=function(){return{code:this.code,message:this.message}},On.prototype.toJSON=function(){return this.D()};var ml="auth/",gl={"argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","user-cancelled":"User did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},yl="android",vl="dynamicLinkDomain",bl="handleCodeInApp",_l="iOS",wl="url",kl="installApp",El="minimumVersion",Tl="packageName",Sl="bundleId",Cl=null,Il=null;qn.prototype.f=function(){return this.b};var Nl="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),Dl=["client_id","response_type","scope","redirect_uri","state"],Al={Uc:{Ma:"locale",Ba:500,Aa:600,Na:"facebook.com",gb:Dl},Wc:{Ma:null,Ba:500,Aa:620,Na:"github.com",gb:Dl},Xc:{Ma:"hl",Ba:515,Aa:680,Na:"google.com",gb:Dl},cd:{Ma:"lang",Ba:485,Aa:705,Na:"twitter.com",gb:Nl}},xl="idToken",Ol="providerId";d(zn,Hn),d(Qn,zn),d(Gn,zn),d(Xn,zn),d(Yn,zn),er.prototype.ya=function(e){return Vi(e,tr(this))},er.prototype.c=function(e,t){var n=tr(this);return n.idToken=t,ji(e,n)},er.prototype.f=function(e,t){return Zn(Ui(e,tr(this)),t)},er.prototype.D=function(){var e={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(e.oauthIdToken=this.idToken),this.accessToken&&(e.oauthAccessToken=this.accessToken),this.secret&&(e.oauthTokenSecret=this.secret),e},nr.prototype.Da=function(e){return this.xb=U(e),this},d(rr,nr),rr.prototype.ta=function(e){return I(this.a,e)||this.a.push(e),this},rr.prototype.Db=function(){return x(this.a)},rr.prototype.credential=function(e,t){if(!e&&!t)throw new On("argument-error","credential failed: must provide the ID token and/or the access token.");return new er(this.providerId,{idToken:e||null,accessToken:t||null},this.providerId)},d(ir,rr),Sn(ir,"PROVIDER_ID","facebook.com"),Sn(ir,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),d(ar,rr),Sn(ar,"PROVIDER_ID","github.com"),Sn(ar,"GITHUB_SIGN_IN_METHOD","github.com"),d(ur,rr),Sn(ur,"PROVIDER_ID","google.com"),Sn(ur,"GOOGLE_SIGN_IN_METHOD","google.com"),d(lr,nr),Sn(lr,"PROVIDER_ID","twitter.com"),Sn(lr,"TWITTER_SIGN_IN_METHOD","twitter.com"),pr.prototype.ya=function(e){return this.signInMethod==fr.EMAIL_LINK_SIGN_IN_METHOD?Fi(e,ph,{email:this.a,oobCode:this.b}):Fi(e,Dh,{email:this.a,password:this.b})},pr.prototype.c=function(e,t){return this.signInMethod==fr.EMAIL_LINK_SIGN_IN_METHOD?Fi(e,fh,{idToken:t,email:this.a,oobCode:this.b}):Fi(e,Eh,{idToken:t,email:this.a,password:this.b})},pr.prototype.f=function(e,t){return Zn(this.ya(e),t)},pr.prototype.D=function(){return{email:this.a,password:this.b,signInMethod:this.signInMethod}},Cn(fr,{PROVIDER_ID:"password"}),Cn(fr,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),Cn(fr,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),gr.prototype.ya=function(e){return e.Ta(yr(this))},gr.prototype.c=function(e,t){var n=yr(this);return n.idToken=t,Fi(e,xh,n)},gr.prototype.f=function(e,t){var n=yr(this);return n.operation="REAUTH",e=Fi(e,Oh,n),Zn(e,t)},gr.prototype.D=function(){var e={providerId:"phone"};return this.a.Sa&&(e.verificationId=this.a.Sa),this.a.Ra&&(e.verificationCode=this.a.Ra),this.a.Fa&&(e.temporaryProof=this.a.Fa),this.a.$&&(e.phoneNumber=this.a.$),e},vr.prototype.Ta=function(t,n){var r=this.a.b;return X(n.verify()).then(function(i){if(!e(i))throw new On("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(n.type){case"recaptcha":return Pi(r,{phoneNumber:t,recaptchaToken:i}).then(function(e){return"function"==typeof n.reset&&n.reset(),e},function(e){throw"function"==typeof n.reset&&n.reset(),e});default:throw new On("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}})},Cn(vr,{PROVIDER_ID:"phone"}),Cn(vr,{PHONE_SIGN_IN_METHOD:"phone"}),kr.prototype.D=function(){return{type:this.b,eventId:this.c,urlResponse:this.f,sessionId:this.g,error:this.a&&this.a.D()}};var Pl=null;Tr.prototype.subscribe=function(e){var t=this;this.a.push(e),this.b||(this.b=function(e){for(var n=0;n<t.a.length;n++)t.a[n](e)},"function"==typeof(e=on("universalLinks.subscribe",Lu))&&e(null,this.b))},Tr.prototype.unsubscribe=function(e){D(this.a,function(t){return t==e})},d(Sr,On),d(Cr,On),Cr.prototype.D=function(){var e={code:this.code,message:this.message};this.email&&(e.email=this.email),this.phoneNumber&&(e.phoneNumber=this.phoneNumber);var t=this.credential&&this.credential.D();return t&&q(e,t),e},Cr.prototype.toJSON=function(){return this.D()};var Rl=/^[+a-zA-Z0-9_.!#$%&'*\/=?^`{|}~-]+@([a-zA-Z0-9-]+\.)+[a-zA-Z0-9]{2,63}$/;Nr.prototype.c=null;var Ll;d(Ar,Nr),Ar.prototype.a=function(){var e=xr(this);return e?new ActiveXObject(e):new XMLHttpRequest},Ar.prototype.b=function(){var e={};return xr(this)&&(e[0]=!0,e[1]=!0),e},Ll=new Ar,d(Or,Nr),Or.prototype.a=function(){var e=new XMLHttpRequest;if("withCredentials"in e)return e;if("undefined"!=typeof XDomainRequest)return new Pr;throw Error("Unsupported browser")},Or.prototype.b=function(){return{}},(Ou=Pr.prototype).open=function(e,t,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(e,t)},Ou.send=function(e){if(e){if("string"!=typeof e)throw Error("Only string data is supported");this.a.send(e)}else this.a.send()},Ou.abort=function(){this.a.abort()},Ou.setRequestHeader=function(){},Ou.getResponseHeader=function(e){return"content-type"==e.toLowerCase()?this.a.contentType:""},Ou.dc=function(){this.status=200,this.responseText=this.a.responseText,Rr(this,4)},Ou.Eb=function(){this.status=500,this.responseText="",Rr(this,4)},Ou.hc=function(){this.Eb()},Ou.ec=function(){this.status=200,Rr(this,1)},Ou.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},Lr.prototype.a=null;var Ml=0;Lr.prototype.reset=function(e,t,n,r,i){"number"==typeof i||Ml++,r||ju(),delete this.a},Vr.prototype.toString=function(){return this.name};var Vl=new Vr("SEVERE",1e3),jl=new Vr("WARNING",900),Ul=new Vr("CONFIG",700),ql=new Vr("FINE",500);Mr.prototype.log=function(e,t,n){if(e.value>=jr(this).value)for(u(t)&&(t=t()),e=new Lr(e,String(t),this.f),n&&(e.a=n),n=this;n;)n=n.a};var Fl={},Bl=null;d(Fr,Nr),Fr.prototype.a=function(){return new Br(this.f)},Fr.prototype.b=function(e){return function(){return e}}({}),d(Br,Ve);var Kl=0;(Ou=Br.prototype).open=function(e,t){if(this.readyState!=Kl)throw this.abort(),Error("Error reopening a connection");this.h=e,this.c=t,this.readyState=1,Kr(this)},Ou.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var t={headers:this.g,method:this.h,credentials:void 0,cache:void 0};e&&(t.body=e),this.i.fetch(new Request(this.c,t)).then(this.gc.bind(this),this.Fb.bind(this))},Ou.abort=function(){this.responseText="",this.g=new Headers,this.status=0,1<=this.readyState&&this.a&&4!=this.readyState&&(this.readyState=4,this.a=!1,Kr(this)),this.readyState=Kl},Ou.gc=function(e){this.a&&(this.b||(this.b=e.headers,this.readyState=2,Kr(this)),this.a&&(this.readyState=3,Kr(this),this.a&&e.text().then(this.fc.bind(this,e),this.Fb.bind(this))))},Ou.fc=function(e,t){this.a&&(this.status=e.status,this.statusText=e.statusText,this.responseText=t,this.readyState=4,Kr(this))},Ou.Fb=function(e){var t=this.f;t&&t.log(jl,"Failed to fetch url "+this.c,e instanceof Error?e:Error(e)),this.a&&(this.readyState=4,Kr(this))},Ou.setRequestHeader=function(e,t){this.g.append(e,t)},Ou.getResponseHeader=function(e){return this.b?this.b.get(e.toLowerCase())||"":((e=this.f)&&e.log(jl,"Attempting to get response header but no headers have been received for url: "+this.c,void 0),"")},Ou.getAllResponseHeaders=function(){if(!this.b){var e=this.f;return e&&e.log(jl,"Attempting to get all response headers but no headers have been received for url: "+this.c,void 0),""}e=[];for(var t=this.b.entries(),n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},d(Wr,Ve);var Wl="";Wr.prototype.b=Ur("goog.net.XhrIo");var Hl=/^https?$/i,zl=["POST","PUT"];(Ou=Wr.prototype).Ga=function(){void 0!==Ru&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",qr(this.b,ni(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},Ou.abort=function(){this.a&&this.c&&(qr(this.b,ni(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),$r(this))},Ou.ua=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),$r(this,!0)),Wr.nb.ua.call(this)},Ou.Ib=function(){this.pa||(this.I||this.i||this.f?Yr(this):this.vc())},Ou.vc=function(){Yr(this)},Ou.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.o){case Wl:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var e=this.b;return e&&e.log(Vl,"Response type "+this.o+" is not supported on this browser",void 0),null}catch(e){return qr(this.b,"Can not get response: "+e.message),null}},ri.prototype.cancel=function(e){if(this.a)this.c instanceof ri&&this.c.cancel();else{if(this.b){var t=this.b;delete this.b,e?t.cancel(e):(t.l--,0>=t.l&&t.cancel())}this.v?this.v.call(this.u,this):this.m=!0,this.a||(e=new hi(this),oi(this),ii(this,!1,e))}},ri.prototype.o=function(e,t){this.i=!1,ii(this,e,t)},ri.prototype.C=function(){oi(this),ii(this,!0,null)},ri.prototype.then=function(e,t,n){var r,i,o=new z(function(e,t){r=e,i=t});return si(this,r,function(e){e instanceof hi?o.cancel():i(e)}),o.then(e,t,n)},m(ri),d(li,y),li.prototype.message="Deferred has already fired",li.prototype.name="AlreadyCalledError",d(hi,y),hi.prototype.message="Deferred was canceled",hi.prototype.name="CanceledError",pi.prototype.c=function(){throw delete Ql[this.a],this.b};var Ql={},Gl=0,Xl=1;d(yi,y),d(vi,Nr),vi.prototype.a=function(){return new this.f},vi.prototype.b=function(){return{}};var Yl,$l="idToken",Jl=new yn(3e4,6e4),Zl={"Content-Type":"application/x-www-form-urlencoded"},eh=new yn(3e4,6e4),th={"Content-Type":"application/json"};bi.prototype.o=function(e,t,n,r,i,o){if($t()&&(void 0===Lu.fetch||void 0===Lu.Headers||void 0===Lu.Request))throw new On("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var a=new Wr(this.c);if(o){a.g=Math.max(0,o);var s=setTimeout(function(){a.dispatchEvent("timeout")},o)}je(a,"complete",function(){s&&clearTimeout(s);var e=null;try{e=JSON.parse(ti(this))||null}catch(t){e=null}t&&t(e)}),Ue(a,"ready",function(){s&&clearTimeout(s),fe(this)}),Ue(a,"timeout",function(){s&&clearTimeout(s),fe(this),t&&t(null)}),Hr(a,e,n,r,i)};var nh=yt("https://apis.google.com/js/client.js?onload=%{onload}"),rh="__fcb"+Math.floor(1e6*Math.random()).toString();bi.prototype.m=function(e,t,n,r,i){var o=this;Yl.then(function(){window.gapi.client.setApiKey(o.b);var a=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:e,method:n,body:r,headers:i,authType:"none",callback:function(e){window.gapi.auth.setToken(a),t&&t(e)}})}).s(function(e){t&&t({error:{message:e&&e.message||"CORS_UNSUPPORTED"}})})},bi.prototype.Pa=function(){return Fi(this,Th,{})},bi.prototype.ob=function(e,t){return Fi(this,kh,{idToken:e,email:t})},bi.prototype.pb=function(e,t){return Fi(this,Eh,{idToken:e,password:t})};var ih={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};(Ou=bi.prototype).qb=function(e,t){var n={idToken:e},r=[];return V(ih,function(e,i){var o=t[i];null===o?r.push(e):i in t&&(n[i]=o)}),r.length&&(n.deleteAttribute=r),Fi(this,kh,n)},Ou.jb=function(e,t){return e={requestType:"PASSWORD_RESET",email:e},q(e,t),Fi(this,yh,e)},Ou.kb=function(e,t){return e={requestType:"EMAIL_SIGNIN",email:e},q(e,t),Fi(this,mh,e)},Ou.ib=function(e,t){return e={requestType:"VERIFY_EMAIL",idToken:e},q(e,t),Fi(this,gh,e)},Ou.Ta=function(e){return Fi(this,Ah,e)},Ou.Ya=function(e,t){return Fi(this,_h,{oobCode:e,newPassword:t})},Ou.Ja=function(e){return Fi(this,sh,{oobCode:e})},Ou.Va=function(e){return Fi(this,ah,{oobCode:e})};var oh,ah={endpoint:"setAccountInfo",B:qi,da:"email"},sh={endpoint:"resetPassword",B:qi,J:function(e){var t=e.requestType;if(!t||!e.email&&"EMAIL_SIGNIN"!=t)throw new On("internal-error")}},uh={endpoint:"signupNewUser",B:function(e){if(Ci(e),!e.password)throw new On("weak-password")},J:xi,R:!0},ch={endpoint:"createAuthUri"},lh={endpoint:"deleteAccount",T:["idToken"]},hh={endpoint:"setAccountInfo",T:["idToken","deleteProvider"],B:function(e){if(!a(e.deleteProvider))throw new On("internal-error")}},ph={endpoint:"emailLinkSignin",T:["email","oobCode"],B:Ci,J:xi,R:!0},fh={endpoint:"emailLinkSignin",T:["idToken","email","oobCode"],B:Ci,J:xi,R:!0},dh={endpoint:"getAccountInfo"},mh={endpoint:"getOobConfirmationCode",T:["requestType"],B:function(e){if("EMAIL_SIGNIN"!=e.requestType)throw new On("internal-error");Ci(e)},da:"email"},gh={endpoint:"getOobConfirmationCode",T:["idToken","requestType"],B:function(e){if("VERIFY_EMAIL"!=e.requestType)throw new On("internal-error")},da:"email"},yh={endpoint:"getOobConfirmationCode",T:["requestType"],B:function(e){if("PASSWORD_RESET"!=e.requestType)throw new On("internal-error");Ci(e)},da:"email"},vh={tb:!0,endpoint:"getProjectConfig",Hb:"GET"},bh={tb:!0,endpoint:"getRecaptchaParam",Hb:"GET",J:function(e){if(!e.recaptchaSiteKey)throw new On("internal-error")}},_h={endpoint:"resetPassword",B:qi,da:"email"},wh={endpoint:"sendVerificationCode",T:["phoneNumber","recaptchaToken"],da:"sessionInfo"},kh={endpoint:"setAccountInfo",T:["idToken"],B:Ii,R:!0},Eh={endpoint:"setAccountInfo",T:["idToken"],B:function(e){if(Ii(e),!e.password)throw new On("weak-password")},J:xi,R:!0},Th={endpoint:"signupNewUser",J:xi,R:!0},Sh={endpoint:"verifyAssertion",B:Li,J:Mi,R:!0},Ch={endpoint:"verifyAssertion",B:Li,J:function(e){if(e.errorMessage&&"USER_NOT_FOUND"==e.errorMessage)throw new On("user-not-found");if(e.errorMessage)throw Bi(e.errorMessage);if(!e[$l])throw new On("internal-error")},R:!0},Ih={endpoint:"verifyAssertion",B:function(e){if(Li(e),!e.idToken)throw new On("internal-error")},J:Mi,R:!0},Nh={endpoint:"verifyCustomToken",B:function(e){if(!e.token)throw new On("invalid-custom-token")},J:xi,R:!0},Dh={endpoint:"verifyPassword",B:function(e){if(Ci(e),!e.password)throw new On("wrong-password")},J:xi,R:!0},Ah={endpoint:"verifyPhoneNumber",B:Oi,J:xi},xh={endpoint:"verifyPhoneNumber",B:function(e){if(!e.idToken)throw new On("internal-error");Oi(e)},J:function(e){if(e.temporaryProof)throw e.code="credential-already-in-use",Ir(e);xi(e)}},Oh={Wb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",B:Oi,J:xi},Ph={Zc:{$a:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",hb:"https://securetoken.googleapis.com/v1/token",id:"p"},ad:{$a:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",hb:"https://staging-securetoken.sandbox.googleapis.com/v1/token",id:"s"},bd:{$a:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",hb:"https://test-securetoken.sandbox.googleapis.com/v1/token",id:"t"}};oh=Wi("__EID__")?"__EID__":void 0;var Rh=yt("https://apis.google.com/js/api.js?onload=%{onload}"),Lh=new yn(3e4,6e4),Mh=new yn(5e3,15e3),Vh=null;Yi.prototype.toString=function(){return this.f?et(this.a,"v",this.f):lt(this.a.a,"v"),this.b?et(this.a,"eid",this.b):lt(this.a.a,"eid"),this.c.length?et(this.a,"fw",this.c.join(",")):lt(this.a.a,"fw"),this.a.toString()},$i.prototype.toString=function(){var e=rt(this.o,"/__/auth/handler");if(et(e,"apiKey",this.m),et(e,"appName",this.c),et(e,"authType",this.l),this.a.isOAuthProvider){var t=this.a;try{var n=Pu.app(this.c).auth().ea()}catch(e){n=null}t.Za=n,et(e,"providerId",this.a.providerId),n=pn((t=this.a).xb);for(var r in n)n[r]=n[r].toString();r=t.Cc,n=U(n);for(var i=0;i<r.length;i++){var o=r[i];o in n&&delete n[o]}t.bb&&t.Za&&!n[t.bb]&&(n[t.bb]=t.Za),j(n)||et(e,"customParameters",hn(n))}if("function"==typeof this.a.Db&&(t=this.a.Db()).length&&et(e,"scopes",t.join(",")),this.i?et(e,"redirectUrl",this.i):lt(e.a,"redirectUrl"),this.g?et(e,"eventId",this.g):lt(e.a,"eventId"),this.h?et(e,"v",this.h):lt(e.a,"v"),this.b)for(var a in this.b)this.b.hasOwnProperty(a)&&!tt(e,a)&&et(e,a,this.b[a]);return this.f?et(e,"eid",this.f):lt(e.a,"eid"),(a=Ji(this.c)).length&&et(e,"fw",a.join(",")),e.toString()},(Ou=Zi.prototype).Ea=function(e,t,n){var r=new On("popup-closed-by-user"),i=new On("web-storage-unsupported"),o=this,a=!1;return this.ga().then(function(){oo(o).then(function(n){n||(e&&Wt(e),t(i),a=!0)})}).s(function(){}).then(function(){if(!a)return zt(e)}).then(function(){if(!a)return Be(n).then(function(){t(r)})})},Ou.Lb=function(){var e=rn();return!ln(e)&&!mn(e)},Ou.Gb=function(){return!1},Ou.Bb=function(e,t,n,r,i,o,a){if(!e)return Y(new On("popup-blocked"));if(a&&!ln())return this.ga().s(function(t){Wt(e),i(t)}),r(),X();this.a||(this.a=eo(no(this)));var s=this;return this.a.then(function(){var t=s.ga().s(function(t){throw Wt(e),i(t),t});return r(),t}).then(function(){wr(n),a||qt(ro(s.m,s.f,s.b,t,n,null,o,s.c,void 0,s.h),e)}).s(function(e){throw"auth/network-request-failed"==e.code&&(s.a=null),e})},Ou.Ca=function(e,t,n){this.a||(this.a=eo(no(this)));var r=this;return this.a.then(function(){wr(t),qt(ro(r.m,r.f,r.b,e,t,Ut(),n,r.c,void 0,r.h))}).s(function(e){throw"auth/network-request-failed"==e.code&&(r.a=null),e})},Ou.ga=function(){var e=this;return to(this).then(function(){return e.i.eb}).s(function(){throw e.a=null,new On("network-request-failed")})},Ou.Pb=function(){return!0},Ou.va=function(e){this.g.push(e)},Ou.Ka=function(e){D(this.g,function(t){return t==e})},(Ou=ao.prototype).get=function(e){return X(this.a.getItem(e)).then(function(e){return e&&fn(e)})},Ou.set=function(e,t){return X(this.a.setItem(e,hn(t)))},Ou.P=function(e){return X(this.a.removeItem(e))},Ou.Y=function(){},Ou.ca=function(){};var jh=[];so.prototype.f=function(e){var t=e.data.eventType,n=e.data.eventId,r=this.a[t];if(r&&0<r.length){e.ports[0].postMessage({status:"ack",eventId:n,eventType:t,response:null});var i=[];Bu(r,function(t){i.push(X().then(function(){return t(e.origin,e.data.data)}))}),Z(i).then(function(r){var i=[];Bu(r,function(e){i.push({fulfilled:e.Cb,value:e.value,reason:e.reason?e.reason.message:void 0})}),Bu(i,function(e){for(var t in e)void 0===e[t]&&delete e[t]}),e.ports[0].postMessage({status:"done",eventId:n,eventType:t,response:i})})}},so.prototype.subscribe=function(e,t){j(this.a)&&this.b.addEventListener("message",this.c),void 0===this.a[e]&&(this.a[e]=[]),this.a[e].push(t)},so.prototype.unsubscribe=function(e,t){void 0!==this.a[e]&&t?(D(this.a[e],function(e){return e==t}),0==this.a[e].length&&delete this.a[e]):t||delete this.a[e],j(this.a)&&this.b.removeEventListener("message",this.c)},co.prototype.postMessage=function(e,t){this.a.postMessage(e,t)},lo.prototype.close=function(){for(;0<this.a.length;)po(this,this.a[0]);this.b=!0};var Uh;(Ou=fo.prototype).set=function(e,t){var n,r=!1,i=this;return yo(this).then(function(t){return n=t,t=bo(_o(n,!0)),wo(t.get(e))}).then(function(o){var a=bo(_o(n,!0));return o?(o.value=t,wo(a.put(o))):(i.b++,r=!0,o={},o.fbase_key=e,o.value=t,wo(a.add(o)))}).then(function(){return i.c[e]=t,ko(i,e)}).ia(function(){r&&i.b--})},Ou.get=function(e){return yo(this).then(function(t){return wo(bo(_o(t,!1)).get(e))}).then(function(e){return e&&e.value})},Ou.P=function(e){var t=!1,n=this;return yo(this).then(function(r){return t=!0,n.b++,wo(bo(_o(r,!0)).delete(e))}).then(function(){return delete n.c[e],ko(n,e)}).ia(function(){t&&n.b--})},Ou.Y=function(e){0==this.a.length&&To(this),this.a.push(e)},Ou.ca=function(e){D(this.a,function(t){return t==e}),0==this.a.length&&So(this)},(Ou=Co.prototype).get=function(e){return this.b.then(function(t){return t.get(e)})},Ou.set=function(e,t){return this.b.then(function(n){return n.set(e,t)})},Ou.P=function(e){return this.b.then(function(t){return t.P(e)})},Ou.Y=function(e){this.a.push(e)},Ou.ca=function(e){D(this.a,function(t){return t==e})},(Ou=Io.prototype).get=function(e){return X(this.a[e])},Ou.set=function(e,t){return this.a[e]=t,X()},Ou.P=function(e){return delete this.a[e],X()},Ou.Y=function(){},Ou.ca=function(){},(Ou=No.prototype).get=function(e){var t=this;return X().then(function(){return fn(t.a.getItem(e))})},Ou.set=function(e,t){var n=this;return X().then(function(){var r=hn(t);null===r?n.P(e):n.a.setItem(e,r)})},Ou.P=function(e){var t=this;return X().then(function(){t.a.removeItem(e)})},Ou.Y=function(e){Lu.window&&Se(Lu.window,"storage",e)},Ou.ca=function(e){Lu.window&&De(Lu.window,"storage",e)},(Ou=xo.prototype).get=function(){return X(null)},Ou.set=function(){return X()},Ou.P=function(){return X()},Ou.Y=function(){},Ou.ca=function(){},(Ou=Oo.prototype).get=function(e){var t=this;return X().then(function(){return fn(t.a.getItem(e))})},Ou.set=function(e,t){var n=this;return X().then(function(){var r=hn(t);null===r?n.P(e):n.a.setItem(e,r)})},Ou.P=function(e){var t=this;return X().then(function(){t.a.removeItem(e)})},Ou.Y=function(){},Ou.ca=function(){};var qh,Fh,Bh={A:No,Qa:Oo},Kh={A:No,Qa:Oo},Wh={A:ao,Qa:xo},Hh={A:No,Qa:xo},zh={Yc:"local",NONE:"none",$c:"session"};(Ou=Vo.prototype).get=function(e,t){return Uo(this,e.A).get(qo(e,t))},Ou.set=function(e,t,n){var r=qo(e,n),i=this,o=Uo(this,e.A);return o.set(r,t).then(function(){return o.get(r)}).then(function(t){"local"==e.A&&(i.b[r]=t)})},Ou.addListener=function(e,t,n){e=qo(e,t),this.l&&(this.b[e]=Lu.localStorage.getItem(e)),j(this.a)&&(Uo(this,"local").Y(this.f),this.h||(jt()||!wn())&&Lu.indexedDB||!this.l||Ko(this)),this.a[e]||(this.a[e]=[]),this.a[e].push(n)},Ou.removeListener=function(e,t,n){e=qo(e,t),this.a[e]&&(D(this.a[e],function(e){return e==n}),0==this.a[e].length&&delete this.a[e]),j(this.a)&&(Uo(this,"local").ca(this.f),Wo(this))},Ou.Ob=function(e){if(e&&e.f){var t=e.a.key;if(null==t)for(var n in this.a){var r=this.b[n];void 0===r&&(r=null);var i=Lu.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.Wa(n))}else if(0==t.indexOf("firebase:")&&this.a[t]){if(void 0!==e.a.a?Uo(this,"local").ca(this.f):Wo(this),this.o)if(n=Lu.localStorage.getItem(t),(r=e.a.newValue)!==n)null!==r?Lu.localStorage.setItem(t,r):Lu.localStorage.removeItem(t);else if(this.b[t]===r&&void 0===e.a.a)return;var o=this;n=function(){void 0===e.a.a&&o.b[t]===Lu.localStorage.getItem(t)||(o.b[t]=Lu.localStorage.getItem(t),o.Wa(t))},mc&&Ec&&10==Ec&&Lu.localStorage.getItem(t)!==e.a.newValue&&e.a.newValue!==e.a.oldValue?setTimeout(n,10):n()}}else Bu(e,p(this.Wa,this))},Ou.Wa=function(e){this.a[e]&&Bu(this.a[e],function(e){e()})};var Qh,Gh={name:"authEvent",A:"local"};d(Go,function(){this.b=-1});for(var Xh=64,Yh=Xh-1,$h=[],Jh=0;Jh<Yh;Jh++)$h[Jh]=0;var Zh=A(128,$h);Go.prototype.reset=function(){this.g=this.c=0,this.a=Lu.Int32Array?new Int32Array(this.h):x(this.h)};var ep=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];d($o,Go);var tp=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];(Ou=Jo.prototype).ga=function(){return this.za?this.za:this.za=Gt().then(function(){if("function"!=typeof on("universalLinks.subscribe",Lu))throw Zo("cordova-universal-links-plugin-fix is not installed");if(void 0===on("BuildInfo.packageName",Lu))throw Zo("cordova-plugin-buildinfo is not installed");if("function"!=typeof on("cordova.plugins.browsertab.openUrl",Lu))throw Zo("cordova-plugin-browsertab is not installed");if("function"!=typeof on("cordova.InAppBrowser.open",Lu))throw Zo("cordova-plugin-inappbrowser is not installed")},function(){throw new On("cordova-not-ready")})},Ou.Ea=function(e,t){return t(new On("operation-not-supported-in-this-environment")),X()},Ou.Bb=function(){return Y(new On("operation-not-supported-in-this-environment"))},Ou.Pb=function(){return!1},Ou.Lb=function(){return!0},Ou.Gb=function(){return!0},Ou.Ca=function(e,t,n){if(this.c)return Y(new On("redirect-operation-pending"));var r=this,i=Lu.document,o=null,a=null,s=null,u=null;return this.c=X().then(function(){return wr(t),ia(r)}).then(function(){return na(r,e,t,n)}).then(function(){return new z(function(e,t){a=function(){var t=on("cordova.plugins.browsertab.close",Lu);return e(),"function"==typeof t&&t(),r.a&&"function"==typeof r.a.close&&(r.a.close(),r.a=null),!1},r.va(a),s=function(){o||(o=Be(2e3).then(function(){t(new On("redirect-cancelled-by-user"))}))},u=function(){vn()&&s()},i.addEventListener("resume",s,!1),rn().toLowerCase().match(/android/)||i.addEventListener("visibilitychange",u,!1)}).s(function(e){return oa(r).then(function(){throw e})})}).ia(function(){s&&i.removeEventListener("resume",s,!1),u&&i.removeEventListener("visibilitychange",u,!1),o&&o.cancel(),a&&r.Ka(a),r.c=null})},Ou.va=function(e){this.b.push(e),ia(this).s(function(t){"auth/invalid-cordova-configuration"===t.code&&(t=new kr("unknown",null,null,null,new On("no-auth-event")),e(t))})},Ou.Ka=function(e){D(this.b,function(t){return t==e})};var np={name:"pendingRedirect",A:"session"};(Ou=ha.prototype).reset=function(){this.f=!1,this.a.Ka(this.i),this.a=pa(this.u,this.l,this.m)},Ou.Xa=function(){this.b.Xa()},Ou.subscribe=function(e){if(I(this.h,e)||this.h.push(e),!this.f){var t=this;la(this.g).then(function(e){e?ca(t.g).then(function(){fa(t).s(function(e){var n=new kr("unknown",null,null,null,new On("operation-not-supported-in-this-environment"));ga(e)&&t.ab(n)})}):da(t)}).s(function(){da(t)})}},Ou.unsubscribe=function(e){D(this.h,function(t){return t==e})},Ou.ab=function(e){if(!e)throw new On("invalid-auth-event");for(var t=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.ub(e.b,e.c)){(t=this.c[e.b])&&t.h(e,r),t=!0;break}}return ba(this.b),t};var rp=new yn(2e3,1e4),ip=new yn(3e4,6e4);ha.prototype.fa=function(){return this.b.fa()},ha.prototype.Ca=function(e,t,n){var r,i=this;return ua(this.g).then(function(){return i.a.Ca(e,t,n).s(function(e){if(ga(e))throw new On("operation-not-supported-in-this-environment");return r=e,ca(i.g).then(function(){throw r})}).then(function(){return i.a.Pb()?new z(function(){}):ca(i.g).then(function(){return i.fa()}).then(function(){}).s(function(){})})})},ha.prototype.Ea=function(e,t,n,r){return this.a.Ea(n,function(n){e.ha(t,null,n,r)},rp.get())};var op={};va.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},va.prototype.h=function(e,t){if(e){this.reset(),this.g=!0;var n=e.b,r=e.c,i=e.a&&"auth/web-storage-unsupported"==e.a.code,o=e.a&&"auth/operation-not-supported-in-this-environment"==e.a.code;this.i=!(!i&&!o),"unknown"!=n||i||o?e.a?(Ea(this,!0,null,e.a),X()):t.wa(n,r)?_a(this,e,t):Y(new On("invalid-auth-event")):(Ea(this,!1,null,null),X())}else Y(new On("invalid-auth-event"))},va.prototype.Xa=function(){this.g&&!this.i&&Ea(this,!1,null,null)},va.prototype.fa=function(){var e=this;return new z(function(t,n){e.b?e.b().then(t,n):(e.f.push(t),e.c.push(n),Ta(e))})},Sa.prototype.h=function(e,t){if(e){var n=e.b,r=e.c;e.a?(t.ha(e.b,null,e.a,e.c),X()):t.wa(n,r)?Ca(e,t):Y(new On("invalid-auth-event"))}else Y(new On("invalid-auth-event"))},Na.prototype.confirm=function(e){return e=br(this.verificationId,e),this.a(e)},xa.prototype.start=function(){this.a=this.c,Pa(this,!0)},xa.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},Ra.prototype.D=function(){return{apiKey:this.f.b,refreshToken:this.a,accessToken:this.b,expirationTime:this.c}},Ra.prototype.getToken=function(e){return e=!!e,this.b&&!this.a?Y(new On("user-token-expired")):e||!this.b||ju()>this.c-3e4?this.a?ja(this,{grant_type:"refresh_token",refresh_token:this.a}):X(null):X({accessToken:this.b,expirationTime:this.c,refreshToken:this.a})},Ua.prototype.D=function(){return{lastLoginAt:this.b,createdAt:this.a}},d(Ba,ve),d(Ka,Ve),Ka.prototype.oa=function(e){this.ka=e,_i(this.b,e)},Ka.prototype.ea=function(){return this.ka},Ka.prototype.xa=function(){return x(this.O)},Ka.prototype.Ha=function(){this.w.b&&(this.w.stop(),this.w.start())},Sn(Ka.prototype,"providerId","firebase"),(Ou=Ka.prototype).reload=function(){var e=this;return bs(this,rs(this).then(function(){return cs(e).then(function(){return Za(e)}).then(ns)}))},Ou.cc=function(e){return this.F(e).then(function(e){return new Aa(e)})},Ou.F=function(e){var t=this;return bs(this,rs(this).then(function(){return t.h.getToken(e)}).then(function(e){if(!e)throw new On("internal-error");return e.accessToken!=t.qa&&($a(t,e.accessToken),t.dispatchEvent(new Ba("tokenChanged"))),ss(t,"refreshToken",e.refreshToken),e.accessToken}))},Ou.wc=function(e){if(!(e=e.users)||!e.length)throw new On("internal-error");ts(this,{uid:(e=e[0]).localId,displayName:e.displayName,photoURL:e.photoUrl,email:e.email,emailVerified:!!e.emailVerified,phoneNumber:e.phoneNumber,lastLoginAt:e.lastLoginAt,createdAt:e.createdAt});for(var t=ps(e),n=0;n<t.length;n++)os(this,t[n]);ss(this,"isAnonymous",!(this.email&&e.passwordHash||this.providerData&&this.providerData.length))},Ou.fb=function(e){var t=this,n=null;return bs(this,e.f(this.b,this.uid).then(function(e){return ls(t,e),n=ds(t,e,"reauthenticate"),t.i=null,t.reload()}).then(function(){return n}),!0)},Ou.xc=function(e){return Tn("firebase.User.prototype.reauthenticateWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential instead."),this.fb(e).then(function(){})},Ou.cb=function(e){var t=this,n=null;return bs(this,fs(this,e.providerId).then(function(){return t.F()}).then(function(n){return e.c(t.b,n)}).then(function(e){return n=ds(t,e,"link"),ms(t,e)}).then(function(){return n}))},Ou.oc=function(e){return Tn("firebase.User.prototype.linkWithCredential is deprecated. Please use firebase.User.prototype.linkAndRetrieveDataWithCredential instead."),this.cb(e).then(function(e){return e.user})},Ou.pc=function(e,t){var n=this;return bs(this,fs(this,"phone").then(function(){return Da(Qa(n),e,t,p(n.cb,n))}))},Ou.yc=function(e,t){var n=this;return bs(this,X().then(function(){return Da(Qa(n),e,t,p(n.fb,n))}),!0)},Ou.ob=function(e){var t=this;return bs(this,this.F().then(function(n){return t.b.ob(n,e)}).then(function(e){return ls(t,e),t.reload()}))},Ou.Qc=function(e){var t=this;return bs(this,this.F().then(function(n){return e.c(t.b,n)}).then(function(e){return ls(t,e),t.reload()}))},Ou.pb=function(e){var t=this;return bs(this,this.F().then(function(n){return t.b.pb(n,e)}).then(function(e){return ls(t,e),t.reload()}))},Ou.qb=function(e){if(void 0===e.displayName&&void 0===e.photoURL)return rs(this);var t=this;return bs(this,this.F().then(function(n){return t.b.qb(n,{displayName:e.displayName,photoUrl:e.photoURL})}).then(function(e){return ls(t,e),ss(t,"displayName",e.displayName||null),ss(t,"photoURL",e.photoUrl||null),Bu(t.providerData,function(e){"password"===e.providerId&&(Sn(e,"displayName",t.displayName),Sn(e,"photoURL",t.photoURL))}),Za(t)}).then(ns))},Ou.Oc=function(e){var t=this;return bs(this,cs(this).then(function(n){return I(is(t),e)?Ri(t.b,n,[e]).then(function(e){var n={};return Bu(e.providerUserInfo||[],function(e){n[e.providerId]=!0}),Bu(is(t),function(e){n[e]||as(t,e)}),n[vr.PROVIDER_ID]||Sn(t,"phoneNumber",null),Za(t)}):Za(t).then(function(){throw new On("no-such-provider")})}))},Ou.delete=function(){var e=this;return bs(this,this.F().then(function(t){return Fi(e.b,lh,{idToken:t})}).then(function(){e.dispatchEvent(new Ba("userDeleted"))})).then(function(){for(var t=0;t<e.G.length;t++)e.G[t].cancel("app-deleted");Wa(e,null),za(e,null),e.G=[],e.C=!0,Ya(e),Sn(e,"refreshToken",null),e.a&&e.a.unsubscribe(e)})},Ou.ub=function(e,t){return!!("linkViaPopup"==e&&(this.g||null)==t&&this.f||"reauthViaPopup"==e&&(this.g||null)==t&&this.f||"linkViaRedirect"==e&&(this.aa||null)==t||"reauthViaRedirect"==e&&(this.aa||null)==t)},Ou.ha=function(e,t,n,r){"linkViaPopup"!=e&&"reauthViaPopup"!=e||r!=(this.g||null)||(n&&this.v?this.v(n):t&&!n&&this.f&&this.f(t),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.v)},Ou.wa=function(e,t){return"linkViaPopup"==e&&t==(this.g||null)?p(this.zb,this):"reauthViaPopup"==e&&t==(this.g||null)?p(this.Ab,this):"linkViaRedirect"==e&&(this.aa||null)==t?p(this.zb,this):"reauthViaRedirect"==e&&(this.aa||null)==t?p(this.Ab,this):null},Ou.qc=function(e){var t=this;return gs(this,"linkViaPopup",e,function(){return fs(t,e.providerId).then(function(){return Za(t)})},!1)},Ou.zc=function(e){return gs(this,"reauthViaPopup",e,function(){return X()},!0)},Ou.rc=function(e){var t=this;return ys(this,"linkViaRedirect",e,function(){return fs(t,e.providerId)},!1)},Ou.Ac=function(e){return ys(this,"reauthViaRedirect",e,function(){return X()},!0)},Ou.zb=function(e,t){var n=this;this.c&&(this.c.cancel(),this.c=null);var r=null;return bs(this,this.F().then(function(r){return ji(n.b,{requestUri:e,sessionId:t,idToken:r})}).then(function(e){return r=ds(n,e,"link"),ms(n,e)}).then(function(){return r}))},Ou.Ab=function(e,t){var n=this;this.c&&(this.c.cancel(),this.c=null);var r=null;return bs(this,X().then(function(){return Zn(Ui(n.b,{requestUri:e,sessionId:t}),n.uid)}).then(function(e){return r=ds(n,e,"reauthenticate"),ls(n,e),n.i=null,n.reload()}).then(function(){return r}),!0)},Ou.ib=function(e){var t=this,n=null;return bs(this,this.F().then(function(t){return n=t,void 0===e||j(e)?{}:Ln(new Rn(e))}).then(function(e){return t.b.ib(n,e)}).then(function(e){if(t.email!=e)return t.reload()}).then(function(){}))},Ou.toJSON=function(){return this.D()},Ou.D=function(){var e={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,providerData:[],apiKey:this.m,appName:this.o,authDomain:this.u,stsTokenManager:this.h.D(),redirectEventId:this.aa||null};return this.metadata&&q(e,this.metadata.D()),Bu(this.providerData,function(t){e.providerData.push(Nn(t))}),e};var ap={name:"redirectUser",A:"session"};Is.prototype.g=function(){var e=this,t=As("local");Ls(this,function(){return X().then(function(){return e.c&&"local"!=e.c.A?e.b.get(t,e.a):null}).then(function(n){if(n)return Ns(e,"local").then(function(){e.c=t})})})};var sp={name:"persistence",A:"session"};Is.prototype.lb=function(e){var t=null,n=this;return Mo(e),Ls(this,function(){return e!=n.c.A?n.b.get(n.c,n.a).then(function(r){return t=r,Ns(n,e)}).then(function(){if(n.c=As(e),t)return n.b.set(n.c,t,n.a)}):X()})},d(Ms,Ve),d(Vs,ve),d(js,ve),(Ou=Ms.prototype).lb=function(e){return e=this.h.lb(e),Zs(this,e)},Ou.oa=function(e){this.W===e||this.m||(this.W=e,_i(this.b,this.W),this.dispatchEvent(new Vs(this.ea())))},Ou.ea=function(){return this.W},Ou.Rc=function(){var e=Lu.navigator;this.oa(e?e.languages&&e.languages[0]||e.language||e.userLanguage||null:null)},Ou.sc=function(e){this.G.push(e),wi(this.b,Pu.SDK_VERSION?nn(Pu.SDK_VERSION,this.G):null),this.dispatchEvent(new js(this.G))},Ou.xa=function(){return x(this.G)},Ou.toJSON=function(){return{apiKey:Gs(this).options.apiKey,authDomain:Gs(this).options.authDomain,appName:Gs(this).name,currentUser:Xs(this)&&Xs(this).D()}},Ou.ub=function(e,t){switch(e){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==t&&!!this.f;default:return!1}},Ou.ha=function(e,t,n,r){"signInViaPopup"==e&&this.g==r&&(n&&this.v?this.v(n):t&&!n&&this.f&&this.f(t),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.v)},Ou.wa=function(e,t){return"signInViaRedirect"==e||"signInViaPopup"==e&&this.g==t&&this.f?p(this.$b,this):null},Ou.$b=function(e,t){var n=this;e={requestUri:e,sessionId:t},this.c&&(this.c.cancel(),this.c=null);var r=null,i=null,o=Vi(n.b,e).then(function(e){return r=_r(e),i=Wn(e),e});return e=n.V.then(function(){return o}).then(function(e){return Bs(n,e)}).then(function(){return In({user:Xs(n),credential:r,additionalUserInfo:i,operationType:"signIn"})}),Zs(this,e)},Ou.Jc=function(e){if(!sn())return Y(new On("operation-not-supported-in-this-environment"));var t=this,n=Kn(e.providerId),r=dn(),i=null;(!ln()||Yt())&&Gs(this).options.authDomain&&e.isOAuthProvider&&(i=ro(Gs(this).options.authDomain,Gs(this).options.apiKey,Gs(this).name,"signInViaPopup",e,null,r,Pu.SDK_VERSION||null));var o=Ht(i,n&&n.Ba,n&&n.Aa);return n=qs(this).then(function(t){return ma(t,o,"signInViaPopup",e,r,!!i)}).then(function(){return new z(function(e,n){t.ha("signInViaPopup",null,new On("cancelled-popup-request"),t.g),t.f=e,t.v=n,t.g=r,t.c=t.a.Ea(t,"signInViaPopup",o,r)})}).then(function(e){return o&&Wt(o),e?In(e):null}).s(function(e){throw o&&Wt(o),e}),Zs(this,n)},Ou.Kc=function(e){if(!sn())return Y(new On("operation-not-supported-in-this-environment"));var t=this;return Zs(this,qs(this).then(function(){return xs(t.h)}).then(function(){return t.a.Ca("signInViaRedirect",e)}))},Ou.fa=function(){if(!sn())return Y(new On("operation-not-supported-in-this-environment"));var e=this;return Zs(this,qs(this).then(function(){return e.a.fa()}).then(function(e){return e?In(e):null}))},Ou.Pc=function(e){if(!e)return Y(new On("null-user"));var t=this,n={};n.apiKey=Gs(this).options.apiKey,n.authDomain=Gs(this).options.authDomain,n.appName=Gs(this).name;var r=Es(e,n,t.w,t.xa());return Zs(this,this.i.then(function(){if(Gs(t).options.apiKey!=e.m)return r.reload()}).then(function(){return Xs(t)&&e.uid==Xs(t).uid?(us(Xs(t),e),t.Z(e)):(Ks(t,r),es(r),t.Z(r))}).then(function(){$s(t)}))},Ou.mb=function(){var e=this;return Zs(this,this.i.then(function(){return Xs(e)?(Ks(e,null),Ps(e.h).then(function(){$s(e)})):X()}))},Ou.Lc=function(){var e=this;return Rs(this.h,Gs(this).options.authDomain).then(function(t){if(!e.m){var n;if(n=Xs(e)&&t){n=Xs(e).uid;var r=t.uid;n=void 0!==n&&null!==n&&""!==n&&void 0!==r&&null!==r&&""!==r&&n==r}if(n)return us(Xs(e),t),Xs(e).F();(Xs(e)||t)&&(Ks(e,t),t&&(es(t),t.ba=e.w),e.a&&e.a.subscribe(e),$s(e))}})},Ou.Z=function(e){return Os(this.h,e)},Ou.ac=function(){$s(this),this.Z(Xs(this))},Ou.ic=function(){this.mb()},Ou.jc=function(){this.mb()},Ou.kc=function(e){var t=this;this.addAuthTokenListener(function(){e.next(Xs(t))})},Ou.mc=function(e){var t=this;Js(this,function(){e.next(Xs(t))})},Ou.uc=function(e,t,n){var r=this;return this.X&&Pu.Promise.resolve().then(function(){u(e)?e(Xs(r)):u(e.next)&&e.next(Xs(r))}),this.Sb(e,t,n)},Ou.tc=function(e,t,n){var r=this;return this.X&&Pu.Promise.resolve().then(function(){r.O=r.getUid(),u(e)?e(Xs(r)):u(e.next)&&e.next(Xs(r))}),this.Tb(e,t,n)},Ou.bc=function(e){var t=this;return Zs(this,this.i.then(function(){return Xs(t)?Xs(t).F(e).then(function(e){return{accessToken:e}}):null}))},Ou.Mb=function(e){var t=this;return this.i.then(function(){return Qs(t,Fi(t.b,Nh,{token:e}))}).then(function(e){var n=e.user;return ss(n,"isAnonymous",!1),t.Z(n),e})},Ou.Dc=function(e){return Tn("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCustomToken is deprecated. Please use firebase.auth.Auth.prototype.signInWithCustomToken instead."),this.Mb(e)},Ou.Ec=function(e,t){return Tn("firebase.auth.Auth.prototype.signInAndRetrieveDataWithEmailAndPassword is deprecated. Please use firebase.auth.Auth.prototype.signInWithEmailAndPassword instead."),this.Nb(e,t)},Ou.Nb=function(e,t){var n=this;return this.i.then(function(){return Qs(n,Fi(n.b,Dh,{email:e,password:t}))})},Ou.wb=function(e,t){var n=this;return this.i.then(function(){return Qs(n,Fi(n.b,uh,{email:e,password:t}))})},Ou.Vb=function(e,t){return Tn("firebase.auth.Auth.prototype.createUserAndRetrieveDataWithEmailAndPassword is deprecated. Please use firebase.auth.Auth.prototype.createUserWithEmailAndPassword instead."),this.wb(e,t)},Ou.Gc=function(e){return Tn("firebase.auth.Auth.prototype.signInWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential instead."),this.Oa(e).then(function(e){return e.user})},Ou.Oa=function(e){var t=this;return this.i.then(function(){return Qs(t,e.ya(t.b))})},Ou.Pa=function(){var e=this;return this.i.then(function(){var t=Xs(e);return t&&t.isAnonymous?In({user:t,credential:null,additionalUserInfo:In({providerId:null,isNewUser:!1}),operationType:"signIn"}):Qs(e,e.b.Pa()).then(function(t){var n=t.user;return ss(n,"isAnonymous",!0),e.Z(n),t})})},Ou.Fc=function(){return Tn("firebase.auth.Auth.prototype.signInAnonymouslyAndRetrieveData is deprecated. Please use firebase.auth.Auth.prototype.signInAnonymously instead."),this.Pa()},Ou.getUid=function(){return Xs(this)&&Xs(this).uid||null},Ou.Ub=function(e){this.addAuthTokenListener(e),this.u++,0<this.u&&Xs(this)&&Xa(Xs(this))},Ou.Bc=function(e){var t=this;Bu(this.o,function(n){n==e&&t.u--}),0>this.u&&(this.u=0),0==this.u&&Xs(this)&&Ya(Xs(this)),this.removeAuthTokenListener(e)},Ou.addAuthTokenListener=function(e){var t=this;this.o.push(e),Zs(this,this.i.then(function(){t.m||I(t.o,e)&&e(Ys(t))}))},Ou.removeAuthTokenListener=function(e){D(this.o,function(t){return t==e})},Ou.delete=function(){this.m=!0;for(var e=0;e<this.N.length;e++)this.N[e].cancel("app-deleted");return this.N=[],this.h&&(e=this.h).b.removeListener(As("local"),e.a,this.ka),this.a&&(this.a.unsubscribe(this),this.a.Xa()),Pu.Promise.resolve()},Ou.Yb=function(e){return Tn("firebase.auth.Auth.prototype.fetchProvidersForEmail is deprecated. Please use firebase.auth.Auth.prototype.fetchSignInMethodsForEmail instead."),Zs(this,Ni(this.b,e))},Ou.Zb=function(e){return Zs(this,Di(this.b,e))},Ou.nc=function(e){return!!mr(e)},Ou.kb=function(e,t){var n=this;return Zs(this,X().then(function(){var e=new Rn(t);if(!e.c)throw new On("argument-error",bl+" must be true when sending sign in link to email");return Ln(e)}).then(function(t){return n.b.kb(e,t)}).then(function(){}))},Ou.Sc=function(e){return this.Ja(e).then(function(e){return e.data.email})},Ou.Ya=function(e,t){return Zs(this,this.b.Ya(e,t).then(function(){}))},Ou.Ja=function(e){return Zs(this,this.b.Ja(e).then(function(e){return new xn(e)}))},Ou.Va=function(e){return Zs(this,this.b.Va(e).then(function(){}))},Ou.jb=function(e,t){var n=this;return Zs(this,X().then(function(){return void 0===t||j(t)?{}:Ln(new Rn(t))}).then(function(t){return n.b.jb(e,t)}).then(function(){}))},Ou.Ic=function(e,t){return Zs(this,Da(this,e,t,p(this.Oa,this)))},Ou.Hc=function(e,t){var n=this;return Zs(this,X().then(function(){var r=dr(e,t||Ut());return n.Oa(r)}))},eu.prototype.render=function(){},eu.prototype.reset=function(){},eu.prototype.getResponse=function(){},eu.prototype.execute=function(){};var up=null;tu.prototype.render=function(e,t){return this.a[this.b.toString()]=new iu(e,t),this.b++},tu.prototype.reset=function(e){var t=nu(this,e);e=ru(e),t&&e&&(t.delete(),delete this.a[e])},tu.prototype.getResponse=function(e){return(e=nu(this,e))?e.getResponse():null},tu.prototype.execute=function(e){(e=nu(this,e))&&e.execute()},iu.prototype.getResponse=function(){return ou(this),this.b},iu.prototype.execute=function(){ou(this);var e=this;this.a||(this.a=setTimeout(function(){e.b=en();var t=e.c.callback,n=e.c["expired-callback"];if(t)try{t(e.b)}catch(e){}e.a=setTimeout(function(){if(e.a=null,e.b=null,n)try{n()}catch(e){}e.h&&e.execute()},6e4)},500))},iu.prototype.delete=function(){ou(this),this.g=!0,clearTimeout(this.a),this.a=null,De(this.f,"click",this.i)},au.prototype.g=function(){return up||(up=new tu),X(up)},au.prototype.c=function(){};var cp=null,lp=yt("https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),hp=new yn(3e4,6e4);su.prototype.g=function(e){var t=this;return new z(function(n,r){var i=setTimeout(function(){r(new On("network-request-failed"))},hp.get());!Lu.grecaptcha||e!==t.f&&!t.b?(Lu[t.a]=function(){if(Lu.grecaptcha){t.f=e;var o=Lu.grecaptcha.render;Lu.grecaptcha.render=function(e,n){return e=o(e,n),t.b++,e},clearTimeout(i),n(Lu.grecaptcha)}else clearTimeout(i),r(new On("internal-error"));delete Lu[t.a]},X(fi(_t(lp,{onload:t.a,hl:e||""}))).s(function(){clearTimeout(i),r(new On("internal-error","Unable to load external reCAPTCHA dependencies!"))})):(clearTimeout(i),n(Lu.grecaptcha))})},su.prototype.c=function(){this.b--};var pp=null,fp="callback",dp="expired-callback",mp="sitekey",gp="size";(Ou=uu.prototype).za=function(){var e=this;return this.f?this.f:this.f=hu(this,X().then(function(){if(un()&&!$t())return Qt();throw new On("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")}).then(function(){return e.o.g(e.v())}).then(function(t){return e.g=t,Fi(e.u,bh,{})}).then(function(t){e.a[mp]=t.recaptchaSiteKey}).s(function(t){throw e.f=null,t}))},Ou.render=function(){pu(this);var e=this;return hu(this,this.za().then(function(){if(null===e.c){var t=e.m;if(!e.i){var n=Dt(t);t=xt("DIV"),n.appendChild(t)}e.c=e.g.render(t,e.a)}return e.c}))},Ou.verify=function(){pu(this);var e=this;return hu(this,this.render().then(function(t){return new z(function(n){var r=e.g.getResponse(t);if(r)n(r);else{var i=function(t){t&&(lu(e,i),n(t))};e.l.push(i),e.i&&e.g.execute(e.c)}})}))},Ou.reset=function(){pu(this),null!==this.c&&this.g.reset(this.c)},Ou.clear=function(){pu(this),this.C=!0,this.o.c();for(var e=0;e<this.h.length;e++)this.h[e].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){e=Dt(this.m);for(var t;t=e.firstChild;)e.removeChild(t)}},d(fu,uu);var yp="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");Iu(Ms.prototype,{Va:{name:"applyActionCode",j:[mu("code")]},Ja:{name:"checkActionCode",j:[mu("code")]},Ya:{name:"confirmPasswordReset",j:[mu("code"),mu("newPassword")]},wb:{name:"createUserWithEmailAndPassword",j:[mu("email"),mu("password")]},Vb:{name:"createUserAndRetrieveDataWithEmailAndPassword",j:[mu("email"),mu("password")]},Yb:{name:"fetchProvidersForEmail",j:[mu("email")]},Zb:{name:"fetchSignInMethodsForEmail",j:[mu("email")]},fa:{name:"getRedirectResult",j:[]},nc:{name:"isSignInWithEmailLink",j:[mu("emailLink")]},tc:{name:"onAuthStateChanged",j:[Cu(yu(),vu(),"nextOrObserver"),vu("opt_error",!0),vu("opt_completed",!0)]},uc:{name:"onIdTokenChanged",j:[Cu(yu(),vu(),"nextOrObserver"),vu("opt_error",!0),vu("opt_completed",!0)]},jb:{name:"sendPasswordResetEmail",j:[mu("email"),Cu(yu("opt_actionCodeSettings",!0),bu(null,!0),"opt_actionCodeSettings",!0)]},kb:{name:"sendSignInLinkToEmail",j:[mu("email"),yu("actionCodeSettings")]},lb:{name:"setPersistence",j:[mu("persistence")]},Oa:{name:"signInAndRetrieveDataWithCredential",j:[Eu()]},Pa:{name:"signInAnonymously",j:[]},Fc:{name:"signInAnonymouslyAndRetrieveData",j:[]},Gc:{name:"signInWithCredential",j:[Eu()]},Mb:{name:"signInWithCustomToken",j:[mu("token")]},Dc:{name:"signInAndRetrieveDataWithCustomToken",j:[mu("token")]},Nb:{name:"signInWithEmailAndPassword",j:[mu("email"),mu("password")]},Hc:{name:"signInWithEmailLink",j:[mu("email"),mu("emailLink",!0)]},Ec:{name:"signInAndRetrieveDataWithEmailAndPassword",j:[mu("email"),mu("password")]},Ic:{name:"signInWithPhoneNumber",j:[mu("phoneNumber"),Su()]},Jc:{name:"signInWithPopup",j:[Tu()]},Kc:{name:"signInWithRedirect",j:[Tu()]},Pc:{name:"updateCurrentUser",j:[Cu({name:"user",K:"an instance of Firebase User",optional:!1,M:function(e){return!!(e&&e instanceof Ka)}},bu(),"user")]},mb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[mu(null,!0)]},Rc:{name:"useDeviceLanguage",j:[]},Sc:{name:"verifyPasswordResetCode",j:[mu("code")]}}),Nu(Ms.prototype,{lc:{name:"languageCode",sb:Cu(mu(),bu(),"languageCode")}}),Ms.Persistence=zh,Ms.Persistence.LOCAL="local",Ms.Persistence.SESSION="session",Ms.Persistence.NONE="none",Iu(Ka.prototype,{delete:{name:"delete",j:[]},cc:{name:"getIdTokenResult",j:[gu("opt_forceRefresh",!0)]},F:{name:"getIdToken",j:[gu("opt_forceRefresh",!0)]},cb:{name:"linkAndRetrieveDataWithCredential",j:[Eu()]},oc:{name:"linkWithCredential",j:[Eu()]},pc:{name:"linkWithPhoneNumber",j:[mu("phoneNumber"),Su()]},qc:{name:"linkWithPopup",j:[Tu()]},rc:{name:"linkWithRedirect",j:[Tu()]},fb:{name:"reauthenticateAndRetrieveDataWithCredential",j:[Eu()]},xc:{name:"reauthenticateWithCredential",j:[Eu()]},yc:{name:"reauthenticateWithPhoneNumber",j:[mu("phoneNumber"),Su()]},zc:{name:"reauthenticateWithPopup",j:[Tu()]},Ac:{name:"reauthenticateWithRedirect",j:[Tu()]},reload:{name:"reload",j:[]},ib:{name:"sendEmailVerification",j:[Cu(yu("opt_actionCodeSettings",!0),bu(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[mu(null,!0)]},Oc:{name:"unlink",j:[mu("provider")]},ob:{name:"updateEmail",j:[mu("email")]},pb:{name:"updatePassword",j:[mu("password")]},Qc:{name:"updatePhoneNumber",j:[Eu("phone")]},qb:{name:"updateProfile",j:[yu("profile")]}}),Iu(tu.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Iu(eu.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Iu(z.prototype,{ia:{name:"finally"},s:{name:"catch"},then:{name:"then"}}),Nu(Ia.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",sb:gu("appVerificationDisabledForTesting")}}),Iu(Na.prototype,{confirm:{name:"confirm",j:[mu("verificationCode")]}}),Du(fr,"credential",function(e,t){return new pr(e,t)},[mu("email"),mu("password")]),Iu(ir.prototype,{ta:{name:"addScope",j:[mu("scope")]},Da:{name:"setCustomParameters",j:[yu("customOAuthParameters")]}}),Du(ir,"credential",or,[Cu(mu(),yu(),"token")]),Du(fr,"credentialWithLink",dr,[mu("email"),mu("emailLink")]),Iu(ar.prototype,{ta:{name:"addScope",j:[mu("scope")]},Da:{name:"setCustomParameters",j:[yu("customOAuthParameters")]}}),Du(ar,"credential",sr,[Cu(mu(),yu(),"token")]),Iu(ur.prototype,{ta:{name:"addScope",j:[mu("scope")]},Da:{name:"setCustomParameters",j:[yu("customOAuthParameters")]}}),Du(ur,"credential",cr,[Cu(mu(),Cu(yu(),bu()),"idToken"),Cu(mu(),bu(),"accessToken",!0)]),Iu(lr.prototype,{Da:{name:"setCustomParameters",j:[yu("customOAuthParameters")]}}),Du(lr,"credential",hr,[Cu(mu(),yu(),"token"),mu("secret",!0)]),Iu(rr.prototype,{ta:{name:"addScope",j:[mu("scope")]},credential:{name:"credential",j:[Cu(mu(),bu(),"idToken",!0),Cu(mu(),bu(),"accessToken",!0)]},Da:{name:"setCustomParameters",j:[yu("customOAuthParameters")]}}),Du(vr,"credential",br,[mu("verificationId"),mu("verificationCode")]),Iu(vr.prototype,{Ta:{name:"verifyPhoneNumber",j:[mu("phoneNumber"),Su()]}}),Iu(On.prototype,{toJSON:{name:"toJSON",j:[mu(null,!0)]}}),Iu(Cr.prototype,{toJSON:{name:"toJSON",j:[mu(null,!0)]}}),Iu(Sr.prototype,{toJSON:{name:"toJSON",j:[mu(null,!0)]}}),Iu(fu.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),function(){if(void 0===Pu||!Pu.INTERNAL||!Pu.INTERNAL.registerService)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var e={Auth:Ms,Error:On};Du(e,"EmailAuthProvider",fr,[]),Du(e,"FacebookAuthProvider",ir,[]),Du(e,"GithubAuthProvider",ar,[]),Du(e,"GoogleAuthProvider",ur,[]),Du(e,"TwitterAuthProvider",lr,[]),Du(e,"OAuthProvider",rr,[mu("providerId")]),Du(e,"PhoneAuthProvider",vr,[wu()]),Du(e,"RecaptchaVerifier",fu,[Cu(mu(),_u(),"recaptchaContainer"),yu("recaptchaParameters",!0),ku()]),Pu.INTERNAL.registerService("auth",function(e,t){return e=new Ms(e),t({INTERNAL:{getUid:p(e.getUid,e),getToken:p(e.bc,e),addAuthTokenListener:p(e.Ub,e),removeAuthTokenListener:p(e.Bc,e)}}),e},e,function(e,t){if("create"===e)try{t.auth()}catch(e){}}),Pu.INTERNAL.extendNamespace({User:Ka})}()}).apply(void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})}(function(){return this}(),e)}),define("@firebase/logger@0.1.2#dist/index.cjs",function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=[];!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(t.LogLevel||(t.LogLevel={}));var i=t.LogLevel.INFO,o=function(e,n){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(!(n<e.logLevel)){var o=(new Date).toISOString();switch(n){case t.LogLevel.DEBUG:case t.LogLevel.VERBOSE:console.log.apply(console,["["+o+"]  "+e.name+":"].concat(r));break;case t.LogLevel.INFO:console.info.apply(console,["["+o+"]  "+e.name+":"].concat(r));break;case t.LogLevel.WARN:console.warn.apply(console,["["+o+"]  "+e.name+":"].concat(r));break;case t.LogLevel.ERROR:console.error.apply(console,["["+o+"]  "+e.name+":"].concat(r));break;default:throw new Error("Attempted to log a message with an invalid logType (value: "+n+")")}}},a=function(){function e(e){this.name=e,this._logLevel=i,this._logHandler=o,r.push(this)}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in t.LogLevel))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!0,configurable:!0}),e.prototype.debug=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._logHandler.apply(this,[this,t.LogLevel.DEBUG].concat(e))},e.prototype.log=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._logHandler.apply(this,[this,t.LogLevel.VERBOSE].concat(e))},e.prototype.info=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._logHandler.apply(this,[this,t.LogLevel.INFO].concat(e))},e.prototype.warn=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._logHandler.apply(this,[this,t.LogLevel.WARN].concat(e))},e.prototype.error=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._logHandler.apply(this,[this,t.LogLevel.ERROR].concat(e))},e}();t.setLogLevel=function(e){r.forEach(function(t){t.logLevel=e})},t.Logger=a}),define("@firebase/database@0.3.7#dist/index.cjs",["require","exports","module","@firebase/util","@firebase/logger","tslib","@firebase/app"],function(e,t,n){!function(e,t,n,r){"use strict";function i(e){for(var t="",n=e.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(e){}t+="/"+i}return t}function o(e){var t={};"?"===e.charAt(0)&&(e=e.substring(1));for(var n=0,r=e.split("&");n<r.length;n++){var i=r[n];if(0!==i.length){var o=i.split("=");2===o.length?t[decodeURIComponent(o[0])]=decodeURIComponent(o[1]):V("Invalid query segment '"+i+"' in query '"+e+"'")}}return t}function a(e,t){return K(e.name,t.name)}function s(e,t){return K(e,t)}function u(e,t){if(void 0===t&&(t=null),null===e)return Ge.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),y.assert(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e)return new Ve(e,u(t));if(e instanceof Array||!Ye){var n=Ge.EMPTY_NODE,r=e;return y.forEach(r,function(e,t){if(y.contains(r,e)&&"."!==e.substring(0,1)){var i=u(t);!i.isLeafNode()&&i.isEmpty()||(n=n.updateImmediateChild(e,i))}}),n.updatePriority(u(t))}var i=[],o=!1,c=e;if(y.forEach(c,function(e,t){if("string"!=typeof e||"."!==e.substring(0,1)){var n=u(c[e]);n.isEmpty()||(o=o||!n.getPriority().isEmpty(),i.push(new xe(e,n)))}}),0==i.length)return Ge.EMPTY_NODE;var l=He(i,a,function(e){return e.name},s);if(o){var h=He(i,je.getCompare());return new Ge(l,u(t),new Qe({".priority":h},{".priority":je}))}return new Ge(l,u(t),Qe.Default)}function c(e){var t=e.INTERNAL.registerService("database",function(e,t,n){return wn.getInstance().databaseFromApp(e,n)},{Reference:gn,Query:at,Database:kn,enableLogging:O,INTERNAL:Tn,ServerValue:Dn,TEST_ACCESS:Nn},null,!0);y.isNodeSdk()&&(r.exports=t)}Object.defineProperty(n,"__esModule",{value:!0});var l,h,p,f,d,m,g,y=t("@firebase/util"),v=t("@firebase/logger"),b=t("tslib"),_=function(e){return e&&"object"==typeof e&&"default"in e?e.default:e}(t("@firebase/app")),w=function(){function e(e){this.domStorage_=e,this.prefix_="firebase:"}return e.prototype.set=function(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),y.stringify(t))},e.prototype.get=function(e){var t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:y.jsonEval(t)},e.prototype.remove=function(e){this.domStorage_.removeItem(this.prefixedName_(e))},e.prototype.prefixedName_=function(e){return this.prefix_+e},e.prototype.toString=function(){return this.domStorage_.toString()},e}(),k=function(){function e(){this.cache_={},this.isInMemoryStorage=!0}return e.prototype.set=function(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t},e.prototype.get=function(e){return y.contains(this.cache_,e)?this.cache_[e]:null},e.prototype.remove=function(e){delete this.cache_[e]},e}(),E=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){var t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new w(t)}}catch(e){}return new k},T=E("localStorage"),S=E("sessionStorage"),C=new v.Logger("@firebase/database"),I=function(){var e=1;return function(){return e++}}(),N=function(e){var t=y.stringToByteArray(e),n=new y.Sha1;n.update(t);var r=n.digest();return y.base64.encodeByteArray(r)},D=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n="",r=0;r<e.length;r++)Array.isArray(e[r])||e[r]&&"object"==typeof e[r]&&"number"==typeof e[r].length?n+=D.apply(null,e[r]):"object"==typeof e[r]?n+=y.stringify(e[r]):n+=e[r],n+=" ";return n},A=null,x=!0,O=function(e,t){y.assert(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(C.logLevel=v.LogLevel.VERBOSE,A=C.log.bind(C),t&&S.set("logging_enabled",!0)):"function"==typeof e?A=e:(A=null,S.remove("logging_enabled"))},P=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!0===x&&(x=!1,null===A&&!0===S.get("logging_enabled")&&O(!0)),A){var n=D.apply(null,e);A(n)}},R=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];P.apply(void 0,[e].concat(t))}},L=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE INTERNAL ERROR: "+D.apply(void 0,e);C.error(n)},M=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE FATAL ERROR: "+D.apply(void 0,e);throw C.error(n),new Error(n)},V=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE WARNING: "+D.apply(void 0,e);C.warn(n)},j=function(){"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&V("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},U=function(e){return"number"==typeof e&&(e!=e||e==Number.POSITIVE_INFINITY||e==Number.NEGATIVE_INFINITY)},q=function(e){if(y.isNodeSdk()||"complete"===document.readyState)e();else{var t=!1,n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}},F="[MIN_NAME]",B="[MAX_NAME]",K=function(e,t){if(e===t)return 0;if(e===F||t===B)return-1;if(t===F||e===B)return 1;var n=ee(e),r=ee(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1},W=function(e,t){return e===t?0:e<t?-1:1},H=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+y.stringify(t))},z=function(e){if("object"!=typeof e||null===e)return y.stringify(e);var t=[];for(var n in e)t.push(n);t.sort();for(var r="{",i=0;i<t.length;i++)0!==i&&(r+=","),r+=y.stringify(t[i]),r+=":",r+=z(e[t[i]]);return r+="}"},Q=function(e,t){var n=e.length;if(n<=t)return[e];for(var r=[],i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r},G=function(e,t){if(Array.isArray(e))for(var n=0;n<e.length;++n)t(n,e[n]);else y.forEach(e,function(e,n){return t(n,e)})},X=function(e){y.assert(!U(e),"Invalid JSON number");var t,n,r,i,o,a,s;for(0===e?(n=0,r=0,t=1/e==-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(e)/Math.LN2),1023))+1023,r=Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(e/Math.pow(2,-1074)))),a=[],o=52;o;o-=1)a.push(r%2?1:0),r=Math.floor(r/2);for(o=11;o;o-=1)a.push(n%2?1:0),n=Math.floor(n/2);a.push(t?1:0),a.reverse(),s=a.join("");var u="";for(o=0;o<64;o+=8){var c=parseInt(s.substr(o,8),2).toString(16);1===c.length&&(c="0"+c),u+=c}return u.toLowerCase()},Y=function(){return!("object"!=typeof window||!window.chrome||!window.chrome.extension||/^chrome/.test(window.location.href))},$=function(){return"object"==typeof Windows&&"object"==typeof Windows.UI},J=function(e,t){var n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"==e?n="Client doesn't have permission to access the desired data.":"unavailable"==e&&(n="The service is unavailable");var r=new Error(e+" at "+t.path.toString()+": "+n);return r.code=e.toUpperCase(),r},Z=new RegExp("^-?\\d{1,10}$"),ee=function(e){if(Z.test(e)){var t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},te=function(e){try{e()}catch(e){setTimeout(function(){var t=e.stack||"";throw V("Exception was thrown by user callback.",t),e},Math.floor(0))}},ne=function(){return("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},re=function(e,t){var n=setTimeout(e,t);return"object"==typeof n&&n.unref&&n.unref(),n},ie=function(){function e(e,t){if(void 0===t){this.pieces_=e.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}return Object.defineProperty(e,"Empty",{get:function(){return new e("")},enumerable:!0,configurable:!0}),e.prototype.getFront=function(){return this.pieceNum_>=this.pieces_.length?null:this.pieces_[this.pieceNum_]},e.prototype.getLength=function(){return this.pieces_.length-this.pieceNum_},e.prototype.popFront=function(){var t=this.pieceNum_;return t<this.pieces_.length&&t++,new e(this.pieces_,t)},e.prototype.getBack=function(){return this.pieceNum_<this.pieces_.length?this.pieces_[this.pieces_.length-1]:null},e.prototype.toString=function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"},e.prototype.toUrlEncodedString=function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+encodeURIComponent(String(this.pieces_[t])));return e||"/"},e.prototype.slice=function(e){return void 0===e&&(e=0),this.pieces_.slice(this.pieceNum_+e)},e.prototype.parent=function(){if(this.pieceNum_>=this.pieces_.length)return null;for(var t=[],n=this.pieceNum_;n<this.pieces_.length-1;n++)t.push(this.pieces_[n]);return new e(t,0)},e.prototype.child=function(t){for(var n=[],r=this.pieceNum_;r<this.pieces_.length;r++)n.push(this.pieces_[r]);if(t instanceof e)for(r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);else for(var i=t.split("/"),r=0;r<i.length;r++)i[r].length>0&&n.push(i[r]);return new e(n,0)},e.prototype.isEmpty=function(){return this.pieceNum_>=this.pieces_.length},e.relativePath=function(t,n){var r=t.getFront(),i=n.getFront();if(null===r)return n;if(r===i)return e.relativePath(t.popFront(),n.popFront());throw new Error("INTERNAL ERROR: innerPath ("+n+") is not within outerPath ("+t+")")},e.comparePaths=function(e,t){for(var n=e.slice(),r=t.slice(),i=0;i<n.length&&i<r.length;i++){var o=K(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1},e.prototype.equals=function(e){if(this.getLength()!==e.getLength())return!1;for(var t=this.pieceNum_,n=e.pieceNum_;t<=this.pieces_.length;t++,n++)if(this.pieces_[t]!==e.pieces_[n])return!1;return!0},e.prototype.contains=function(e){var t=this.pieceNum_,n=e.pieceNum_;if(this.getLength()>e.getLength())return!1;for(;t<this.pieces_.length;){if(this.pieces_[t]!==e.pieces_[n])return!1;++t,++n}return!0},e}(),oe=function(){function e(e,t){this.errorPrefix_=t,this.parts_=e.slice(),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=y.stringLength(this.parts_[n]);this.checkValid_()}return Object.defineProperty(e,"MAX_PATH_DEPTH",{get:function(){return 32},enumerable:!0,configurable:!0}),Object.defineProperty(e,"MAX_PATH_LENGTH_BYTES",{get:function(){return 768},enumerable:!0,configurable:!0}),e.prototype.push=function(e){this.parts_.length>0&&(this.byteLength_+=1),this.parts_.push(e),this.byteLength_+=y.stringLength(e),this.checkValid_()},e.prototype.pop=function(){var e=this.parts_.pop();this.byteLength_-=y.stringLength(e),this.parts_.length>0&&(this.byteLength_-=1)},e.prototype.checkValid_=function(){if(this.byteLength_>e.MAX_PATH_LENGTH_BYTES)throw new Error(this.errorPrefix_+"has a key path longer than "+e.MAX_PATH_LENGTH_BYTES+" bytes ("+this.byteLength_+").");if(this.parts_.length>e.MAX_PATH_DEPTH)throw new Error(this.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+e.MAX_PATH_DEPTH+") or object contains a cycle "+this.toErrorString())},e.prototype.toErrorString=function(){return 0==this.parts_.length?"":"in property '"+this.parts_.join(".")+"'"},e}(),ae="long_polling",se=function(){function e(e,t,n,r,i){void 0===i&&(i=""),this.secure=t,this.namespace=n,this.webSocketOnly=r,this.persistenceKey=i,this.host=e.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.internalHost=T.get("host:"+e)||this.host}return e.prototype.needsQueryParam=function(){return this.host!==this.internalHost||this.isCustomHost()},e.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},e.prototype.isDemoHost=function(){return"firebaseio-demo.com"===this.domain},e.prototype.isCustomHost=function(){return"firebaseio.com"!==this.domain&&"firebaseio-demo.com"!==this.domain},e.prototype.updateHost=function(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&T.set("host:"+this.host,this.internalHost))},e.prototype.connectionURL=function(e,t){y.assert("string"==typeof e,"typeof type must == string"),y.assert("object"==typeof t,"typeof params must == object");var n;if("websocket"===e)n=(this.secure?"wss://":"ws://")+this.internalHost+"/.ws?";else{if(e!==ae)throw new Error("Unknown connection type: "+e);n=(this.secure?"https://":"http://")+this.internalHost+"/.lp?"}this.needsQueryParam()&&(t.ns=this.namespace);var r=[];return y.forEach(t,function(e,t){r.push(e+"="+t)}),n+r.join("&")},e.prototype.toString=function(){var e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e},e.prototype.toURLString=function(){return(this.secure?"https://":"http://")+this.host},e}(),ue=function(e){var t=ce(e),n=t.subdomain;"firebase"===t.domain&&M(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),n&&"undefined"!=n||"localhost"===t.domain||M("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||j();var r="ws"===t.scheme||"wss"===t.scheme;return{repoInfo:new se(t.host,t.secure,n,r),path:new ie(t.pathString)}},ce=function(e){var t="",n="",r="",a="",s=!0,u="https",c=443;if("string"==typeof e){var l=e.indexOf("//");l>=0&&(u=e.substring(0,l-1),e=e.substring(l+2));var h=e.indexOf("/");-1===h&&(h=e.length);var p=e.indexOf("?");-1===p&&(p=e.length),t=e.substring(0,Math.min(h,p)),h<p&&(a=i(e.substring(h,p)));var f=o(e.substring(Math.min(e.length,p)));(l=t.indexOf(":"))>=0?(s="https"===u||"wss"===u,c=parseInt(t.substring(l+1),10)):l=e.length;var d=t.split(".");3===d.length?(n=d[1],r=d[0].toLowerCase()):2===d.length?n=d[0]:"localhost"===d[0].slice(0,l).toLowerCase()&&(n="localhost"),""===r&&"ns"in f&&(r=f.ns)}return{host:t,port:c,domain:n,subdomain:r,secure:s,scheme:u,pathString:a}},le=/[\[\].#$\/\u0000-\u001F\u007F]/,he=/[\[\].#$\u0000-\u001F\u007F]/,pe=function(e){return"string"==typeof e&&0!==e.length&&!le.test(e)},fe=function(e){return"string"==typeof e&&0!==e.length&&!he.test(e)},de=function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),fe(e)},me=function(e){return null===e||"string"==typeof e||"number"==typeof e&&!U(e)||e&&"object"==typeof e&&y.contains(e,".sv")},ge=function(e,t,n,r,i){i&&void 0===n||ye(y.errorPrefix(e,t,i),n,r)},ye=function(e,t,n){var r=n instanceof ie?new oe(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+r.toErrorString());if("function"==typeof t)throw new Error(e+"contains a function "+r.toErrorString()+" with contents = "+t.toString());if(U(t))throw new Error(e+"contains "+t.toString()+" "+r.toErrorString());if("string"==typeof t&&t.length>10485760/3&&y.stringLength(t)>10485760)throw new Error(e+"contains a string greater than 10485760 utf8 bytes "+r.toErrorString()+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){var i=!1,o=!1;if(y.forEach(t,function(t,n){if(".value"===t)i=!0;else if(".priority"!==t&&".sv"!==t&&(o=!0,!pe(t)))throw new Error(e+" contains an invalid key ("+t+") "+r.toErrorString()+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');r.push(t),ye(e,n,r),r.pop()}),i&&o)throw new Error(e+' contains ".value" child '+r.toErrorString()+" in addition to actual children.")}},ve=function(e,t){var n,r;for(n=0;n<t.length;n++)for(var i=(r=t[n]).slice(),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!pe(i[o]))throw new Error(e+"contains an invalid key ("+i[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');t.sort(ie.comparePaths);var a=null;for(n=0;n<t.length;n++){if(r=t[n],null!==a&&a.contains(r))throw new Error(e+"contains a path "+a.toString()+" that is ancestor of another path "+r.toString());a=r}},be=function(e,t,n,r,i){if(!i||void 0!==n){var o=y.errorPrefix(e,t,i);if(!n||"object"!=typeof n||Array.isArray(n))throw new Error(o+" must be an object containing the children to replace.");var a=[];y.forEach(n,function(e,t){var n=new ie(e);if(ye(o,t,r.child(n)),".priority"===n.getBack()&&!me(t))throw new Error(o+"contains an invalid value for '"+n.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(n)}),ve(o,a)}},_e=function(e,t,n,r){if(!r||void 0!==n){if(U(n))throw new Error(y.errorPrefix(e,t,r)+"is "+n.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!me(n))throw new Error(y.errorPrefix(e,t,r)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},we=function(e,t,n,r){if(!r||void 0!==n)switch(n){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(y.errorPrefix(e,t,r)+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},ke=function(e,t,n,r){if(!(r&&void 0===n||pe(n)))throw new Error(y.errorPrefix(e,t,r)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},Ee=function(e,t,n,r){if(!(r&&void 0===n||fe(n)))throw new Error(y.errorPrefix(e,t,r)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Te=function(e,t,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Ee(e,t,n,r)},Se=function(e,t){if(".info"===t.getFront())throw new Error(e+" failed = Can't modify data under /.info/")},Ce=function(e,t,n){var r=n.path.toString();if("string"!=typeof n.repoInfo.host||0===n.repoInfo.host.length||!pe(n.repoInfo.namespace)&&"localhost"!==n.repoInfo.host.split(":")[0]||0!==r.length&&!de(r))throw new Error(y.errorPrefix(e,t,!1)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},Ie=function(e,t,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw new Error(y.errorPrefix(e,t,r)+"must be a boolean.")},Ne=function(){function e(e,t){this.repo_=e,this.path_=t}return e.prototype.cancel=function(e){y.validateArgCount("OnDisconnect.cancel",0,1,arguments.length),y.validateCallback("OnDisconnect.cancel",1,e,!0);var t=new y.Deferred;return this.repo_.onDisconnectCancel(this.path_,t.wrapCallback(e)),t.promise},e.prototype.remove=function(e){y.validateArgCount("OnDisconnect.remove",0,1,arguments.length),Se("OnDisconnect.remove",this.path_),y.validateCallback("OnDisconnect.remove",1,e,!0);var t=new y.Deferred;return this.repo_.onDisconnectSet(this.path_,null,t.wrapCallback(e)),t.promise},e.prototype.set=function(e,t){y.validateArgCount("OnDisconnect.set",1,2,arguments.length),Se("OnDisconnect.set",this.path_),ge("OnDisconnect.set",1,e,this.path_,!1),y.validateCallback("OnDisconnect.set",2,t,!0);var n=new y.Deferred;return this.repo_.onDisconnectSet(this.path_,e,n.wrapCallback(t)),n.promise},e.prototype.setWithPriority=function(e,t,n){y.validateArgCount("OnDisconnect.setWithPriority",2,3,arguments.length),Se("OnDisconnect.setWithPriority",this.path_),ge("OnDisconnect.setWithPriority",1,e,this.path_,!1),_e("OnDisconnect.setWithPriority",2,t,!1),y.validateCallback("OnDisconnect.setWithPriority",3,n,!0);var r=new y.Deferred;return this.repo_.onDisconnectSetWithPriority(this.path_,e,t,r.wrapCallback(n)),r.promise},e.prototype.update=function(e,t){if(y.validateArgCount("OnDisconnect.update",1,2,arguments.length),Se("OnDisconnect.update",this.path_),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,V("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}be("OnDisconnect.update",1,e,this.path_,!1),y.validateCallback("OnDisconnect.update",2,t,!0);var i=new y.Deferred;return this.repo_.onDisconnectUpdate(this.path_,e,i.wrapCallback(t)),i.promise},e}(),De=function(){function e(e,t){this.committed=e,this.snapshot=t}return e.prototype.toJSON=function(){return y.validateArgCount("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},e}(),Ae=function(){var e="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",t=0,n=[];return function(r){var i=r===t;t=r;var o,a=new Array(8);for(o=7;o>=0;o--)a[o]=e.charAt(r%64),r=Math.floor(r/64);y.assert(0===r,"Cannot push at time == 0");var s=a.join("");if(i){for(o=11;o>=0&&63===n[o];o--)n[o]=0;n[o]++}else for(o=0;o<12;o++)n[o]=Math.floor(64*Math.random());for(o=0;o<12;o++)s+=e.charAt(n[o]);return y.assert(20===s.length,"nextPushId: Length should be 20."),s}}(),xe=function(){function e(e,t){this.name=e,this.node=t}return e.Wrap=function(t,n){return new e(t,n)},e}(),Oe=function(){function e(){}return e.prototype.getCompare=function(){return this.compare.bind(this)},e.prototype.indexedValueChanged=function(e,t){var n=new xe(F,e),r=new xe(F,t);return 0!==this.compare(n,r)},e.prototype.minPost=function(){return xe.MIN},e}(),Pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b.__extends(t,e),Object.defineProperty(t,"__EMPTY_NODE",{get:function(){return l},set:function(e){l=e},enumerable:!0,configurable:!0}),t.prototype.compare=function(e,t){return K(e.name,t.name)},t.prototype.isDefinedOn=function(e){throw y.assertionError("KeyIndex.isDefinedOn not expected to be called.")},t.prototype.indexedValueChanged=function(e,t){return!1},t.prototype.minPost=function(){return xe.MIN},t.prototype.maxPost=function(){return new xe(B,l)},t.prototype.makePost=function(e,t){return y.assert("string"==typeof e,"KeyIndex indexValue must always be a string."),new xe(e,l)},t.prototype.toString=function(){return".key"},t}(Oe),Re=new Pe,Le=function(e){return"number"==typeof e?"number:"+X(e):"string:"+e},Me=function(e){if(e.isLeafNode()){var t=e.val();y.assert("string"==typeof t||"number"==typeof t||"object"==typeof t&&y.contains(t,".sv"),"Priority must be a string or number.")}else y.assert(e===h||e.isEmpty(),"priority of unexpected type.");y.assert(e===h||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},Ve=function(){function e(t,n){void 0===n&&(n=e.__childrenNodeConstructor.EMPTY_NODE),this.value_=t,this.priorityNode_=n,this.lazyHash_=null,y.assert(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),Me(this.priorityNode_)}return Object.defineProperty(e,"__childrenNodeConstructor",{get:function(){return p},set:function(e){p=e},enumerable:!0,configurable:!0}),e.prototype.isLeafNode=function(){return!0},e.prototype.getPriority=function(){return this.priorityNode_},e.prototype.updatePriority=function(t){return new e(this.value_,t)},e.prototype.getImmediateChild=function(t){return".priority"===t?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE},e.prototype.getChild=function(t){return t.isEmpty()?this:".priority"===t.getFront()?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE},e.prototype.hasChild=function(){return!1},e.prototype.getPredecessorChildName=function(e,t){return null},e.prototype.updateImmediateChild=function(t,n){return".priority"===t?this.updatePriority(n):n.isEmpty()&&".priority"!==t?this:e.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,n).updatePriority(this.priorityNode_)},e.prototype.updateChild=function(t,n){var r=t.getFront();return null===r?n:n.isEmpty()&&".priority"!==r?this:(y.assert(".priority"!==r||1===t.getLength(),".priority must be the last token in a path"),this.updateImmediateChild(r,e.__childrenNodeConstructor.EMPTY_NODE.updateChild(t.popFront(),n)))},e.prototype.isEmpty=function(){return!1},e.prototype.numChildren=function(){return 0},e.prototype.forEachChild=function(e,t){return!1},e.prototype.val=function(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},e.prototype.hash=function(){if(null===this.lazyHash_){var e="";this.priorityNode_.isEmpty()||(e+="priority:"+Le(this.priorityNode_.val())+":");var t=typeof this.value_;e+=t+":",e+="number"===t?X(this.value_):this.value_,this.lazyHash_=N(e)}return this.lazyHash_},e.prototype.getValue=function(){return this.value_},e.prototype.compareTo=function(t){return t===e.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof e.__childrenNodeConstructor?-1:(y.assert(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))},e.prototype.compareToLeafNode_=function(t){var n=typeof t.value_,r=typeof this.value_,i=e.VALUE_TYPE_ORDER.indexOf(n),o=e.VALUE_TYPE_ORDER.indexOf(r);return y.assert(i>=0,"Unknown leaf type: "+n),y.assert(o>=0,"Unknown leaf type: "+r),i===o?"object"===r?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-i},e.prototype.withIndex=function(){return this},e.prototype.isIndexed=function(){return!0},e.prototype.equals=function(e){if(e===this)return!0;if(e.isLeafNode()){var t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1},e.VALUE_TYPE_ORDER=["object","boolean","number","string"],e}(),je=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b.__extends(t,e),t.prototype.compare=function(e,t){var n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?K(e.name,t.name):i},t.prototype.isDefinedOn=function(e){return!e.getPriority().isEmpty()},t.prototype.indexedValueChanged=function(e,t){return!e.getPriority().equals(t.getPriority())},t.prototype.minPost=function(){return xe.MIN},t.prototype.maxPost=function(){return new xe(B,new Ve("[PRIORITY-POST]",d))},t.prototype.makePost=function(e,t){var n=f(e);return new xe(t,new Ve("[PRIORITY-POST]",n))},t.prototype.toString=function(){return".priority"},t}(Oe)),Ue=function(){function e(e,t,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!e.isEmpty();)if(e=e,o=t?n(e.key,t):1,r&&(o*=-1),o<0)e=this.isReverse_?e.left:e.right;else{if(0===o){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}return e.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e},e.prototype.hasNext=function(){return this.nodeStack_.length>0},e.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}},e}(),qe=function(){function e(t,n,r,i,o){this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:Be.EMPTY_NODE,this.right=null!=o?o:Be.EMPTY_NODE}return e.prototype.copy=function(t,n,r,i,o){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},e.prototype.count=function(){return this.left.count()+1+this.right.count()},e.prototype.isEmpty=function(){return!1},e.prototype.inorderTraversal=function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)},e.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},e.prototype.minKey=function(){return this.min_().key},e.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},e.prototype.insert=function(e,t,n){var r,i;return i=this,r=n(e,i.key),(i=r<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===r?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n))).fixUp_()},e.prototype.removeMin_=function(){if(this.left.isEmpty())return Be.EMPTY_NODE;var e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),(e=e.copy(null,null,null,e.left.removeMin_(),null)).fixUp_()},e.prototype.remove=function(e,t){var n,r;if(n=this,t(e,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return Be.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()},e.prototype.isRed_=function(){return this.color},e.prototype.fixUp_=function(){var e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e},e.prototype.moveRedLeft_=function(){var e=this.colorFlip_();return e.right.left.isRed_()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight_())).rotateLeft_()).colorFlip_()),e},e.prototype.moveRedRight_=function(){var e=this.colorFlip_();return e.left.left.isRed_()&&(e=(e=e.rotateRight_()).colorFlip_()),e},e.prototype.rotateLeft_=function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},e.prototype.rotateRight_=function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},e.prototype.colorFlip_=function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)},e.prototype.checkMaxDepth_=function(){var e=this.check_();return Math.pow(2,e)<=this.count()+1},e.prototype.check_=function(){var e;if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");if((e=this.left.check_())!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)},e.RED=!0,e.BLACK=!1,e}(),Fe=function(){function e(){}return e.prototype.copy=function(e,t,n,r,i){return this},e.prototype.insert=function(e,t,n){return new qe(e,t,null)},e.prototype.remove=function(e,t){return this},e.prototype.count=function(){return 0},e.prototype.isEmpty=function(){return!0},e.prototype.inorderTraversal=function(e){return!1},e.prototype.reverseTraversal=function(e){return!1},e.prototype.minKey=function(){return null},e.prototype.maxKey=function(){return null},e.prototype.check_=function(){return 0},e.prototype.isRed_=function(){return!1},e}(),Be=function(){function e(t,n){void 0===n&&(n=e.EMPTY_NODE),this.comparator_=t,this.root_=n}return e.prototype.insert=function(t,n){return new e(this.comparator_,this.root_.insert(t,n,this.comparator_).copy(null,null,qe.BLACK,null,null))},e.prototype.remove=function(t){return new e(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,qe.BLACK,null,null))},e.prototype.get=function(e){for(var t,n=this.root_;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key)))return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null},e.prototype.getPredecessorKey=function(e){for(var t,n=this.root_,r=null;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},e.prototype.isEmpty=function(){return this.root_.isEmpty()},e.prototype.count=function(){return this.root_.count()},e.prototype.minKey=function(){return this.root_.minKey()},e.prototype.maxKey=function(){return this.root_.maxKey()},e.prototype.inorderTraversal=function(e){return this.root_.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.root_.reverseTraversal(e)},e.prototype.getIterator=function(e){return new Ue(this.root_,null,this.comparator_,!1,e)},e.prototype.getIteratorFrom=function(e,t){return new Ue(this.root_,e,this.comparator_,!1,t)},e.prototype.getReverseIteratorFrom=function(e,t){return new Ue(this.root_,e,this.comparator_,!0,t)},e.prototype.getReverseIterator=function(e){return new Ue(this.root_,null,this.comparator_,!0,e)},e.EMPTY_NODE=new Fe,e}(),Ke=Math.log(2),We=function(){function e(e){this.count=function(e){return parseInt(Math.log(e)/Ke,10)}(e+1),this.current_=this.count-1;var t=function(e){return parseInt(Array(e+1).join("1"),2)}(this.count);this.bits_=e+1&t}return e.prototype.nextBitIsOne=function(){var e=!(this.bits_&1<<this.current_);return this.current_--,e},e}(),He=function(e,t,n,r){e.sort(t);var i=function(t,r){var o,a,s=r-t;if(0==s)return null;if(1==s)return o=e[t],a=n?n(o):o,new qe(a,o.node,qe.BLACK,null,null);var u=parseInt(s/2,10)+t,c=i(t,u),l=i(u+1,r);return o=e[u],a=n?n(o):o,new qe(a,o.node,qe.BLACK,c,l)},o=function(t){for(var r=null,o=null,a=e.length,s=function(t,r){var o=a-t,s=a;a-=t;var c=i(o+1,s),l=e[o],h=n?n(l):l;u(new qe(h,l.node,r,null,c))},u=function(e){r?(r.left=e,r=e):(o=e,r=e)},c=0;c<t.count;++c){var l=t.nextBitIsOne(),h=Math.pow(2,t.count-(c+1));l?s(h,qe.BLACK):(s(h,qe.BLACK),s(h,qe.RED))}return o}(new We(e.length));return new Be(r||t,o)},ze={},Qe=function(){function e(e,t){this.indexes_=e,this.indexSet_=t}return Object.defineProperty(e,"Default",{get:function(){return y.assert(ze&&je,"ChildrenNode.ts has not been loaded"),m=m||new e({".priority":ze},{".priority":je})},enumerable:!0,configurable:!0}),e.prototype.get=function(e){var t=y.safeGet(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t===ze?null:t},e.prototype.hasIndex=function(e){return y.contains(this.indexSet_,e.toString())},e.prototype.addIndex=function(t,n){y.assert(t!==Re,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r=[],i=!1,o=n.getIterator(xe.Wrap),a=o.getNext();a;)i=i||t.isDefinedOn(a.node),r.push(a),a=o.getNext();var s;s=i?He(r,t.getCompare()):ze;var u=t.toString(),c=y.clone(this.indexSet_);c[u]=t;var l=y.clone(this.indexes_);return l[u]=s,new e(l,c)},e.prototype.addToIndexes=function(t,n){var r=this;return new e(y.map(this.indexes_,function(e,i){var o=y.safeGet(r.indexSet_,i);if(y.assert(o,"Missing index implementation for "+i),e===ze){if(o.isDefinedOn(t.node)){for(var a=[],s=n.getIterator(xe.Wrap),u=s.getNext();u;)u.name!=t.name&&a.push(u),u=s.getNext();return a.push(t),He(a,o.getCompare())}return ze}var c=n.get(t.name),l=e;return c&&(l=l.remove(new xe(t.name,c))),l.insert(t,t.node)}),this.indexSet_)},e.prototype.removeFromIndexes=function(t,n){return new e(y.map(this.indexes_,function(e){if(e===ze)return e;var r=n.get(t.name);return r?e.remove(new xe(t.name,r)):e}),this.indexSet_)},e}(),Ge=function(){function e(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&Me(this.priorityNode_),this.children_.isEmpty()&&y.assert(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(e,"EMPTY_NODE",{get:function(){return g||(g=new e(new Be(s),null,Qe.Default))},enumerable:!0,configurable:!0}),e.prototype.isLeafNode=function(){return!1},e.prototype.getPriority=function(){return this.priorityNode_||g},e.prototype.updatePriority=function(t){return this.children_.isEmpty()?this:new e(this.children_,t,this.indexMap_)},e.prototype.getImmediateChild=function(e){if(".priority"===e)return this.getPriority();var t=this.children_.get(e);return null===t?g:t},e.prototype.getChild=function(e){var t=e.getFront();return null===t?this:this.getImmediateChild(t).getChild(e.popFront())},e.prototype.hasChild=function(e){return null!==this.children_.get(e)},e.prototype.updateImmediateChild=function(t,n){if(y.assert(n,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(n);var r=new xe(t,n),i=void 0,o=void 0,a=void 0;return n.isEmpty()?(i=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(t,n),o=this.indexMap_.addToIndexes(r,this.children_)),a=i.isEmpty()?g:this.priorityNode_,new e(i,a,o)},e.prototype.updateChild=function(e,t){var n=e.getFront();if(null===n)return t;y.assert(".priority"!==e.getFront()||1===e.getLength(),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(e.popFront(),t);return this.updateImmediateChild(n,r)},e.prototype.isEmpty=function(){return this.children_.isEmpty()},e.prototype.numChildren=function(){return this.children_.count()},e.prototype.val=function(t){if(this.isEmpty())return null;var n={},r=0,i=0,o=!0;if(this.forEachChild(je,function(a,s){n[a]=s.val(t),r++,o&&e.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):o=!1}),!t&&o&&i<2*r){var a=[];for(var s in n)a[s]=n[s];return a}return t&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},e.prototype.hash=function(){if(null===this.lazyHash_){var e="";this.getPriority().isEmpty()||(e+="priority:"+Le(this.getPriority().val())+":"),this.forEachChild(je,function(t,n){var r=n.hash();""!==r&&(e+=":"+t+":"+r)}),this.lazyHash_=""===e?"":N(e)}return this.lazyHash_},e.prototype.getPredecessorChildName=function(e,t,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new xe(e,t));return i?i.name:null}return this.children_.getPredecessorKey(e)},e.prototype.getFirstChildName=function(e){var t=this.resolveIndex_(e);if(t){var n=t.minKey();return n&&n.name}return this.children_.minKey()},e.prototype.getFirstChild=function(e){var t=this.getFirstChildName(e);return t?new xe(t,this.children_.get(t)):null},e.prototype.getLastChildName=function(e){var t=this.resolveIndex_(e);if(t){var n=t.maxKey();return n&&n.name}return this.children_.maxKey()},e.prototype.getLastChild=function(e){var t=this.getLastChildName(e);return t?new xe(t,this.children_.get(t)):null},e.prototype.forEachChild=function(e,t){var n=this.resolveIndex_(e);return n?n.inorderTraversal(function(e){return t(e.name,e.node)}):this.children_.inorderTraversal(t)},e.prototype.getIterator=function(e){return this.getIteratorFrom(e.minPost(),e)},e.prototype.getIteratorFrom=function(e,t){var n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,function(e){return e});for(var r=this.children_.getIteratorFrom(e.name,xe.Wrap),i=r.peek();null!=i&&t.compare(i,e)<0;)r.getNext(),i=r.peek();return r},e.prototype.getReverseIterator=function(e){return this.getReverseIteratorFrom(e.maxPost(),e)},e.prototype.getReverseIteratorFrom=function(e,t){var n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,function(e){return e});for(var r=this.children_.getReverseIteratorFrom(e.name,xe.Wrap),i=r.peek();null!=i&&t.compare(i,e)>0;)r.getNext(),i=r.peek();return r},e.prototype.compareTo=function(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Xe?-1:0},e.prototype.withIndex=function(t){if(t===Re||this.indexMap_.hasIndex(t))return this;var n=this.indexMap_.addIndex(t,this.children_);return new e(this.children_,this.priorityNode_,n)},e.prototype.isIndexed=function(e){return e===Re||this.indexMap_.hasIndex(e)},e.prototype.equals=function(e){if(e===this)return!0;if(e.isLeafNode())return!1;var t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){for(var n=this.getIterator(je),r=t.getIterator(je),i=n.getNext(),o=r.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1}return!1},e.prototype.resolveIndex_=function(e){return e===Re?null:this.indexMap_.get(e.toString())},e.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,e}(),Xe=new(function(e){function t(){return e.call(this,new Be(s),Ge.EMPTY_NODE,Qe.Default)||this}return b.__extends(t,e),t.prototype.compareTo=function(e){return e===this?0:1},t.prototype.equals=function(e){return e===this},t.prototype.getPriority=function(){return this},t.prototype.getImmediateChild=function(e){return Ge.EMPTY_NODE},t.prototype.isEmpty=function(){return!1},t}(Ge));Object.defineProperties(xe,{MIN:{value:new xe(F,Ge.EMPTY_NODE)},MAX:{value:new xe(B,Xe)}}),Pe.__EMPTY_NODE=Ge.EMPTY_NODE,Ve.__childrenNodeConstructor=Ge,h=Xe,d=Xe;var Ye=!0;f=u;var $e,Je,Ze=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b.__extends(t,e),t.prototype.compare=function(e,t){var n=e.node.compareTo(t.node);return 0===n?K(e.name,t.name):n},t.prototype.isDefinedOn=function(e){return!0},t.prototype.indexedValueChanged=function(e,t){return!e.equals(t)},t.prototype.minPost=function(){return xe.MIN},t.prototype.maxPost=function(){return xe.MAX},t.prototype.makePost=function(e,t){var n=u(e);return new xe(t,n)},t.prototype.toString=function(){return".value"},t}(Oe)),et=function(e){function t(t){var n=e.call(this)||this;return n.indexPath_=t,y.assert(!t.isEmpty()&&".priority"!==t.getFront(),"Can't create PathIndex with empty path or .priority key"),n}return b.__extends(t,e),t.prototype.extractChild=function(e){return e.getChild(this.indexPath_)},t.prototype.isDefinedOn=function(e){return!e.getChild(this.indexPath_).isEmpty()},t.prototype.compare=function(e,t){var n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?K(e.name,t.name):i},t.prototype.makePost=function(e,t){var n=u(e),r=Ge.EMPTY_NODE.updateChild(this.indexPath_,n);return new xe(t,r)},t.prototype.maxPost=function(){var e=Ge.EMPTY_NODE.updateChild(this.indexPath_,Xe);return new xe(B,e)},t.prototype.toString=function(){return this.indexPath_.slice().join("/")},t}(Oe),tt=function(){function e(e,t,n){this.node_=e,this.ref_=t,this.index_=n}return e.prototype.val=function(){return y.validateArgCount("DataSnapshot.val",0,0,arguments.length),this.node_.val()},e.prototype.exportVal=function(){return y.validateArgCount("DataSnapshot.exportVal",0,0,arguments.length),this.node_.val(!0)},e.prototype.toJSON=function(){return y.validateArgCount("DataSnapshot.toJSON",0,1,arguments.length),this.exportVal()},e.prototype.exists=function(){return y.validateArgCount("DataSnapshot.exists",0,0,arguments.length),!this.node_.isEmpty()},e.prototype.child=function(t){y.validateArgCount("DataSnapshot.child",0,1,arguments.length),t=String(t),Ee("DataSnapshot.child",1,t,!1);var n=new ie(t),r=this.ref_.child(n);return new e(this.node_.getChild(n),r,je)},e.prototype.hasChild=function(e){y.validateArgCount("DataSnapshot.hasChild",1,1,arguments.length),Ee("DataSnapshot.hasChild",1,e,!1);var t=new ie(e);return!this.node_.getChild(t).isEmpty()},e.prototype.getPriority=function(){return y.validateArgCount("DataSnapshot.getPriority",0,0,arguments.length),this.node_.getPriority().val()},e.prototype.forEach=function(t){var n=this;return y.validateArgCount("DataSnapshot.forEach",1,1,arguments.length),y.validateCallback("DataSnapshot.forEach",1,t,!1),!this.node_.isLeafNode()&&!!this.node_.forEachChild(this.index_,function(r,i){return t(new e(i,n.ref_.child(r),je))})},e.prototype.hasChildren=function(){return y.validateArgCount("DataSnapshot.hasChildren",0,0,arguments.length),!this.node_.isLeafNode()&&!this.node_.isEmpty()},Object.defineProperty(e.prototype,"key",{get:function(){return this.ref_.getKey()},enumerable:!0,configurable:!0}),e.prototype.numChildren=function(){return y.validateArgCount("DataSnapshot.numChildren",0,0,arguments.length),this.node_.numChildren()},e.prototype.getRef=function(){return y.validateArgCount("DataSnapshot.ref",0,0,arguments.length),this.ref_},Object.defineProperty(e.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),e}(),nt=function(){function e(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}return e.prototype.getPath=function(){var e=this.snapshot.getRef();return"value"===this.eventType?e.path:e.getParent().path},e.prototype.getEventType=function(){return this.eventType},e.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},e.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+y.stringify(this.snapshot.exportVal())},e}(),rt=function(){function e(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}return e.prototype.getPath=function(){return this.path},e.prototype.getEventType=function(){return"cancel"},e.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},e.prototype.toString=function(){return this.path.toString()+":cancel"},e}(),it=function(){function e(e,t,n){this.callback_=e,this.cancelCallback_=t,this.context_=n}return e.prototype.respondsTo=function(e){return"value"===e},e.prototype.createEvent=function(e,t){var n=t.getQueryParams().getIndex();return new nt("value",this,new tt(e.snapshotNode,t.getRef(),n))},e.prototype.getEventRunner=function(e){var t=this.context_;if("cancel"===e.getEventType()){y.assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(t,e.error)}}var r=this.callback_;return function(){r.call(t,e.snapshot)}},e.prototype.createCancelEvent=function(e,t){return this.cancelCallback_?new rt(this,e,t):null},e.prototype.matches=function(t){return t instanceof e&&(!t.callback_||!this.callback_||t.callback_===this.callback_&&t.context_===this.context_)},e.prototype.hasAnyCallback=function(){return null!==this.callback_},e}(),ot=function(){function e(e,t,n){this.callbacks_=e,this.cancelCallback_=t,this.context_=n}return e.prototype.respondsTo=function(e){var t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,y.contains(this.callbacks_,t)},e.prototype.createCancelEvent=function(e,t){return this.cancelCallback_?new rt(this,e,t):null},e.prototype.createEvent=function(e,t){y.assert(null!=e.childName,"Child events should have a childName.");var n=t.getRef().child(e.childName),r=t.getQueryParams().getIndex();return new nt(e.type,this,new tt(e.snapshotNode,n,r),e.prevName)},e.prototype.getEventRunner=function(e){var t=this.context_;if("cancel"===e.getEventType()){y.assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(t,e.error)}}var r=this.callbacks_[e.eventType];return function(){r.call(t,e.snapshot,e.prevName)}},e.prototype.matches=function(t){if(t instanceof e){if(!this.callbacks_||!t.callbacks_)return!0;if(this.context_===t.context_){var n=y.getCount(t.callbacks_);if(n===y.getCount(this.callbacks_)){if(1===n){var r=y.getAnyKey(t.callbacks_),i=y.getAnyKey(this.callbacks_);return!(i!==r||t.callbacks_[r]&&this.callbacks_[i]&&t.callbacks_[r]!==this.callbacks_[i])}return y.every(this.callbacks_,function(e,n){return t.callbacks_[e]===n})}}}return!1},e.prototype.hasAnyCallback=function(){return null!==this.callbacks_},e}(),at=function(){function e(e,t,n,r){this.repo=e,this.path=t,this.queryParams_=n,this.orderByCalled_=r}return Object.defineProperty(e,"__referenceConstructor",{get:function(){return y.assert($e,"Reference.ts has not been loaded"),$e},set:function(e){$e=e},enumerable:!0,configurable:!0}),e.validateQueryEndpoints_=function(e){var t=null,n=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(n=e.getIndexEndValue()),e.getIndex()===Re){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!=F)throw new Error(r);if("string"!=typeof t)throw new Error(i)}if(e.hasEnd()){if(e.getIndexEndName()!=B)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(e.getIndex()===je){if(null!=t&&!me(t)||null!=n&&!me(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(y.assert(e.getIndex()instanceof et||e.getIndex()===Ze,"unknown index type."),null!=t&&"object"==typeof t||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.")},e.validateLimit_=function(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.")},e.prototype.validateNoPreviousOrderByCall_=function(e){if(!0===this.orderByCalled_)throw new Error(e+": You can't combine multiple orderBy calls.")},e.prototype.getQueryParams=function(){return this.queryParams_},e.prototype.getRef=function(){return y.validateArgCount("Query.ref",0,0,arguments.length),new e.__referenceConstructor(this.repo,this.path)},e.prototype.on=function(t,n,r,i){y.validateArgCount("Query.on",2,4,arguments.length),we("Query.on",1,t,!1),y.validateCallback("Query.on",2,n,!1);var o=e.getCancelAndContextArgs_("Query.on",r,i);if("value"===t)this.onValueEvent(n,o.cancel,o.context);else{var a={};a[t]=n,this.onChildEvent(a,o.cancel,o.context)}return n},e.prototype.onValueEvent=function(e,t,n){var r=new it(e,t||null,n||null);this.repo.addEventCallbackForQuery(this,r)},e.prototype.onChildEvent=function(e,t,n){var r=new ot(e,t,n);this.repo.addEventCallbackForQuery(this,r)},e.prototype.off=function(e,t,n){y.validateArgCount("Query.off",0,3,arguments.length),we("Query.off",1,e,!0),y.validateCallback("Query.off",2,t,!0),y.validateContextObject("Query.off",3,n,!0);var r=null,i=null;"value"===e?r=new it(t||null,null,n||null):e&&(t&&((i={})[e]=t),r=new ot(i,null,n||null)),this.repo.removeEventCallbackForQuery(this,r)},e.prototype.once=function(t,n,r,i){var o=this;y.validateArgCount("Query.once",1,4,arguments.length),we("Query.once",1,t,!1),y.validateCallback("Query.once",2,n,!0);var a=e.getCancelAndContextArgs_("Query.once",r,i),s=!0,u=new y.Deferred;u.promise.catch(function(){});var c=function(e){s&&(s=!1,o.off(t,c),n&&n.bind(a.context)(e),u.resolve(e))};return this.on(t,c,function(e){o.off(t,c),a.cancel&&a.cancel.bind(a.context)(e),u.reject(e)}),u.promise},e.prototype.limitToFirst=function(t){if(y.validateArgCount("Query.limitToFirst",1,1,arguments.length),"number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("Query.limitToFirst: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new e(this.repo,this.path,this.queryParams_.limitToFirst(t),this.orderByCalled_)},e.prototype.limitToLast=function(t){if(y.validateArgCount("Query.limitToLast",1,1,arguments.length),"number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("Query.limitToLast: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new e(this.repo,this.path,this.queryParams_.limitToLast(t),this.orderByCalled_)},e.prototype.orderByChild=function(t){if(y.validateArgCount("Query.orderByChild",1,1,arguments.length),"$key"===t)throw new Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===t)throw new Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===t)throw new Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');Ee("Query.orderByChild",1,t,!1),this.validateNoPreviousOrderByCall_("Query.orderByChild");var n=new ie(t);if(n.isEmpty())throw new Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");var r=new et(n),i=this.queryParams_.orderBy(r);return e.validateQueryEndpoints_(i),new e(this.repo,this.path,i,!0)},e.prototype.orderByKey=function(){y.validateArgCount("Query.orderByKey",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByKey");var t=this.queryParams_.orderBy(Re);return e.validateQueryEndpoints_(t),new e(this.repo,this.path,t,!0)},e.prototype.orderByPriority=function(){y.validateArgCount("Query.orderByPriority",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByPriority");var t=this.queryParams_.orderBy(je);return e.validateQueryEndpoints_(t),new e(this.repo,this.path,t,!0)},e.prototype.orderByValue=function(){y.validateArgCount("Query.orderByValue",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByValue");var t=this.queryParams_.orderBy(Ze);return e.validateQueryEndpoints_(t),new e(this.repo,this.path,t,!0)},e.prototype.startAt=function(t,n){void 0===t&&(t=null),y.validateArgCount("Query.startAt",0,2,arguments.length),ge("Query.startAt",1,t,this.path,!0),ke("Query.startAt",2,n,!0);var r=this.queryParams_.startAt(t,n);if(e.validateLimit_(r),e.validateQueryEndpoints_(r),this.queryParams_.hasStart())throw new Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return void 0===t&&(t=null,n=null),new e(this.repo,this.path,r,this.orderByCalled_)},e.prototype.endAt=function(t,n){void 0===t&&(t=null),y.validateArgCount("Query.endAt",0,2,arguments.length),ge("Query.endAt",1,t,this.path,!0),ke("Query.endAt",2,n,!0);var r=this.queryParams_.endAt(t,n);if(e.validateLimit_(r),e.validateQueryEndpoints_(r),this.queryParams_.hasEnd())throw new Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new e(this.repo,this.path,r,this.orderByCalled_)},e.prototype.equalTo=function(e,t){if(y.validateArgCount("Query.equalTo",1,2,arguments.length),ge("Query.equalTo",1,e,this.path,!1),ke("Query.equalTo",2,t,!0),this.queryParams_.hasStart())throw new Error("Query.equalTo: Starting point was already set (by another call to startAt or equalTo).");if(this.queryParams_.hasEnd())throw new Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.startAt(e,t).endAt(e,t)},e.prototype.toString=function(){return y.validateArgCount("Query.toString",0,0,arguments.length),this.repo.toString()+this.path.toUrlEncodedString()},e.prototype.toJSON=function(){return y.validateArgCount("Query.toJSON",0,1,arguments.length),this.toString()},e.prototype.queryObject=function(){return this.queryParams_.getQueryObject()},e.prototype.queryIdentifier=function(){var e=this.queryObject(),t=z(e);return"{}"===t?"default":t},e.prototype.isEqual=function(t){if(y.validateArgCount("Query.isEqual",1,1,arguments.length),!(t instanceof e))throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");var n=this.repo===t.repo,r=this.path.equals(t.path),i=this.queryIdentifier()===t.queryIdentifier();return n&&r&&i},e.getCancelAndContextArgs_=function(e,t,n){var r={cancel:null,context:null};if(t&&n)r.cancel=t,y.validateCallback(e,3,r.cancel,!0),r.context=n,y.validateContextObject(e,4,r.context,!0);else if(t)if("object"==typeof t&&null!==t)r.context=t;else{if("function"!=typeof t)throw new Error(y.errorPrefix(e,3,!0)+" must either be a cancel callback or a context object.");r.cancel=t}return r},Object.defineProperty(e.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),e}(),st=function(){function e(){this.set={}}return e.prototype.add=function(e,t){this.set[e]=null===t||t},e.prototype.contains=function(e){return y.contains(this.set,e)},e.prototype.get=function(e){return this.contains(e)?this.set[e]:void 0},e.prototype.remove=function(e){delete this.set[e]},e.prototype.clear=function(){this.set={}},e.prototype.isEmpty=function(){return y.isEmpty(this.set)},e.prototype.count=function(){return y.getCount(this.set)},e.prototype.each=function(e){y.forEach(this.set,function(t,n){return e(t,n)})},e.prototype.keys=function(){var e=[];return y.forEach(this.set,function(t){e.push(t)}),e},e}(),ut=function(){function e(){this.value_=null,this.children_=null}return e.prototype.find=function(e){if(null!=this.value_)return this.value_.getChild(e);if(e.isEmpty()||null==this.children_)return null;var t=e.getFront();return e=e.popFront(),this.children_.contains(t)?this.children_.get(t).find(e):null},e.prototype.remember=function(t,n){if(t.isEmpty())this.value_=n,this.children_=null;else if(null!==this.value_)this.value_=this.value_.updateChild(t,n);else{null==this.children_&&(this.children_=new st);var r=t.getFront();this.children_.contains(r)||this.children_.add(r,new e);var i=this.children_.get(r);t=t.popFront(),i.remember(t,n)}},e.prototype.forget=function(e){if(e.isEmpty())return this.value_=null,this.children_=null,!0;if(null!==this.value_){if(this.value_.isLeafNode())return!1;var t=this.value_;this.value_=null;var n=this;return t.forEachChild(je,function(e,t){n.remember(new ie(e),t)}),this.forget(e)}if(null!==this.children_){var r=e.getFront();return e=e.popFront(),this.children_.contains(r)&&this.children_.get(r).forget(e)&&this.children_.remove(r),!!this.children_.isEmpty()&&(this.children_=null,!0)}return!0},e.prototype.forEachTree=function(e,t){null!==this.value_?t(e,this.value_):this.forEachChild(function(n,r){var i=new ie(e.toString()+"/"+n);r.forEachTree(i,t)})},e.prototype.forEachChild=function(e){null!==this.children_&&this.children_.each(function(t,n){e(t,n)})},e}(),ct=function(e){return e=e||{},e.timestamp=e.timestamp||(new Date).getTime(),e},lt=function(e,t){return e&&"object"==typeof e?(y.assert(".sv"in e,"Unexpected leaf node or priority contents"),t[e[".sv"]]):e},ht=function(e,t){var n=new ut;return e.forEachTree(new ie(""),function(e,r){n.remember(e,pt(r,t))}),n},pt=function(e,t){var n,r=e.getPriority().val(),i=lt(r,t);if(e.isLeafNode()){var o=e,a=lt(o.getValue(),t);return a!==o.getValue()||i!==o.getPriority().val()?new Ve(a,u(i)):e}var s=e;return n=s,i!==s.getPriority().val()&&(n=n.updatePriority(new Ve(i))),s.forEachChild(je,function(e,r){var i=pt(r,t);i!==r&&(n=n.updateImmediateChild(e,i))}),n};!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Je||(Je={}));var ft,dt,mt=function(){function e(e,t,n,r){this.fromUser=e,this.fromServer=t,this.queryId=n,this.tagged=r,y.assert(!r||t,"Tagged queries must be from server.")}return e.User=new e(!0,!1,null,!1),e.Server=new e(!1,!0,null,!1),e.forServerTaggedQuery=function(t){return new e(!1,!0,t,!0)},e}(),gt=function(){function e(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=Je.ACK_USER_WRITE,this.source=mt.User}return e.prototype.operationForChild=function(t){if(this.path.isEmpty()){if(null!=this.affectedTree.value)return y.assert(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new ie(t));return new e(ie.Empty,n,this.revert)}return y.assert(this.path.getFront()===t,"operationForChild called for unrelated child."),new e(this.path.popFront(),this.affectedTree,this.revert)},e}(),yt=function(){return ft||(ft=new Be(W)),ft},vt=function(){function e(e,t){void 0===t&&(t=yt()),this.value=e,this.children=t}return e.fromObject=function(t){var n=e.Empty;return y.forEach(t,function(e,t){n=n.set(new ie(e),t)}),n},e.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},e.prototype.findRootMostMatchingPathAndValue=function(e,t){if(null!=this.value&&t(this.value))return{path:ie.Empty,value:this.value};if(e.isEmpty())return null;var n=e.getFront(),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(e.popFront(),t);return null!=i?{path:new ie(n).child(i.path),value:i.value}:null}return null},e.prototype.findRootMostValueAndPath=function(e){return this.findRootMostMatchingPathAndValue(e,function(){return!0})},e.prototype.subtree=function(t){if(t.isEmpty())return this;var n=t.getFront(),r=this.children.get(n);return null!==r?r.subtree(t.popFront()):e.Empty},e.prototype.set=function(t,n){if(t.isEmpty())return new e(n,this.children);var r=t.getFront(),i=(this.children.get(r)||e.Empty).set(t.popFront(),n),o=this.children.insert(r,i);return new e(this.value,o)},e.prototype.remove=function(t){if(t.isEmpty())return this.children.isEmpty()?e.Empty:new e(null,this.children);var n=t.getFront(),r=this.children.get(n);if(r){var i=r.remove(t.popFront()),o=void 0;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&o.isEmpty()?e.Empty:new e(this.value,o)}return this},e.prototype.get=function(e){if(e.isEmpty())return this.value;var t=e.getFront(),n=this.children.get(t);return n?n.get(e.popFront()):null},e.prototype.setTree=function(t,n){if(t.isEmpty())return n;var r=t.getFront(),i=(this.children.get(r)||e.Empty).setTree(t.popFront(),n),o=void 0;return o=i.isEmpty()?this.children.remove(r):this.children.insert(r,i),new e(this.value,o)},e.prototype.fold=function(e){return this.fold_(ie.Empty,e)},e.prototype.fold_=function(e,t){var n={};return this.children.inorderTraversal(function(r,i){n[r]=i.fold_(e.child(r),t)}),t(e,this.value,n)},e.prototype.findOnPath=function(e,t){return this.findOnPath_(e,ie.Empty,t)},e.prototype.findOnPath_=function(e,t,n){var r=!!this.value&&n(t,this.value);if(r)return r;if(e.isEmpty())return null;var i=e.getFront(),o=this.children.get(i);return o?o.findOnPath_(e.popFront(),t.child(i),n):null},e.prototype.foreachOnPath=function(e,t){return this.foreachOnPath_(e,ie.Empty,t)},e.prototype.foreachOnPath_=function(t,n,r){if(t.isEmpty())return this;this.value&&r(n,this.value);var i=t.getFront(),o=this.children.get(i);return o?o.foreachOnPath_(t.popFront(),n.child(i),r):e.Empty},e.prototype.foreach=function(e){this.foreach_(ie.Empty,e)},e.prototype.foreach_=function(e,t){this.children.inorderTraversal(function(n,r){r.foreach_(e.child(n),t)}),this.value&&t(e,this.value)},e.prototype.foreachChild=function(e){this.children.inorderTraversal(function(t,n){n.value&&e(t,n.value)})},e.Empty=new e(null),e}(),bt=function(){function e(e,t){this.source=e,this.path=t,this.type=Je.LISTEN_COMPLETE}return e.prototype.operationForChild=function(t){return this.path.isEmpty()?new e(this.source,ie.Empty):new e(this.source,this.path.popFront())},e}(),_t=function(){function e(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=Je.OVERWRITE}return e.prototype.operationForChild=function(t){return this.path.isEmpty()?new e(this.source,ie.Empty,this.snap.getImmediateChild(t)):new e(this.source,this.path.popFront(),this.snap)},e}(),wt=function(){function e(e,t,n){this.source=e,this.path=t,this.children=n,this.type=Je.MERGE}return e.prototype.operationForChild=function(t){if(this.path.isEmpty()){var n=this.children.subtree(new ie(t));return n.isEmpty()?null:n.value?new _t(this.source,ie.Empty,n.value):new e(this.source,ie.Empty,n)}return y.assert(this.path.getFront()===t,"Can't get a merge for a child not on the path of the operation"),new e(this.source,this.path.popFront(),this.children)},e.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},e}(),kt=function(){function e(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}return e.prototype.isFullyInitialized=function(){return this.fullyInitialized_},e.prototype.isFiltered=function(){return this.filtered_},e.prototype.isCompleteForPath=function(e){if(e.isEmpty())return this.isFullyInitialized()&&!this.filtered_;var t=e.getFront();return this.isCompleteForChild(t)},e.prototype.isCompleteForChild=function(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)},e.prototype.getNode=function(){return this.node_},e}(),Et=function(){function e(e,t){this.eventCache_=e,this.serverCache_=t}return e.prototype.updateEventSnap=function(t,n,r){return new e(new kt(t,n,r),this.serverCache_)},e.prototype.updateServerSnap=function(t,n,r){return new e(this.eventCache_,new kt(t,n,r))},e.prototype.getEventCache=function(){return this.eventCache_},e.prototype.getCompleteEventSnap=function(){return this.eventCache_.isFullyInitialized()?this.eventCache_.getNode():null},e.prototype.getServerCache=function(){return this.serverCache_},e.prototype.getCompleteServerSnap=function(){return this.serverCache_.isFullyInitialized()?this.serverCache_.getNode():null},e.Empty=new e(new kt(Ge.EMPTY_NODE,!1,!1),new kt(Ge.EMPTY_NODE,!1,!1)),e}(),Tt=function(){function e(e,t,n,r,i){this.type=e,this.snapshotNode=t,this.childName=n,this.oldSnap=r,this.prevName=i}return e.valueChange=function(t){return new e(e.VALUE,t)},e.childAddedChange=function(t,n){return new e(e.CHILD_ADDED,n,t)},e.childRemovedChange=function(t,n){return new e(e.CHILD_REMOVED,n,t)},e.childChangedChange=function(t,n,r){return new e(e.CHILD_CHANGED,n,t,r)},e.childMovedChange=function(t,n){return new e(e.CHILD_MOVED,n,t)},e.CHILD_ADDED="child_added",e.CHILD_REMOVED="child_removed",e.CHILD_CHANGED="child_changed",e.CHILD_MOVED="child_moved",e.VALUE="value",e}(),St=function(){function e(e){this.index_=e}return e.prototype.updateChild=function(e,t,n,r,i,o){y.assert(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");var a=e.getImmediateChild(t);return a.getChild(r).equals(n.getChild(r))&&a.isEmpty()==n.isEmpty()?e:(null!=o&&(n.isEmpty()?e.hasChild(t)?o.trackChildChange(Tt.childRemovedChange(t,a)):y.assert(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Tt.childAddedChange(t,n)):o.trackChildChange(Tt.childChangedChange(t,n,a))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))},e.prototype.updateFullNode=function(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(je,function(e,r){t.hasChild(e)||n.trackChildChange(Tt.childRemovedChange(e,r))}),t.isLeafNode()||t.forEachChild(je,function(t,r){if(e.hasChild(t)){var i=e.getImmediateChild(t);i.equals(r)||n.trackChildChange(Tt.childChangedChange(t,r,i))}else n.trackChildChange(Tt.childAddedChange(t,r))})),t.withIndex(this.index_)},e.prototype.updatePriority=function(e,t){return e.isEmpty()?Ge.EMPTY_NODE:e.updatePriority(t)},e.prototype.filtersNodes=function(){return!1},e.prototype.getIndexedFilter=function(){return this},e.prototype.getIndex=function(){return this.index_},e}(),Ct=function(){function e(){this.changeMap_={}}return e.prototype.trackChildChange=function(e){var t=e.type,n=e.childName;y.assert(t==Tt.CHILD_ADDED||t==Tt.CHILD_CHANGED||t==Tt.CHILD_REMOVED,"Only child changes supported for tracking"),y.assert(".priority"!==n,"Only non-priority child changes can be tracked.");var r=y.safeGet(this.changeMap_,n);if(r){var i=r.type;if(t==Tt.CHILD_ADDED&&i==Tt.CHILD_REMOVED)this.changeMap_[n]=Tt.childChangedChange(n,e.snapshotNode,r.snapshotNode);else if(t==Tt.CHILD_REMOVED&&i==Tt.CHILD_ADDED)delete this.changeMap_[n];else if(t==Tt.CHILD_REMOVED&&i==Tt.CHILD_CHANGED)this.changeMap_[n]=Tt.childRemovedChange(n,r.oldSnap);else if(t==Tt.CHILD_CHANGED&&i==Tt.CHILD_ADDED)this.changeMap_[n]=Tt.childAddedChange(n,e.snapshotNode);else{if(t!=Tt.CHILD_CHANGED||i!=Tt.CHILD_CHANGED)throw y.assertionError("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap_[n]=Tt.childChangedChange(n,e.snapshotNode,r.oldSnap)}}else this.changeMap_[n]=e},e.prototype.getChanges=function(){return y.getValues(this.changeMap_)},e}(),It=new(function(){function e(){}return e.prototype.getCompleteChild=function(e){return null},e.prototype.getChildAfterChild=function(e,t,n){return null},e}()),Nt=function(){function e(e,t,n){void 0===n&&(n=null),this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}return e.prototype.getCompleteChild=function(e){var t=this.viewCache_.getEventCache();if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);var n=null!=this.optCompleteServerCache_?new kt(this.optCompleteServerCache_,!0,!1):this.viewCache_.getServerCache();return this.writes_.calcCompleteChild(e,n)},e.prototype.getChildAfterChild=function(e,t,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:this.viewCache_.getCompleteServerSnap(),i=this.writes_.calcIndexedSlice(r,t,1,n,e);return 0===i.length?null:i[0]},e}(),Dt=function(e,t){this.viewCache=e,this.changes=t},At=function(){function e(e){this.filter_=e}return e.prototype.assertIndexed=function(e){y.assert(e.getEventCache().getNode().isIndexed(this.filter_.getIndex()),"Event snap not indexed"),y.assert(e.getServerCache().getNode().isIndexed(this.filter_.getIndex()),"Server snap not indexed")},e.prototype.applyOperation=function(t,n,r,i){var o,a,s=new Ct;if(n.type===Je.OVERWRITE){var u=n;u.source.fromUser?o=this.applyUserOverwrite_(t,u.path,u.snap,r,i,s):(y.assert(u.source.fromServer,"Unknown source."),a=u.source.tagged||t.getServerCache().isFiltered()&&!u.path.isEmpty(),o=this.applyServerOverwrite_(t,u.path,u.snap,r,i,a,s))}else if(n.type===Je.MERGE){var c=n;c.source.fromUser?o=this.applyUserMerge_(t,c.path,c.children,r,i,s):(y.assert(c.source.fromServer,"Unknown source."),a=c.source.tagged||t.getServerCache().isFiltered(),o=this.applyServerMerge_(t,c.path,c.children,r,i,a,s))}else if(n.type===Je.ACK_USER_WRITE){var l=n;o=l.revert?this.revertUserWrite_(t,l.path,r,i,s):this.ackUserWrite_(t,l.path,l.affectedTree,r,i,s)}else{if(n.type!==Je.LISTEN_COMPLETE)throw y.assertionError("Unknown operation type: "+n.type);o=this.listenComplete_(t,n.path,r,s)}var h=s.getChanges();return e.maybeAddValueEvent_(t,o,h),new Dt(o,h)},e.maybeAddValueEvent_=function(e,t,n){var r=t.getEventCache();if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=e.getCompleteEventSnap();(n.length>0||!e.getEventCache().isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(Tt.valueChange(t.getCompleteEventSnap()))}},e.prototype.generateEventCacheAfterServerEvent_=function(e,t,n,r,i){var o=e.getEventCache();if(null!=n.shadowingWrite(t))return e;var a=void 0,s=void 0;if(t.isEmpty())if(y.assert(e.getServerCache().isFullyInitialized(),"If change path is empty, we must have complete server data"),e.getServerCache().isFiltered()){var u=e.getCompleteServerSnap(),c=u instanceof Ge?u:Ge.EMPTY_NODE,l=n.calcCompleteEventChildren(c);a=this.filter_.updateFullNode(e.getEventCache().getNode(),l,i)}else{var h=n.calcCompleteEventCache(e.getCompleteServerSnap());a=this.filter_.updateFullNode(e.getEventCache().getNode(),h,i)}else{var p=t.getFront();if(".priority"==p){y.assert(1==t.getLength(),"Can't have a priority with additional path components");var f=o.getNode();s=e.getServerCache().getNode();var d=n.calcEventCacheAfterServerOverwrite(t,f,s);a=null!=d?this.filter_.updatePriority(f,d):o.getNode()}else{var m=t.popFront(),g=void 0;if(o.isCompleteForChild(p)){s=e.getServerCache().getNode();var v=n.calcEventCacheAfterServerOverwrite(t,o.getNode(),s);g=null!=v?o.getNode().getImmediateChild(p).updateChild(m,v):o.getNode().getImmediateChild(p)}else g=n.calcCompleteChild(p,e.getServerCache());a=null!=g?this.filter_.updateChild(o.getNode(),p,g,m,r,i):o.getNode()}}return e.updateEventSnap(a,o.isFullyInitialized()||t.isEmpty(),this.filter_.filtersNodes())},e.prototype.applyServerOverwrite_=function(e,t,n,r,i,o,a){var s,u=e.getServerCache(),c=o?this.filter_:this.filter_.getIndexedFilter();if(t.isEmpty())s=c.updateFullNode(u.getNode(),n,null);else if(c.filtersNodes()&&!u.isFiltered()){var l=u.getNode().updateChild(t,n);s=c.updateFullNode(u.getNode(),l,null)}else{var h=t.getFront();if(!u.isCompleteForPath(t)&&t.getLength()>1)return e;var p=t.popFront(),f=u.getNode().getImmediateChild(h).updateChild(p,n);s=".priority"==h?c.updatePriority(u.getNode(),f):c.updateChild(u.getNode(),h,f,p,It,null)}var d=e.updateServerSnap(s,u.isFullyInitialized()||t.isEmpty(),c.filtersNodes()),m=new Nt(r,d,i);return this.generateEventCacheAfterServerEvent_(d,t,r,m,a)},e.prototype.applyUserOverwrite_=function(e,t,n,r,i,o){var a,s,u=e.getEventCache(),c=new Nt(r,e,i);if(t.isEmpty())s=this.filter_.updateFullNode(e.getEventCache().getNode(),n,o),a=e.updateEventSnap(s,!0,this.filter_.filtersNodes());else{var l=t.getFront();if(".priority"===l)s=this.filter_.updatePriority(e.getEventCache().getNode(),n),a=e.updateEventSnap(s,u.isFullyInitialized(),u.isFiltered());else{var h=t.popFront(),p=u.getNode().getImmediateChild(l),f=void 0;if(h.isEmpty())f=n;else{var d=c.getCompleteChild(l);f=null!=d?".priority"===h.getBack()&&d.getChild(h.parent()).isEmpty()?d:d.updateChild(h,n):Ge.EMPTY_NODE}if(p.equals(f))a=e;else{var m=this.filter_.updateChild(u.getNode(),l,f,h,c,o);a=e.updateEventSnap(m,u.isFullyInitialized(),this.filter_.filtersNodes())}}}return a},e.cacheHasChild_=function(e,t){return e.getEventCache().isCompleteForChild(t)},e.prototype.applyUserMerge_=function(t,n,r,i,o,a){var s=this,u=t;return r.foreach(function(r,c){var l=n.child(r);e.cacheHasChild_(t,l.getFront())&&(u=s.applyUserOverwrite_(u,l,c,i,o,a))}),r.foreach(function(r,c){var l=n.child(r);e.cacheHasChild_(t,l.getFront())||(u=s.applyUserOverwrite_(u,l,c,i,o,a))}),u},e.prototype.applyMerge_=function(e,t){return t.foreach(function(t,n){e=e.updateChild(t,n)}),e},e.prototype.applyServerMerge_=function(e,t,n,r,i,o,a){var s=this;if(e.getServerCache().getNode().isEmpty()&&!e.getServerCache().isFullyInitialized())return e;var u,c=e;u=t.isEmpty()?n:vt.Empty.setTree(t,n);var l=e.getServerCache().getNode();return u.children.inorderTraversal(function(t,n){if(l.hasChild(t)){var u=e.getServerCache().getNode().getImmediateChild(t),h=s.applyMerge_(u,n);c=s.applyServerOverwrite_(c,new ie(t),h,r,i,o,a)}}),u.children.inorderTraversal(function(t,n){var u=!e.getServerCache().isCompleteForChild(t)&&null==n.value;if(!l.hasChild(t)&&!u){var h=e.getServerCache().getNode().getImmediateChild(t),p=s.applyMerge_(h,n);c=s.applyServerOverwrite_(c,new ie(t),p,r,i,o,a)}}),c},e.prototype.ackUserWrite_=function(e,t,n,r,i,o){if(null!=r.shadowingWrite(t))return e;var a=e.getServerCache().isFiltered(),s=e.getServerCache();if(null!=n.value){if(t.isEmpty()&&s.isFullyInitialized()||s.isCompleteForPath(t))return this.applyServerOverwrite_(e,t,s.getNode().getChild(t),r,i,a,o);if(t.isEmpty()){var u=vt.Empty;return s.getNode().forEachChild(Re,function(e,t){u=u.set(new ie(e),t)}),this.applyServerMerge_(e,t,u,r,i,a,o)}return e}var c=vt.Empty;return n.foreach(function(e,n){var r=t.child(e);s.isCompleteForPath(r)&&(c=c.set(e,s.getNode().getChild(r)))}),this.applyServerMerge_(e,t,c,r,i,a,o)},e.prototype.listenComplete_=function(e,t,n,r){var i=e.getServerCache(),o=e.updateServerSnap(i.getNode(),i.isFullyInitialized()||t.isEmpty(),i.isFiltered());return this.generateEventCacheAfterServerEvent_(o,t,n,It,r)},e.prototype.revertUserWrite_=function(e,t,n,r,i){var o;if(null!=n.shadowingWrite(t))return e;var a=new Nt(n,e,r),s=e.getEventCache().getNode(),u=void 0;if(t.isEmpty()||".priority"===t.getFront()){var c=void 0;if(e.getServerCache().isFullyInitialized())c=n.calcCompleteEventCache(e.getCompleteServerSnap());else{var l=e.getServerCache().getNode();y.assert(l instanceof Ge,"serverChildren would be complete if leaf node"),c=n.calcCompleteEventChildren(l)}c=c,u=this.filter_.updateFullNode(s,c,i)}else{var h=t.getFront(),p=n.calcCompleteChild(h,e.getServerCache());null==p&&e.getServerCache().isCompleteForChild(h)&&(p=s.getImmediateChild(h)),(u=null!=p?this.filter_.updateChild(s,h,p,t.popFront(),a,i):e.getEventCache().getNode().hasChild(h)?this.filter_.updateChild(s,h,Ge.EMPTY_NODE,t.popFront(),a,i):s).isEmpty()&&e.getServerCache().isFullyInitialized()&&(o=n.calcCompleteEventCache(e.getCompleteServerSnap())).isLeafNode()&&(u=this.filter_.updateFullNode(u,o,i))}return o=e.getServerCache().isFullyInitialized()||null!=n.shadowingWrite(ie.Empty),e.updateEventSnap(u,o,this.filter_.filtersNodes())},e}(),xt=function(){function e(e){this.query_=e,this.index_=this.query_.getQueryParams().getIndex()}return e.prototype.generateEventsForChanges=function(e,t,n){var r=this,i=[],o=[];return e.forEach(function(e){e.type===Tt.CHILD_CHANGED&&r.index_.indexedValueChanged(e.oldSnap,e.snapshotNode)&&o.push(Tt.childMovedChange(e.childName,e.snapshotNode))}),this.generateEventsForType_(i,Tt.CHILD_REMOVED,e,n,t),this.generateEventsForType_(i,Tt.CHILD_ADDED,e,n,t),this.generateEventsForType_(i,Tt.CHILD_MOVED,o,n,t),this.generateEventsForType_(i,Tt.CHILD_CHANGED,e,n,t),this.generateEventsForType_(i,Tt.VALUE,e,n,t),i},e.prototype.generateEventsForType_=function(e,t,n,r,i){var o=this,a=n.filter(function(e){return e.type===t});a.sort(this.compareChanges_.bind(this)),a.forEach(function(t){var n=o.materializeSingleChange_(t,i);r.forEach(function(r){r.respondsTo(t.type)&&e.push(r.createEvent(n,o.query_))})})},e.prototype.materializeSingleChange_=function(e,t){return"value"===e.type||"child_removed"===e.type?e:(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,this.index_),e)},e.prototype.compareChanges_=function(e,t){if(null==e.childName||null==t.childName)throw y.assertionError("Should only compare child_ events.");var n=new xe(e.childName,e.snapshotNode),r=new xe(t.childName,t.snapshotNode);return this.index_.compare(n,r)},e}(),Ot=function(){function e(e,t){this.query_=e,this.eventRegistrations_=[];var n=this.query_.getQueryParams(),r=new St(n.getIndex()),i=n.getNodeFilter();this.processor_=new At(i);var o=t.getServerCache(),a=t.getEventCache(),s=r.updateFullNode(Ge.EMPTY_NODE,o.getNode(),null),u=i.updateFullNode(Ge.EMPTY_NODE,a.getNode(),null),c=new kt(s,o.isFullyInitialized(),r.filtersNodes()),l=new kt(u,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=new Et(l,c),this.eventGenerator_=new xt(this.query_)}return e.prototype.getQuery=function(){return this.query_},e.prototype.getServerCache=function(){return this.viewCache_.getServerCache().getNode()},e.prototype.getCompleteServerCache=function(e){var t=this.viewCache_.getCompleteServerSnap();return t&&(this.query_.getQueryParams().loadsAllData()||!e.isEmpty()&&!t.getImmediateChild(e.getFront()).isEmpty())?t.getChild(e):null},e.prototype.isEmpty=function(){return 0===this.eventRegistrations_.length},e.prototype.addEventRegistration=function(e){this.eventRegistrations_.push(e)},e.prototype.removeEventRegistration=function(e,t){var n=[];if(t){y.assert(null==e,"A cancel should cancel all event registrations.");var r=this.query_.path;this.eventRegistrations_.forEach(function(e){t=t;var i=e.createCancelEvent(t,r);i&&n.push(i)})}if(e){for(var i=[],o=0;o<this.eventRegistrations_.length;++o){var a=this.eventRegistrations_[o];if(a.matches(e)){if(e.hasAnyCallback()){i=i.concat(this.eventRegistrations_.slice(o+1));break}}else i.push(a)}this.eventRegistrations_=i}else this.eventRegistrations_=[];return n},e.prototype.applyOperation=function(e,t,n){e.type===Je.MERGE&&null!==e.source.queryId&&(y.assert(this.viewCache_.getCompleteServerSnap(),"We should always have a full cache before handling merges"),y.assert(this.viewCache_.getCompleteEventSnap(),"Missing event cache, even though we have a server cache"));var r=this.viewCache_,i=this.processor_.applyOperation(r,e,t,n);return this.processor_.assertIndexed(i.viewCache),y.assert(i.viewCache.getServerCache().isFullyInitialized()||!r.getServerCache().isFullyInitialized(),"Once a server snap is complete, it should never go back"),this.viewCache_=i.viewCache,this.generateEventsForChanges_(i.changes,i.viewCache.getEventCache().getNode(),null)},e.prototype.getInitialEvents=function(e){var t=this.viewCache_.getEventCache(),n=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(je,function(e,t){n.push(Tt.childAddedChange(e,t))}),t.isFullyInitialized()&&n.push(Tt.valueChange(t.getNode())),this.generateEventsForChanges_(n,t.getNode(),e)},e.prototype.generateEventsForChanges_=function(e,t,n){var r=n?[n]:this.eventRegistrations_;return this.eventGenerator_.generateEventsForChanges(e,t,r)},e}(),Pt=function(){function e(){this.views_={}}return Object.defineProperty(e,"__referenceConstructor",{get:function(){return y.assert(dt,"Reference.ts has not been loaded"),dt},set:function(e){y.assert(!dt,"__referenceConstructor has already been defined"),dt=e},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){return y.isEmpty(this.views_)},e.prototype.applyOperation=function(e,t,n){var r=e.source.queryId;if(null!==r){var i=y.safeGet(this.views_,r);return y.assert(null!=i,"SyncTree gave us an op for an invalid query."),i.applyOperation(e,t,n)}var o=[];return y.forEach(this.views_,function(r,i){o=o.concat(i.applyOperation(e,t,n))}),o},e.prototype.addEventRegistration=function(e,t,n,r,i){var o=e.queryIdentifier(),a=y.safeGet(this.views_,o);if(!a){var s=n.calcCompleteEventCache(i?r:null),u=!1;s?u=!0:r instanceof Ge?(s=n.calcCompleteEventChildren(r),u=!1):(s=Ge.EMPTY_NODE,u=!1);var c=new Et(new kt(s,u,!1),new kt(r,i,!1));a=new Ot(e,c),this.views_[o]=a}return a.addEventRegistration(t),a.getInitialEvents(t)},e.prototype.removeEventRegistration=function(t,n,r){var i=t.queryIdentifier(),o=[],a=[],s=this.hasCompleteView();if("default"===i){var u=this;y.forEach(this.views_,function(e,t){a=a.concat(t.removeEventRegistration(n,r)),t.isEmpty()&&(delete u.views_[e],t.getQuery().getQueryParams().loadsAllData()||o.push(t.getQuery()))})}else{var c=y.safeGet(this.views_,i);c&&(a=a.concat(c.removeEventRegistration(n,r)),c.isEmpty()&&(delete this.views_[i],c.getQuery().getQueryParams().loadsAllData()||o.push(c.getQuery())))}return s&&!this.hasCompleteView()&&o.push(new e.__referenceConstructor(t.repo,t.path)),{removed:o,events:a}},e.prototype.getQueryViews=function(){var e=this;return Object.keys(this.views_).map(function(t){return e.views_[t]}).filter(function(e){return!e.getQuery().getQueryParams().loadsAllData()})},e.prototype.getCompleteServerCache=function(e){var t=null;return y.forEach(this.views_,function(n,r){t=t||r.getCompleteServerCache(e)}),t},e.prototype.viewForQuery=function(e){if(e.getQueryParams().loadsAllData())return this.getCompleteView();var t=e.queryIdentifier();return y.safeGet(this.views_,t)},e.prototype.viewExistsForQuery=function(e){return null!=this.viewForQuery(e)},e.prototype.hasCompleteView=function(){return null!=this.getCompleteView()},e.prototype.getCompleteView=function(){return y.findValue(this.views_,function(e){return e.getQuery().getQueryParams().loadsAllData()})||null},e}(),Rt=function(){function e(e){this.writeTree_=e}return e.prototype.addWrite=function(t,n){if(t.isEmpty())return new e(new vt(n));var r=this.writeTree_.findRootMostValueAndPath(t);if(null!=r){var i=r.path,o=r.value,a=ie.relativePath(i,t);return o=o.updateChild(a,n),new e(this.writeTree_.set(i,o))}var s=new vt(n);return new e(this.writeTree_.setTree(t,s))},e.prototype.addWrites=function(e,t){var n=this;return y.forEach(t,function(t,r){n=n.addWrite(e.child(t),r)}),n},e.prototype.removeWrite=function(t){return t.isEmpty()?e.Empty:new e(this.writeTree_.setTree(t,vt.Empty))},e.prototype.hasCompleteWrite=function(e){return null!=this.getCompleteNode(e)},e.prototype.getCompleteNode=function(e){var t=this.writeTree_.findRootMostValueAndPath(e);return null!=t?this.writeTree_.get(t.path).getChild(ie.relativePath(t.path,e)):null},e.prototype.getCompleteChildren=function(){var e=[],t=this.writeTree_.value;return null!=t?t.isLeafNode()||t.forEachChild(je,function(t,n){e.push(new xe(t,n))}):this.writeTree_.children.inorderTraversal(function(t,n){null!=n.value&&e.push(new xe(t,n.value))}),e},e.prototype.childCompoundWrite=function(t){if(t.isEmpty())return this;var n=this.getCompleteNode(t);return new e(null!=n?new vt(n):this.writeTree_.subtree(t))},e.prototype.isEmpty=function(){return this.writeTree_.isEmpty()},e.prototype.apply=function(t){return e.applySubtreeWrite_(ie.Empty,this.writeTree_,t)},e.Empty=new e(new vt(null)),e.applySubtreeWrite_=function(t,n,r){if(null!=n.value)return r.updateChild(t,n.value);var i=null;return n.children.inorderTraversal(function(n,o){".priority"===n?(y.assert(null!==o.value,"Priority writes must always be leaf nodes"),i=o.value):r=e.applySubtreeWrite_(t.child(n),o,r)}),r.getChild(t).isEmpty()||null===i||(r=r.updateChild(t.child(".priority"),i)),r},e}(),Lt=function(){function e(){this.visibleWrites_=Rt.Empty,this.allWrites_=[],this.lastWriteId_=-1}return e.prototype.childWrites=function(e){return new Mt(e,this)},e.prototype.addOverwrite=function(e,t,n,r){y.assert(n>this.lastWriteId_,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),this.allWrites_.push({path:e,snap:t,writeId:n,visible:r}),r&&(this.visibleWrites_=this.visibleWrites_.addWrite(e,t)),this.lastWriteId_=n},e.prototype.addMerge=function(e,t,n){y.assert(n>this.lastWriteId_,"Stacking an older merge on top of newer ones"),this.allWrites_.push({path:e,children:t,writeId:n,visible:!0}),this.visibleWrites_=this.visibleWrites_.addWrites(e,t),this.lastWriteId_=n},e.prototype.getWrite=function(e){for(var t=0;t<this.allWrites_.length;t++){var n=this.allWrites_[t];if(n.writeId===e)return n}return null},e.prototype.removeWrite=function(e){var t=this,n=this.allWrites_.findIndex(function(t){return t.writeId===e});y.assert(n>=0,"removeWrite called with nonexistent writeId.");var r=this.allWrites_[n];this.allWrites_.splice(n,1);for(var i=r.visible,o=!1,a=this.allWrites_.length-1;i&&a>=0;){var s=this.allWrites_[a];s.visible&&(a>=n&&this.recordContainsPath_(s,r.path)?i=!1:r.path.contains(s.path)&&(o=!0)),a--}if(i){if(o)return this.resetTree_(),!0;if(r.snap)this.visibleWrites_=this.visibleWrites_.removeWrite(r.path);else{var u=r.children;y.forEach(u,function(e){t.visibleWrites_=t.visibleWrites_.removeWrite(r.path.child(e))})}return!0}return!1},e.prototype.getCompleteWriteData=function(e){return this.visibleWrites_.getCompleteNode(e)},e.prototype.calcCompleteEventCache=function(t,n,r,i){if(r||i){var o=this.visibleWrites_.childCompoundWrite(t);if(!i&&o.isEmpty())return n;if(i||null!=n||o.hasCompleteWrite(ie.Empty)){var a=function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(e.path.contains(t)||t.contains(e.path))},s=e.layerTree_(this.allWrites_,a,t),u=n||Ge.EMPTY_NODE;return s.apply(u)}return null}var c=this.visibleWrites_.getCompleteNode(t);if(null!=c)return c;var l=this.visibleWrites_.childCompoundWrite(t);return l.isEmpty()?n:null!=n||l.hasCompleteWrite(ie.Empty)?(u=n||Ge.EMPTY_NODE,l.apply(u)):null},e.prototype.calcCompleteEventChildren=function(e,t){var n=Ge.EMPTY_NODE,r=this.visibleWrites_.getCompleteNode(e);if(r)return r.isLeafNode()||r.forEachChild(je,function(e,t){n=n.updateImmediateChild(e,t)}),n;if(t){var i=this.visibleWrites_.childCompoundWrite(e);return t.forEachChild(je,function(e,t){var r=i.childCompoundWrite(new ie(e)).apply(t);n=n.updateImmediateChild(e,r)}),i.getCompleteChildren().forEach(function(e){n=n.updateImmediateChild(e.name,e.node)}),n}return this.visibleWrites_.childCompoundWrite(e).getCompleteChildren().forEach(function(e){n=n.updateImmediateChild(e.name,e.node)}),n},e.prototype.calcEventCacheAfterServerOverwrite=function(e,t,n,r){y.assert(n||r,"Either existingEventSnap or existingServerSnap must exist");var i=e.child(t);if(this.visibleWrites_.hasCompleteWrite(i))return null;var o=this.visibleWrites_.childCompoundWrite(i);return o.isEmpty()?r.getChild(t):o.apply(r.getChild(t))},e.prototype.calcCompleteChild=function(e,t,n){var r=e.child(t),i=this.visibleWrites_.getCompleteNode(r);return null!=i?i:n.isCompleteForChild(t)?this.visibleWrites_.childCompoundWrite(r).apply(n.getNode().getImmediateChild(t)):null},e.prototype.shadowingWrite=function(e){return this.visibleWrites_.getCompleteNode(e)},e.prototype.calcIndexedSlice=function(e,t,n,r,i,o){var a,s=this.visibleWrites_.childCompoundWrite(e),u=s.getCompleteNode(ie.Empty);if(null!=u)a=u;else{if(null==t)return[];a=s.apply(t)}if((a=a.withIndex(o)).isEmpty()||a.isLeafNode())return[];for(var c=[],l=o.getCompare(),h=i?a.getReverseIteratorFrom(n,o):a.getIteratorFrom(n,o),p=h.getNext();p&&c.length<r;)0!==l(p,n)&&c.push(p),p=h.getNext();return c},e.prototype.recordContainsPath_=function(e,t){return e.snap?e.path.contains(t):!!y.findKey(e.children,function(n,r){return e.path.child(r).contains(t)})},e.prototype.resetTree_=function(){this.visibleWrites_=e.layerTree_(this.allWrites_,e.DefaultFilter_,ie.Empty),this.allWrites_.length>0?this.lastWriteId_=this.allWrites_[this.allWrites_.length-1].writeId:this.lastWriteId_=-1},e.DefaultFilter_=function(e){return e.visible},e.layerTree_=function(e,t,n){for(var r=Rt.Empty,i=0;i<e.length;++i){var o=e[i];if(t(o)){var a=o.path,s=void 0;if(o.snap)n.contains(a)?(s=ie.relativePath(n,a),r=r.addWrite(s,o.snap)):a.contains(n)&&(s=ie.relativePath(a,n),r=r.addWrite(ie.Empty,o.snap.getChild(s)));else{if(!o.children)throw y.assertionError("WriteRecord should have .snap or .children");if(n.contains(a))s=ie.relativePath(n,a),r=r.addWrites(s,o.children);else if(a.contains(n))if((s=ie.relativePath(a,n)).isEmpty())r=r.addWrites(ie.Empty,o.children);else{var u=y.safeGet(o.children,s.getFront());if(u){var c=u.getChild(s.popFront());r=r.addWrite(ie.Empty,c)}}}}}return r},e}(),Mt=function(){function e(e,t){this.treePath_=e,this.writeTree_=t}return e.prototype.calcCompleteEventCache=function(e,t,n){return this.writeTree_.calcCompleteEventCache(this.treePath_,e,t,n)},e.prototype.calcCompleteEventChildren=function(e){return this.writeTree_.calcCompleteEventChildren(this.treePath_,e)},e.prototype.calcEventCacheAfterServerOverwrite=function(e,t,n){return this.writeTree_.calcEventCacheAfterServerOverwrite(this.treePath_,e,t,n)},e.prototype.shadowingWrite=function(e){return this.writeTree_.shadowingWrite(this.treePath_.child(e))},e.prototype.calcIndexedSlice=function(e,t,n,r,i){return this.writeTree_.calcIndexedSlice(this.treePath_,e,t,n,r,i)},e.prototype.calcCompleteChild=function(e,t){return this.writeTree_.calcCompleteChild(this.treePath_,e,t)},e.prototype.child=function(t){return new e(this.treePath_.child(t),this.writeTree_)},e}(),Vt=function(){function e(e){this.listenProvider_=e,this.syncPointTree_=vt.Empty,this.pendingWriteTree_=new Lt,this.tagToQueryMap_={},this.queryToTagMap_={}}return e.prototype.applyUserOverwrite=function(e,t,n,r){return this.pendingWriteTree_.addOverwrite(e,t,n,r),r?this.applyOperationToSyncPoints_(new _t(mt.User,e,t)):[]},e.prototype.applyUserMerge=function(e,t,n){this.pendingWriteTree_.addMerge(e,t,n);var r=vt.fromObject(t);return this.applyOperationToSyncPoints_(new wt(mt.User,e,r))},e.prototype.ackUserWrite=function(e,t){void 0===t&&(t=!1);var n=this.pendingWriteTree_.getWrite(e);if(this.pendingWriteTree_.removeWrite(e)){var r=vt.Empty;return null!=n.snap?r=r.set(ie.Empty,!0):y.forEach(n.children,function(e,t){r=r.set(new ie(e),t)}),this.applyOperationToSyncPoints_(new gt(n.path,r,t))}return[]},e.prototype.applyServerOverwrite=function(e,t){return this.applyOperationToSyncPoints_(new _t(mt.Server,e,t))},e.prototype.applyServerMerge=function(e,t){var n=vt.fromObject(t);return this.applyOperationToSyncPoints_(new wt(mt.Server,e,n))},e.prototype.applyListenComplete=function(e){return this.applyOperationToSyncPoints_(new bt(mt.Server,e))},e.prototype.applyTaggedQueryOverwrite=function(t,n,r){var i=this.queryKeyForTag_(r);if(null!=i){var o=e.parseQueryKey_(i),a=o.path,s=o.queryId,u=ie.relativePath(a,t),c=new _t(mt.forServerTaggedQuery(s),u,n);return this.applyTaggedOperation_(a,c)}return[]},e.prototype.applyTaggedQueryMerge=function(t,n,r){var i=this.queryKeyForTag_(r);if(i){var o=e.parseQueryKey_(i),a=o.path,s=o.queryId,u=ie.relativePath(a,t),c=vt.fromObject(n),l=new wt(mt.forServerTaggedQuery(s),u,c);return this.applyTaggedOperation_(a,l)}return[]},e.prototype.applyTaggedListenComplete=function(t,n){var r=this.queryKeyForTag_(n);if(r){var i=e.parseQueryKey_(r),o=i.path,a=i.queryId,s=ie.relativePath(o,t),u=new bt(mt.forServerTaggedQuery(a),s);return this.applyTaggedOperation_(o,u)}return[]},e.prototype.addEventRegistration=function(t,n){var r=t.path,i=null,o=!1;this.syncPointTree_.foreachOnPath(r,function(e,t){var n=ie.relativePath(e,r);i=i||t.getCompleteServerCache(n),o=o||t.hasCompleteView()});var a=this.syncPointTree_.get(r);a?(o=o||a.hasCompleteView(),i=i||a.getCompleteServerCache(ie.Empty)):(a=new Pt,this.syncPointTree_=this.syncPointTree_.set(r,a));var s;null!=i?s=!0:(s=!1,i=Ge.EMPTY_NODE,this.syncPointTree_.subtree(r).foreachChild(function(e,t){var n=t.getCompleteServerCache(ie.Empty);n&&(i=i.updateImmediateChild(e,n))}));var u=a.viewExistsForQuery(t);if(!u&&!t.getQueryParams().loadsAllData()){var c=e.makeQueryKey_(t);y.assert(!(c in this.queryToTagMap_),"View does not exist, but we have a tag");var l=e.getNextQueryTag_();this.queryToTagMap_[c]=l,this.tagToQueryMap_["_"+l]=c}var h=this.pendingWriteTree_.childWrites(r),p=a.addEventRegistration(t,n,h,i,s);if(!u&&!o){var f=a.viewForQuery(t);p=p.concat(this.setupListener_(t,f))}return p},e.prototype.removeEventRegistration=function(t,n,r){var i=this,o=t.path,a=this.syncPointTree_.get(o),s=[];if(a&&("default"===t.queryIdentifier()||a.viewExistsForQuery(t))){var u=a.removeEventRegistration(t,n,r);a.isEmpty()&&(this.syncPointTree_=this.syncPointTree_.remove(o));var c=u.removed;s=u.events;var l=-1!==c.findIndex(function(e){return e.getQueryParams().loadsAllData()}),h=this.syncPointTree_.findOnPath(o,function(e,t){return t.hasCompleteView()});if(l&&!h){var p=this.syncPointTree_.subtree(o);if(!p.isEmpty())for(var f=this.collectDistinctViewsForSubTree_(p),d=0;d<f.length;++d){var m=f[d],g=m.getQuery(),y=this.createListenerForView_(m);this.listenProvider_.startListening(e.queryForListening_(g),this.tagForQuery_(g),y.hashFn,y.onComplete)}}!h&&c.length>0&&!r&&(l?this.listenProvider_.stopListening(e.queryForListening_(t),null):c.forEach(function(t){var n=i.queryToTagMap_[e.makeQueryKey_(t)];i.listenProvider_.stopListening(e.queryForListening_(t),n)})),this.removeTags_(c)}return s},e.prototype.calcCompleteEventCache=function(e,t){var n=this.pendingWriteTree_,r=this.syncPointTree_.findOnPath(e,function(t,n){var r=ie.relativePath(t,e),i=n.getCompleteServerCache(r);if(i)return i});return n.calcCompleteEventCache(e,r,t,!0)},e.prototype.collectDistinctViewsForSubTree_=function(e){return e.fold(function(e,t,n){if(t&&t.hasCompleteView())return[t.getCompleteView()];var r=[];return t&&(r=t.getQueryViews()),y.forEach(n,function(e,t){r=r.concat(t)}),r})},e.prototype.removeTags_=function(t){for(var n=0;n<t.length;++n){var r=t[n];if(!r.getQueryParams().loadsAllData()){var i=e.makeQueryKey_(r),o=this.queryToTagMap_[i];delete this.queryToTagMap_[i],delete this.tagToQueryMap_["_"+o]}}},e.queryForListening_=function(e){return e.getQueryParams().loadsAllData()&&!e.getQueryParams().isDefault()?e.getRef():e},e.prototype.setupListener_=function(t,n){var r=t.path,i=this.tagForQuery_(t),o=this.createListenerForView_(n),a=this.listenProvider_.startListening(e.queryForListening_(t),i,o.hashFn,o.onComplete),s=this.syncPointTree_.subtree(r);if(i)y.assert(!s.value.hasCompleteView(),"If we're adding a query, it shouldn't be shadowed");else for(var u=s.fold(function(e,t,n){if(!e.isEmpty()&&t&&t.hasCompleteView())return[t.getCompleteView().getQuery()];var r=[];return t&&(r=r.concat(t.getQueryViews().map(function(e){return e.getQuery()}))),y.forEach(n,function(e,t){r=r.concat(t)}),r}),c=0;c<u.length;++c){var l=u[c];this.listenProvider_.stopListening(e.queryForListening_(l),this.tagForQuery_(l))}return a},e.prototype.createListenerForView_=function(e){var t=this,n=e.getQuery(),r=this.tagForQuery_(n);return{hashFn:function(){return(e.getServerCache()||Ge.EMPTY_NODE).hash()},onComplete:function(e){if("ok"===e)return r?t.applyTaggedListenComplete(n.path,r):t.applyListenComplete(n.path);var i=J(e,n);return t.removeEventRegistration(n,null,i)}}},e.makeQueryKey_=function(e){return e.path.toString()+"$"+e.queryIdentifier()},e.parseQueryKey_=function(e){var t=e.indexOf("$");return y.assert(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new ie(e.substr(0,t))}},e.prototype.queryKeyForTag_=function(e){return this.tagToQueryMap_["_"+e]},e.prototype.tagForQuery_=function(t){var n=e.makeQueryKey_(t);return y.safeGet(this.queryToTagMap_,n)},e.getNextQueryTag_=function(){return e.nextQueryTag_++},e.prototype.applyTaggedOperation_=function(e,t){var n=this.syncPointTree_.get(e);y.assert(n,"Missing sync point for query tag that we're tracking");var r=this.pendingWriteTree_.childWrites(e);return n.applyOperation(t,r,null)},e.prototype.applyOperationToSyncPoints_=function(e){return this.applyOperationHelper_(e,this.syncPointTree_,null,this.pendingWriteTree_.childWrites(ie.Empty))},e.prototype.applyOperationHelper_=function(e,t,n,r){if(e.path.isEmpty())return this.applyOperationDescendantsHelper_(e,t,n,r);var i=t.get(ie.Empty);null==n&&null!=i&&(n=i.getCompleteServerCache(ie.Empty));var o=[],a=e.path.getFront(),s=e.operationForChild(a),u=t.children.get(a);if(u&&s){var c=n?n.getImmediateChild(a):null,l=r.child(a);o=o.concat(this.applyOperationHelper_(s,u,c,l))}return i&&(o=o.concat(i.applyOperation(e,r,n))),o},e.prototype.applyOperationDescendantsHelper_=function(e,t,n,r){var i=this,o=t.get(ie.Empty);null==n&&null!=o&&(n=o.getCompleteServerCache(ie.Empty));var a=[];return t.children.inorderTraversal(function(t,o){var s=n?n.getImmediateChild(t):null,u=r.child(t),c=e.operationForChild(t);c&&(a=a.concat(i.applyOperationDescendantsHelper_(c,o,s,u)))}),o&&(a=a.concat(o.applyOperation(e,r,n))),a},e.nextQueryTag_=1,e}(),jt=function(){function e(){this.rootNode_=Ge.EMPTY_NODE}return e.prototype.getNode=function(e){return this.rootNode_.getChild(e)},e.prototype.updateSnapshot=function(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)},e}(),Ut=function(){function e(e){this.app_=e}return e.prototype.getToken=function(e){return this.app_.INTERNAL.getToken(e).then(null,function(e){return e&&"auth/token-not-initialized"===e.code?(P("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)})},e.prototype.addTokenChangeListener=function(e){this.app_.INTERNAL.addAuthTokenListener(e)},e.prototype.removeTokenChangeListener=function(e){this.app_.INTERNAL.removeAuthTokenListener(e)},e.prototype.notifyForInvalidToken=function(){var e='Provided authentication credentials for the app named "'+this.app_.name+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.app_.options?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.app_.options?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',V(e)},e}(),qt=function(){function e(){this.counters_={}}return e.prototype.incrementCounter=function(e,t){void 0===t&&(t=1),y.contains(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t},e.prototype.get=function(){return y.deepCopy(this.counters_)},e}(),Ft=function(){function e(){}return e.getCollection=function(e){var t=e.toString();return this.collections_[t]||(this.collections_[t]=new qt),this.collections_[t]},e.getOrCreateReporter=function(e,t){var n=e.toString();return this.reporters_[n]||(this.reporters_[n]=t()),this.reporters_[n]},e.collections_={},e.reporters_={},e}(),Bt=function(){function e(e){this.collection_=e,this.last_=null}return e.prototype.get=function(){var e=this.collection_.get(),t=y.clone(e);return this.last_&&y.forEach(this.last_,function(e,n){t[e]=t[e]-n}),this.last_=e,t},e}(),Kt=1e4,Wt=3e4,Ht=function(){function e(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Bt(e);var n=Kt+(Wt-Kt)*Math.random();re(this.reportStats_.bind(this),Math.floor(n))}return e.prototype.includeStat=function(e){this.statsToReport_[e]=!0},e.prototype.reportStats_=function(){var e=this,t=this.statsListener_.get(),n={},r=!1;y.forEach(t,function(t,i){i>0&&y.contains(e.statsToReport_,t)&&(n[t]=i,r=!0)}),r&&this.server_.reportStats(n),re(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},e}(),zt=function(){function e(){this.eventLists_=[],this.recursionDepth_=0}return e.prototype.queueEvents=function(e){for(var t=null,n=0;n<e.length;n++){var r=e[n],i=r.getPath();null===t||i.equals(t.getPath())||(this.eventLists_.push(t),t=null),null===t&&(t=new Qt(i)),t.add(r)}t&&this.eventLists_.push(t)},e.prototype.raiseEventsAtPath=function(e,t){this.queueEvents(t),this.raiseQueuedEventsMatchingPredicate_(function(t){return t.equals(e)})},e.prototype.raiseEventsForChangedPath=function(e,t){this.queueEvents(t),this.raiseQueuedEventsMatchingPredicate_(function(t){return t.contains(e)||e.contains(t)})},e.prototype.raiseQueuedEventsMatchingPredicate_=function(e){this.recursionDepth_++;for(var t=!0,n=0;n<this.eventLists_.length;n++){var r=this.eventLists_[n];r&&(e(r.getPath())?(this.eventLists_[n].raise(),this.eventLists_[n]=null):t=!1)}t&&(this.eventLists_=[]),this.recursionDepth_--},e}(),Qt=function(){function e(e){this.path_=e,this.events_=[]}return e.prototype.add=function(e){this.events_.push(e)},e.prototype.raise=function(){for(var e=0;e<this.events_.length;e++){var t=this.events_[e];if(null!==t){this.events_[e]=null;var n=t.getEventRunner();A&&P("event: "+t.toString()),te(n)}}},e.prototype.getPath=function(){return this.path_},e}(),Gt=function(){function e(e){this.allowedEvents_=e,this.listeners_={},y.assert(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}return e.prototype.trigger=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(Array.isArray(this.listeners_[e]))for(var r=this.listeners_[e].slice(),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)},e.prototype.on=function(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});var r=this.getInitialEvent(e);r&&t.apply(n,r)},e.prototype.off=function(e,t,n){this.validateEventType_(e);for(var r=this.listeners_[e]||[],i=0;i<r.length;i++)if(r[i].callback===t&&(!n||n===r[i].context))return void r.splice(i,1)},e.prototype.validateEventType_=function(e){y.assert(this.allowedEvents_.find(function(t){return t===e}),"Unknown event: "+e)},e}(),Xt=function(e){function t(){var t,n,r=e.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(n="visibilitychange",t="hidden"):void 0!==document.mozHidden?(n="mozvisibilitychange",t="mozHidden"):void 0!==document.msHidden?(n="msvisibilitychange",t="msHidden"):void 0!==document.webkitHidden&&(n="webkitvisibilitychange",t="webkitHidden")),r.visible_=!0,n&&document.addEventListener(n,function(){var e=!document[t];e!==r.visible_&&(r.visible_=e,r.trigger("visible",e))},!1),r}return b.__extends(t,e),t.getInstance=function(){return new t},t.prototype.getInitialEvent=function(e){return y.assert("visible"===e,"Unknown event type: "+e),[this.visible_]},t}(Gt),Yt=function(e){function t(){var t=e.call(this,["online"])||this;return t.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||y.isMobileCordova()||(window.addEventListener("online",function(){t.online_||(t.online_=!0,t.trigger("online",!0))},!1),window.addEventListener("offline",function(){t.online_&&(t.online_=!1,t.trigger("online",!1))},!1)),t}return b.__extends(t,e),t.getInstance=function(){return new t},t.prototype.getInitialEvent=function(e){return y.assert("online"===e,"Unknown event type: "+e),[this.online_]},t.prototype.currentlyOnline=function(){return this.online_},t}(Gt),$t=function(){function e(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return e.prototype.closeAfter=function(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},e.prototype.handleResponse=function(e,t){var n=this;this.pendingResponses[e]=t;for(var r=this;this.pendingResponses[this.currentResponseNum]&&"break"!==function(){var e=r.pendingResponses[r.currentResponseNum];delete r.pendingResponses[r.currentResponseNum];for(var t=0;t<e.length;++t)!function(t){e[t]&&te(function(){n.onMessage_(e[t])})}(t);if(r.currentResponseNum===r.closeAfterResponse)return r.onClose&&(r.onClose(),r.onClose=null),"break";r.currentResponseNum++}(););},e}(),Jt="pLPCommand",Zt="pRTLPCB",en=function(){function e(e,t,n,r){this.connId=e,this.repoInfo=t,this.transportSessionId=n,this.lastSessionId=r,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=R(e),this.stats_=Ft.getCollection(t),this.urlFn=function(e){return t.connectionURL(ae,e)}}return e.prototype.open=function(e,t){var n=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new $t(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null},Math.floor(3e4)),q(function(){if(!n.isClosed_){n.scriptTagHolder=new tn(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e[0],i=e[1],o=e[2];if(n.incrementIncomingBytes_(e),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,"start"==r)n.id=i,n.password=o;else{if("close"!==r)throw new Error("Unrecognized command received: "+r);i?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(i,function(){n.onClosed_()})):n.onClosed_()}},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e[0],i=e[1];n.incrementIncomingBytes_(e),n.myPacketOrderer.handleResponse(r,i)},function(){n.onClosed_()},n.urlFn);var e={};e.start="t",e.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=n.scriptTagHolder.uniqueCallbackIdentifier),e.v="5",n.transportSessionId&&(e.s=n.transportSessionId),n.lastSessionId&&(e.ls=n.lastSessionId),!y.isNodeSdk()&&"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf("firebaseio.com")&&(e.r="f");var t=n.urlFn(e);n.log_("Connecting via long-poll to "+t),n.scriptTagHolder.addTag(t,function(){})}})},e.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},e.forceAllow=function(){e.forceAllow_=!0},e.forceDisallow=function(){e.forceDisallow_=!0},e.isAvailable=function(){return e.forceAllow_||!e.forceDisallow_&&"undefined"!=typeof document&&null!=document.createElement&&!Y()&&!$()&&!y.isNodeSdk()},e.prototype.markConnectionHealthy=function(){},e.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},e.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},e.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},e.prototype.send=function(e){var t=y.stringify(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);for(var n=y.base64Encode(t),r=Q(n,1840),i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++},e.prototype.addDisconnectPingFrame=function(e,t){if(!y.isNodeSdk()){this.myDisconnFrame=document.createElement("iframe");var n={};n.dframe="t",n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},e.prototype.incrementIncomingBytes_=function(e){var t=y.stringify(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)},e}(),tn=function(){function e(t,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new st,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,y.isNodeSdk())this.commandCB=t,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=I(),window[Jt+this.uniqueCallbackIdentifier]=t,window[Zt+this.uniqueCallbackIdentifier]=n,this.myIFrame=e.createIFrame_();var o="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(o='<script>document.domain="'+document.domain+'";<\/script>');var a="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(e){P("frame writing exception"),e.stack&&P(e.stack),P(e)}}}return e.createIFrame_=function(){var e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||P("No IE domain setting required")}catch(n){var t=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+t+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e},e.prototype.close=function(){var t=this;if(this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(function(){null!==t.myIFrame&&(document.body.removeChild(t.myIFrame),t.myIFrame=null)},Math.floor(0))),y.isNodeSdk()&&this.myID){var n={};n.disconn="t",n.id=this.myID,n.pw=this.myPW;var r=this.urlFn(n);e.nodeRestRequest(r)}var i=this.onDisconnect;i&&(this.onDisconnect=null,i())},e.prototype.startLongPoll=function(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););},e.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.count()<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;for(var t=this.urlFn(e),n="",r=0;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+n.length<=1870;){var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1},e.prototype.enqueueSegment=function(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()},e.prototype.addLongPollTag_=function(e,t){var n=this;this.outstandingRequests.add(t,1);var r=function(){n.outstandingRequests.remove(t),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,function(){clearTimeout(i),r()})},e.prototype.addTag=function(e,t){var n=this;y.isNodeSdk()?this.doNodeLongPoll(e,t):setTimeout(function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){var e=r.readyState;e&&"loaded"!==e&&"complete"!==e||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=function(){P("Long-poll script failed to load: "+e),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(e){}},Math.floor(1))},e}(),nn=null;"undefined"!=typeof MozWebSocket?nn=MozWebSocket:"undefined"!=typeof WebSocket&&(nn=WebSocket);var rn=function(){function e(t,n,r,i){this.connId=t,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=R(this.connId),this.stats_=Ft.getCollection(n),this.connURL=e.connectionURL_(n,r,i)}return e.connectionURL_=function(e,t,n){var r={};return r.v="5",!y.isNodeSdk()&&"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf("firebaseio.com")&&(r.r="f"),t&&(r.s=t),n&&(r.ls=n),e.connectionURL("websocket",r)},e.prototype.open=function(e,t){var n=this;this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,T.set("previous_websocket_failure",!0);try{if(y.isNodeSdk()){var r=y.CONSTANTS.NODE_ADMIN?"AdminNode":"Node",i={headers:{"User-Agent":"Firebase/5/"+_.SDK_VERSION+"/"+process.platform+"/"+r}},o=process.env,a=0==this.connURL.indexOf("wss://")?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a}),this.mySock=new nn(this.connURL,[],i)}else this.mySock=new nn(this.connURL)}catch(e){this.log_("Error instantiating WebSocket.");var s=e.message||e.data;return s&&this.log_(s),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(e){n.handleIncomingFrame(e)},this.mySock.onerror=function(e){n.log_("WebSocket error.  Closing connection.");var t=e.message||e.data;t&&n.log_(t),n.onClosed_()}},e.prototype.start=function(){},e.forceDisallow=function(){e.forceDisallow_=!0},e.isAvailable=function(){var t=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(t=!0)}return!t&&null!==nn&&!e.forceDisallow_},e.previouslyFailed=function(){return T.isInMemoryStorage||!0===T.get("previous_websocket_failure")},e.prototype.markConnectionHealthy=function(){T.remove("previous_websocket_failure")},e.prototype.appendFrame_=function(e){if(this.frames.push(e),this.frames.length==this.totalFrames){var t=this.frames.join("");this.frames=null;var n=y.jsonEval(t);this.onMessage(n)}},e.prototype.handleNewFrameCount_=function(e){this.totalFrames=e,this.frames=[]},e.prototype.extractFrameCount_=function(e){if(y.assert(null===this.frames,"We already have a frame buffer"),e.length<=6){var t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e},e.prototype.handleIncomingFrame=function(e){if(null!==this.mySock){var t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{var n=this.extractFrameCount_(t);null!==n&&this.appendFrame_(n)}}},e.prototype.send=function(e){this.resetKeepAlive();var t=y.stringify(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);var n=Q(t,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])},e.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},e.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},e.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},e.prototype.resetKeepAlive=function(){var e=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(function(){e.mySock&&e.sendString_("0"),e.resetKeepAlive()},Math.floor(45e3))},e.prototype.sendString_=function(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},e.responsesRequiredToBeHealthy=2,e.healthyTimeout=3e4,e}(),on=function(){function e(e){this.initTransports_(e)}return Object.defineProperty(e,"ALL_TRANSPORTS",{get:function(){return[en,rn]},enumerable:!0,configurable:!0}),e.prototype.initTransports_=function(t){var n=rn&&rn.isAvailable(),r=n&&!rn.previouslyFailed();if(t.webSocketOnly&&(n||V("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[rn];else{var i=this.transports_=[];G(e.ALL_TRANSPORTS,function(e,t){t&&t.isAvailable()&&i.push(t)})}},e.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},e.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},e}(),an=function(){function e(e,t,n,r,i,o,a){this.id=e,this.repoInfo_=t,this.onMessage_=n,this.onReady_=r,this.onDisconnect_=i,this.onKill_=o,this.lastSessionId=a,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=R("c:"+this.id+":"),this.transportManager_=new on(t),this.log_("Connection created"),this.start_()}return e.prototype.start_=function(){var e=this,t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,void 0,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(function(){e.conn_&&e.conn_.open(n,r)},Math.floor(0));var i=t.healthyTimeout||0;i>0&&(this.healthyTimeout_=re(function(){e.healthyTimeout_=null,e.isHealthy_||(e.conn_&&e.conn_.bytesReceived>102400?(e.log_("Connection exceeded healthy timeout but has received "+e.conn_.bytesReceived+" bytes.  Marking connection healthy."),e.isHealthy_=!0,e.conn_.markConnectionHealthy()):e.conn_&&e.conn_.bytesSent>10240?e.log_("Connection exceeded healthy timeout but has sent "+e.conn_.bytesSent+" bytes.  Leaving connection alive."):(e.log_("Closing unhealthy connection after timeout."),e.close()))},Math.floor(i)))},e.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},e.prototype.disconnReceiver_=function(e){var t=this;return function(n){e===t.conn_?t.onConnectionLost_(n):e===t.secondaryConn_?(t.log_("Secondary connection lost."),t.onSecondaryConnectionLost_()):t.log_("closing an old connection")}},e.prototype.connReceiver_=function(e){var t=this;return function(n){2!=t.state_&&(e===t.rx_?t.onPrimaryMessageReceived_(n):e===t.secondaryConn_?t.onSecondaryMessageReceived_(n):t.log_("message on old connection"))}},e.prototype.sendRequest=function(e){var t={t:"d",d:e};this.sendData_(t)},e.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},e.prototype.onSecondaryControl_=function(e){if("t"in e){var t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},e.prototype.onSecondaryMessageReceived_=function(e){var t=H("t",e),n=H("d",e);if("c"==t)this.onSecondaryControl_(n);else{if("d"!=t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}},e.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},e.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},e.prototype.onPrimaryMessageReceived_=function(e){var t=H("t",e),n=H("d",e);"c"==t?this.onControl_(n):"d"==t&&this.onDataMessage_(n)},e.prototype.onDataMessage_=function(e){this.onPrimaryResponse_(),this.onMessage_(e)},e.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},e.prototype.onControl_=function(e){var t=H("t",e);if("d"in e){var n=e.d;if("h"===t)this.onHandshake_(n);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?L("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):L("Unknown control packet command: "+t)}},e.prototype.onHandshake_=function(e){var t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.updateHost(r),0==this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==n&&V("Protocol version mismatch detected"),this.tryStartUpgrade_())},e.prototype.tryStartUpgrade_=function(){var e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)},e.prototype.startUpgrade_=function(e){var t=this;this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),re(function(){t.secondaryConn_&&(t.log_("Timed out trying to upgrade."),t.secondaryConn_.close())},Math.floor(6e4))},e.prototype.onReset_=function(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.updateHost(e),1===this.state_?this.close():(this.closeConnections_(),this.start_())},e.prototype.onConnectionEstablished_=function(e,t){var n=this;this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):re(function(){n.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))},e.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},e.prototype.onSecondaryConnectionLost_=function(){var e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()},e.prototype.onConnectionLost_=function(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(T.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},e.prototype.onConnectionShutdown_=function(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()},e.prototype.sendData_=function(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)},e.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},e.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},e}(),sn=function(){function e(){}return e.prototype.put=function(e,t,n,r){},e.prototype.merge=function(e,t,n,r){},e.prototype.refreshAuthToken=function(e){},e.prototype.onDisconnectPut=function(e,t,n){},e.prototype.onDisconnectMerge=function(e,t,n){},e.prototype.onDisconnectCancel=function(e,t){},e.prototype.reportStats=function(e){},e}(),un=1e3,cn=3e5,ln=function(e){function t(n,r,i,o,a,s){var u=e.call(this)||this;if(u.repoInfo_=n,u.onDataUpdate_=r,u.onConnectStatus_=i,u.onServerInfoUpdate_=o,u.authTokenProvider_=a,u.authOverride_=s,u.id=t.nextPersistentConnectionId_++,u.log_=R("p:"+u.id+":"),u.interruptReasons_={},u.listens_={},u.outstandingPuts_=[],u.outstandingPutCount_=0,u.onDisconnectRequestQueue_=[],u.connected_=!1,u.reconnectDelay_=un,u.maxReconnectDelay_=cn,u.securityDebugCallback_=null,u.lastSessionId=null,u.establishConnectionTimer_=null,u.visible_=!1,u.requestCBHash_={},u.requestNumber_=0,u.realtime_=null,u.authToken_=null,u.forceTokenRefresh_=!1,u.invalidAuthTokenCount_=0,u.firstConnection_=!0,u.lastConnectionAttemptTime_=null,u.lastConnectionEstablishedTime_=null,s&&!y.isNodeSdk())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return u.scheduleConnect_(0),Xt.getInstance().on("visible",u.onVisible_,u),-1===n.host.indexOf("fblocal")&&Yt.getInstance().on("online",u.onOnline_,u),u}return b.__extends(t,e),t.prototype.sendRequest=function(e,t,n){var r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_(y.stringify(i)),y.assert(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)},t.prototype.listen=function(e,t,n,r){var i=e.queryIdentifier(),o=e.path.toString();this.log_("Listen called for "+o+" "+i),this.listens_[o]=this.listens_[o]||{},y.assert(e.getQueryParams().isDefault()||!e.getQueryParams().loadsAllData(),"listen() called for non-default but complete query"),y.assert(!this.listens_[o][i],"listen() called twice for same path/queryId.");var a={onComplete:r,hashFn:t,query:e,tag:n};this.listens_[o][i]=a,this.connected_&&this.sendListen_(a)},t.prototype.sendListen_=function(e){var n=this,r=e.query,i=r.path.toString(),o=r.queryIdentifier();this.log_("Listen on "+i+" for "+o);var a={p:i};e.tag&&(a.q=r.queryObject(),a.t=e.tag),a.h=e.hashFn(),this.sendRequest("q",a,function(a){var s=a.d,u=a.s;t.warnOnListenWarnings_(s,r),(n.listens_[i]&&n.listens_[i][o])===e&&(n.log_("listen response",a),"ok"!==u&&n.removeListen_(i,o),e.onComplete&&e.onComplete(u,s))})},t.warnOnListenWarnings_=function(e,t){if(e&&"object"==typeof e&&y.contains(e,"w")){var n=y.safeGet(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+t.getQueryParams().getIndex().toString()+'"',i=t.path.toString();V("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+i+" to your security rules for better performance.")}}},t.prototype.refreshAuthToken=function(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},function(){}),this.reduceReconnectDelayIfAdminCredential_(e)},t.prototype.reduceReconnectDelayIfAdminCredential_=function(e){(e&&40===e.length||y.isAdmin(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},t.prototype.tryAuth=function(){var e=this;if(this.connected_&&this.authToken_){var t=this.authToken_,n=y.isValidFormat(t)?"auth":"gauth",r={cred:t};null===this.authOverride_?r.noauth=!0:"object"==typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(n,r,function(n){var r=n.s,i=n.d||"error";e.authToken_===t&&("ok"===r?e.invalidAuthTokenCount_=0:e.onAuthRevoked_(r,i))})}},t.prototype.unlisten=function(e,t){var n=e.path.toString(),r=e.queryIdentifier();this.log_("Unlisten called for "+n+" "+r),y.assert(e.getQueryParams().isDefault()||!e.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e.queryObject(),t)},t.prototype.sendUnlisten_=function(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);var i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)},t.prototype.onDisconnectPut=function(e,t,n){this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})},t.prototype.onDisconnectMerge=function(e,t,n){this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})},t.prototype.onDisconnectCancel=function(e,t){this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})},t.prototype.sendOnDisconnect_=function(e,t,n,r){var i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,function(e){r&&setTimeout(function(){r(e.s,e.d)},Math.floor(0))})},t.prototype.put=function(e,t,n,r){this.putInternal("p",e,t,n,r)},t.prototype.merge=function(e,t,n,r){this.putInternal("m",e,t,n,r)},t.prototype.putInternal=function(e,t,n,r,i){var o={p:t,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:r}),this.outstandingPutCount_++;var a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+t)},t.prototype.sendPut_=function(e){var t=this,n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,function(r){t.log_(n+" response",r),delete t.outstandingPuts_[e],t.outstandingPutCount_--,0===t.outstandingPutCount_&&(t.outstandingPuts_=[]),i&&i(r.s,r.d)})},t.prototype.reportStats=function(e){var t=this;if(this.connected_){var n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,function(e){if("ok"!==e.s){var n=e.d;t.log_("reportStats","Error sending stats: "+n)}})}},t.prototype.onDataMessage_=function(e){if("r"in e){this.log_("from server: "+y.stringify(e));var t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}},t.prototype.onDataPush_=function(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):L("Unrecognized action received from server: "+y.stringify(e)+"\nAre you using the latest client?")},t.prototype.onReady_=function(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},t.prototype.scheduleConnect_=function(e){var t=this;y.assert(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(function(){t.establishConnectionTimer_=null,t.establishConnection_()},Math.floor(e))},t.prototype.onVisible_=function(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=un,this.realtime_||this.scheduleConnect_(0)),this.visible_=e},t.prototype.onOnline_=function(e){e?(this.log_("Browser went online."),this.reconnectDelay_=un,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},t.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=un),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());var e=(new Date).getTime()-this.lastConnectionAttemptTime_,t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},t.prototype.establishConnection_=function(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;var e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+t.nextConnectionId_++,o=this,a=this.lastSessionId,s=!1,u=null,c=function(){u?u.close():(s=!0,r())},l=function(e){y.assert(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(e)};this.realtime_={close:c,sendRequest:l};var h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(h).then(function(t){s?P("getToken() completed but was canceled"):(P("getToken() completed. Creating connection."),o.authToken_=t&&t.accessToken,u=new an(i,o.repoInfo_,e,n,r,function(e){V(e+" ("+o.repoInfo_.toString()+")"),o.interrupt("server_kill")},a))}).then(null,function(e){o.log_("Failed to get token: "+e),s||(y.CONSTANTS.NODE_ADMIN&&V(e),c())})}},t.prototype.interrupt=function(e){P("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},t.prototype.resume=function(e){P("Resuming connection for reason: "+e),delete this.interruptReasons_[e],y.isEmpty(this.interruptReasons_)&&(this.reconnectDelay_=un,this.realtime_||this.scheduleConnect_(0))},t.prototype.handleTimestamp_=function(e){var t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})},t.prototype.cancelSentTransactions_=function(){for(var e=0;e<this.outstandingPuts_.length;e++){var t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},t.prototype.onListenRevoked_=function(e,t){var n;n=t?t.map(function(e){return z(e)}).join("$"):"default";var r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")},t.prototype.removeListen_=function(e,t){var n,r=new ie(e).toString();return void 0!==this.listens_[r]?(n=this.listens_[r][t],delete this.listens_[r][t],0===y.getCount(this.listens_[r])&&delete this.listens_[r]):n=void 0,n},t.prototype.onAuthRevoked_=function(e,t){P("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},t.prototype.onSecurityDebugPacket_=function(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))},t.prototype.restoreState_=function(){var e=this;this.tryAuth(),y.forEach(this.listens_,function(t,n){y.forEach(n,function(t,n){e.sendListen_(n)})});for(var t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){var n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}},t.prototype.sendConnectStats_=function(){var e={},t="js";y.CONSTANTS.NODE_ADMIN?t="admin_node":y.CONSTANTS.NODE_CLIENT&&(t="node"),e["sdk."+t+"."+_.SDK_VERSION.replace(/\./g,"-")]=1,y.isMobileCordova()?e["framework.cordova"]=1:y.isReactNative()&&(e["framework.reactnative"]=1),this.reportStats(e)},t.prototype.shouldReconnect_=function(){var e=Yt.getInstance().currentlyOnline();return y.isEmpty(this.interruptReasons_)&&e},t.nextPersistentConnectionId_=0,t.nextConnectionId_=0,t}(sn),hn=function(e){function t(t,n,r){var i=e.call(this)||this;return i.repoInfo_=t,i.onDataUpdate_=n,i.authTokenProvider_=r,i.log_=R("p:rest:"),i.listens_={},i}return b.__extends(t,e),t.prototype.reportStats=function(e){throw new Error("Method not implemented.")},t.getListenId_=function(e,t){return void 0!==t?"tag$"+t:(y.assert(e.getQueryParams().isDefault(),"should have a tag if it's not a default query."),e.path.toString())},t.prototype.listen=function(e,n,r,i){var o=this,a=e.path.toString();this.log_("Listen called for "+a+" "+e.queryIdentifier());var s=t.getListenId_(e,r),u={};this.listens_[s]=u;var c=e.getQueryParams().toRestQueryStringParameters();this.restRequest_(a+".json",c,function(e,t){var n=t;404===e&&(n=null,e=null),null===e&&o.onDataUpdate_(a,n,!1,r),y.safeGet(o.listens_,s)===u&&i(e?401==e?"permission_denied":"rest_error:"+e:"ok",null)})},t.prototype.unlisten=function(e,n){var r=t.getListenId_(e,n);delete this.listens_[r]},t.prototype.refreshAuthToken=function(e){},t.prototype.restRequest_=function(e,t,n){var r=this;void 0===t&&(t={}),t.format="export",this.authTokenProvider_.getToken(!1).then(function(i){var o=i&&i.accessToken;o&&(t.auth=o);var a=(r.repoInfo_.secure?"https://":"http://")+r.repoInfo_.host+e+"?"+y.querystring(t);r.log_("Sending REST request for "+a);var s=new XMLHttpRequest;s.onreadystatechange=function(){if(n&&4===s.readyState){r.log_("REST Response for "+a+" received. status:",s.status,"response:",s.responseText);var e=null;if(s.status>=200&&s.status<300){try{e=y.jsonEval(s.responseText)}catch(e){V("Failed to parse JSON response for "+a+": "+s.responseText)}n(null,e)}else 401!==s.status&&404!==s.status&&V("Got unsuccessful REST response for "+a+" Status: "+s.status),n(s.status);n=null}},s.open("GET",a,!0),s.send()})},t}(sn),pn=function(){function e(e,t,n){var r=this;this.repoInfo_=e,this.app=n,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new zt,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=new ut,this.persistentConnection_=null;var i=new Ut(n);if(this.stats_=Ft.getCollection(e),t||ne())this.server_=new hn(this.repoInfo_,this.onDataUpdate_.bind(this),i),setTimeout(this.onConnectStatus_.bind(this,!0),0);else{var o=n.options.databaseAuthVariableOverride;if(void 0!==o&&null!==o){if("object"!=typeof o)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{y.stringify(o)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}this.persistentConnection_=new ln(this.repoInfo_,this.onDataUpdate_.bind(this),this.onConnectStatus_.bind(this),this.onServerInfoUpdate_.bind(this),i,o),this.server_=this.persistentConnection_}i.addTokenChangeListener(function(e){r.server_.refreshAuthToken(e)}),this.statsReporter_=Ft.getOrCreateReporter(e,function(){return new Ht(r.stats_,r.server_)}),this.transactions_init_(),this.infoData_=new jt,this.infoSyncTree_=new Vt({startListening:function(e,t,n,i){var o=[],a=r.infoData_.getNode(e.path);return a.isEmpty()||(o=r.infoSyncTree_.applyServerOverwrite(e.path,a),setTimeout(function(){i("ok")},0)),o},stopListening:function(){}}),this.updateInfo_("connected",!1),this.serverSyncTree_=new Vt({startListening:function(e,t,n,i){return r.server_.listen(e,n,t,function(t,n){var o=i(t,n);r.eventQueue_.raiseEventsForChangedPath(e.path,o)}),[]},stopListening:function(e,t){r.server_.unlisten(e,t)}})}return e.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},e.prototype.name=function(){return this.repoInfo_.namespace},e.prototype.serverTime=function(){var e=this.infoData_.getNode(new ie(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+e},e.prototype.generateServerValues=function(){return ct({timestamp:this.serverTime()})},e.prototype.onDataUpdate_=function(e,t,n,r){this.dataUpdateCount++;var i=new ie(e);t=this.interceptServerDataCallback_?this.interceptServerDataCallback_(e,t):t;var o=[];if(r)if(n){var a=y.map(t,function(e){return u(e)});o=this.serverSyncTree_.applyTaggedQueryMerge(i,a,r)}else{var s=u(t);o=this.serverSyncTree_.applyTaggedQueryOverwrite(i,s,r)}else if(n){var c=y.map(t,function(e){return u(e)});o=this.serverSyncTree_.applyServerMerge(i,c)}else{var l=u(t);o=this.serverSyncTree_.applyServerOverwrite(i,l)}var h=i;o.length>0&&(h=this.rerunTransactions_(i)),this.eventQueue_.raiseEventsForChangedPath(h,o)},e.prototype.interceptServerData_=function(e){this.interceptServerDataCallback_=e},e.prototype.onConnectStatus_=function(e){this.updateInfo_("connected",e),!1===e&&this.runOnDisconnectEvents_()},e.prototype.onServerInfoUpdate_=function(e){var t=this;G(e,function(e,n){t.updateInfo_(n,e)})},e.prototype.updateInfo_=function(e,t){var n=new ie("/.info/"+e),r=u(t);this.infoData_.updateSnapshot(n,r);var i=this.infoSyncTree_.applyServerOverwrite(n,r);this.eventQueue_.raiseEventsForChangedPath(n,i)},e.prototype.getNextWriteId_=function(){return this.nextWriteId_++},e.prototype.setWithPriority=function(e,t,n,r){var i=this;this.log_("set",{path:e.toString(),value:t,priority:n});var o=this.generateServerValues(),a=u(t,n),s=pt(a,o),c=this.getNextWriteId_(),l=this.serverSyncTree_.applyUserOverwrite(e,s,c,!0);this.eventQueue_.queueEvents(l),this.server_.put(e.toString(),a.val(!0),function(t,n){var o="ok"===t;o||V("set at "+e+" failed: "+t);var a=i.serverSyncTree_.ackUserWrite(c,!o);i.eventQueue_.raiseEventsForChangedPath(e,a),i.callOnCompleteCallback(r,t,n)});var h=this.abortTransactions_(e);this.rerunTransactions_(h),this.eventQueue_.raiseEventsForChangedPath(h,[])},e.prototype.update=function(e,t,n){var r=this;this.log_("update",{path:e.toString(),value:t});var i=!0,o=this.generateServerValues(),a={};if(y.forEach(t,function(e,t){i=!1;var n=u(t);a[e]=pt(n,o)}),i)P("update() called with empty data.  Don't do anything."),this.callOnCompleteCallback(n,"ok");else{var s=this.getNextWriteId_(),c=this.serverSyncTree_.applyUserMerge(e,a,s);this.eventQueue_.queueEvents(c),this.server_.merge(e.toString(),t,function(t,i){var o="ok"===t;o||V("update at "+e+" failed: "+t);var a=r.serverSyncTree_.ackUserWrite(s,!o),u=a.length>0?r.rerunTransactions_(e):e;r.eventQueue_.raiseEventsForChangedPath(u,a),r.callOnCompleteCallback(n,t,i)}),y.forEach(t,function(t){var n=r.abortTransactions_(e.child(t));r.rerunTransactions_(n)}),this.eventQueue_.raiseEventsForChangedPath(e,[])}},e.prototype.runOnDisconnectEvents_=function(){var e=this;this.log_("onDisconnectEvents");var t=this.generateServerValues(),n=[];ht(this.onDisconnect_,t).forEachTree(ie.Empty,function(t,r){n=n.concat(e.serverSyncTree_.applyServerOverwrite(t,r));var i=e.abortTransactions_(t);e.rerunTransactions_(i)}),this.onDisconnect_=new ut,this.eventQueue_.raiseEventsForChangedPath(ie.Empty,n)},e.prototype.onDisconnectCancel=function(e,t){var n=this;this.server_.onDisconnectCancel(e.toString(),function(r,i){"ok"===r&&n.onDisconnect_.forget(e),n.callOnCompleteCallback(t,r,i)})},e.prototype.onDisconnectSet=function(e,t,n){var r=this,i=u(t);this.server_.onDisconnectPut(e.toString(),i.val(!0),function(t,o){"ok"===t&&r.onDisconnect_.remember(e,i),r.callOnCompleteCallback(n,t,o)})},e.prototype.onDisconnectSetWithPriority=function(e,t,n,r){var i=this,o=u(t,n);this.server_.onDisconnectPut(e.toString(),o.val(!0),function(t,n){"ok"===t&&i.onDisconnect_.remember(e,o),i.callOnCompleteCallback(r,t,n)})},e.prototype.onDisconnectUpdate=function(e,t,n){var r=this;if(y.isEmpty(t))return P("onDisconnect().update() called with empty data.  Don't do anything."),void this.callOnCompleteCallback(n,"ok");this.server_.onDisconnectMerge(e.toString(),t,function(i,o){"ok"===i&&y.forEach(t,function(t,n){var i=u(n);r.onDisconnect_.remember(e.child(t),i)}),r.callOnCompleteCallback(n,i,o)})},e.prototype.addEventCallbackForQuery=function(e,t){var n;n=".info"===e.path.getFront()?this.infoSyncTree_.addEventRegistration(e,t):this.serverSyncTree_.addEventRegistration(e,t),this.eventQueue_.raiseEventsAtPath(e.path,n)},e.prototype.removeEventCallbackForQuery=function(e,t){var n;n=".info"===e.path.getFront()?this.infoSyncTree_.removeEventRegistration(e,t):this.serverSyncTree_.removeEventRegistration(e,t),this.eventQueue_.raiseEventsAtPath(e.path,n)},e.prototype.interrupt=function(){this.persistentConnection_&&this.persistentConnection_.interrupt("repo_interrupt")},e.prototype.resume=function(){this.persistentConnection_&&this.persistentConnection_.resume("repo_interrupt")},e.prototype.stats=function(e){if(void 0===e&&(e=!1),"undefined"!=typeof console){var t;e?(this.statsListener_||(this.statsListener_=new Bt(this.stats_)),t=this.statsListener_.get()):t=this.stats_.get();var n=Object.keys(t).reduce(function(e,t){return Math.max(t.length,e)},0);y.forEach(t,function(e,t){for(var r=e.length;r<n+2;r++)e+=" ";console.log(e+t)})}},e.prototype.statsIncrementCounter=function(e){this.stats_.incrementCounter(e),this.statsReporter_.includeStat(e)},e.prototype.log_=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="";this.persistentConnection_&&(n=this.persistentConnection_.id+":"),P.apply(void 0,[n].concat(e))},e.prototype.callOnCompleteCallback=function(e,t,n){e&&te(function(){if("ok"==t)e(null);else{var r=(t||"error").toUpperCase(),i=r;n&&(i+=": "+n);var o=new Error(i);o.code=r,e(o)}})},Object.defineProperty(e.prototype,"database",{get:function(){return this.__database||(this.__database=new kn(this))},enumerable:!0,configurable:!0}),e}(),fn=function(){function e(t){this.indexedFilter_=new St(t.getIndex()),this.index_=t.getIndex(),this.startPost_=e.getStartPost_(t),this.endPost_=e.getEndPost_(t)}return e.prototype.getStartPost=function(){return this.startPost_},e.prototype.getEndPost=function(){return this.endPost_},e.prototype.matches=function(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0},e.prototype.updateChild=function(e,t,n,r,i,o){return this.matches(new xe(t,n))||(n=Ge.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,o)},e.prototype.updateFullNode=function(e,t,n){t.isLeafNode()&&(t=Ge.EMPTY_NODE);var r=t.withIndex(this.index_);r=r.updatePriority(Ge.EMPTY_NODE);var i=this;return t.forEachChild(je,function(e,t){i.matches(new xe(e,t))||(r=r.updateImmediateChild(e,Ge.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,n)},e.prototype.updatePriority=function(e,t){return e},e.prototype.filtersNodes=function(){return!0},e.prototype.getIndexedFilter=function(){return this.indexedFilter_},e.prototype.getIndex=function(){return this.index_},e.getStartPost_=function(e){if(e.hasStart()){var t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()},e.getEndPost_=function(e){if(e.hasEnd()){var t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()},e}(),dn=function(){function e(e){this.rangedFilter_=new fn(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}return e.prototype.updateChild=function(e,t,n,r,i,o){return this.rangedFilter_.matches(new xe(t,n))||(n=Ge.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,o):this.fullLimitUpdateChild_(e,t,n,i,o)},e.prototype.updateFullNode=function(e,t,n){var r;if(t.isLeafNode()||t.isEmpty())r=Ge.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_))for(r=Ge.EMPTY_NODE.withIndex(this.index_),s=void 0,s=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_),c=0;s.hasNext()&&c<this.limit_&&(h=s.getNext(),this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),h)<=0:this.index_.compare(h,this.rangedFilter_.getEndPost())<=0);)r=r.updateImmediateChild(h.name,h.node),c++;else{r=(r=t.withIndex(this.index_)).updatePriority(Ge.EMPTY_NODE);var i=void 0,o=void 0,a=void 0,s=void 0;if(this.reverse_){s=r.getReverseIterator(this.index_),i=this.rangedFilter_.getEndPost(),o=this.rangedFilter_.getStartPost();var u=this.index_.getCompare();a=function(e,t){return u(t,e)}}else s=r.getIterator(this.index_),i=this.rangedFilter_.getStartPost(),o=this.rangedFilter_.getEndPost(),a=this.index_.getCompare();for(var c=0,l=!1;s.hasNext();){var h=s.getNext();!l&&a(i,h)<=0&&(l=!0),l&&c<this.limit_&&a(h,o)<=0?c++:r=r.updateImmediateChild(h.name,Ge.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)},e.prototype.updatePriority=function(e,t){return e},e.prototype.filtersNodes=function(){return!0},e.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},e.prototype.getIndex=function(){return this.index_},e.prototype.fullLimitUpdateChild_=function(e,t,n,r,i){var o;if(this.reverse_){var a=this.index_.getCompare();o=function(e,t){return a(t,e)}}else o=this.index_.getCompare();var s=e;y.assert(s.numChildren()==this.limit_,"");var u=new xe(t,n),c=this.reverse_?s.getFirstChild(this.index_):s.getLastChild(this.index_),l=this.rangedFilter_.matches(u);if(s.hasChild(t)){for(var h=s.getImmediateChild(t),p=r.getChildAfterChild(this.index_,c,this.reverse_);null!=p&&(p.name==t||s.hasChild(p.name));)p=r.getChildAfterChild(this.index_,p,this.reverse_);var f=null==p?1:o(p,u);if(l&&!n.isEmpty()&&f>=0)return null!=i&&i.trackChildChange(Tt.childChangedChange(t,n,h)),s.updateImmediateChild(t,n);null!=i&&i.trackChildChange(Tt.childRemovedChange(t,h));var d=s.updateImmediateChild(t,Ge.EMPTY_NODE);return null!=p&&this.rangedFilter_.matches(p)?(null!=i&&i.trackChildChange(Tt.childAddedChange(p.name,p.node)),d.updateImmediateChild(p.name,p.node)):d}return n.isEmpty()?e:l&&o(c,u)>=0?(null!=i&&(i.trackChildChange(Tt.childRemovedChange(c.name,c.node)),i.trackChildChange(Tt.childAddedChange(t,n))),s.updateImmediateChild(t,n).updateImmediateChild(c.name,Ge.EMPTY_NODE)):e},e}(),mn=function(){function e(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=je}return e.prototype.hasStart=function(){return this.startSet_},e.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:this.viewFrom_===e.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT},e.prototype.getIndexStartValue=function(){return y.assert(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},e.prototype.getIndexStartName=function(){return y.assert(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:F},e.prototype.hasEnd=function(){return this.endSet_},e.prototype.getIndexEndValue=function(){return y.assert(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},e.prototype.getIndexEndName=function(){return y.assert(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:B},e.prototype.hasLimit=function(){return this.limitSet_},e.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},e.prototype.getLimit=function(){return y.assert(this.limitSet_,"Only valid if limit has been set"),this.limit_},e.prototype.getIndex=function(){return this.index_},e.prototype.copy_=function(){var t=new e;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t},e.prototype.limit=function(e){var t=this.copy_();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="",t},e.prototype.limitToFirst=function(t){var n=this.copy_();return n.limitSet_=!0,n.limit_=t,n.viewFrom_=e.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT,n},e.prototype.limitToLast=function(t){var n=this.copy_();return n.limitSet_=!0,n.limit_=t,n.viewFrom_=e.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_RIGHT,n},e.prototype.startAt=function(e,t){var n=this.copy_();return n.startSet_=!0,void 0===e&&(e=null),n.indexStartValue_=e,null!=t?(n.startNameSet_=!0,n.indexStartName_=t):(n.startNameSet_=!1,n.indexStartName_=""),n},e.prototype.endAt=function(e,t){var n=this.copy_();return n.endSet_=!0,void 0===e&&(e=null),n.indexEndValue_=e,void 0!==t?(n.endNameSet_=!0,n.indexEndName_=t):(n.endNameSet_=!1,n.indexEndName_=""),n},e.prototype.orderBy=function(e){var t=this.copy_();return t.index_=e,t},e.prototype.getQueryObject=function(){var t=e.WIRE_PROTOCOL_CONSTANTS_,n={};if(this.startSet_&&(n[t.INDEX_START_VALUE]=this.indexStartValue_,this.startNameSet_&&(n[t.INDEX_START_NAME]=this.indexStartName_)),this.endSet_&&(n[t.INDEX_END_VALUE]=this.indexEndValue_,this.endNameSet_&&(n[t.INDEX_END_NAME]=this.indexEndName_)),this.limitSet_){n[t.LIMIT]=this.limit_;var r=this.viewFrom_;""===r&&(r=this.isViewFromLeft()?t.VIEW_FROM_LEFT:t.VIEW_FROM_RIGHT),n[t.VIEW_FROM]=r}return this.index_!==je&&(n[t.INDEX]=this.index_.toString()),n},e.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},e.prototype.isDefault=function(){return this.loadsAllData()&&this.index_==je},e.prototype.getNodeFilter=function(){return this.loadsAllData()?new St(this.getIndex()):this.hasLimit()?new dn(this):new fn(this)},e.prototype.toRestQueryStringParameters=function(){var t=e.REST_QUERY_CONSTANTS_,n={};if(this.isDefault())return n;var r;return this.index_===je?r=t.PRIORITY_INDEX:this.index_===Ze?r=t.VALUE_INDEX:this.index_===Re?r=t.KEY_INDEX:(y.assert(this.index_ instanceof et,"Unrecognized index type!"),r=this.index_.toString()),n[t.ORDER_BY]=y.stringify(r),this.startSet_&&(n[t.START_AT]=y.stringify(this.indexStartValue_),this.startNameSet_&&(n[t.START_AT]+=","+y.stringify(this.indexStartName_))),this.endSet_&&(n[t.END_AT]=y.stringify(this.indexEndValue_),this.endNameSet_&&(n[t.END_AT]+=","+y.stringify(this.indexEndName_))),this.limitSet_&&(this.isViewFromLeft()?n[t.LIMIT_TO_FIRST]=this.limit_:n[t.LIMIT_TO_LAST]=this.limit_),n},e.WIRE_PROTOCOL_CONSTANTS_={INDEX_START_VALUE:"sp",INDEX_START_NAME:"sn",INDEX_END_VALUE:"ep",INDEX_END_NAME:"en",LIMIT:"l",VIEW_FROM:"vf",VIEW_FROM_LEFT:"l",VIEW_FROM_RIGHT:"r",INDEX:"i"},e.REST_QUERY_CONSTANTS_={ORDER_BY:"orderBy",PRIORITY_INDEX:"$priority",VALUE_INDEX:"$value",KEY_INDEX:"$key",START_AT:"startAt",END_AT:"endAt",LIMIT_TO_FIRST:"limitToFirst",LIMIT_TO_LAST:"limitToLast"},e.DEFAULT=new e,e}(),gn=function(e){function t(t,n){if(!(t instanceof pn))throw new Error("new Reference() no longer supported - use app.database().");return e.call(this,t,n,mn.DEFAULT,!1)||this}return b.__extends(t,e),t.prototype.getKey=function(){return y.validateArgCount("Reference.key",0,0,arguments.length),this.path.isEmpty()?null:this.path.getBack()},t.prototype.child=function(e){return y.validateArgCount("Reference.child",1,1,arguments.length),"number"==typeof e?e=String(e):e instanceof ie||(null===this.path.getFront()?Te("Reference.child",1,e,!1):Ee("Reference.child",1,e,!1)),new t(this.repo,this.path.child(e))},t.prototype.getParent=function(){y.validateArgCount("Reference.parent",0,0,arguments.length);var e=this.path.parent();return null===e?null:new t(this.repo,e)},t.prototype.getRoot=function(){y.validateArgCount("Reference.root",0,0,arguments.length);for(var e=this;null!==e.getParent();)e=e.getParent();return e},t.prototype.databaseProp=function(){return this.repo.database},t.prototype.set=function(e,t){y.validateArgCount("Reference.set",1,2,arguments.length),Se("Reference.set",this.path),ge("Reference.set",1,e,this.path,!1),y.validateCallback("Reference.set",2,t,!0);var n=new y.Deferred;return this.repo.setWithPriority(this.path,e,null,n.wrapCallback(t)),n.promise},t.prototype.update=function(e,t){if(y.validateArgCount("Reference.update",1,2,arguments.length),Se("Reference.update",this.path),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,V("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}be("Reference.update",1,e,this.path,!1),y.validateCallback("Reference.update",2,t,!0);var i=new y.Deferred;return this.repo.update(this.path,e,i.wrapCallback(t)),i.promise},t.prototype.setWithPriority=function(e,t,n){if(y.validateArgCount("Reference.setWithPriority",2,3,arguments.length),Se("Reference.setWithPriority",this.path),ge("Reference.setWithPriority",1,e,this.path,!1),_e("Reference.setWithPriority",2,t,!1),y.validateCallback("Reference.setWithPriority",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var r=new y.Deferred;return this.repo.setWithPriority(this.path,e,t,r.wrapCallback(n)),r.promise},t.prototype.remove=function(e){return y.validateArgCount("Reference.remove",0,1,arguments.length),Se("Reference.remove",this.path),y.validateCallback("Reference.remove",1,e,!0),this.set(null,e)},t.prototype.transaction=function(e,t,n){if(y.validateArgCount("Reference.transaction",1,3,arguments.length),Se("Reference.transaction",this.path),y.validateCallback("Reference.transaction",1,e,!1),y.validateCallback("Reference.transaction",2,t,!0),Ie("Reference.transaction",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";void 0===n&&(n=!0);var r=new y.Deferred;return"function"==typeof t&&r.promise.catch(function(){}),this.repo.startTransaction(this.path,e,function(e,n,i){e?r.reject(e):r.resolve(new De(n,i)),"function"==typeof t&&t(e,n,i)},n),r.promise},t.prototype.setPriority=function(e,t){y.validateArgCount("Reference.setPriority",1,2,arguments.length),Se("Reference.setPriority",this.path),_e("Reference.setPriority",1,e,!1),y.validateCallback("Reference.setPriority",2,t,!0);var n=new y.Deferred;return this.repo.setWithPriority(this.path.child(".priority"),e,null,n.wrapCallback(t)),n.promise},t.prototype.push=function(e,t){y.validateArgCount("Reference.push",0,2,arguments.length),Se("Reference.push",this.path),ge("Reference.push",1,e,this.path,!0),y.validateCallback("Reference.push",2,t,!0);var n,r=this.repo.serverTime(),i=Ae(r),o=this.child(i),a=this.child(i);return n=null!=e?o.set(e,t).then(function(){return a}):Promise.resolve(a),o.then=n.then.bind(n),o.catch=n.then.bind(n,void 0),"function"==typeof t&&n.catch(function(){}),o},t.prototype.onDisconnect=function(){return Se("Reference.onDisconnect",this.path),new Ne(this.repo,this.path)},Object.defineProperty(t.prototype,"database",{get:function(){return this.databaseProp()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this.getKey()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this.getParent()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this.getRoot()},enumerable:!0,configurable:!0}),t}(at);at.__referenceConstructor=gn,Pt.__referenceConstructor=gn;var yn,vn=function(){this.children={},this.childCount=0,this.value=null},bn=function(){function e(e,t,n){void 0===e&&(e=""),void 0===t&&(t=null),void 0===n&&(n=new vn),this.name_=e,this.parent_=t,this.node_=n}return e.prototype.subTree=function(t){for(var n,r=t instanceof ie?t:new ie(t),i=this;null!==(n=r.getFront());)i=new e(n,i,y.safeGet(i.node_.children,n)||new vn),r=r.popFront();return i},e.prototype.getValue=function(){return this.node_.value},e.prototype.setValue=function(e){y.assert(void 0!==e,"Cannot set value to undefined"),this.node_.value=e,this.updateParents_()},e.prototype.clear=function(){this.node_.value=null,this.node_.children={},this.node_.childCount=0,this.updateParents_()},e.prototype.hasChildren=function(){return this.node_.childCount>0},e.prototype.isEmpty=function(){return null===this.getValue()&&!this.hasChildren()},e.prototype.forEachChild=function(t){var n=this;y.forEach(this.node_.children,function(r,i){t(new e(r,n,i))})},e.prototype.forEachDescendant=function(e,t,n){t&&!n&&e(this),this.forEachChild(function(t){t.forEachDescendant(e,!0,n)}),t&&n&&e(this)},e.prototype.forEachAncestor=function(e,t){for(var n=t?this:this.parent();null!==n;){if(e(n))return!0;n=n.parent()}return!1},e.prototype.forEachImmediateDescendantWithValue=function(e){this.forEachChild(function(t){null!==t.getValue()?e(t):t.forEachImmediateDescendantWithValue(e)})},e.prototype.path=function(){return new ie(null===this.parent_?this.name_:this.parent_.path()+"/"+this.name_)},e.prototype.name=function(){return this.name_},e.prototype.parent=function(){return this.parent_},e.prototype.updateParents_=function(){null!==this.parent_&&this.parent_.updateChild_(this.name_,this)},e.prototype.updateChild_=function(e,t){var n=t.isEmpty(),r=y.contains(this.node_.children,e);n&&r?(delete this.node_.children[e],this.node_.childCount--,this.updateParents_()):n||r||(this.node_.children[e]=t.node_,this.node_.childCount++,this.updateParents_())},e}();!function(e){e[e.RUN=0]="RUN",e[e.SENT=1]="SENT",e[e.COMPLETED=2]="COMPLETED",e[e.SENT_NEEDS_ABORT=3]="SENT_NEEDS_ABORT",e[e.NEEDS_ABORT=4]="NEEDS_ABORT"}(yn||(yn={})),pn.MAX_TRANSACTION_RETRIES_=25,pn.prototype.transactions_init_=function(){this.transactionQueueTree_=new bn},pn.prototype.startTransaction=function(e,t,n,r){this.log_("transaction on "+e);var i=function(){},o=new gn(this,e);o.on("value",i);var a={path:e,update:t,onComplete:n,status:null,order:I(),applyLocally:r,retryCount:0,unwatcher:function(){o.off("value",i)},abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},s=this.getLatestState_(e);a.currentInputSnapshot=s;var c=a.update(s.val());if(void 0===c){if(a.unwatcher(),a.currentOutputSnapshotRaw=null,a.currentOutputSnapshotResolved=null,a.onComplete){var l=new tt(a.currentInputSnapshot,new gn(this,a.path),je);a.onComplete(null,!1,l)}}else{ye("transaction failed: Data returned ",c,a.path),a.status=yn.RUN;var h=this.transactionQueueTree_.subTree(e),p=h.getValue()||[];p.push(a),h.setValue(p);var f=void 0;"object"==typeof c&&null!==c&&y.contains(c,".priority")?(f=y.safeGet(c,".priority"),y.assert(me(f),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):f=(this.serverSyncTree_.calcCompleteEventCache(e)||Ge.EMPTY_NODE).getPriority().val(),f=f;var d=this.generateServerValues(),m=u(c,f),g=pt(m,d);a.currentOutputSnapshotRaw=m,a.currentOutputSnapshotResolved=g,a.currentWriteId=this.getNextWriteId_();var v=this.serverSyncTree_.applyUserOverwrite(e,g,a.currentWriteId,a.applyLocally);this.eventQueue_.raiseEventsForChangedPath(e,v),this.sendReadyTransactions_()}},pn.prototype.getLatestState_=function(e,t){return this.serverSyncTree_.calcCompleteEventCache(e,t)||Ge.EMPTY_NODE},pn.prototype.sendReadyTransactions_=function(e){var t=this;if(void 0===e&&(e=this.transactionQueueTree_),e||this.pruneCompletedTransactionsBelowNode_(e),null!==e.getValue()){var n=this.buildTransactionQueue_(e);y.assert(n.length>0,"Sending zero length transaction queue"),n.every(function(e){return e.status===yn.RUN})&&this.sendTransactionQueue_(e.path(),n)}else e.hasChildren()&&e.forEachChild(function(e){t.sendReadyTransactions_(e)})},pn.prototype.sendTransactionQueue_=function(e,t){for(var n=this,r=t.map(function(e){return e.currentWriteId}),i=this.getLatestState_(e,r),o=i,a=i.hash(),s=0;s<t.length;s++){var u=t[s];y.assert(u.status===yn.RUN,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=yn.SENT,u.retryCount++;var c=ie.relativePath(e,u.path);o=o.updateChild(c,u.currentOutputSnapshotRaw)}var l=o.val(!0),h=e;this.server_.put(h.toString(),l,function(r){n.log_("transaction put response",{path:h.toString(),status:r});var i=[];if("ok"===r){for(var o=[],a=0;a<t.length;a++){if(t[a].status=yn.COMPLETED,i=i.concat(n.serverSyncTree_.ackUserWrite(t[a].currentWriteId)),t[a].onComplete){var s=t[a].currentOutputSnapshotResolved,u=new gn(n,t[a].path),c=new tt(s,u,je);o.push(t[a].onComplete.bind(null,null,!0,c))}t[a].unwatcher()}for(n.pruneCompletedTransactionsBelowNode_(n.transactionQueueTree_.subTree(e)),n.sendReadyTransactions_(),n.eventQueue_.raiseEventsForChangedPath(e,i),a=0;a<o.length;a++)te(o[a])}else{if("datastale"===r)for(a=0;a<t.length;a++)t[a].status===yn.SENT_NEEDS_ABORT?t[a].status=yn.NEEDS_ABORT:t[a].status=yn.RUN;else for(V("transaction at "+h.toString()+" failed: "+r),a=0;a<t.length;a++)t[a].status=yn.NEEDS_ABORT,t[a].abortReason=r;n.rerunTransactions_(e)}},a)},pn.prototype.rerunTransactions_=function(e){var t=this.getAncestorTransactionNode_(e),n=t.path(),r=this.buildTransactionQueue_(t);return this.rerunTransactionQueue_(r,n),n},pn.prototype.rerunTransactionQueue_=function(e,t){if(0!==e.length){for(var n=[],r=[],i=e.filter(function(e){return e.status===yn.RUN}).map(function(e){return e.currentWriteId}),o=0;o<e.length;o++){var a=e[o],s=ie.relativePath(t,a.path),c=!1,l=void 0;if(y.assert(null!==s,"rerunTransactionsUnderNode_: relativePath should not be null."),a.status===yn.NEEDS_ABORT)c=!0,l=a.abortReason,r=r.concat(this.serverSyncTree_.ackUserWrite(a.currentWriteId,!0));else if(a.status===yn.RUN)if(a.retryCount>=pn.MAX_TRANSACTION_RETRIES_)c=!0,l="maxretry",r=r.concat(this.serverSyncTree_.ackUserWrite(a.currentWriteId,!0));else{var h=this.getLatestState_(a.path,i);a.currentInputSnapshot=h;var p=e[o].update(h.val());if(void 0!==p){ye("transaction failed: Data returned ",p,a.path);var f=u(p);"object"==typeof p&&null!=p&&y.contains(p,".priority")||(f=f.updatePriority(h.getPriority()));var d=a.currentWriteId,m=this.generateServerValues(),g=pt(f,m);a.currentOutputSnapshotRaw=f,a.currentOutputSnapshotResolved=g,a.currentWriteId=this.getNextWriteId_(),i.splice(i.indexOf(d),1),r=(r=r.concat(this.serverSyncTree_.applyUserOverwrite(a.path,g,a.currentWriteId,a.applyLocally))).concat(this.serverSyncTree_.ackUserWrite(d,!0))}else c=!0,l="nodata",r=r.concat(this.serverSyncTree_.ackUserWrite(a.currentWriteId,!0))}if(this.eventQueue_.raiseEventsForChangedPath(t,r),r=[],c&&(e[o].status=yn.COMPLETED,function(e){setTimeout(e,Math.floor(0))}(e[o].unwatcher),e[o].onComplete))if("nodata"===l){var v=new gn(this,e[o].path),b=e[o].currentInputSnapshot,_=new tt(b,v,je);n.push(e[o].onComplete.bind(null,null,!1,_))}else n.push(e[o].onComplete.bind(null,new Error(l),!1,null))}for(this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_),o=0;o<n.length;o++)te(n[o]);this.sendReadyTransactions_()}},pn.prototype.getAncestorTransactionNode_=function(e){for(var t,n=this.transactionQueueTree_;null!==(t=e.getFront())&&null===n.getValue();)n=n.subTree(t),e=e.popFront();return n},pn.prototype.buildTransactionQueue_=function(e){var t=[];return this.aggregateTransactionQueuesForNode_(e,t),t.sort(function(e,t){return e.order-t.order}),t},pn.prototype.aggregateTransactionQueuesForNode_=function(e,t){var n=this,r=e.getValue();if(null!==r)for(var i=0;i<r.length;i++)t.push(r[i]);e.forEachChild(function(e){n.aggregateTransactionQueuesForNode_(e,t)})},pn.prototype.pruneCompletedTransactionsBelowNode_=function(e){var t=this,n=e.getValue();if(n){for(var r=0,i=0;i<n.length;i++)n[i].status!==yn.COMPLETED&&(n[r]=n[i],r++);n.length=r,e.setValue(n.length>0?n:null)}e.forEachChild(function(e){t.pruneCompletedTransactionsBelowNode_(e)})},pn.prototype.abortTransactions_=function(e){var t=this,n=this.getAncestorTransactionNode_(e).path(),r=this.transactionQueueTree_.subTree(e);return r.forEachAncestor(function(e){t.abortTransactionsOnNode_(e)}),this.abortTransactionsOnNode_(r),r.forEachDescendant(function(e){t.abortTransactionsOnNode_(e)}),n},pn.prototype.abortTransactionsOnNode_=function(e){var t=e.getValue();if(null!==t){for(var n=[],r=[],i=-1,o=0;o<t.length;o++)t[o].status===yn.SENT_NEEDS_ABORT||(t[o].status===yn.SENT?(y.assert(i===o-1,"All SENT items should be at beginning of queue."),i=o,t[o].status=yn.SENT_NEEDS_ABORT,t[o].abortReason="set"):(y.assert(t[o].status===yn.RUN,"Unexpected transaction status in abort"),t[o].unwatcher(),r=r.concat(this.serverSyncTree_.ackUserWrite(t[o].currentWriteId,!0)),t[o].onComplete&&n.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));for(-1===i?e.setValue(null):t.length=i+1,this.eventQueue_.raiseEventsForChangedPath(e.path(),r),o=0;o<n.length;o++)te(n[o])}};var _n,wn=function(){function e(){this.repos_={},this.useRestClient_=!1}return e.getInstance=function(){return _n||(_n=new e),_n},e.prototype.interrupt=function(){for(var e in this.repos_)for(var t in this.repos_[e])this.repos_[e][t].interrupt()},e.prototype.resume=function(){for(var e in this.repos_)for(var t in this.repos_[e])this.repos_[e][t].resume()},e.prototype.databaseFromApp=function(e,t){var n=t||e.options.databaseURL;void 0===n&&M("Can't determine Firebase Database URL.  Be sure to include databaseURL option when calling firebase.initializeApp().");var r=ue(n),i=r.repoInfo;return Ce("Invalid Firebase Database URL",1,r),r.path.isEmpty()||M("Database URL must point to the root of a Firebase Database (not including a child path)."),this.createRepo(i,e).database},e.prototype.deleteRepo=function(e){var t=y.safeGet(this.repos_,e.app.name);t&&y.safeGet(t,e.repoInfo_.toURLString())===e||M("Database "+e.app.name+"("+e.repoInfo_+") has already been deleted."),e.interrupt(),delete t[e.repoInfo_.toURLString()]},e.prototype.createRepo=function(e,t){var n=y.safeGet(this.repos_,t.name);n||(n={},this.repos_[t.name]=n);var r=y.safeGet(n,e.toURLString());return r&&M("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),r=new pn(e,this.useRestClient_,t),n[e.toURLString()]=r,r},e.prototype.forceRestClient=function(e){this.useRestClient_=e},e}(),kn=function(){function e(e){this.repo_=e,e instanceof pn||M("Don't call new Database() directly - please use firebase.database()."),this.root_=new gn(e,ie.Empty),this.INTERNAL=new En(this)}return Object.defineProperty(e.prototype,"app",{get:function(){return this.repo_.app},enumerable:!0,configurable:!0}),e.prototype.ref=function(e){return this.checkDeleted_("ref"),y.validateArgCount("database.ref",0,1,arguments.length),e instanceof gn?this.refFromURL(e.toString()):void 0!==e?this.root_.child(e):this.root_},e.prototype.refFromURL=function(e){var t="database.refFromURL";this.checkDeleted_(t),y.validateArgCount(t,1,1,arguments.length);var n=ue(e);Ce(t,1,n);var r=n.repoInfo;return r.host!==this.repo_.repoInfo_.host&&M(t+": Host name does not match the current database: (found "+r.host+" but expected "+this.repo_.repoInfo_.host+")"),this.ref(n.path.toString())},e.prototype.checkDeleted_=function(e){null===this.repo_&&M("Cannot call "+e+" on a deleted database.")},e.prototype.goOffline=function(){y.validateArgCount("database.goOffline",0,0,arguments.length),this.checkDeleted_("goOffline"),this.repo_.interrupt()},e.prototype.goOnline=function(){y.validateArgCount("database.goOnline",0,0,arguments.length),this.checkDeleted_("goOnline"),this.repo_.resume()},e.ServerValue={TIMESTAMP:{".sv":"timestamp"}},e}(),En=function(){function e(e){this.database=e}return e.prototype.delete=function(){return b.__awaiter(this,void 0,void 0,function(){return b.__generator(this,function(e){return this.database.checkDeleted_("delete"),wn.getInstance().deleteRepo(this.database.repo_),this.database.repo_=null,this.database.root_=null,this.database.INTERNAL=null,this.database=null,[2]})})},e}(),Tn=Object.freeze({forceLongPolling:function(){rn.forceDisallow(),en.forceAllow()},forceWebSockets:function(){en.forceDisallow()},isWebSocketsAvailable:function(){return rn.isAvailable()},setSecurityDebugCallback:function(e,t){e.repo.persistentConnection_.securityDebugCallback_=t},stats:function(e,t){e.repo.stats(t)},statsIncrementCounter:function(e,t){e.repo.statsIncrementCounter(t)},dataUpdateCount:function(e){return e.repo.dataUpdateCount},interceptServerData:function(e,t){return e.repo.interceptServerData_(t)}}),Sn=ln;ln.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},ln.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};var Cn=an,In=se,Nn=Object.freeze({DataConnection:Sn,RealTimeConnection:Cn,hijackHash:function(e){var t=ln.prototype.put;return ln.prototype.put=function(n,r,i,o){void 0!==o&&(o=e()),t.call(this,n,r,i,o)},function(){ln.prototype.put=t}},ConnectionTarget:In,queryIdentifier:function(e){return e.queryIdentifier()},listens:function(e){return e.repo.persistentConnection_.listens_},forceRestClient:function(e){wn.getInstance().forceRestClient(e)}}),Dn=kn.ServerValue;c(_),n.registerDatabase=c,n.Database=kn,n.Query=at,n.Reference=gn,n.enableLogging=O,n.ServerValue=Dn,n.DataSnapshot=tt,n.OnDisconnect=Ne}(0,e,t,n)}),define("@firebase/webchannel-wrapper@0.2.11#dist/index",function(e,t,n){!function(e,t,n,r){(function(){"use strict";function e(e){return"string"==typeof e}function t(e,t){e=e.split("."),t=t||St;for(var n=0;n<e.length;n++)if(null==(t=t[e[n]]))return null;return t}function n(){}function i(e){var t=typeof e;if("object"==t){if(!e)return"null";if(e instanceof Array)return"array";if(e instanceof Object)return t;var n=Object.prototype.toString.call(e);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof e.length&&void 0!==e.splice&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==e.call&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("call"))return"function"}else if("function"==t&&void 0===e.call)return"object";return t}function o(e){return"array"==i(e)}function a(e){var t=i(e);return"array"==t||"object"==t&&"number"==typeof e.length}function s(e){return"function"==i(e)}function u(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function c(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function h(e,t,n){return(h=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?c:l).apply(null,arguments)}function p(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function f(e,t){function n(){}n.prototype=t.prototype,e.L=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.mh=function(e,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return t.prototype[n].apply(e,i)}}function d(e){if(Error.captureStackTrace)Error.captureStackTrace(this,d);else{var t=Error().stack;t&&(this.stack=t)}e&&(this.message=String(e))}function m(e,t){for(var n="",r=(e=e.split("%s")).length-1,i=0;i<r;i++)n+=e[i]+(i<t.length?t[i]:"%s");d.call(this,n+e[r])}function g(e,t){throw new m("Failure"+(e?": "+e:""),Array.prototype.slice.call(arguments,1))}function y(){0!=Dt&&(At[this[Ct]||(this[Ct]=++It)]=this),this.Ka=this.Ka,this.Qa=this.Qa}function v(t){e:{for(var n=it,r=t.length,i=e(t)?t.split(""):t,o=0;o<r;o++)if(o in i&&n.call(void 0,i[o],o,t)){n=o;break e}n=-1}return 0>n?null:e(t)?t.charAt(n):t[n]}function b(e){if(!o(e))for(var t=e.length-1;0<=t;t--)delete e[t];e.length=0}function _(e,t){var n;return(n=0<=(t=Ot(e,t)))&&Array.prototype.splice.call(e,t,1),n}function w(e){return Array.prototype.concat.apply([],arguments)}function k(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function E(e){return/^[\s\xa0]*$/.test(e)}function T(e,t){return e<t?-1:e>t?1:0}function S(e){return-1!=xt.indexOf(e)}function C(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function I(e){var t,n=[],r=0;for(t in e)n[r++]=e[t];return n}function N(e){var t,n=[],r=0;for(t in e)n[r++]=t;return n}function D(e){var t,n={};for(t in e)n[t]=e[t];return n}function A(e,t){for(var n,r,i=1;i<arguments.length;i++){r=arguments[i];for(n in r)e[n]=r[n];for(var o=0;o<Ut.length;o++)n=Ut[o],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function x(e){return x[" "](e),e}function O(e,t){var n=$t;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}function P(){var e=St.document;return e?e.documentMode:void 0}function R(e){return O(e,function(){for(var t=0,n=Mt(String(qt)).split("."),r=Mt(String(e)).split("."),i=Math.max(n.length,r.length),o=0;0==t&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;t=T(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||T(0==a[2].length,0==s[2].length)||T(a[2],s[2]),a=a[3],s=s[3]}while(0==t)}return 0<=t})}function L(e,t){this.type=e,this.currentTarget=this.target=t,this.defaultPrevented=this.Ea=!1,this.Be=!0}function M(e,t){L.call(this,e?e.type:""),this.relatedTarget=this.currentTarget=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=this.offsetY=this.offsetX=0,this.key="",this.charCode=this.keyCode=0,this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.fb=null,e&&this.Kf(e,t)}function V(e){return!(!e||!e[on])}function j(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.Ob=i,this.key=++an,this.Sa=this.Eb=!1}function U(e){this.src=e,this.J={},this.xb=0}function q(e,t,n,r){for(var i=0;i<e.length;++i){var o=e[i];if(!o.Sa&&o.listener==t&&o.capture==!!n&&o.Ob==r)return i}return-1}function F(e,t,n,r,i){if(r&&r.once)return W(e,t,n,r,i);if(o(t)){for(var a=0;a<t.length;a++)F(e,t[a],n,r,i);return null}return n=J(n),V(e)?e.nb(t,n,u(r)?!!r.capture:!!r,i):B(e,t,n,!1,r,i)}function B(e,t,n,r,i,o){if(!t)throw Error("Invalid event type");var a=u(i)?!!i.capture:!!i,s=$(e);if(s||(e[sn]=s=new U(e)),(n=s.add(t,n,r,a,o)).proxy)return n;if(r=K(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)nn||(i=a),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(Q(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return cn++,n}function K(){var e=Y,t=en?function(n){return e.call(t.src,t.listener,n)}:function(n){if(!(n=e.call(t.src,t.listener,n)))return n};return t}function W(e,t,n,r,i){if(o(t)){for(var a=0;a<t.length;a++)W(e,t[a],n,r,i);return null}return n=J(n),V(e)?e.Oc(t,n,u(r)?!!r.capture:!!r,i):B(e,t,n,!0,r,i)}function H(e,t,n,r,i){if(o(t))for(var a=0;a<t.length;a++)H(e,t[a],n,r,i);else r=u(r)?!!r.capture:!!r,n=J(n),V(e)?e.ed(t,n,r,i):e&&(e=$(e))&&(t=e.jb(t,n,r,i))&&z(t)}function z(e){if("number"!=typeof e&&e&&!e.Sa){var t=e.src;if(V(t))t.Le(e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(Q(n),r):t.addListener&&t.removeListener&&t.removeListener(r),cn--,(n=$(t))?(n.ye(e),0==n.xb&&(n.src=null,t[sn]=null)):e.Vb()}}}function Q(e){return e in un?un[e]:un[e]="on"+e}function G(e,t,n,r){var i=!0;if((e=$(e))&&(t=e.J[t.toString()]))for(t=t.concat(),e=0;e<t.length;e++){var o=t[e];o&&o.capture==n&&!o.Sa&&(o=X(o,r),i=i&&!1!==o)}return i}function X(e,t){var n=e.listener,r=e.Ob||e.src;return e.Eb&&z(e),n.call(r,t)}function Y(e,n){if(e.Sa)return!0;if(!en){var r=n||t("window.event");n=new M(r,this);var i=!0;if(!(0>r.keyCode||void 0!=r.returnValue)){e:{var o=!1;if(0==r.keyCode)try{r.keyCode=-1;break e}catch(e){o=!0}(o||void 0==r.returnValue)&&(r.returnValue=!0)}for(r=[],o=n.currentTarget;o;o=o.parentNode)r.push(o);for(e=e.type,o=r.length-1;!n.Ea&&0<=o;o--){n.currentTarget=r[o];var a=G(r[o],e,!0,n);i=i&&a}for(o=0;!n.Ea&&o<r.length;o++)n.currentTarget=r[o],a=G(r[o],e,!1,n),i=i&&a}return i}return X(e,new M(n,this))}function $(e){return(e=e[sn])instanceof U?e:null}function J(e){return s(e)?e:(e[ln]||(e[ln]=function(t){return e.handleEvent(t)}),e[ln])}function Z(){y.call(this),this.ka=new U(this),this.Pe=this,this.Uc=null}function ee(e,t){this.Sf=100,this.ef=e,this.ug=t,this.Zb=0,this.Pb=null}function te(){this.lc=this.Va=null}function ne(){this.next=this.scope=this.Gc=null}function re(e){St.setTimeout(function(){throw e},0)}function ie(){var e=St.MessageChannel;if(void 0===e&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!S("Presto")&&(e=function(){var e=document.createElement("IFRAME");e.style.display="none",e.src="",document.documentElement.appendChild(e);var t=e.contentWindow;(e=t.document).open(),e.write(""),e.close();var n="callImmediate"+Math.random(),r="file:"==t.location.protocol?"*":t.location.protocol+"//"+t.location.host;e=h(function(e){"*"!=r&&e.origin!=r||e.data!=n||this.port1.onmessage()},this),t.addEventListener("message",e,!1),this.port1={},this.port2={postMessage:function(){t.postMessage(n,r)}}}),void 0!==e&&!S("Trident")&&!S("MSIE")){var t=new e,n={},r=n;return t.port1.onmessage=function(){if(void 0!==n.next){var e=(n=n.next).rd;n.rd=null,e()}},function(e){r.next={rd:e},r=r.next,t.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(e){var t=document.createElement("SCRIPT");t.onreadystatechange=function(){t.onreadystatechange=null,t.parentNode.removeChild(t),t=null,e(),e=null},document.documentElement.appendChild(t)}:function(e){St.setTimeout(e,0)}}function oe(){if(St.Promise&&St.Promise.resolve){var e=St.Promise.resolve(void 0);dn=function(){e.then(ae)}}else dn=function(){var e=ae;!s(St.setImmediate)||St.Window&&St.Window.prototype&&!S("Edge")&&St.Window.prototype.setImmediate==St.setImmediate?(fn||(fn=ie()),fn(e)):St.setImmediate(e)}}function ae(){for(var e;e=gn.remove();){try{e.Gc.call(e.scope)}catch(e){re(e)}gn.wg(e)}mn=!1}function se(e,t){Z.call(this),this.Na=e||1,this.wb=t||St,this.nd=h(this.Rg,this),this.ie=Nt()}function ue(e,t,n){if(s(e))n&&(e=h(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=h(e.handleEvent,e)}return 2147483647<Number(t)?-1:St.setTimeout(e,t||0)}function ce(e,t,n){y.call(this),this.Uf=null!=n?h(e,n):e,this.Na=t,this.Xe=h(this.fg,this),this.qc=[]}function le(e){y.call(this),this.i=e,this.o={}}function he(e,t,n){this.reset(e,t,n,void 0,void 0)}function pe(e){this.pe=e,this.Zd=this.uc=this.mb=this.$b=null}function fe(e,t){this.name=e,this.value=t}function de(e){Sn||(Sn=new pe(""),Tn[""]=Sn,Sn.Ge(kn));var t;if(!(t=Tn[e])){t=new pe(e);var n=e.lastIndexOf("."),r=e.substr(n+1);(n=de(e.substr(0,n))).Qe(r,t),t.Fg(n),Tn[e]=t}return t}function me(e,t){e&&e.info(t,void 0)}function ge(e,t){e&&e.lf(t)}function ye(){this.s=de("goog.labs.net.webChannel.WebChannelDebug"),this.Wc=!0}function ve(e){L.call(this,"serverreachability",e)}function be(e){Cn.dispatchEvent(new ve(Cn,e))}function _e(e,t){L.call(this,"statevent",e),this.stat=t}function we(e){Cn.dispatchEvent(new _e(Cn,e))}function ke(e,t,n){L.call(this,"timingevent",e),this.size=t,this.rtt=n}function Ee(e,t,n){Cn.dispatchEvent(new ke(Cn,e,t,n))}function Te(e,t){if(!s(e))throw Error("Fn must not be null and must be a function");return St.setTimeout(function(){e()},t)}function Se(){}function Ce(){}function Ie(){L.call(this,"d")}function Ne(){L.call(this,"c")}function De(){}function Ae(e,t,n,r,i){this.b=e,this.a=t,this.ra=n,this.R=r,this.Xc=i||1,this.Fc=new le(this),this.Ua=xn,e=Wt?125:void 0,this.Vc=new se(e),this.A=null,this.S=!1,this.Da=this.pa=this.ua=this.ic=this.qb=this.hd=this.Ga=null,this.ba=[],this.h=null,this.Bb=0,this.I=this.Fa=null,this.w=-1,this.Za=!1,this.Ra=0,this.ac=null,this.lb=this.Ed=this.yc=!1}function xe(e,t){switch(e){case 0:return"Non-200 return code ("+t+")";case 1:return"XMLHTTP failure (no data)";case 2:return"HttpConnection timeout";default:return"Unknown error"}}function Oe(t){if(t.H&&"function"==typeof t.H)return t.H();if(e(t))return t.split("");if(a(t)){for(var n=[],r=t.length,i=0;i<r;i++)n.push(t[i]);return n}return I(t)}function Pe(t,n,r){if(t.forEach&&"function"==typeof t.forEach)t.forEach(n,r);else if(a(t)||e(t))Rt(t,n,r);else{if(t.W&&"function"==typeof t.W)var i=t.W();else if(t.H&&"function"==typeof t.H)i=void 0;else if(a(t)||e(t)){i=[];for(var o=t.length,s=0;s<o;s++)i.push(s)}else i=N(t);s=(o=Oe(t)).length;for(var u=0;u<s;u++)n.call(r,o[u],i&&i[u],t)}}function Re(e,t){this.D={},this.o=[],this.j=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else e&&this.addAll(e)}function Le(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Me(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var o=e[n].substring(0,r);i=e[n].substring(r+1)}else o=e[n];t(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Ve(e,t){this.xa=this.zb=this.qa="",this.Ca=null,this.ib=this.K="",this.O=this.Qf=!1;var n;e instanceof Ve?(this.O=void 0!==t?t:e.O,this.tb(e.qa),this.cd(e.zb),this.rb(e.xa),this.sb(e.Ca),this.ec(e.K),this.bd(e.P.clone()),this.$c(e.ib)):e&&(n=String(e).match(Rn))?(this.O=!!t,this.tb(n[1]||"",!0),this.cd(n[2]||"",!0),this.rb(n[3]||"",!0),this.sb(n[4]),this.ec(n[5]||"",!0),this.bd(n[6]||"",!0),this.$c(n[7]||"",!0)):(this.O=!!t,this.P=new Ke(null,this.O))}function je(e){return e instanceof Ve?e.clone():new Ve(e,void 0)}function Ue(e,t,n,r){var i=new Ve(null,void 0);return e&&i.tb(e),t&&i.rb(t),n&&i.sb(n),r&&i.ec(r),i}function qe(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Fe(t,n,r){return e(t)?(t=encodeURI(t).replace(n,Be),r&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Be(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}function Ke(e,t){this.j=this.m=null,this.ja=e||null,this.O=!!t}function We(){this.xe=Nt()}function He(){qn||(qn=new We)}function ze(e,t){this.b=e,this.a=t,this.f=this.A=null,this.bc=!1,this.K=null,this.w=-1,this.Ad=this.na=null}function Qe(){this.od=this.$d=null}function Ge(e){this.D=new Re,e&&this.addAll(e)}function Xe(e){var t=typeof e;return"object"==t&&e||"function"==t?"o"+(e[Ct]||(e[Ct]=++It)):t.substr(0,1)+e}function Ye(e,t){this.Pc=e,this.map=t,this.context=null}function $e(e){this.me=e||Fn,St.PerformanceNavigationTiming?(e=St.performance.getEntriesByType("navigation"),e=0<e.length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol)):e=!!(St.vc&&St.vc.ke&&St.vc.ke()&&St.vc.ke().nh),this.Xb=e?this.me:1,this.v=null,1<this.Xb&&(this.v=new Ge),this.f=null,this.ba=[]}function Je(){this.xg=this.rg=void 0}function Ze(){this.jg=new Je}function et(e,t){var n=new ye;n.debug("TestLoadImage: loading "+e);var r=new Image;r.onload=p(tt,n,r,"TestLoadImage: loaded",!0,t),r.onerror=p(tt,n,r,"TestLoadImage: error",!1,t),r.onabort=p(tt,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=p(tt,n,r,"TestLoadImage: timeout",!1,t),St.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}function tt(e,t,n,r,i){try{e.debug(n),t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(t){e.cb(t)}}function nt(e){Z.call(this),this.headers=new Re,this.Xa=e||null,this.ha=!1,this.mc=this.c=null,this.ge=this.Tb="",this.Pa=0,this.I="",this.Aa=this.Lc=this.Qb=this.Ec=!1,this.vb=0,this.hc=null,this.Ae=Kn,this.jc=this.lg=this.Ab=!1}function rt(e){return Bt&&R(9)&&"number"==typeof e.timeout&&void 0!==e.ontimeout}function it(e){return"content-type"==e.toLowerCase()}function ot(e,t){return{type:t,lengthComputable:e.lengthComputable,loaded:e.loaded,total:e.total}}function at(e){var t="";return C(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function st(t,n,r){e:{for(i in r){var i=!1;break e}i=!0}if(i)return t;if(r=at(r),e(t)){if(n=encodeURIComponent(String(n)),r=null!=r?"="+encodeURIComponent(String(r)):"",n+=r){if(0>(r=t.indexOf("#"))&&(r=t.length),0>(i=t.indexOf("?"))||i>r){i=r;var o=""}else o=t.substring(i+1,r);r=(t=[t.substr(0,i),o,t.substr(r)])[1],t[1]=n?r?r+"&"+n:n:r,t=t[0]+(t[1]?"?"+t[1]:"")+t[2]}return t}return t.l(n,r),t}function ut(e){this.Bd=22,this.De=0,this.M=[],this.a=new ye,this.Ib=new Qe,this.na=this.md=this.hb=this.K=this.u=this.Kc=this.aa=this.gb=this.N=this.Rb=this.A=null,this.Te=!0,this.ag=this.Yb=0,this.kf=!!t("internalChannelParams.failFast",e),this.fd=this.Ja=this.wa=this.ia=this.ea=this.i=null,this.Se=!0,this.w=this.he=this.Sb=-1,this.rc=this.Ha=this.La=0,this.Ve=t("internalChannelParams.baseRetryDelayMs",e)||5e3,this.vg=t("internalChannelParams.retryDelaySeedMs",e)||1e4,this.nf=t("internalChannelParams.forwardChannelMaxRetries",e)||2,this.Od=t("internalChannelParams.forwardChannelRequestTimeoutMs",e)||2e4,this.Xa=e&&e.oh||void 0,this.Db=void 0,this.Ra=0,this.gc=e&&e.supportsCrossDomainXhr||!1,this.ra="",this.G=new $e(e&&e.concurrentRequestLimit),this.kc=new Ze,this.ta=!e||void 0===e.backgroundChannelTest||e.backgroundChannelTest,(this.Nd=e&&e.fastHandshake||!1)&&!this.ta&&(this.a.T("Force backgroundChannelTest when fastHandshake is enabled."),this.ta=!0),e&&e.Id&&this.a.Id()}function ct(){}function lt(e){for(var t=arguments[0],n=1;n<arguments.length;n++){var r=arguments[n];if(0==r.lastIndexOf("/",0))t=r;else{var i;(i=""==t)||(i=t.length-1,i=0<=i&&t.indexOf("/",i)==i),t=i?t+r:t+"/"+r}}return t}function ht(){if(Bt&&!(10<=Number(Yt)))throw Error("Environmental error: no available transport.")}function pt(e,t){Z.call(this),this.b=new ut(t),this.yb=e,this.Qg=t&&t.testUrl?t.testUrl:lt(this.yb,"test"),this.s=de("goog.labs.net.webChannel.WebChannelBaseTransport"),this.Rc=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.b.ga(e),e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.zd&&(e?e["X-WebChannel-Client-Profile"]=t.zd:e={"X-WebChannel-Client-Profile":t.zd}),this.b.Eg(e),(e=t&&t.httpHeadersOverwriteParam)&&!E(e)&&this.b.Cg(e),this.Og=t&&t.supportsCrossDomainXhr||!1,this.zg=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!E(t)&&(this.b.Dg(t),null!==(e=this.Rc)&&t in e&&(e=this.Rc,t in e&&delete e[t],(e=this.s)&&e.T("Ignore httpSessionIdParam also specified with messageUrlParams: "+t,void 0))),this.vd=new mt(this)}function ft(e){Ie.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.ne=e)&&(e=this.ne,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function dt(e){Ne.call(this),this.status=1,this.errorCode=e}function mt(e){this.b=e}function gt(){this.V=[],this.Z=[]}function yt(e,t){if(y.call(this),this.oe=e||0,this.Wb=t||10,this.oe>this.Wb)throw Error(Qn);this.fa=new gt,this.oa=new Ge,this.Ac=0,this.Nc=null,this.Cb()}function vt(e,t){this.fe=e,this.gd=t}function bt(e){this.Y=[],e&&this.Lf(e)}function _t(){bt.call(this)}function wt(e,t){this.Gd=void 0,this.cc=new _t,yt.call(this,e,t)}function kt(e,t,n,r){this.Jf=e,this.Ab=!!r,wt.call(this,t,n)}var Et,Tt=Tt||{},St=this,Ct="closure_uid_"+(1e9*Math.random()>>>0),It=0,Nt=Date.now||function(){return+new Date};f(d,Error),d.prototype.name="CustomError",f(m,d),m.prototype.name="AssertionError";var Dt=0,At={};y.prototype.Ka=!1,y.prototype.bb=function(){if(!this.Ka&&(this.Ka=!0,this.F(),0!=Dt)){var e=this[Ct]||(this[Ct]=++It);if(0!=Dt&&this.Qa&&0<this.Qa.length)throw Error(this+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete At[e]}},y.prototype.F=function(){if(this.Qa)for(;this.Qa.length;)this.Qa.shift()()};var xt,Ot=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(t,n){if(e(t))return e(n)&&1==n.length?t.indexOf(n,0):-1;for(var r=0;r<t.length;r++)if(r in t&&t[r]===n)return r;return-1},Pt=Array.prototype.lastIndexOf?function(e,t){return Array.prototype.lastIndexOf.call(e,t,e.length-1)}:function(t,n){var r=t.length-1;if(0>r&&(r=Math.max(0,t.length+r)),e(t))return e(n)&&1==n.length?t.lastIndexOf(n,r):-1;for(;0<=r;r--)if(r in t&&t[r]===n)return r;return-1},Rt=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(t,n,r){for(var i=t.length,o=e(t)?t.split(""):t,a=0;a<i;a++)a in o&&n.call(r,o[a],a,t)},Lt=Array.prototype.some?function(e,t){return Array.prototype.some.call(e,t,void 0)}:function(t,n){for(var r=t.length,i=e(t)?t.split(""):t,o=0;o<r;o++)if(o in i&&n.call(void 0,i[o],o,t))return!0;return!1},Mt=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};e:{var Vt=St.navigator;if(Vt){var jt=Vt.userAgent;if(jt){xt=jt;break e}}xt=""}var Ut="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");x[" "]=n;var qt,Ft=S("Opera"),Bt=S("Trident")||S("MSIE"),Kt=S("Edge"),Wt=Kt||Bt,Ht=S("Gecko")&&!(-1!=xt.toLowerCase().indexOf("webkit")&&!S("Edge"))&&!(S("Trident")||S("MSIE"))&&!S("Edge"),zt=-1!=xt.toLowerCase().indexOf("webkit")&&!S("Edge");e:{var Qt="",Gt=function(){var e=xt;return Ht?/rv:([^\);]+)(\)|;)/.exec(e):Kt?/Edge\/([\d\.]+)/.exec(e):Bt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):zt?/WebKit\/(\S+)/.exec(e):Ft?/(?:Version)[ \/]?(\S+)/.exec(e):void 0}();if(Gt&&(Qt=Gt?Gt[1]:""),Bt){var Xt=P();if(null!=Xt&&Xt>parseFloat(Qt)){qt=String(Xt);break e}}qt=Qt}var Yt,$t={},Jt=St.document;Yt=Jt&&Bt?P()||("CSS1Compat"==Jt.compatMode?parseInt(qt,10):5):void 0;var Zt=Object.freeze||function(e){return e},en=!Bt||9<=Number(Yt),tn=Bt&&!R("9"),nn=function(){if(!St.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{St.addEventListener("test",n,t),St.removeEventListener("test",n,t)}catch(e){}return e}();L.prototype.stopPropagation=function(){this.Ea=!0},L.prototype.preventDefault=function(){this.defaultPrevented=!0,this.Be=!1},f(M,L);var rn=Zt({2:"touch",3:"pen",4:"mouse"});M.prototype.Kf=function(t,n){var r=this.type=t.type,i=t.changedTouches?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.currentTarget=n,n=t.relatedTarget){if(Ht){e:{try{x(n.nodeName);var o=!0;break e}catch(e){}o=!1}o||(n=null)}}else"mouseover"==r?n=t.fromElement:"mouseout"==r&&(n=t.toElement);this.relatedTarget=n,null===i?(this.offsetX=zt||void 0!==t.offsetX?t.offsetX:t.layerX,this.offsetY=zt||void 0!==t.offsetY?t.offsetY:t.layerY,this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0):(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0),this.button=t.button,this.keyCode=t.keyCode||0,this.key=t.key||"",this.charCode=t.charCode||("keypress"==r?t.keyCode:0),this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=e(t.pointerType)?t.pointerType:rn[t.pointerType]||"",this.state=t.state,this.fb=t,t.defaultPrevented&&this.preventDefault()},M.prototype.stopPropagation=function(){M.L.stopPropagation.call(this),this.fb.stopPropagation?this.fb.stopPropagation():this.fb.cancelBubble=!0},M.prototype.preventDefault=function(){M.L.preventDefault.call(this);var e=this.fb;if(e.preventDefault)e.preventDefault();else if(e.returnValue=!1,tn)try{(e.ctrlKey||112<=e.keyCode&&123>=e.keyCode)&&(e.keyCode=-1)}catch(e){}};var on="closure_listenable_"+(1e6*Math.random()|0),an=0;j.prototype.Vb=function(){this.Sa=!0,this.Ob=this.src=this.proxy=this.listener=null},(Et=U.prototype).add=function(e,t,n,r,i){var o=e.toString();(e=this.J[o])||(e=this.J[o]=[],this.xb++);var a=q(e,t,r,i);return-1<a?(t=e[a],n||(t.Eb=!1)):(t=new j(t,this.src,o,!!r,i),t.Eb=n,e.push(t)),t},Et.remove=function(e,t,n,r){if(!((e=e.toString())in this.J))return!1;var i=this.J[e];return-1<(t=q(i,t,n,r))&&(i[t].Vb(),Array.prototype.splice.call(i,t,1),0==i.length&&(delete this.J[e],this.xb--),!0)},Et.ye=function(e){var t=e.type;t in this.J&&_(this.J[t],e)&&(e.Vb(),0==this.J[t].length&&(delete this.J[t],this.xb--))},Et.pb=function(e){e=e&&e.toString();var t;for(t in this.J)if(!e||t==e){for(var n=this.J[t],r=0;r<n.length;r++)n[r].Vb();delete this.J[t],this.xb--}},Et.jb=function(e,t,n,r){var i=-1;return(e=this.J[e.toString()])&&(i=q(e,t,n,r)),-1<i?e[i]:null};var sn="closure_lm_"+(1e6*Math.random()|0),un={},cn=0,ln="__closure_events_fn_"+(1e9*Math.random()>>>0);f(Z,y),Z.prototype[on]=!0,(Et=Z.prototype).addEventListener=function(e,t,n,r){F(this,e,t,n,r)},Et.removeEventListener=function(e,t,n,r){H(this,e,t,n,r)},Et.dispatchEvent=function(t){var n,r=this.Uc;if(r)for(n=[];r;r=r.Uc)n.push(r);r=this.Pe;var i=t.type||t;if(e(t))t=new L(t,r);else if(t instanceof L)t.target=t.target||r;else{var o=t;A(t=new L(i,r),o)}if(o=!0,n)for(var a=n.length-1;!t.Ea&&0<=a;a--){var s=t.currentTarget=n[a];o=s.Lb(i,!0,t)&&o}if(t.Ea||(s=t.currentTarget=r,o=s.Lb(i,!0,t)&&o,t.Ea||(o=s.Lb(i,!1,t)&&o)),n)for(a=0;!t.Ea&&a<n.length;a++)s=t.currentTarget=n[a],o=s.Lb(i,!1,t)&&o;return o},Et.F=function(){Z.L.F.call(this),this.pg(),this.Uc=null},Et.nb=function(e,t,n,r){return this.ka.add(String(e),t,!1,n,r)},Et.Oc=function(e,t,n,r){return this.ka.add(String(e),t,!0,n,r)},Et.ed=function(e,t,n,r){this.ka.remove(String(e),t,n,r)},Et.Le=function(e){this.ka.ye(e)},Et.pg=function(){this.ka&&this.ka.pb(void 0)},Et.Lb=function(e,t,n){if(!(e=this.ka.J[String(e)]))return!0;e=e.concat();for(var r=!0,i=0;i<e.length;++i){var o=e[i];if(o&&!o.Sa&&o.capture==t){var a=o.listener,s=o.Ob||o.src;o.Eb&&this.Le(o),r=!1!==a.call(s,n)&&r}}return r&&0!=n.Be},Et.jb=function(e,t,n,r){return this.ka.jb(String(e),t,n,r)};var hn=St.JSON.stringify;ee.prototype.get=function(){if(0<this.Zb){this.Zb--;var e=this.Pb;this.Pb=e.next,e.next=null}else e=this.ef();return e},ee.prototype.put=function(e){this.ug(e),this.Zb<this.Sf&&(this.Zb++,e.next=this.Pb,this.Pb=e)};var pn=new ee(function(){return new ne},function(e){e.reset()});te.prototype.add=function(e,t){var n=this.Af();n.set(e,t),this.lc?this.lc.next=n:this.Va=n,this.lc=n},te.prototype.remove=function(){var e=null;return this.Va&&(e=this.Va,this.Va=this.Va.next,this.Va||(this.lc=null),e.next=null),e},te.prototype.wg=function(e){pn.put(e)},te.prototype.Af=function(){return pn.get()},ne.prototype.set=function(e,t){this.Gc=e,this.scope=t,this.next=null},ne.prototype.reset=function(){this.next=this.scope=this.Gc=null};var fn,dn,mn=!1,gn=new te;f(se,Z),(Et=se.prototype).enabled=!1,Et.B=null,Et.setInterval=function(e){this.Na=e,this.B&&this.enabled?(this.stop(),this.start()):this.B&&this.stop()},Et.Rg=function(){if(this.enabled){var e=Nt()-this.ie;0<e&&e<.8*this.Na?this.B=this.wb.setTimeout(this.nd,this.Na-e):(this.B&&(this.wb.clearTimeout(this.B),this.B=null),this.ff(),this.enabled&&(this.stop(),this.start()))}},Et.ff=function(){this.dispatchEvent("tick")},Et.start=function(){this.enabled=!0,this.B||(this.B=this.wb.setTimeout(this.nd,this.Na),this.ie=Nt())},Et.stop=function(){this.enabled=!1,this.B&&(this.wb.clearTimeout(this.B),this.B=null)},Et.F=function(){se.L.F.call(this),this.stop(),delete this.wb},f(ce,y),(Et=ce.prototype).Ta=!1,Et.ob=0,Et.B=null,Et.mf=function(e){this.qc=arguments,this.B||this.ob?this.Ta=!0:this.Cc()},Et.stop=function(){this.B&&(St.clearTimeout(this.B),this.B=null,this.Ta=!1,this.qc=[])},Et.pause=function(){this.ob++},Et.resume=function(){this.ob--,this.ob||!this.Ta||this.B||(this.Ta=!1,this.Cc())},Et.F=function(){ce.L.F.call(this),this.stop()},Et.fg=function(){this.B=null,this.Ta&&!this.ob&&(this.Ta=!1,this.Cc())},Et.Cc=function(){this.B=ue(this.Xe,this.Na),this.Uf.apply(null,this.qc)},f(le,y);var yn=[];(Et=le.prototype).nb=function(e,t,n,r){return this.Tf(e,t,n,r)},Et.Tf=function(e,t,n,r){o(t)||(t&&(yn[0]=t.toString()),t=yn);for(var i=0;i<t.length;i++){var a=F(e,t[i],n||this.handleEvent,r||!1,this.i||this);if(!a)break;this.o[a.key]=a}return this},Et.Oc=function(e,t,n,r){return this.je(e,t,n,r)},Et.je=function(e,t,n,r,i){if(o(t))for(var a=0;a<t.length;a++)this.je(e,t[a],n,r,i);else{if(!(e=W(e,t,n||this.handleEvent,r,i||this.i||this)))return this;this.o[e.key]=e}return this},Et.ed=function(e,t,n,r,i){if(o(t))for(var a=0;a<t.length;a++)this.ed(e,t[a],n,r,i);else n=n||this.handleEvent,r=u(r)?!!r.capture:!!r,i=i||this.i||this,n=J(n),r=!!r,(t=V(e)?e.jb(t,n,r,i):e&&(e=$(e))?e.jb(t,n,r,i):null)&&(z(t),delete this.o[t.key])},Et.pb=function(){C(this.o,function(e,t){this.o.hasOwnProperty(t)&&z(e)},this),this.o={}},Et.F=function(){le.L.F.call(this),this.pb()},Et.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},he.prototype.Md=null;var vn=0;he.prototype.reset=function(e,t,n,r,i){"number"==typeof i||vn++,r||Nt(),this.mb=e,delete this.Md},he.prototype.Bg=function(e){this.Md=e},he.prototype.Ge=function(e){this.mb=e},fe.prototype.toString=function(){return this.name};var bn=new fe("SEVERE",1e3),_n=new fe("WARNING",900),wn=new fe("INFO",800),kn=new fe("CONFIG",700),En=new fe("FINE",500);(Et=pe.prototype).getName=function(){return this.pe},Et.getParent=function(){return this.$b},Et.pf=function(){return this.uc||(this.uc={}),this.uc},Et.Ge=function(e){this.mb=e},Et.Qd=function(){return this.mb?this.mb:this.$b?this.$b.Qd():(g("Root logger has no level set."),null)},Et.Pf=function(e){return e.value>=this.Qd().value},Et.log=function(e,t,n){this.Pf(e)&&(s(t)&&(t=t()),this.gf(this.uf(e,t,n)))},Et.uf=function(e,t,n){return e=new he(e,String(t),this.pe),n&&e.Bg(n),e},Et.ca=function(e,t){this.log(bn,e,t)},Et.T=function(e,t){this.log(_n,e,t)},Et.info=function(e,t){this.log(wn,e,t)},Et.lf=function(e){this.log(En,e,void 0)},Et.gf=function(e){for(var t=this;t;)t.We(e),t=t.getParent()},Et.We=function(e){if(this.Zd)for(var t,n=0;t=this.Zd[n];n++)t(e)},Et.Fg=function(e){this.$b=e},Et.Qe=function(e,t){this.pf()[e]=t};var Tn={},Sn=null;(Et=ye.prototype).Id=function(){this.Wc=!1},Et.Tg=function(e,t,n,r,i){var o=this;this.info(function(){return"XMLHTTP REQ ("+n+") [attempt "+r+"]: "+e+"\n"+t+"\n"+o.Xf(i)})},Et.Ug=function(e,t,n,r,i,o){this.info(function(){return"XMLHTTP RESP ("+n+") [ attempt "+r+"]: "+e+"\n"+t+"\n"+i+" "+o})},Et.Wa=function(e,t,n){var r=this;this.info(function(){return"XMLHTTP TEXT ("+e+"): "+r.ng(t)+(n?" "+n:"")})},Et.Sg=function(e){this.info(function(){return"TIMEOUT: "+e})},Et.debug=function(e){ge(this.s,e)},Et.cb=function(e,t){var n=this.s;n&&n.ca(t||"Exception",e)},Et.info=function(e){me(this.s,e)},Et.T=function(e){var t=this.s;t&&t.T(e,void 0)},Et.ca=function(e){var t=this.s;t&&t.ca(e,void 0)},Et.ng=function(e){if(!this.Wc)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(var n=0;n<t.length;n++)o(t[n])&&this.Wf(t[n]);return hn(t)}catch(t){return this.debug("Exception parsing expected JS array - probably was not JS"),e}},Et.Wf=function(e){if(!(2>e.length||(e=e[1],!o(e)||1>e.length))){var t=e[0];if("noop"!=t&&"stop"!=t&&"close"!=t)for(t=1;t<e.length;t++)e[t]=""}},Et.Xf=function(e){if(!this.Wc)return e;if(!e)return null;var t="";e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].split("=");if(1<r.length){var i=r[0];r=r[1];var o=i.split("_");t=2<=o.length&&"type"==o[1]?t+(i+"=")+r+"&":t+(i+"=redacted&")}}return t};var Cn=new Z;f(ve,L),f(_e,L),f(ke,L);var In={NO_ERROR:0,Vg:1,bh:2,ah:3,Yg:4,$g:5,dh:6,Ne:7,TIMEOUT:8,gh:9},Nn={Xg:"complete",kh:"success",Oe:"error",Ne:"abort",ih:"ready",jh:"readystatechange",TIMEOUT:"timeout",eh:"incrementaldata",hh:"progress",Zg:"downloadprogress",lh:"uploadprogress"};Se.prototype.pd=null,Se.prototype.Vd=function(){return this.pd||(this.pd=this.Mf())};var Dn={OPEN:"a",Wg:"b",Oe:"c",fh:"d"};f(Ie,L),f(Ne,L);var An;f(De,Se),De.prototype.Dd=function(){var e=this.Wd();return e?new ActiveXObject(e):new XMLHttpRequest},De.prototype.Mf=function(){var e={};return this.Wd()&&(e[0]=!0,e[1]=!0),e},De.prototype.Wd=function(){if(!this.be&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],t=0;t<e.length;t++){var n=e[t];try{return new ActiveXObject(n),this.be=n}catch(e){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return this.be},An=new De;var xn=45e3,On={},Pn={};(Et=Ae.prototype).ga=function(e){this.A=e},Et.setTimeout=function(e){this.Ua=e},Et.He=function(e){this.Ra=e},Et.Gg=function(e){this.ba=e},Et.la=function(){return this.ba},Et.kd=function(e,t){this.ic=1,this.ua=e.clone().Ub(),this.Da=t,this.yc=!0,this.Ce(null)},Et.jd=function(e,t,n){this.ic=1,this.ua=e.clone().Ub(),this.Da=null,this.yc=t,this.Ce(n)},Et.Ce=function(e){this.qb=Nt(),this.eb(),this.pa=this.ua.clone(),this.pa.dc("t",this.Xc),this.Bb=0,this.h=this.b.Jb(this.b.fc()?e:null),0<this.Ra&&(this.ac=new ce(h(this.Me,this,this.h),this.Ra)),this.Fc.nb(this.h,"readystatechange",this.mg),e=this.A?D(this.A):{},this.Da?(this.Fa||(this.Fa="POST"),e["Content-Type"]="application/x-www-form-urlencoded",this.h.send(this.pa,this.Fa,this.Da,e)):(this.Fa="GET",this.h.send(this.pa,this.Fa,null,e)),be(1),this.a.Tg(this.Fa,this.pa,this.R,this.Xc,this.Da)},Et.mg=function(e){e=e.target;var t=this.ac;t&&3==e.ma()?(this.a.debug("Throttling readystatechange."),t.mf()):this.Me(e)},Et.Me=function(e){try{e==this.h?this.hg():this.a.T("Called back with an unexpected xmlhttp")}catch(e){if(this.a.debug("Failed call to OnXmlHttpReadyStateChanged_"),this.h&&this.h.ya()){var t=this;this.a.cb(e,function(){return"ResponseText: "+t.h.ya()})}else this.a.cb(e,"No response text")}},Et.hg=function(){var e=this.h.ma(),t=this.h.Ud(),n=this.h.za();if(!(3>e||3==e&&!Wt&&!this.h.ya())){this.Za||4!=e||7==t||be(8==t||0>=n?3:2),this.Fb();var r=this.h.za();if(this.w=r,!(t=this.h.ya())){var i=this;this.a.debug(function(){return"No response text for uri "+i.pa+" status "+r})}if(this.S=200==r,this.a.Ug(this.Fa,this.pa,this.R,this.Xc,e,r),this.S){if(this.Ig()){if(!(n=this.sf()))return this.S=!1,this.I=3,we(12),this.a.T("XMLHTTP Missing X_HTTP_INITIAL_RESPONSE ("+this.R+")"),this.Ia(),void this.Kb();this.a.Wa(this.R,n,"Initial handshake response via X-HTTP-Initial-Response"),this.lb=!0,this.Yc(n)}this.yc?(this.Fd(e,t),Wt&&this.S&&3==e&&this.Ng()):(this.a.Wa(this.R,t,null),this.Yc(t)),4==e&&this.Ia(),this.S&&!this.Za&&(4==e?this.b.Tc(this):(this.S=!1,this.eb()))}else 400==r&&0<t.indexOf("Unknown SID")?(this.I=3,we(12),this.a.T("XMLHTTP Unknown SID ("+this.R+")")):(this.I=0,we(13),this.a.T("XMLHTTP Bad status "+r+" ("+this.R+")")),this.Ia(),this.Kb()}},Et.Ig=function(){return this.Ed&&!this.lb},Et.sf=function(){if(this.h){var e=this.h.kb("X-HTTP-Initial-Response");if(e&&!E(e))return e}return null},Et.Ag=function(){this.Ed=!0},Et.Fd=function(e,t){for(var n=!0;!this.Za&&this.Bb<t.length;){var r=this.vf(t);if(r==Pn){4==e&&(this.I=4,we(14),n=!1),this.a.Wa(this.R,null,"[Incomplete Response]");break}if(r==On){this.I=4,we(15),this.a.Wa(this.R,t,"[Invalid Chunk]"),n=!1;break}this.a.Wa(this.R,r,null),this.Yc(r)}4==e&&0==t.length&&(this.I=1,we(16),n=!1),this.S=this.S&&n,n||(this.a.Wa(this.R,t,"[Invalid Chunked Response]"),this.Ia(),this.Kb())},Et.kg=function(){if(this.h){var e=this.h.ma(),t=this.h.ya();this.Bb<t.length&&(this.Fb(),this.Fd(e,t),this.S&&4!=e&&this.eb())}},Et.Ng=function(){this.Fc.nb(this.Vc,"tick",this.kg),this.Vc.start()},Et.vf=function(e){var t=this.Bb,n=e.indexOf("\n",t);return-1==n?Pn:(t=Number(e.substring(t,n)),isNaN(t)?On:(n+=1)+t>e.length?Pn:(e=e.substr(n,t),this.Bb=n+t,e))},Et.yg=function(e){this.ic=2,this.ua=e.clone().Ub(),e=!1,St.navigator&&St.navigator.sendBeacon&&(e=St.navigator.sendBeacon(this.ua.toString(),"")),!e&&St.Image&&((new Image).src=this.ua,e=!0),e||(this.h=this.b.Jb(null),this.h.send(this.ua)),this.qb=Nt(),this.eb()},Et.cancel=function(){this.Za=!0,this.Ia()},Et.tg=function(e){e&&this.setTimeout(e),this.Ga&&(this.Fb(),this.eb())},Et.eb=function(){this.hd=Nt()+this.Ua,this.Ke(this.Ua)},Et.Ke=function(e){if(null!=this.Ga)throw Error("WatchDog timer not null");this.Ga=Te(h(this.gg,this),e)},Et.Fb=function(){this.Ga&&(St.clearTimeout(this.Ga),this.Ga=null)},Et.gg=function(){this.Ga=null;var e=Nt();0<=e-this.hd?this.Df():(this.a.T("WatchDog timer called too early"),this.Ke(this.hd-e))},Et.Df=function(){this.S&&this.a.ca("Received watchdog timeout even though request loaded successfully"),this.a.Sg(this.pa),2!=this.ic&&(be(3),we(17)),this.Ia(),this.I=2,this.Kb()},Et.Kb=function(){this.b.de()||this.Za||this.b.Tc(this)},Et.Ia=function(){this.Fb();var e=this.ac;e&&"function"==typeof e.bb&&e.bb(),this.ac=null,this.Vc.stop(),this.Fc.pb(),this.h&&(e=this.h,this.h=null,e.abort(),e.bb())},Et.Hc=function(){return this.I},Et.Yc=function(e){try{this.b.ue(this,e),be(4)}catch(e){this.a.cb(e,"Error in httprequest callback")}},(Et=Re.prototype).C=function(){return this.j},Et.H=function(){this.wc();for(var e=[],t=0;t<this.o.length;t++)e.push(this.D[this.o[t]]);return e},Et.W=function(){return this.wc(),this.o.concat()},Et.va=function(e){return Le(this.D,e)},Et.X=function(){return 0==this.j},Et.clear=function(){this.D={},this.j=this.o.length=0},Et.remove=function(e){return!!Le(this.D,e)&&(delete this.D[e],this.j--,this.o.length>2*this.j&&this.wc(),!0)},Et.wc=function(){if(this.j!=this.o.length){for(var e=0,t=0;e<this.o.length;){var n=this.o[e];Le(this.D,n)&&(this.o[t++]=n),e++}this.o.length=t}if(this.j!=this.o.length){var r={};for(t=e=0;e<this.o.length;)n=this.o[e],Le(r,n)||(this.o[t++]=n,r[n]=1),e++;this.o.length=t}},Et.get=function(e,t){return Le(this.D,e)?this.D[e]:t},Et.set=function(e,t){Le(this.D,e)||(this.j++,this.o.push(e)),this.D[e]=t},Et.addAll=function(e){if(e instanceof Re)for(var t=e.W(),n=0;n<t.length;n++)this.set(t[n],e.get(t[n]));else for(t in e)this.set(t,e[t])},Et.forEach=function(e,t){for(var n=this.W(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);e.call(t,o,i,this)}},Et.clone=function(){return new Re(this)};var Rn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;(Et=Ve.prototype).toString=function(){var e=[],t=this.qa;t&&e.push(Fe(t,Ln,!0),":");var n=this.xa;return(n||"file"==t)&&(e.push("//"),(t=this.zb)&&e.push(Fe(t,Ln,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.Ca)&&e.push(":",String(n))),(n=this.K)&&(this.Ic()&&"/"!=n.charAt(0)&&e.push("/"),e.push(Fe(n,"/"==n.charAt(0)?Vn:Mn,!0))),(n=this.Rd())&&e.push("?",n),(n=this.ib)&&e.push("#",Fe(n,Un)),e.join("")},Et.resolve=function(e){var t=this.clone(),n=e.Hf();n?t.tb(e.qa):n=e.If(),n?t.cd(e.zb):n=e.Ic(),n?t.rb(e.xa):n=e.Ff();var r=e.K;if(n)t.sb(e.Ca);else if(n=e.ae()){if("/"!=r.charAt(0))if(this.Ic()&&!this.ae())r="/"+r;else{var i=t.K.lastIndexOf("/");-1!=i&&(r=t.K.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(-1!=i.indexOf("./")||-1!=i.indexOf("/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?t.ec(r):n=e.Gf(),n?t.bd(e.P.clone()):n=e.Ef(),n&&t.$c(e.ib),t},Et.clone=function(){return new Ve(this)},Et.tb=function(e,t){this.U(),(this.qa=t?qe(e,!0):e)&&(this.qa=this.qa.replace(/:$/,""))},Et.Hf=function(){return!!this.qa},Et.cd=function(e,t){this.U(),this.zb=t?qe(e):e},Et.If=function(){return!!this.zb},Et.rb=function(e,t){this.U(),this.xa=t?qe(e,!0):e},Et.Ic=function(){return!!this.xa},Et.sb=function(e){if(this.U(),e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);this.Ca=e}else this.Ca=null},Et.Ff=function(){return null!=this.Ca},Et.ec=function(e,t){this.U(),this.K=t?qe(e,!0):e},Et.ae=function(){return!!this.K},Et.Gf=function(){return""!==this.P.toString()},Et.bd=function(e,t){this.U(),e instanceof Ke?(this.P=e,this.P.ad(this.O)):(t||(e=Fe(e,jn)),this.P=new Ke(e,this.O))},Et.Rd=function(){return this.P.toString()},Et.getQuery=function(){return this.Rd()},Et.l=function(e,t){this.U(),this.P.set(e,t)},Et.dc=function(e,t){this.U(),o(t)||(t=[String(t)]),this.P.Ie(e,t)},Et.$c=function(e,t){this.U(),this.ib=t?qe(e):e},Et.Ef=function(){return!!this.ib},Et.Ub=function(){return this.U(),this.l("zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Nt()).toString(36)),this},Et.removeParameter=function(e){return this.U(),this.P.remove(e),this},Et.U=function(){if(this.Qf)throw Error("Tried to modify a read-only Uri")},Et.ad=function(e){this.O=e,this.P&&this.P.ad(e)};var Ln=/[#\/\?@]/g,Mn=/[#\?:]/g,Vn=/[#\?]/g,jn=/[#\?@]/g,Un=/#/g;(Et=Ke.prototype).$=function(){if(!this.m&&(this.m=new Re,this.j=0,this.ja)){var e=this;Me(this.ja,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})}},Et.C=function(){return this.$(),this.j},Et.add=function(e,t){this.$(),this.Oa(),e=this.Ma(e);var n=this.m.get(e);return n||this.m.set(e,n=[]),n.push(t),this.j+=1,this},Et.remove=function(e){return this.$(),e=this.Ma(e),!!this.m.va(e)&&(this.Oa(),this.j-=this.m.get(e).length,this.m.remove(e))},Et.clear=function(){this.Oa(),this.m=null,this.j=0},Et.X=function(){return this.$(),0==this.j},Et.va=function(e){return this.$(),e=this.Ma(e),this.m.va(e)},Et.forEach=function(e,t){this.$(),this.m.forEach(function(n,r){Rt(n,function(n){e.call(t,n,r,this)},this)},this)},Et.W=function(){this.$();for(var e=this.m.H(),t=this.m.W(),n=[],r=0;r<t.length;r++)for(var i=e[r],o=0;o<i.length;o++)n.push(t[r]);return n},Et.H=function(t){this.$();var n=[];if(e(t))this.va(t)&&(n=w(n,this.m.get(this.Ma(t))));else{t=this.m.H();for(var r=0;r<t.length;r++)n=w(n,t[r])}return n},Et.set=function(e,t){return this.$(),this.Oa(),e=this.Ma(e),this.va(e)&&(this.j-=this.m.get(e).length),this.m.set(e,[t]),this.j+=1,this},Et.get=function(e,t){return e&&0<(e=this.H(e)).length?String(e[0]):t},Et.Ie=function(e,t){this.remove(e),0<t.length&&(this.Oa(),this.m.set(this.Ma(e),k(t)),this.j+=t.length)},Et.toString=function(){if(this.ja)return this.ja;if(!this.m)return"";for(var e=[],t=this.m.W(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.H(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),e.push(a)}}return this.ja=e.join("&")},Et.Oa=function(){this.ja=null},Et.clone=function(){var e=new Ke;return e.ja=this.ja,this.m&&(e.m=this.m.clone(),e.j=this.j),e},Et.Ma=function(e){return e=String(e),this.O&&(e=e.toLowerCase()),e},Et.ad=function(e){e&&!this.O&&(this.$(),this.Oa(),this.m.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(this.remove(t),this.Ie(n,e))},this)),this.O=e},Et.extend=function(e){for(var t=0;t<arguments.length;t++)Pe(arguments[t],function(e,t){this.add(t,e)},this)};var qn=null;We.prototype.set=function(e){this.xe=e},We.prototype.reset=function(){this.set(Nt())},We.prototype.get=function(){return this.xe},f(He,function(){qn||(qn=new We)}),(Et=ze.prototype).g=null,Et.ga=function(e){this.A=e},Et.connect=function(e){this.K=e,e=this.b.Sd(this.K),we(3);var t=this.b.Ib.$d;null!=t?(this.na=this.b.$a(t[0]),this.g=1,this.xd()):(e.dc("MODE","init"),!this.b.ta&&this.b.aa&&e.dc("X-HTTP-Session-Id",this.b.aa),this.f=new Ae(this,this.a,void 0,void 0,void 0),this.f.ga(this.A),this.f.jd(e,!1,null),this.g=0)},Et.xd=function(){this.a.debug("TestConnection: starting stage 2");var e=this.b.Ib.od;if(null!=e)this.a.debug(function(){return"Buffered"}),we(4),e?(we(10),this.b.ub(this,!1)):(we(11),this.b.ub(this,!0));else{this.f=new Ae(this,this.a,void 0,void 0,void 0),this.f.ga(this.A);var t=this.b.Pd(this.na,this.K);we(4),t.dc("TYPE","xmlhttp");var n=this.b.aa,r=this.b.Kc;n&&r&&t.l(n,r),this.f.jd(t,!1,this.na)}},Et.Jb=function(e){return this.b.Jb(e)},Et.abort=function(){this.f&&(this.f.cancel(),this.f=null),this.w=-1},Et.de=function(){return!1},Et.ue=function(e,t){if(this.w=e.w,0==this.g)if(this.a.debug("TestConnection: Got data for stage 1"),this.pc(e),t){try{var n=this.b.kc.zc(t)}catch(e){return this.a.cb(e),void this.b.dd(this)}this.na=this.b.$a(n[0])}else this.a.debug("TestConnection: Null responseText"),this.b.dd(this);else 1==this.g&&(this.bc?we(6):"11111"==t?(we(5),this.bc=!0,this.Ze()&&(this.w=200,this.f.cancel(),this.a.debug("Test connection succeeded; using streaming connection"),we(11),this.b.ub(this,!0))):(we(7),this.bc=!1))},Et.Tc=function(){this.w=this.f.w,this.f.S?0==this.g?(this.g=1,this.a.debug("TestConnection: request complete for initial check"),this.xd()):1==this.g&&(this.a.debug("TestConnection: request complete for stage 2"),this.bc?(this.a.debug("Test connection succeeded; using streaming connection"),we(11),this.b.ub(this,!0)):(this.a.debug("Test connection failed; not using streaming"),we(10),this.b.ub(this,!1))):(this.a.debug("TestConnection: request failed, in state "+this.g),0==this.g?we(8):1==this.g&&we(9),this.b.dd(this))},Et.pc=function(e){if(!this.b.ta&&(e=e.h)){var t=e.kb("X-Client-Wire-Protocol");this.Ad=t||null,this.b.aa&&((e=e.kb("X-HTTP-Session-Id"))?this.b.Fe(e):this.a.T("Missing X_HTTP_SESSION_ID in the handshake response"))}},Et.fc=function(){return this.b.fc()},Et.Ba=function(){return this.b.Ba()},Et.Ze=function(){return!Bt||10<=Number(Yt)},(Et=Ge.prototype).C=function(){return this.D.C()},Et.add=function(e){this.D.set(Xe(e),e)},Et.addAll=function(e){for(var t=(e=Oe(e)).length,n=0;n<t;n++)this.add(e[n])},Et.pb=function(e){for(var t=(e=Oe(e)).length,n=0;n<t;n++)this.remove(e[n])},Et.remove=function(e){return this.D.remove(Xe(e))},Et.clear=function(){this.D.clear()},Et.X=function(){return this.D.X()},Et.contains=function(e){return this.D.va(Xe(e))},Et.H=function(){return this.D.H()},Et.clone=function(){return new Ge(this)};var Fn=10;(Et=$e.prototype).ld=function(e){this.v||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(this.Xb=this.me,this.v=new Ge,this.f&&(this.oc(this.f),this.f=null))},Et.ee=function(){return!!this.f||!!this.v&&this.v.C()>=this.Xb},Et.xf=function(){return this.f?1:this.v?this.v.C():0},Et.Jc=function(e){return this.f?this.f==e:!!this.v&&this.v.contains(e)},Et.oc=function(e){this.v?this.v.add(e):this.f=e},Et.ze=function(e){this.f&&this.f==e?this.f=null:this.v&&this.v.contains(e)&&this.v.remove(e)},Et.cancel=function(){this.ba=this.la(),this.f?(this.f.cancel(),this.f=null):this.v&&!this.v.X()&&(Rt(this.v.H(),function(e){e.cancel()}),this.v.clear())},Et.la=function(){if(null!=this.f)return this.ba.concat(this.f.la());if(null!=this.v&&!this.v.X()){var e=this.ba;return Rt(this.v.H(),function(t){e=e.concat(t.la())}),e}return k(this.ba)},Et.Re=function(e){this.ba=this.ba.concat(e)},Et.$e=function(){this.ba.length=0},Je.prototype.stringify=function(e){return St.JSON.stringify(e,this.rg)},Je.prototype.parse=function(e){return St.JSON.parse(e,this.xg)},Ze.prototype.hf=function(e,t,n){var r=n||"";try{Pe(e,function(e,n){var i=e;u(e)&&(i=hn(e)),t.push(r+n+"="+encodeURIComponent(i))})}catch(e){throw t.push(r+"type="+encodeURIComponent("_badmap")),e}},Ze.prototype.jf=function(e,t,n){for(var r=-1;;){var i=["count="+t];-1==r?0<t?(r=e[0].Pc,i.push("ofs="+r)):r=0:i.push("ofs="+r);for(var o=!0,a=0;a<t;a++){var s=e[a].Pc,u=e[a].map;if(0>(s-=r))r=Math.max(0,e[a].Pc-100),o=!1;else try{this.hf(u,i,"req"+s+"_")}catch(e){n&&n(u)}}if(o)return i.join("&")}},Ze.prototype.zc=function(e){return this.jg.parse(e)};var Bn=St.JSON.parse;f(nt,Z);var Kn="";nt.prototype.s=de("goog.net.XhrIo");var Wn=/^https?$/i,Hn=["POST","PUT"];(Et=nt.prototype).Je=function(e){this.Ab=e},Et.send=function(e,t,n,r){if(this.c)throw Error("[goog.net.XhrIo] Object is active with another request="+this.Tb+"; newUri="+e);t=t?t.toUpperCase():"GET",this.Tb=e,this.I="",this.Pa=0,this.ge=t,this.Ec=!1,this.ha=!0,this.c=this.df(),this.mc=this.Xa?this.Xa.Vd():An.Vd(),this.c.onreadystatechange=h(this.te,this),this.lg&&"onprogress"in this.c&&(this.c.onprogress=h(function(e){this.re(e,!0)},this),this.c.upload&&(this.c.upload.onprogress=h(this.re,this)));try{ge(this.s,this.da("Opening Xhr")),this.Lc=!0,this.c.open(t,String(e),!0),this.Lc=!1}catch(e){return ge(this.s,this.da("Error opening Xhr: "+e.message)),void this.Ld(e)}e=n||"";var i=this.headers.clone();r&&Pe(r,function(e,t){i.set(t,e)}),r=v(i.W()),n=St.FormData&&e instanceof St.FormData,!(0<=Ot(Hn,t))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(e,t){this.c.setRequestHeader(t,e)},this),this.Ae&&(this.c.responseType=this.Ae),"withCredentials"in this.c&&this.c.withCredentials!==this.Ab&&(this.c.withCredentials=this.Ab);try{this.yd(),0<this.vb&&(this.jc=rt(this.c),ge(this.s,this.da("Will abort after "+this.vb+"ms if incomplete, xhr2 "+this.jc)),this.jc?(this.c.timeout=this.vb,this.c.ontimeout=h(this.Ua,this)):this.hc=ue(this.Ua,this.vb,this)),ge(this.s,this.da("Sending request")),this.Qb=!0,this.c.send(e),this.Qb=!1}catch(e){ge(this.s,this.da("Send error: "+e.message)),this.Ld(e)}},Et.df=function(){return this.Xa?this.Xa.Dd():An.Dd()},Et.Ua=function(){void 0!==Tt&&this.c&&(this.I="Timed out after "+this.vb+"ms, aborting",this.Pa=8,ge(this.s,this.da(this.I)),this.dispatchEvent("timeout"),this.abort(8))},Et.Ld=function(e){this.ha=!1,this.c&&(this.Aa=!0,this.c.abort(),this.Aa=!1),this.I=e,this.Pa=5,this.Jd(),this.Gb()},Et.Jd=function(){this.Ec||(this.Ec=!0,this.dispatchEvent("complete"),this.dispatchEvent("error"))},Et.abort=function(e){this.c&&this.ha&&(ge(this.s,this.da("Aborting")),this.ha=!1,this.Aa=!0,this.c.abort(),this.Aa=!1,this.Pa=e||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),this.Gb())},Et.F=function(){this.c&&(this.ha&&(this.ha=!1,this.Aa=!0,this.c.abort(),this.Aa=!1),this.Gb(!0)),nt.L.F.call(this)},Et.te=function(){this.Ka||(this.Lc||this.Qb||this.Aa?this.se():this.eg())},Et.eg=function(){this.se()},Et.se=function(){if(this.ha&&void 0!==Tt)if(this.mc[1]&&4==this.ma()&&2==this.za())ge(this.s,this.da("Local request error detected and ignored"));else if(this.Qb&&4==this.ma())ue(this.te,0,this);else if(this.dispatchEvent("readystatechange"),this.Mc()){ge(this.s,this.da("Request complete")),this.ha=!1;try{this.Rf()?(this.dispatchEvent("complete"),this.dispatchEvent("success")):(this.Pa=6,this.I=this.Yd()+" ["+this.za()+"]",this.Jd())}finally{this.Gb()}}},Et.re=function(e,t){this.dispatchEvent(ot(e,"progress")),this.dispatchEvent(ot(e,t?"downloadprogress":"uploadprogress"))},Et.Gb=function(e){if(this.c){this.yd();var t=this.c,r=this.mc[0]?n:null;this.mc=this.c=null,e||this.dispatchEvent("ready");try{t.onreadystatechange=r}catch(t){(e=this.s)&&e.ca("Problem encountered resetting onreadystatechange: "+t.message,void 0)}}},Et.yd=function(){this.c&&this.jc&&(this.c.ontimeout=null),this.hc&&(St.clearTimeout(this.hc),this.hc=null)},Et.Ba=function(){return!!this.c},Et.Mc=function(){return 4==this.ma()},Et.Rf=function(){var e=this.za();e:switch(e){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}return t||0===e&&!this.Of()},Et.Of=function(){var e=String(this.Tb).match(Rn)[1]||null;return!e&&St.self&&St.self.location&&(e=St.self.location.protocol,e=e.substr(0,e.length-1)),Wn.test(e?e.toLowerCase():"")},Et.ma=function(){return this.c?this.c.readyState:0},Et.za=function(){try{return 2<this.ma()?this.c.status:-1}catch(e){return-1}},Et.Yd=function(){try{return 2<this.ma()?this.c.statusText:""}catch(e){return ge(this.s,"Can not get status: "+e.message),""}},Et.ya=function(){try{return this.c?this.c.responseText:""}catch(e){return ge(this.s,"Can not get responseText: "+e.message),""}},Et.yf=function(e){if(this.c){var t=this.c.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Bn(t)}},Et.getResponseHeader=function(e){if(this.c&&this.Mc())return null===(e=this.c.getResponseHeader(e))?void 0:e},Et.getAllResponseHeaders=function(){return this.c&&this.Mc()?this.c.getAllResponseHeaders()||"":""},Et.kb=function(e){return this.c?this.c.getResponseHeader(e):null},Et.Ud=function(){return this.Pa},Et.Hc=function(){return e(this.I)?this.I:String(this.I)},Et.da=function(e){return e+" ["+this.ge+" "+this.Tb+" "+this.za()+"]"},(Et=ut.prototype).tc=8,Et.g=1,Et.connect=function(e,t,n,r,i){this.a.debug("connect()"),we(0),this.K=t,this.gb=n||{},r&&void 0!==i&&(this.gb.OSID=r,this.gb.OAID=i),this.ta&&(this.a.debug("connect() bypassed channel-test."),this.Ib.$d=[],this.Ib.od=!1),this.bf(e)},Et.disconnect=function(){if(this.a.debug("disconnect()"),this.qd(),3==this.g){var e=this.Yb++,t=this.hb.clone();t.l("SID",this.ra),t.l("RID",e),t.l("TYPE","terminate"),this.Ya(t),new Ae(this,this.a,this.ra,e,void 0).yg(t)}this.qe()},Et.bf=function(e){this.a.debug("connectTest_()"),this.Ja=new ze(this,this.a),null===this.N&&this.Ja.ga(this.A);var t=e;this.N&&this.A&&(t=st(e,this.N,this.A)),this.Ja.connect(t)},Et.af=function(){this.a.debug("connectChannel_()"),this.hb=this.Sd(this.K),this.Dc()},Et.qd=function(){this.Ja&&(this.Ja.abort(),this.Ja=null),this.u&&(this.u.cancel(),this.u=null),this.ia&&(St.clearTimeout(this.ia),this.ia=null),this.Hb(),this.G.cancel(),this.ea&&(St.clearTimeout(this.ea),this.ea=null)},Et.ga=function(e){this.A=e},Et.Eg=function(e){this.Rb=e},Et.Cg=function(e){this.N=e},Et.Dg=function(e){this.aa=e},Et.Fe=function(e){this.Kc=e},Et.He=function(e){this.Ra=e},Et.Hg=function(){this.gc=!0},Et.Ee=function(e){this.i=e},Et.Nf=function(){return!this.fd},Et.Zc=function(e){1e3==this.M.length&&this.a.ca(function(){return"Already have 1000 queued maps upon queueing "+hn(e)}),this.M.push(new Ye(this.ag++,e)),3==this.g&&this.Dc()},Et.qf=function(){return this.kf?0:this.nf},Et.de=function(){return 0==this.g},Et.getState=function(){return this.g},Et.Dc=function(){this.G.ee()||this.ea||(this.ea=Te(h(this.we,this),0),this.La=0)},Et.Yf=function(e){return this.G.xf()>=this.G.Xb-(this.ea?1:0)?(this.a.ca("Unexpected retry request is scheduled."),!1):this.ea?(this.a.debug("Use the retry request that is already scheduled."),this.M=e.la().concat(this.M),!0):!(1==this.g||2==this.g||this.La>=this.qf()||(this.a.debug("Going to retry POST"),this.ea=Te(h(this.we,this,e),this.Xd(this.La)),this.La++,0))},Et.we=function(e){this.ea=null,this.Mg(e)},Et.Mg=function(e){this.a.debug("startForwardChannel_"),1==this.g?e?this.a.ca("Not supposed to retry the open"):(this.ig(),this.g=2):3==this.g&&(e?this.le(e):0==this.M.length?this.a.debug("startForwardChannel_ returned: nothing to send"):this.G.ee()?this.a.ca("startForwardChannel_ returned: connection already in progress"):(this.le(),this.a.debug("startForwardChannel_ finished, sent request")))},Et.ig=function(){this.a.debug("open_()"),this.Yb=Math.floor(1e5*Math.random());var e=this.Yb++,t=new Ae(this,this.a,"",e,void 0),n=this.A;this.Rb&&(n?(n=D(n),A(n,this.Rb)):n=this.Rb),null===this.N&&t.ga(n);var r=this.Hd(t),i=this.hb.clone();i.l("RID",e),0<this.Bd&&i.l("CVER",this.Bd),this.ta&&this.aa&&i.l("X-HTTP-Session-Id",this.aa),this.Ya(i),this.N&&n&&st(i,this.N,n),this.G.oc(t),this.Nd?(i.l("$req",r),i.l("SID","null"),t.Ag(),t.kd(i,null)):t.kd(i,r)},Et.le=function(e){var t=e?e.R:this.Yb++,n=this.hb.clone();n.l("SID",this.ra),n.l("RID",t),n.l("AID",this.Sb),this.Ya(n),this.N&&this.A&&st(n,this.N,this.A),t=new Ae(this,this.a,this.ra,t,this.La+1),null===this.N&&t.ga(this.A),e&&this.sg(e),e=this.Hd(t),t.setTimeout(Math.round(.5*this.Od)+Math.round(.5*this.Od*Math.random())),this.G.oc(t),t.kd(n,e)},Et.Ya=function(e){this.i&&Pe({},function(t,n){e.l(n,t)})},Et.Hd=function(e){var t=Math.min(this.M.length,1e3),n=this.i?h(this.i.Ue,this.i,this):null;return n=this.kc.jf(this.M,t,n),e.Gg(this.M.splice(0,t)),n},Et.sg=function(e){this.M=e.la().concat(this.M)},Et.Kd=function(){if(!this.u&&!this.ia){this.rc=1;var e=this.ve;dn||oe(),mn||(dn(),mn=!0),gn.add(e,this),this.Ha=0}},Et.Qc=function(){return this.u||this.ia?(this.a.ca("Request already in progress"),!1):!(3<=this.Ha||(this.a.debug("Going to retry GET"),this.rc++,this.ia=Te(h(this.ve,this),this.Xd(this.Ha)),this.Ha++,0))},Et.ve=function(){this.ia=null,this.Kg()},Et.Kg=function(){this.a.debug("Creating new HttpRequest"),this.u=new Ae(this,this.a,this.ra,"rpc",this.rc),null===this.N&&this.u.ga(this.A),this.u.He(this.Ra);var e=this.md.clone();e.l("RID","rpc"),e.l("SID",this.ra),e.l("CI",this.fd?"0":"1"),e.l("AID",this.Sb),this.Ya(e),e.l("TYPE","xmlhttp"),this.N&&this.A&&st(e,this.N,this.A),this.Db&&this.u.setTimeout(this.Db),this.u.jd(e,!0,this.na),this.a.debug("New Request created")},Et.ub=function(e,t){this.a.debug("Test Connection Finished");var n=e.Ad;n&&this.G.ld(n),this.fd=this.Se&&t,this.w=e.w,this.af()},Et.dd=function(e){this.a.debug("Test Connection Failed"),this.w=e.w,this.sa(2)},Et.ue=function(e,t){if(0!=this.g&&(this.u==e||this.G.Jc(e)))if(this.w=e.w,!e.lb&&this.G.Jc(e)&&3==this.g){try{var n=this.kc.zc(t)}catch(e){n=null}o(n)&&3==n.length?this.Cf(n,e):(this.a.debug("Bad POST response data returned"),this.sa(11))}else(e.lb||this.u==e)&&this.Hb(),E(t)||(n=this.kc.zc(t),this.dg(n,e))},Et.Cf=function(e,t){0==e[0]?this.Bf(t):(this.he=e[1],0<(t=this.he-this.Sb)&&(e=e[2],this.a.debug(e+" bytes (in "+t+" arrays) are outstanding on the BackChannel"),this.Jg(e)&&!this.wa&&(this.wa=Te(h(this.bg,this),6e3))))},Et.Bf=function(e){if(this.a.debug("Server claims our backchannel is missing."),this.ia)this.a.debug("But we are currently starting the request.");else{if(this.u){if(!(this.u.qb+3e3<e.qb))return;this.Hb(),this.u.cancel(),this.u=null}else this.a.T("We do not have a BackChannel established");this.Qc(),we(18)}},Et.Jg=function(e){return 37500>e&&!this.Nf()&&0==this.Ha},Et.$a=function(e){return this.Te?this.i?this.i.$a(e):e:null},Et.bg=function(){null!=this.wa&&(this.wa=null,this.u.cancel(),this.u=null,this.Qc(),we(19))},Et.Hb=function(){null!=this.wa&&(St.clearTimeout(this.wa),this.wa=null)},Et.Tc=function(e){this.a.debug("Request complete");var t=null;if(this.u==e){this.Hb(),this.u=null;var n=2}else{if(!this.G.Jc(e))return;t=e.la(),this.G.ze(e),n=1}if(this.w=e.w,0!=this.g)if(e.S)1==n?(Ee(e.Da?e.Da.length:0,Nt()-e.qb,this.La),this.Dc()):this.Kd();else{var r=e.Hc();if(3==r||0==r&&0<this.w)this.a.debug("Not retrying due to error type");else{var i=this;if(this.a.debug(function(){return"Maybe retrying, last error: "+xe(r,i.w)}),1==n&&this.Yf(e)||2==n&&this.Qc())return;this.a.debug("Exceeded max number of retries")}switch(t&&0<t.length&&this.G.Re(t),this.a.debug("Error: HTTP request failed"),r){case 1:this.sa(5);break;case 4:this.sa(10);break;case 3:this.sa(6);break;default:this.sa(2)}}},Et.Xd=function(e){var t=this.Ve+Math.floor(Math.random()*this.vg);return this.Ba()||(this.a.debug("Inactive channel"),t*=2),t*e},Et.pc=function(e){if(this.ta&&(e=e.h)){var t=e.kb("X-Client-Wire-Protocol");t&&this.G.ld(t),this.aa&&((e=e.kb("X-HTTP-Session-Id"))?(this.Fe(e),this.hb.l(this.aa,e)):this.a.T("Missing X_HTTP_SESSION_ID in the handshake response"))}},Et.dg=function(e,t){for(var n=this.i&&this.i.sc?[]:null,r=0;r<e.length;r++){var i=e[r];if(this.Sb=i[0],i=i[1],2==this.g)if("c"==i[0]){this.ra=i[1],this.na=this.$a(i[2]);var o=i[3];null!=o&&(this.tc=o,this.a.info("VER="+this.tc)),null!=(o=i[4])&&(this.De=o,this.a.info("SVER="+this.De)),null!=(i=i[5])&&"number"==typeof i&&0<i&&(this.Db=i*=1.5,this.a.info("backChannelRequestTimeoutMs_="+i)),this.pc(t),this.g=3,this.i&&this.i.wd(),this.Lg(t)}else"stop"!=i[0]&&"close"!=i[0]||this.sa(7);else 3==this.g&&("stop"==i[0]||"close"==i[0]?(n&&0!=n.length&&(this.i.sc(this,n),n.length=0),"stop"==i[0]?this.sa(7):this.disconnect()):"noop"!=i[0]&&(n?n.push(i):this.i&&this.i.ud(i)),this.Ha=0)}n&&0!=n.length&&this.i.sc(this,n)},Et.Lg=function(e){this.md=this.Pd(this.na,this.K),e.lb?(this.a.debug("Upgrade the handshake request to a backchannel."),this.G.ze(e),e.tg(this.Db),this.u=e):this.Kd()},Et.sa=function(e){if(this.a.info("Error code "+e),2==e){var t=null;this.i&&(t=null);var n=h(this.Pg,this);t||(t=new Ve("//www.google.com/images/cleardot.gif"),St.location&&"http"==St.location.protocol||t.tb("https"),t.Ub()),et(t.toString(),n)}else we(2);this.cg(e)},Et.Pg=function(e){e?(this.a.info("Successfully pinged google.com"),we(2)):(this.a.info("Failed to ping google.com"),we(1))},Et.cg=function(e){this.a.debug("HttpChannel: error - "+e),this.g=0,this.i&&this.i.td(e),this.qe(),this.qd()},Et.qe=function(){if(this.g=0,this.w=-1,this.i){var e=this.G.la();if(0!=e.length||0!=this.M.length){var t=this;this.a.debug(function(){return"Number of undelivered maps, pending: "+e.length+", outgoing: "+t.M.length}),this.G.$e(),k(this.M),this.M.length=0}this.i.sd()}},Et.Sd=function(e){return e=this.Cd(null,e),this.a.debug("GetForwardChannelUri: "+e),e},Et.Pd=function(e,t){return e=this.Cd(this.fc()?e:null,t),this.a.debug("GetBackChannelUri: "+e),e},Et.Cd=function(e,t){var n=je(t);if(""!=n.xa)e&&n.rb(e+"."+n.xa),n.sb(n.Ca);else{var r=St.location;n=Ue(r.protocol,e?e+"."+r.hostname:r.hostname,+r.port,t)}return this.gb&&C(this.gb,function(e,t){n.l(t,e)}),e=this.aa,t=this.Kc,e&&t&&n.l(e,t),n.l("VER",this.tc),this.Ya(n),n},Et.Jb=function(e){if(e&&!this.gc)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new nt(this.Xa)).Je(this.gc),e},Et.Ba=function(){return!!this.i&&this.i.Ba()},Et.fc=function(){return this.gc},new He,(Et=ct.prototype).sc=null,Et.wd=function(){},Et.ud=function(){},Et.td=function(){},Et.sd=function(){},Et.Ba=function(){return!0},Et.Ue=function(){},Et.$a=function(e){return e},ht.prototype.cf=function(e,t){return new pt(e,t)},f(pt,Z),(Et=pt.prototype).addEventListener=function(e,t,n,r){pt.L.addEventListener.call(this,e,t,n,r)},Et.removeEventListener=function(e,t,n,r){pt.L.removeEventListener.call(this,e,t,n,r)},Et.open=function(){this.b.Ee(this.vd),this.Og&&this.b.Hg(),this.b.connect(this.Qg,this.yb,this.Rc||void 0)},Et.close=function(){this.b.disconnect()},Et.send=function(t){if(e(t)){var n={};n.__data__=t,this.b.Zc(n)}else this.zg?(n={},n.__data__=hn(t),this.b.Zc(n)):this.b.Zc(t)},Et.F=function(){this.b.Ee(null),delete this.vd,this.b.disconnect(),delete this.b,pt.L.F.call(this)},f(ft,Ie),f(dt,Ne),f(mt,ct),mt.prototype.wd=function(){me(this.b.s,"WebChannel opened on "+this.b.yb),this.b.dispatchEvent("a")},mt.prototype.ud=function(e){this.b.dispatchEvent(new ft(e))},mt.prototype.td=function(e){me(this.b.s,"WebChannel aborted on "+this.b.yb+" due to channel error: "+e),this.b.dispatchEvent(new dt(e))},mt.prototype.sd=function(){me(this.b.s,"WebChannel closed on "+this.b.yb),this.b.dispatchEvent("b")};var zn=p(function(e,t){function n(){}n.prototype=e.prototype;var r=new n;return e.apply(r,Array.prototype.slice.call(arguments,1)),r},ht);(Et=gt.prototype).Vf=function(){0==this.V.length&&(this.V=this.Z,this.V.reverse(),this.Z=[])},Et.enqueue=function(e){this.Z.push(e)},Et.ab=function(){return this.Vf(),this.V.pop()},Et.C=function(){return this.V.length+this.Z.length},Et.X=function(){return 0==this.V.length&&0==this.Z.length},Et.clear=function(){this.V=[],this.Z=[]},Et.contains=function(e){return 0<=Ot(this.V,e)||0<=Ot(this.Z,e)},Et.remove=function(e){var t=this.V,n=Pt(t,e);return 0<=n?(Array.prototype.splice.call(t,n,1),t=!0):t=!1,t||_(this.Z,e)},Et.H=function(){for(var e=[],t=this.V.length-1;0<=t;--t)e.push(this.V[t]);var n=this.Z.length;for(t=0;t<n;++t)e.push(this.Z[t]);return e},f(yt,y);var Qn="[goog.structs.Pool] Min can not be greater than max";(Et=yt.prototype).Mb=function(){var e=Nt();if(!(null!=this.Nc&&e-this.Nc<this.Ac)){var t=this.qg();return t&&(this.Nc=e,this.oa.add(t)),t}},Et.og=function(e){return!!this.oa.remove(e)&&(this.nc(e),!0)},Et.qg=function(){for(var e;0<this.Td()&&(e=this.fa.ab(),!this.Sc(e));)this.Cb();return!e&&this.C()<this.Wb&&(e=this.xc()),e},Et.nc=function(e){this.oa.remove(e),this.Sc(e)&&this.C()<this.Wb?this.fa.enqueue(e):this.Bc(e)},Et.Cb=function(){for(var e=this.fa;this.C()<this.oe;)e.enqueue(this.xc());for(;this.C()>this.Wb&&0<this.Td();)this.Bc(e.ab())},Et.xc=function(){return{}},Et.Bc=function(e){if("function"==typeof e.bb)e.bb();else for(var t in e)e[t]=null},Et.Sc=function(e){return"function"!=typeof e.Ye||e.Ye()},Et.contains=function(e){return this.fa.contains(e)||this.oa.contains(e)},Et.C=function(){return this.fa.C()+this.oa.C()},Et.rf=function(){return this.oa.C()},Et.Td=function(){return this.fa.C()},Et.X=function(){return this.fa.X()&&this.oa.X()},Et.F=function(){if(yt.L.F.call(this),0<this.rf())throw Error("[goog.structs.Pool] Objects not released");delete this.oa;for(var e=this.fa;!e.X();)this.Bc(e.ab());delete this.fa},vt.prototype.getKey=function(){return this.fe},vt.prototype.clone=function(){return new vt(this.fe,this.gd)},(Et=bt.prototype).ce=function(e,t){var n=this.Y;n.push(new vt(e,t)),this.$f(n.length-1)},Et.Lf=function(e){if(e instanceof bt){var t=e.W();if(e=e.H(),0>=this.C()){for(var n=this.Y,r=0;r<t.length;r++)n.push(new vt(t[r],e[r]));return}}else t=N(e),e=I(e);for(r=0;r<t.length;r++)this.ce(t[r],e[r])},Et.remove=function(){var e=this.Y,t=e.length,n=e[0];if(!(0>=t))return 1==t?b(e):(e[0]=e.pop(),this.Zf()),n.gd},Et.Zf=function(){for(var e=0,t=this.Y,n=t.length,r=t[e];e<n>>1;){var i=this.tf(e),o=this.zf(e);if(i=o<n&&t[o].getKey()<t[i].getKey()?o:i,t[i].getKey()>r.getKey())break;t[e]=t[i],e=i}t[e]=r},Et.$f=function(e){for(var t=this.Y,n=t[e];0<e;){var r=this.wf(e);if(!(t[r].getKey()>n.getKey()))break;t[e]=t[r],e=r}t[e]=n},Et.tf=function(e){return 2*e+1},Et.zf=function(e){return 2*e+2},Et.wf=function(e){return e-1>>1},Et.H=function(){for(var e=this.Y,t=[],n=e.length,r=0;r<n;r++)t.push(e[r].gd);return t},Et.W=function(){for(var e=this.Y,t=[],n=e.length,r=0;r<n;r++)t.push(e[r].getKey());return t},Et.va=function(e){return Lt(this.Y,function(t){return t.getKey()==e})},Et.clone=function(){return new bt(this)},Et.C=function(){return this.Y.length},Et.X=function(){return 0==this.Y.length},Et.clear=function(){b(this.Y)},f(_t,bt),_t.prototype.enqueue=function(e,t){this.ce(e,t)},_t.prototype.ab=function(){return this.remove()},f(wt,yt),(Et=wt.prototype).Mb=function(e,t){if(!e)return(e=wt.L.Mb.call(this))&&this.Ac&&(this.Gd=St.setTimeout(h(this.Nb,this),this.Ac)),e;this.cc.enqueue(void 0!==t?t:100,e),this.Nb()},Et.Nb=function(){for(var e=this.cc;0<e.C();){var t=this.Mb();if(!t)break;e.ab().apply(this,[t])}},Et.nc=function(e){wt.L.nc.call(this,e),this.Nb()},Et.Cb=function(){wt.L.Cb.call(this),this.Nb()},Et.F=function(){wt.L.F.call(this),St.clearTimeout(this.Gd),this.cc.clear(),this.cc=null},f(kt,wt),kt.prototype.xc=function(){var e=new nt,t=this.Jf;return t&&t.forEach(function(t,n){e.headers.set(n,t)}),this.Ab&&e.Je(!0),e},kt.prototype.Sc=function(e){return!e.Ka&&!e.Ba()},ht.prototype.createWebChannel=ht.prototype.cf,pt.prototype.send=pt.prototype.send,pt.prototype.open=pt.prototype.open,pt.prototype.close=pt.prototype.close,In.NO_ERROR=0,In.TIMEOUT=8,In.HTTP_ERROR=6,Nn.COMPLETE="complete",Ce.EventType=Dn,Dn.OPEN="a",Dn.CLOSE="b",Dn.ERROR="c",Dn.MESSAGE="d",Z.prototype.listen=Z.prototype.nb,kt.prototype.getObject=kt.prototype.Mb,kt.prototype.releaseObject=kt.prototype.og,nt.prototype.listenOnce=nt.prototype.Oc,nt.prototype.getLastError=nt.prototype.Hc,nt.prototype.getLastErrorCode=nt.prototype.Ud,nt.prototype.getStatus=nt.prototype.za,nt.prototype.getStatusText=nt.prototype.Yd,nt.prototype.getResponseJson=nt.prototype.yf,nt.prototype.getResponseText=nt.prototype.ya,nt.prototype.getResponseText=nt.prototype.ya,nt.prototype.send=nt.prototype.send,r.exports={createWebChannelTransport:zn,ErrorCode:In,EventType:Nn,WebChannel:Ce,XhrIoPool:kt}}).call(void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})}(function(){return this}(),0,0,n)}),define("@firebase/firestore@0.8.8#dist/index.cjs",["require","exports","module","@firebase/app","@firebase/logger","tslib","@firebase/webchannel-wrapper"],function(e,t,n){!function(e,t,n,r){"use strict";function i(){return Dt.logLevel===St.LogLevel.DEBUG?Et.DEBUG:Dt.logLevel===St.LogLevel.SILENT?Et.SILENT:Et.ERROR}function o(e){switch(e){case Et.DEBUG:Dt.logLevel=St.LogLevel.DEBUG;break;case Et.ERROR:Dt.logLevel=St.LogLevel.ERROR;break;case Et.SILENT:Dt.logLevel=St.LogLevel.SILENT;break;default:Dt.error("Firestore ("+Nt+"): Invalid value passed to `setLogLevel`")}}function a(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(Dt.logLevel<=St.LogLevel.DEBUG){var i=n.map(u);Dt.debug.apply(Dt,["Firestore ("+Nt+") ["+e+"]: "+t].concat(i))}}function s(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(Dt.logLevel<=St.LogLevel.ERROR){var r=t.map(u);Dt.error.apply(Dt,["Firestore ("+Nt+"): "+e].concat(r))}}function u(e){if("string"==typeof e)return e;var t=At.getPlatform();try{return t.formatJSON(e)}catch(t){return e}}function c(e){var t="FIRESTORE ("+Nt+") INTERNAL ASSERTION FAILED: "+e;throw s(t),new Error(t)}function l(e,t){e||c(t)}function h(){return At.getPlatform().emptyByteString}function p(e,t){function n(){var e="This constructor is private.";throw t&&(e+=" ",e+=t),new Ot(xt.INVALID_ARGUMENT,e)}n.prototype=e.prototype;for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);return n}function f(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function d(e,t){return void 0!==e?e:t}function m(e,t){for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Number(n);isNaN(r)||t(r,e[n])}}function g(e){var t=[];return y(e,function(e,n){return t.push(n)}),t}function y(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function v(e){l(null!=e&&"object"==typeof e,"isEmpty() expects object parameter.");for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function b(e){l(e&&"object"==typeof e,"shallowCopy() expects object parameter.");var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}function _(e,t,n){if(t.length!==n)throw new Ot(xt.INVALID_ARGUMENT,"Function "+e+"() requires "+q(n,"argument")+", but was called with "+q(t.length,"argument")+".")}function w(e,t,n){if(t.length<n)throw new Ot(xt.INVALID_ARGUMENT,"Function "+e+"() requires at least "+q(n,"argument")+", but was called with "+q(t.length,"argument")+".")}function k(e,t,n,r){if(t.length<n||t.length>r)throw new Ot(xt.INVALID_ARGUMENT,"Function "+e+"() requires between "+n+" and "+r+" arguments, but was called with "+q(t.length,"argument")+".")}function E(e,t,n,r){if(!(t instanceof Array)||t.length<r)throw new Ot(xt.INVALID_ARGUMENT,"Function "+e+"() requires its "+n+" argument to be an array with at least "+q(r,"element")+".")}function T(e,t,n,r){O(e,t,U(n)+" argument",r)}function S(e,t,n,r){void 0!==r&&T(e,t,n,r)}function C(e,t,n,r){O(e,t,n+" option",r)}function I(e,t,n,r){void 0!==r&&C(e,t,n,r)}function N(e,t,n,r,i){if(!(r instanceof Array))throw new Ot(xt.INVALID_ARGUMENT,"Function "+e+"() requires its "+t+" option to be an array, but it was: "+R(r));for(var o=0;o<r.length;++o)if(!i(r[o]))throw new Ot(xt.INVALID_ARGUMENT,"Function "+e+"() requires all "+t+" elements to be "+n+", but the value at index "+o+" was: "+R(r[o]))}function D(e,t,n,r,i){void 0!==r&&N(e,t,n,r,i)}function A(e,t,n,r,i){for(var o=[],a=0,s=i;a<s.length;a++){var u=s[a];if(u===r)return;o.push(R(u))}var c=R(r);throw new Ot(xt.INVALID_ARGUMENT,"Invalid value "+c+" provided to function "+e+'() for option "'+n+'". Acceptable values: '+o.join(", "))}function x(e,t,n,r,i){void 0!==r&&A(e,t,n,r,i)}function O(e,t,n,r){if(!("object"===t?P(r):"non-empty string"===t?"string"==typeof r&&""!==r:typeof r===t)){var i=R(r);throw new Ot(xt.INVALID_ARGUMENT,"Function "+e+"() requires its "+n+" to be of type "+t+", but it was: "+i)}}function P(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function R(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";var t=L(e);return t?"a custom "+t+" object":"an object"}return"function"==typeof e?"a function":c("Unknown wrong type: "+typeof e)}function L(e){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&t.length>1)return t[1]}return null}function M(e,t,n){if(void 0===n)throw new Ot(xt.INVALID_ARGUMENT,"Function "+e+"() requires a valid "+U(t)+" argument, but it was undefined.")}function V(e,t,n){y(t,function(t,r){if(n.indexOf(t)<0)throw new Ot(xt.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+e+"(). Available options: "+n.join(", "))})}function j(e,t,n,r){var i=R(r);return new Ot(xt.INVALID_ARGUMENT,"Function "+e+"() requires its "+U(n)+" argument to be a "+t+", but it was: "+i)}function U(e){switch(e){case 1:return"first";case 2:return"second";case 3:return"third";default:return e+"th"}}function q(e,t){return e+" "+t+(1===e?"":"s")}function F(e,t){return e<t?-1:e>t?1:0}function B(e,t){return null!==e&&void 0!==e?!(!t||!e.isEqual(t)):e===t}function K(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!e[n].isEqual(t[n]))return!1;return!0}function W(e){return e+"\0"}function H(){if("undefined"==typeof Uint8Array)throw new Ot(xt.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function z(){if(!At.getPlatform().base64Available)throw new Ot(xt.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function Q(e,t){return e<t?-1:e>t?1:e===t?0:isNaN(e)?isNaN(t)?0:-1:1}function G(e,t){return e===t?0!==e||1/e==1/t:e!==e&&t!==t}function X(e){return null===e||void 0===e}function Y(e){return kn(e)&&e<=wn&&e>=_n}function $(e){return e instanceof vn?e.internalValue.slice():[]}function J(e){switch(e){case xt.OK:return c("Treated status OK as error");case xt.CANCELLED:case xt.UNKNOWN:case xt.DEADLINE_EXCEEDED:case xt.RESOURCE_EXHAUSTED:case xt.INTERNAL:case xt.UNAVAILABLE:case xt.UNAUTHENTICATED:return!1;case xt.INVALID_ARGUMENT:case xt.NOT_FOUND:case xt.ALREADY_EXISTS:case xt.PERMISSION_DENIED:case xt.FAILED_PRECONDITION:case xt.ABORTED:case xt.OUT_OF_RANGE:case xt.UNIMPLEMENTED:case xt.DATA_LOSS:return!0;default:return c("Unknown status code: "+e)}}function Z(e){var t=qn[e];if(void 0!==t)return ee(t)}function ee(e){if(void 0===e)return s("GRPC error has no .code"),xt.UNKNOWN;switch(e){case qn.OK:return xt.OK;case qn.CANCELLED:return xt.CANCELLED;case qn.UNKNOWN:return xt.UNKNOWN;case qn.DEADLINE_EXCEEDED:return xt.DEADLINE_EXCEEDED;case qn.RESOURCE_EXHAUSTED:return xt.RESOURCE_EXHAUSTED;case qn.INTERNAL:return xt.INTERNAL;case qn.UNAVAILABLE:return xt.UNAVAILABLE;case qn.UNAUTHENTICATED:return xt.UNAUTHENTICATED;case qn.INVALID_ARGUMENT:return xt.INVALID_ARGUMENT;case qn.NOT_FOUND:return xt.NOT_FOUND;case qn.ALREADY_EXISTS:return xt.ALREADY_EXISTS;case qn.PERMISSION_DENIED:return xt.PERMISSION_DENIED;case qn.FAILED_PRECONDITION:return xt.FAILED_PRECONDITION;case qn.ABORTED:return xt.ABORTED;case qn.OUT_OF_RANGE:return xt.OUT_OF_RANGE;case qn.UNIMPLEMENTED:return xt.UNIMPLEMENTED;case qn.DATA_LOSS:return xt.DATA_LOSS;default:return c("Unknown status code: "+e)}}function te(e){if(void 0===e)return qn.OK;switch(e){case xt.OK:return qn.OK;case xt.CANCELLED:return qn.CANCELLED;case xt.UNKNOWN:return qn.UNKNOWN;case xt.DEADLINE_EXCEEDED:return qn.DEADLINE_EXCEEDED;case xt.RESOURCE_EXHAUSTED:return qn.RESOURCE_EXHAUSTED;case xt.INTERNAL:return qn.INTERNAL;case xt.UNAVAILABLE:return qn.UNAVAILABLE;case xt.UNAUTHENTICATED:return qn.UNAUTHENTICATED;case xt.INVALID_ARGUMENT:return qn.INVALID_ARGUMENT;case xt.NOT_FOUND:return qn.NOT_FOUND;case xt.ALREADY_EXISTS:return qn.ALREADY_EXISTS;case xt.PERMISSION_DENIED:return qn.PERMISSION_DENIED;case xt.FAILED_PRECONDITION:return qn.FAILED_PRECONDITION;case xt.ABORTED:return qn.ABORTED;case xt.OUT_OF_RANGE:return qn.OUT_OF_RANGE;case xt.UNIMPLEMENTED:return qn.UNIMPLEMENTED;case xt.DATA_LOSS:return qn.DATA_LOSS;default:return c("Unknown status code: "+e)}}function ne(e){switch(e){case 200:return xt.OK;case 400:return xt.INVALID_ARGUMENT;case 401:return xt.UNAUTHENTICATED;case 403:return xt.PERMISSION_DENIED;case 404:return xt.NOT_FOUND;case 409:return xt.ABORTED;case 416:return xt.OUT_OF_RANGE;case 429:return xt.RESOURCE_EXHAUSTED;case 499:return xt.CANCELLED;case 500:return xt.UNKNOWN;case 501:return xt.UNIMPLEMENTED;case 503:return xt.UNAVAILABLE;case 504:return xt.DEADLINE_EXCEEDED;default:return e>=200&&e<300?xt.OK:e>=400&&e<500?xt.FAILED_PRECONDITION:e>=500&&e<600?xt.INTERNAL:xt.UNKNOWN}}function re(){return Zn}function ie(){return er}function oe(){return tr}function ae(){return nr}function se(){return rr}function ue(){return new Yt(Ht.comparator)}function ce(){return new Yt(Ht.comparator)}function le(e,t){l(!X(e),t+" is missing")}function he(e){return"number"==typeof e?e:"string"==typeof e?Number(e):c("can't parse "+e)}function pe(e,t,n){return t===n||!t&&n in e}function fe(e){for(var t="",n=0;n<e.length;n++)t.length>0&&(t=me(t)),t=de(e.get(n),t);return me(t)}function de(e,t){for(var n=t,r=e.length,i=0;i<r;i++){var o=e.charAt(i);switch(o){case"\0":n+=Vr+Ur;break;case Vr:n+=Vr+qr;break;default:n+=o}}return n}function me(e){return e+Vr+jr}function ge(e){var t=e.length;if(l(t>=2,"Invalid path "+e),2===t)return l(e.charAt(0)===Vr&&e.charAt(1)===jr,"Non-empty path "+e+" had length 2"),Bt.EMPTY_PATH;for(var n=t-2,r=[],i="",o=0;o<t;){var a=e.indexOf(Vr,o);switch((a<0||a>n)&&c('Invalid encoded resource path: "'+e+'"'),e.charAt(a+1)){case jr:var s=e.substring(o,a),u=void 0;0===i.length?u=s:(u=i+=s,i=""),r.push(u);break;case Ur:i+=e.substring(o,a),i+="\0";break;case qr:i+=e.substring(o,a+1);break;default:c('Invalid encoded resource path: "'+e+'"')}o=a+2}return new Bt(r)}function ye(e){return new Qr(function(t,n){e.onsuccess=function(e){var n=e.target.result;t(n)},e.onerror=function(e){n(e.target.error)}})}function ve(e){return Ai.getStore(e,mi.store)}function be(e){return Ai.getStore(e,yi.store)}function _e(e){return Gr.getStore(e,yi.store).get(yi.key).next(function(e){return l(null!==e,"Missing metadata row."),e})}function we(e){return _e(e).next(function(e){return e.highestListenSequenceNumber})}function ke(e){return Ai.getStore(e,gi.store)}function Ee(e){return Ai.getStore(e,di.store)}function Te(e){return e.code===xt.DATA_LOSS&&e.message===ti}function Se(e){return Ai.getStore(e,fi.store)}function Ce(e){return Ai.getStore(e,vi.store)}function Ie(e){return e.path.toArray()}function Ne(e){var t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw c("Unknown remote document type");t=e.noDocument}return JSON.stringify(t).length}function De(e){return[0,fe(e)]}function Ae(e){e.createObjectStore(si.store)}function xe(e){e.createObjectStore(ui.store,{keyPath:ui.keyPath}),e.createObjectStore(ci.store,{keyPath:ci.keyPath,autoIncrement:!0}).createIndex(ci.userMutationsIndex,ci.userMutationsKeyPath,{unique:!0}),e.createObjectStore(li.store)}function Oe(e,t){return t.store(ci.store).loadAll().next(function(n){e.deleteObjectStore(ci.store),e.createObjectStore(ci.store,{keyPath:ci.keyPath,autoIncrement:!0}).createIndex(ci.userMutationsIndex,ci.userMutationsKeyPath,{unique:!0});var r=t.store(ci.store),i=n.map(function(e){return r.put(e)});return Qr.waitFor(i)})}function Pe(e){e.createObjectStore(fi.store)}function Re(e){e.createObjectStore(di.store)}function Le(e){e.createObjectStore(gi.store,{keyPath:gi.keyPath}).createIndex(gi.documentTargetsIndex,gi.documentTargetsKeyPath,{unique:!0}),e.createObjectStore(mi.store,{keyPath:mi.keyPath}).createIndex(mi.queryTargetsIndexName,mi.queryTargetsKeyPath,{unique:!0}),e.createObjectStore(yi.store)}function Me(e){e.deleteObjectStore(gi.store),e.deleteObjectStore(mi.store),e.deleteObjectStore(yi.store)}function Ve(e){var t=e.store(yi.store),n=new yi(0,0,Rn.MIN.toTimestamp(),0);return t.put(yi.key,n)}function je(e){e.createObjectStore(vi.store,{keyPath:"id",autoIncrement:!0})}function Ue(e){e.createObjectStore(bi.store,{keyPath:bi.keyPath})}function qe(e,t,n){var r=li.prefixForPath(t,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),a=!1;return He(e).iterate({range:o,keysOnly:!0},function(e,n,r){var o=e[0],s=e[1];e[2],o===t&&s===i&&(a=!0),r.done()}).next(function(){return a})}function Fe(e,t){var n=!1;return ze(e).iterateSerial(function(r){return qe(e,r,t).next(function(e){return e&&(n=!0),Qr.resolve(!e)})}).next(function(){return n})}function Be(e,t,n){var r=e.store(ci.store),i=e.store(li.store),o=[],a=IDBKeyRange.only(n.batchId),s=0,u=r.iterate({range:a},function(e,t,n){return s++,n.delete()});o.push(u.next(function(){l(1===s,"Dangling document-mutation reference found: Missing batch "+n.batchId)}));for(var c=[],h=0,p=n.mutations;h<p.length;h++){var f=p[h],d=li.key(t,f.key.path,n.batchId);o.push(i.delete(d)),c.push(f.key)}return Qr.waitFor(o).next(function(){return c})}function Ke(e){return e instanceof Uint8Array?(l("YES"===process.env.USE_MOCK_PERSISTENCE,"Persisting non-string stream tokens is only supported with mock persistence."),e.toString()):e}function We(e){return Ai.getStore(e,ci.store)}function He(e){return Ai.getStore(e,li.store)}function ze(e){return Ai.getStore(e,ui.store)}function Qe(e){return void 0!==e.documents}function Ge(e,t){var n=e[0],r=e[1],i=t[0],o=t[1],a=F(n,i);return 0===a?F(r,o):a}function Xe(e){return e.code===xt.FAILED_PRECONDITION&&e.message===Ci}function Ye(e){return e.store(si.store)}function $e(e){return e.store(bi.store)}function Je(e){return[0,fe(e.path)]}function Ze(e,t){return new gi(0,fe(e.path),t)}function et(e,t){return ke(e).put(Ze(t,e.currentSequenceNumber))}function tt(){return new Yt(Ht.comparator)}function nt(e,t){var n=function(e){switch(e){case $n.Added:return 1;case $n.Modified:case $n.Metadata:return 2;case $n.Removed:return 0;default:return c("Unknown ChangeType: "+e)}};return n(e)-n(t)}function rt(e){var t=Or.INVALID;if(null!=e)try{var n=JSON.parse(e);l("number"==typeof n,"Found non-numeric sequence number"),t=n}catch(e){s(go,"Failed to read sequence number from WebStorage",e)}return t}function it(e){if(e.search(Oo)>=0)throw new Ot(xt.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(xo.bind.apply(xo,[void 0].concat(e.split("."))))}catch(t){throw new Ot(xt.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}function ot(e){if(!e)return new Ro;switch(e.type){case"gapi":return new Vo(e.client,e.sessionIndex||"0");case"provider":return e.client;default:throw new Ot(xt.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}function at(e){return st(e,["next","error","complete"])}function st(e,t){if("object"!=typeof e||null===e)return!1;for(var n=e,r=0,i=t;r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}function ut(e){switch(e){case to.Set:case to.MergeSet:case to.Update:return!0;case to.Argument:return!1;default:throw c("Unexpected case for UserDataSource: "+e)}}function ct(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Vt||e instanceof Mt||e instanceof Rt||e instanceof Go||e instanceof jo)}function lt(e,t,n){if(!ct(n)||!P(n)){var r=R(n);throw"an object"===r?t.createError(e+" a custom object"):t.createError(e+" "+r)}}function ht(e,t){if(t instanceof xo)return t._internalPath;if("string"==typeof t)return pt(e,t);throw new Ot(xt.INVALID_ARGUMENT,"Function "+e+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function pt(e,t){try{return it(t)._internalPath}catch(t){var n=ft(t);throw new Ot(xt.INVALID_ARGUMENT,"Function "+e+"() called with invalid data. "+n)}}function ft(e){return e instanceof Error?e.message:e.toString()}function dt(){throw new Ot(xt.INVALID_ARGUMENT,'QuerySnapshot.docChanges has been changed from a property into a method, so usages like "querySnapshot.docChanges" should become "querySnapshot.docChanges()"')}function mt(e,t){if(void 0===t)return{merge:!1};if(V(e,t,["merge","mergeFields"]),I(e,"boolean","merge",t.merge),D(e,"mergeFields","a string or a FieldPath",t.mergeFields,function(e){return"string"==typeof e||e instanceof xo}),void 0!==t.mergeFields&&void 0!==t.merge)throw new Ot(xt.INVALID_ARGUMENT,"Invalid options passed to function "+e+'(): You cannot specify both "merge" and "mergeFields".');return t}function gt(e,t){return void 0===t?{}:(V(e,t,["serverTimestamps"]),x(e,"options","serverTimestamps",t.serverTimestamps,["estimate","previous","none"]),t)}function yt(e,t){S(e,"object",1,t),t&&(V(e,t,["source"]),x(e,"options","source",t.source,["default","server","cache"]))}function vt(e,t,n){if(t instanceof aa){if(t.firestore!==n)throw new Ot(xt.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}throw j(e,"DocumentReference",1,t)}function bt(e,t,n){if(n.oldDocs.isEmpty()){var r,i=0;return n.docChanges.map(function(t){var o=new ca(e,t.doc.key,t.doc,n.fromCache,n.mutatedKeys.has(t.doc.key));return l(t.type===$n.Added,"Invalid event type for first snapshot"),l(!r||n.query.docComparator(r,t.doc)<0,"Got added events in wrong order"),r=t.doc,{type:"added",doc:o,oldIndex:-1,newIndex:i++}})}var o=n.oldDocs;return n.docChanges.filter(function(e){return t||e.type!==$n.Metadata}).map(function(t){var r=new ca(e,t.doc.key,t.doc,n.fromCache,n.mutatedKeys.has(t.doc.key)),i=-1,a=-1;return t.type!==$n.Added&&(l((i=o.indexOf(t.doc.key))>=0,"Index for document not found"),o=o.delete(t.doc.key)),t.type!==$n.Removed&&(a=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:_t(t.type),doc:r,oldIndex:i,newIndex:a}})}function _t(e){switch(e){case $n.Added:return"added";case $n.Modified:case $n.Metadata:return"modified";case $n.Removed:return"removed";default:return c("Unknown change type: "+e)}}function wt(e){e.INTERNAL.registerService("firestore",function(e){return new ra(e)},b(ka))}function kt(e){wt(e)}Object.defineProperty(n,"__esModule",{value:!0});var Et,Tt=function(e){return e&&"object"==typeof e&&"default"in e?e.default:e}(t("@firebase/app")),St=t("@firebase/logger"),Ct=t("tslib"),It=t("@firebase/webchannel-wrapper"),Nt=Tt.SDK_VERSION,Dt=new St.Logger("@firebase/firestore");!function(e){e[e.DEBUG=0]="DEBUG",e[e.ERROR=1]="ERROR",e[e.SILENT=2]="SILENT"}(Et||(Et={}));var At=function(){function e(){}return e.setPlatform=function(t){e.platform&&c("Platform already defined"),e.platform=t},e.getPlatform=function(){return e.platform||c("Platform not set"),e.platform},e}(),xt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Ot=function(e){function t(t,n){var r=e.call(this,n)||this;return r.code=t,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Ct.__extends(t,e),t}(Error),Pt=function(){function e(){}return e.newId=function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t="",n=0;n<20;n++)t+=e.charAt(Math.floor(Math.random()*e.length));return l(20===t.length,"Invalid auto ID: "+t),t},e}(),Rt=function(){function e(e){z(),this._binaryString=e}return e.fromBase64String=function(t){_("Blob.fromBase64String",arguments,1),T("Blob.fromBase64String","string",1,t),z();try{return new e(At.getPlatform().atob(t))}catch(e){throw new Ot(xt.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+e)}},e.fromUint8Array=function(t){if(_("Blob.fromUint8Array",arguments,1),H(),!(t instanceof Uint8Array))throw j("Blob.fromUint8Array","Uint8Array",1,t);return new e(Array.prototype.map.call(t,function(e){return String.fromCharCode(e)}).join(""))},e.prototype.toBase64=function(){return _("Blob.toBase64",arguments,0),z(),At.getPlatform().btoa(this._binaryString)},e.prototype.toUint8Array=function(){_("Blob.toUint8Array",arguments,0),H();for(var e=new Uint8Array(this._binaryString.length),t=0;t<this._binaryString.length;t++)e[t]=this._binaryString.charCodeAt(t);return e},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e.prototype.isEqual=function(e){return this._binaryString===e._binaryString},e.prototype._compareTo=function(e){return F(this._binaryString,e._binaryString)},e}(),Lt=p(Rt,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),Mt=function(){function e(e,t){if(_("GeoPoint",arguments,2),T("GeoPoint","number",1,e),T("GeoPoint","number",2,t),!isFinite(e)||e<-90||e>90)throw new Ot(xt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ot(xt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}return Object.defineProperty(e.prototype,"latitude",{get:function(){return this._lat},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"longitude",{get:function(){return this._long},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(e){return this._lat===e._lat&&this._long===e._long},e.prototype._compareTo=function(e){return F(this._lat,e._lat)||F(this._long,e._long)},e}(),Vt=function(){function e(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ot(xt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ot(xt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Ot(xt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ot(xt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}return e.now=function(){return e.fromMillis(Date.now())},e.fromDate=function(t){return e.fromMillis(t.getTime())},e.fromMillis=function(t){var n=Math.floor(t/1e3);return new e(n,1e6*(t-1e3*n))},e.prototype.toDate=function(){return new Date(this.toMillis())},e.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},e.prototype._compareTo=function(e){return this.seconds===e.seconds?F(this.nanoseconds,e.nanoseconds):F(this.seconds,e.seconds)},e.prototype.isEqual=function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds},e.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},e}(),jt=function(e,t,n,r){this.databaseId=e,this.persistenceKey=t,this.host=n,this.ssl=r},Ut="(default)",qt=function(){function e(e,t){this.projectId=e,this.database=t||Ut}return Object.defineProperty(e.prototype,"isDefaultDatabase",{get:function(){return this.database===Ut},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database},e.prototype.compareTo=function(e){return F(this.projectId,e.projectId)||F(this.database,e.database)},e}(),Ft=function(){function e(e,t,n){this.init(e,t,n)}return e.prototype.init=function(e,t,n){void 0===t?t=0:t>e.length&&c("offset "+t+" out of range "+e.length),void 0===n?n=e.length-t:n>e.length-t&&c("length "+n+" out of range "+(e.length-t)),this.segments=e,this.offset=t,this.len=n},e.prototype.construct=function(e,t,n){var r=Object.create(Object.getPrototypeOf(this));return r.init(e,t,n),r},Object.defineProperty(e.prototype,"length",{get:function(){return this.len},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return 0===e.comparator(this,t)},e.prototype.child=function(t){var n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach(function(e){n.push(e)}):"string"==typeof t?n.push(t):c("Unknown parameter type for Path.child(): "+t),this.construct(n)},e.prototype.limit=function(){return this.offset+this.length},e.prototype.popFirst=function(e){return e=void 0===e?1:e,l(this.length>=e,"Can't call popFirst() with less segments"),this.construct(this.segments,this.offset+e,this.length-e)},e.prototype.popLast=function(){return l(!this.isEmpty(),"Can't call popLast() on empty path"),this.construct(this.segments,this.offset,this.length-1)},e.prototype.firstSegment=function(){return l(!this.isEmpty(),"Can't call firstSegment() on empty path"),this.segments[this.offset]},e.prototype.lastSegment=function(){return l(!this.isEmpty(),"Can't call lastSegment() on empty path"),this.segments[this.limit()-1]},e.prototype.get=function(e){return l(e<this.length,"Index out of range"),this.segments[this.offset+e]},e.prototype.isEmpty=function(){return 0===this.length},e.prototype.isPrefixOf=function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0},e.prototype.isImmediateParentOf=function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0},e.prototype.forEach=function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])},e.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},e.comparator=function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=e.get(r),o=t.get(r);if(i<o)return-1;if(i>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0},e}(),Bt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ct.__extends(t,e),t.prototype.canonicalString=function(){return this.toArray().join("/")},t.prototype.toString=function(){return this.canonicalString()},t.fromString=function(e){if(e.indexOf("//")>=0)throw new Ot(xt.INVALID_ARGUMENT,"Invalid path ("+e+"). Paths must not contain // in them.");return new t(e.split("/").filter(function(e){return e.length>0}))},t.EMPTY_PATH=new t([]),t}(Ft),Kt=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Wt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ct.__extends(t,e),t.isValidIdentifier=function(e){return Kt.test(e)},t.prototype.canonicalString=function(){return this.toArray().map(function(e){return e=e.replace("\\","\\\\").replace("`","\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e}).join(".")},t.prototype.toString=function(){return this.canonicalString()},t.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},t.keyField=function(){return new t(["__name__"])},t.fromServerFormat=function(e){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new Ot(xt.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},a=!1;i<e.length;){var s=e[i];if("\\"===s){if(i+1===e.length)throw new Ot(xt.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var u=e[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Ot(xt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else"`"===s?(a=!a,i++):"."!==s||a?(r+=s,i++):(o(),i++)}if(o(),a)throw new Ot(xt.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(n)},t.EMPTY_PATH=new t([]),t}(Ft),Ht=function(){function e(t){this.path=t,l(e.isDocumentKey(t),"Invalid DocumentKey with an odd number of segments: "+t.toArray().join("/"))}return e.prototype.isEqual=function(e){return null!==e&&0===Bt.comparator(this.path,e.path)},e.prototype.toString=function(){return this.path.toString()},e.comparator=function(e,t){return Bt.comparator(e.path,t.path)},e.isDocumentKey=function(e){return e.length%2==0},e.fromSegments=function(t){return new e(new Bt(t.slice()))},e.fromPathString=function(t){return new e(Bt.fromString(t))},e.EMPTY=new e(new Bt([])),e}(),zt=function(){function e(e,t){this.key=e,this.version=t}return e.compareByKey=function(e,t){return Ht.comparator(e.key,t.key)},e}(),Qt=function(e){function t(t,n,r,i){var o=e.call(this,t,n)||this;return o.data=r,o.hasLocalMutations=!!i.hasLocalMutations,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return Ct.__extends(t,e),t.prototype.field=function(e){return this.data.field(e)},t.prototype.fieldValue=function(e){var t=this.field(e);return t?t.value():void 0},t.prototype.value=function(){return this.data.value()},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.data.isEqual(e.data)&&this.hasLocalMutations===e.hasLocalMutations&&this.hasCommittedMutations===e.hasCommittedMutations},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.data.toString()+", {hasLocalMutations: "+this.hasLocalMutations+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!0,configurable:!0}),t.compareByField=function(e,t,n){var r=t.field(e),i=n.field(e);return void 0!==r&&void 0!==i?r.compareTo(i):c("Trying to compare documents on fields that don't exist")},t}(zt),Gt=function(e){function t(t,n,r){var i=e.call(this,t,n)||this;return i.hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return Ct.__extends(t,e),t.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.hasCommittedMutations===this.hasCommittedMutations&&e.version.isEqual(this.version)&&e.key.isEqual(this.key)},t}(zt),Xt=function(e){function t(t,n){return e.call(this,t,n)||this}return Ct.__extends(t,e),t.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.version.isEqual(this.version)&&e.key.isEqual(this.key)},t}(zt),Yt=function(){function e(e,t){this.comparator=e,this.root=t||Jt.EMPTY}return e.prototype.insert=function(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,Jt.BLACK,null,null))},e.prototype.remove=function(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Jt.BLACK,null,null))},e.prototype.get=function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null},e.prototype.indexOf=function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1},e.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(e.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),e.prototype.minKey=function(){return this.root.minKey()},e.prototype.maxKey=function(){return this.root.maxKey()},e.prototype.inorderTraversal=function(e){return this.root.inorderTraversal(e)},e.prototype.forEach=function(e){this.inorderTraversal(function(t,n){return e(t,n),!1})},e.prototype.reverseTraversal=function(e){return this.root.reverseTraversal(e)},e.prototype.getIterator=function(){return new $t(this.root,null,this.comparator,!1)},e.prototype.getIteratorFrom=function(e){return new $t(this.root,e,this.comparator,!1)},e.prototype.getReverseIterator=function(){return new $t(this.root,null,this.comparator,!0)},e.prototype.getReverseIteratorFrom=function(e){return new $t(this.root,e,this.comparator,!0)},e}(),$t=function(){function e(e,t,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!e.isEmpty();)if(i=t?n(e.key,t):1,r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}return e.prototype.getNext=function(){l(this.nodeStack.length>0,"getNext() called on iterator when hasNext() is false.");var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t},e.prototype.hasNext=function(){return this.nodeStack.length>0},e.prototype.peek=function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}},e}(),Jt=function(){function e(t,n,r,i,o){this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:e.EMPTY,this.right=null!=o?o:e.EMPTY,this.size=this.left.size+1+this.right.size}return e.prototype.copy=function(t,n,r,i,o){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},e.prototype.isEmpty=function(){return!1},e.prototype.inorderTraversal=function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)},e.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},e.prototype.minKey=function(){return this.min().key},e.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},e.prototype.insert=function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()},e.prototype.removeMin=function(){if(this.left.isEmpty())return e.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),(t=t.copy(null,null,null,t.left.removeMin(),null)).fixUp()},e.prototype.remove=function(t,n){var r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(t,i.key)){if(i.right.isEmpty())return e.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()},e.prototype.isRed=function(){return this.color},e.prototype.fixUp=function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e},e.prototype.moveRedLeft=function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e},e.prototype.moveRedRight=function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e},e.prototype.rotateLeft=function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},e.prototype.rotateRight=function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},e.prototype.colorFlip=function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)},e.prototype.checkMaxDepth=function(){var e=this.check();return Math.pow(2,e)<=this.size+1},e.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw c("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed())throw c("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check();if(e!==this.right.check())throw c("Black depths differ");return e+(this.isRed()?0:1)},e.EMPTY=null,e.RED=!0,e.BLACK=!1,e}(),Zt=function(){function e(){this.size=0}return e.prototype.copy=function(e,t,n,r,i){return this},e.prototype.insert=function(e,t,n){return new Jt(e,t)},e.prototype.remove=function(e,t){return this},e.prototype.isEmpty=function(){return!0},e.prototype.inorderTraversal=function(e){return!1},e.prototype.reverseTraversal=function(e){return!1},e.prototype.minKey=function(){return null},e.prototype.maxKey=function(){return null},e.prototype.isRed=function(){return!1},e.prototype.checkMaxDepth=function(){return!0},e.prototype.check=function(){return 0},e}();Jt.EMPTY=new Zt;var en;!function(e){e[e.NullValue=0]="NullValue",e[e.BooleanValue=1]="BooleanValue",e[e.NumberValue=2]="NumberValue",e[e.TimestampValue=3]="TimestampValue",e[e.StringValue=4]="StringValue",e[e.BlobValue=5]="BlobValue",e[e.RefValue=6]="RefValue",e[e.GeoPointValue=7]="GeoPointValue",e[e.ArrayValue=8]="ArrayValue",e[e.ObjectValue=9]="ObjectValue"}(en||(en={}));var tn;!function(e){e[e.Default=0]="Default",e[e.Estimate=1]="Estimate",e[e.Previous=2]="Previous"}(tn||(tn={}));var nn,rn=function(){function e(e,t){this.serverTimestampBehavior=e,this.timestampsInSnapshots=t}return e.fromSnapshotOptions=function(t,n){switch(t.serverTimestamps){case"estimate":return new e(tn.Estimate,n);case"previous":return new e(tn.Previous,n);case"none":case void 0:return new e(tn.Default,n);default:return c("fromSnapshotOptions() called with invalid options.")}},e}(),on=function(){function e(){}return e.prototype.toString=function(){var e=this.value();return null===e?"null":e.toString()},e.prototype.defaultCompareTo=function(e){return l(this.typeOrder!==e.typeOrder,"Default compareTo should not be used for values of same type."),F(this.typeOrder,e.typeOrder)},e}(),an=function(e){function t(){var t=e.call(this)||this;return t.typeOrder=en.NullValue,t.internalValue=null,t}return Ct.__extends(t,e),t.prototype.value=function(e){return null},t.prototype.isEqual=function(e){return e instanceof t},t.prototype.compareTo=function(e){return e instanceof t?0:this.defaultCompareTo(e)},t.INSTANCE=new t,t}(on),sn=function(e){function t(t){var n=e.call(this)||this;return n.internalValue=t,n.typeOrder=en.BooleanValue,n}return Ct.__extends(t,e),t.prototype.value=function(e){return this.internalValue},t.prototype.isEqual=function(e){return e instanceof t&&this.internalValue===e.internalValue},t.prototype.compareTo=function(e){return e instanceof t?F(this,e):this.defaultCompareTo(e)},t.of=function(e){return e?t.TRUE:t.FALSE},t.TRUE=new t(!0),t.FALSE=new t(!1),t}(on),un=function(e){function t(t){var n=e.call(this)||this;return n.internalValue=t,n.typeOrder=en.NumberValue,n}return Ct.__extends(t,e),t.prototype.value=function(e){return this.internalValue},t.prototype.compareTo=function(e){return e instanceof t?Q(this.internalValue,e.internalValue):this.defaultCompareTo(e)},t}(on),cn=function(e){function t(t){return e.call(this,t)||this}return Ct.__extends(t,e),t.prototype.isEqual=function(e){return e instanceof t&&G(this.internalValue,e.internalValue)},t}(un),ln=function(e){function t(t){var n=e.call(this,t)||this;return n.internalValue=t,n}return Ct.__extends(t,e),t.prototype.isEqual=function(e){return e instanceof t&&G(this.internalValue,e.internalValue)},t.NAN=new t(NaN),t.POSITIVE_INFINITY=new t(1/0),t.NEGATIVE_INFINITY=new t(-1/0),t}(un),hn=function(e){function t(t){var n=e.call(this)||this;return n.internalValue=t,n.typeOrder=en.StringValue,n}return Ct.__extends(t,e),t.prototype.value=function(e){return this.internalValue},t.prototype.isEqual=function(e){return e instanceof t&&this.internalValue===e.internalValue},t.prototype.compareTo=function(e){return e instanceof t?F(this.internalValue,e.internalValue):this.defaultCompareTo(e)},t}(on),pn=function(e){function t(t){var n=e.call(this)||this;return n.internalValue=t,n.typeOrder=en.TimestampValue,n}return Ct.__extends(t,e),t.prototype.value=function(e){return e&&e.timestampsInSnapshots?this.internalValue:this.internalValue.toDate()},t.prototype.isEqual=function(e){return e instanceof t&&this.internalValue.isEqual(e.internalValue)},t.prototype.compareTo=function(e){return e instanceof t?this.internalValue._compareTo(e.internalValue):e instanceof fn?-1:this.defaultCompareTo(e)},t}(on),fn=function(e){function t(t,n){var r=e.call(this)||this;return r.localWriteTime=t,r.previousValue=n,r.typeOrder=en.TimestampValue,r}return Ct.__extends(t,e),t.prototype.value=function(e){return e&&e.serverTimestampBehavior===tn.Estimate?new pn(this.localWriteTime).value(e):e&&e.serverTimestampBehavior===tn.Previous&&this.previousValue?this.previousValue.value(e):null},t.prototype.isEqual=function(e){return e instanceof t&&this.localWriteTime.isEqual(e.localWriteTime)},t.prototype.compareTo=function(e){return e instanceof t?this.localWriteTime._compareTo(e.localWriteTime):e instanceof pn?1:this.defaultCompareTo(e)},t.prototype.toString=function(){return"<ServerTimestamp localTime="+this.localWriteTime.toString()+">"},t}(on),dn=function(e){function t(t){var n=e.call(this)||this;return n.internalValue=t,n.typeOrder=en.BlobValue,n}return Ct.__extends(t,e),t.prototype.value=function(e){return this.internalValue},t.prototype.isEqual=function(e){return e instanceof t&&this.internalValue.isEqual(e.internalValue)},t.prototype.compareTo=function(e){return e instanceof t?this.internalValue._compareTo(e.internalValue):this.defaultCompareTo(e)},t}(on),mn=function(e){function t(t,n){var r=e.call(this)||this;return r.databaseId=t,r.key=n,r.typeOrder=en.RefValue,r}return Ct.__extends(t,e),t.prototype.value=function(e){return this.key},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.databaseId.isEqual(e.databaseId)},t.prototype.compareTo=function(e){if(e instanceof t){var n=this.databaseId.compareTo(e.databaseId);return 0!==n?n:Ht.comparator(this.key,e.key)}return this.defaultCompareTo(e)},t}(on),gn=function(e){function t(t){var n=e.call(this)||this;return n.internalValue=t,n.typeOrder=en.GeoPointValue,n}return Ct.__extends(t,e),t.prototype.value=function(e){return this.internalValue},t.prototype.isEqual=function(e){return e instanceof t&&this.internalValue.isEqual(e.internalValue)},t.prototype.compareTo=function(e){return e instanceof t?this.internalValue._compareTo(e.internalValue):this.defaultCompareTo(e)},t}(on),yn=function(e){function t(t){var n=e.call(this)||this;return n.internalValue=t,n.typeOrder=en.ObjectValue,n}return Ct.__extends(t,e),t.prototype.value=function(e){var t={};return this.internalValue.inorderTraversal(function(n,r){t[n]=r.value(e)}),t},t.prototype.forEach=function(e){this.internalValue.inorderTraversal(e)},t.prototype.isEqual=function(e){if(e instanceof t){for(var n=this.internalValue.getIterator(),r=e.internalValue.getIterator();n.hasNext()&&r.hasNext();){var i=n.getNext(),o=r.getNext();if(i.key!==o.key||!i.value.isEqual(o.value))return!1}return!n.hasNext()&&!r.hasNext()}return!1},t.prototype.compareTo=function(e){if(e instanceof t){for(var n=this.internalValue.getIterator(),r=e.internalValue.getIterator();n.hasNext()&&r.hasNext();){var i=n.getNext(),o=r.getNext(),a=F(i.key,o.key)||i.value.compareTo(o.value);if(a)return a}return F(n.hasNext(),r.hasNext())}return this.defaultCompareTo(e)},t.prototype.set=function(e,n){if(l(!e.isEmpty(),"Cannot set field for empty path on ObjectValue"),1===e.length)return this.setChild(e.firstSegment(),n);var r=this.child(e.firstSegment());r instanceof t||(r=t.EMPTY);var i=r.set(e.popFirst(),n);return this.setChild(e.firstSegment(),i)},t.prototype.delete=function(e){if(l(!e.isEmpty(),"Cannot delete field for empty path on ObjectValue"),1===e.length)return new t(this.internalValue.remove(e.firstSegment()));var n=this.child(e.firstSegment());if(n instanceof t){var r=n.delete(e.popFirst());return new t(this.internalValue.insert(e.firstSegment(),r))}return this},t.prototype.contains=function(e){return void 0!==this.field(e)},t.prototype.field=function(e){l(!e.isEmpty(),"Can't get field of empty path");var n=this;return e.forEach(function(e){n=n instanceof t?n.internalValue.get(e)||void 0:void 0}),n},t.prototype.toString=function(){return JSON.stringify(this.value())},t.prototype.child=function(e){return this.internalValue.get(e)||void 0},t.prototype.setChild=function(e,n){return new t(this.internalValue.insert(e,n))},t.EMPTY=new t(new Yt(F)),t}(on),vn=function(e){function t(t){var n=e.call(this)||this;return n.internalValue=t,n.typeOrder=en.ArrayValue,n}return Ct.__extends(t,e),t.prototype.value=function(e){return this.internalValue.map(function(t){return t.value(e)})},t.prototype.forEach=function(e){this.internalValue.forEach(e)},t.prototype.isEqual=function(e){if(e instanceof t){if(this.internalValue.length!==e.internalValue.length)return!1;for(var n=0;n<this.internalValue.length;n++)if(!this.internalValue[n].isEqual(e.internalValue[n]))return!1;return!0}return!1},t.prototype.compareTo=function(e){if(e instanceof t){for(var n=Math.min(this.internalValue.length,e.internalValue.length),r=0;r<n;r++){var i=this.internalValue[r].compareTo(e.internalValue[r]);if(i)return i}return F(this.internalValue.length,e.internalValue.length)}return this.defaultCompareTo(e)},t.prototype.toString=function(){return JSON.stringify(this.value())},t}(on),bn=Number,_n=bn.MIN_SAFE_INTEGER||-(Math.pow(2,53)-1),wn=bn.MAX_SAFE_INTEGER||Math.pow(2,53)-1,kn=bn.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},En=function(){function e(e,t,n,r,i,o){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r=null),void 0===i&&(i=null),void 0===o&&(o=null),this.path=e,this.explicitOrderBy=t,this.filters=n,this.limit=r,this.startAt=i,this.endAt=o,this.memoizedCanonicalId=null,this.memoizedOrderBy=null,this.startAt&&this.assertValidBound(this.startAt),this.endAt&&this.assertValidBound(this.endAt)}return e.atPath=function(t){return new e(t)},Object.defineProperty(e.prototype,"orderBy",{get:function(){if(null===this.memoizedOrderBy){var e=this.getInequalityFilterField(),t=this.getFirstOrderByField();if(null!==e&&null===t)e.isKeyField()?this.memoizedOrderBy=[On]:this.memoizedOrderBy=[new xn(e),On];else{l(null===e||null!==t&&e.isEqual(t),"First orderBy should match inequality field."),this.memoizedOrderBy=[];for(var n=!1,r=0,i=this.explicitOrderBy;r<i.length;r++){var o=i[r];this.memoizedOrderBy.push(o),o.field.isKeyField()&&(n=!0)}if(!n){var a=this.explicitOrderBy.length>0?this.explicitOrderBy[this.explicitOrderBy.length-1].dir:Dn.ASCENDING;this.memoizedOrderBy.push(a===Dn.ASCENDING?On:Pn)}}}return this.memoizedOrderBy},enumerable:!0,configurable:!0}),e.prototype.addFilter=function(t){l(null==this.getInequalityFilterField()||!(t instanceof Cn)||!t.isInequality()||t.field.isEqual(this.getInequalityFilterField()),"Query must only have one inequality field."),l(!Ht.isDocumentKey(this.path),"No filtering allowed for document query");var n=this.filters.concat([t]);return new e(this.path,this.explicitOrderBy.slice(),n,this.limit,this.startAt,this.endAt)},e.prototype.addOrderBy=function(t){l(!Ht.isDocumentKey(this.path),"No ordering allowed for document query"),l(!this.startAt&&!this.endAt,"Bounds must be set after orderBy");var n=this.explicitOrderBy.concat([t]);return new e(this.path,n,this.filters.slice(),this.limit,this.startAt,this.endAt)},e.prototype.withLimit=function(t){return new e(this.path,this.explicitOrderBy.slice(),this.filters.slice(),t,this.startAt,this.endAt)},e.prototype.withStartAt=function(t){return new e(this.path,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,t,this.endAt)},e.prototype.withEndAt=function(t){return new e(this.path,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.startAt,t)},e.prototype.canonicalId=function(){if(null===this.memoizedCanonicalId){var e=this.path.canonicalString();e+="|f:";for(var t=0,n=this.filters;t<n.length;t++)e+=n[t].canonicalId(),e+=",";e+="|ob:";for(var r=0,i=this.orderBy;r<i.length;r++)e+=i[r].canonicalId(),e+=",";X(this.limit)||(e+="|l:",e+=this.limit),this.startAt&&(e+="|lb:",e+=this.startAt.canonicalId()),this.endAt&&(e+="|ub:",e+=this.endAt.canonicalId()),this.memoizedCanonicalId=e}return this.memoizedCanonicalId},e.prototype.toString=function(){var e="Query("+this.path.canonicalString();return this.filters.length>0&&(e+=", filters: ["+this.filters.join(", ")+"]"),X(this.limit)||(e+=", limit: "+this.limit),this.explicitOrderBy.length>0&&(e+=", orderBy: ["+this.explicitOrderBy.join(", ")+"]"),this.startAt&&(e+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(e+=", endAt: "+this.endAt.canonicalId()),e+")"},e.prototype.isEqual=function(e){if(this.limit!==e.limit)return!1;if(this.orderBy.length!==e.orderBy.length)return!1;for(t=0;t<this.orderBy.length;t++)if(!this.orderBy[t].isEqual(e.orderBy[t]))return!1;if(this.filters.length!==e.filters.length)return!1;for(var t=0;t<this.filters.length;t++)if(!this.filters[t].isEqual(e.filters[t]))return!1;return!!this.path.isEqual(e.path)&&!(null!==this.startAt?!this.startAt.isEqual(e.startAt):null!==e.startAt)&&(null!==this.endAt?this.endAt.isEqual(e.endAt):null===e.endAt)},e.prototype.docComparator=function(e,t){for(var n=!1,r=0,i=this.orderBy;r<i.length;r++){var o=i[r],a=o.compare(e,t);if(0!==a)return a;n=n||o.field.isKeyField()}return l(n,"orderBy used that doesn't compare on key field"),0},e.prototype.matches=function(e){return this.matchesAncestor(e)&&this.matchesOrderBy(e)&&this.matchesFilters(e)&&this.matchesBounds(e)},e.prototype.hasLimit=function(){return!X(this.limit)},e.prototype.getFirstOrderByField=function(){return this.explicitOrderBy.length>0?this.explicitOrderBy[0].field:null},e.prototype.getInequalityFilterField=function(){for(var e=0,t=this.filters;e<t.length;e++){var n=t[e];if(n instanceof Cn&&n.isInequality())return n.field}return null},e.prototype.hasArrayContainsFilter=function(){return void 0!==this.filters.find(function(e){return e instanceof Cn&&e.op===Sn.ARRAY_CONTAINS})},e.prototype.isDocumentQuery=function(){return Ht.isDocumentKey(this.path)&&0===this.filters.length},e.prototype.matchesAncestor=function(e){var t=e.key.path;return Ht.isDocumentKey(this.path)?this.path.isEqual(t):this.path.isPrefixOf(t)&&this.path.length===t.length-1},e.prototype.matchesOrderBy=function(e){for(var t=0,n=this.explicitOrderBy;t<n.length;t++){var r=n[t];if(!r.field.isKeyField()&&void 0===e.field(r.field))return!1}return!0},e.prototype.matchesFilters=function(e){for(var t=0,n=this.filters;t<n.length;t++)if(!n[t].matches(e))return!1;return!0},e.prototype.matchesBounds=function(e){return!(this.startAt&&!this.startAt.sortsBeforeDocument(this.orderBy,e)||this.endAt&&this.endAt.sortsBeforeDocument(this.orderBy,e))},e.prototype.assertValidBound=function(e){l(e.position.length<=this.orderBy.length,"Bound is longer than orderBy")},e}(),Tn=function(){function e(){}return e.create=function(e,t,n){if(n.isEqual(an.INSTANCE)){if(t!==Sn.EQUAL)throw new Ot(xt.INVALID_ARGUMENT,"Invalid query. You can only perform equals comparisons on null.");return new In(e)}if(n.isEqual(ln.NAN)){if(t!==Sn.EQUAL)throw new Ot(xt.INVALID_ARGUMENT,"Invalid query. You can only perform equals comparisons on NaN.");return new Nn(e)}return new Cn(e,t,n)},e}(),Sn=function(){function e(e){this.name=e}return e.fromString=function(t){switch(t){case"<":return e.LESS_THAN;case"<=":return e.LESS_THAN_OR_EQUAL;case"==":return e.EQUAL;case">=":return e.GREATER_THAN_OR_EQUAL;case">":return e.GREATER_THAN;case"array-contains":return e.ARRAY_CONTAINS;default:return c("Unknown relation: "+t)}},e.prototype.toString=function(){return this.name},e.prototype.isEqual=function(e){return this.name===e.name},e.LESS_THAN=new e("<"),e.LESS_THAN_OR_EQUAL=new e("<="),e.EQUAL=new e("=="),e.GREATER_THAN=new e(">"),e.GREATER_THAN_OR_EQUAL=new e(">="),e.ARRAY_CONTAINS=new e("array-contains"),e}(),Cn=function(e){function t(t,n,r){var i=e.call(this)||this;return i.field=t,i.op=n,i.value=r,i}return Ct.__extends(t,e),t.prototype.matches=function(e){if(this.field.isKeyField()){l(this.value instanceof mn,"Comparing on key, but filter value not a RefValue"),l(this.op!==Sn.ARRAY_CONTAINS,"array-contains queries don't make sense on document keys.");var t=this.value,n=Ht.comparator(e.key,t.key);return this.matchesComparison(n)}var r=e.field(this.field);return void 0!==r&&this.matchesValue(r)},t.prototype.matchesValue=function(e){var t=this;return this.op===Sn.ARRAY_CONTAINS?e instanceof vn&&void 0!==e.internalValue.find(function(e){return e.isEqual(t.value)}):this.value.typeOrder===e.typeOrder&&this.matchesComparison(e.compareTo(this.value))},t.prototype.matchesComparison=function(e){switch(this.op){case Sn.LESS_THAN:return e<0;case Sn.LESS_THAN_OR_EQUAL:return e<=0;case Sn.EQUAL:return 0===e;case Sn.GREATER_THAN:return e>0;case Sn.GREATER_THAN_OR_EQUAL:return e>=0;default:return c("Unknown relation op"+this.op)}},t.prototype.isInequality=function(){return this.op!==Sn.EQUAL&&this.op!==Sn.ARRAY_CONTAINS},t.prototype.canonicalId=function(){return this.field.canonicalString()+this.op.toString()+this.value.toString()},t.prototype.isEqual=function(e){return e instanceof t&&this.op.isEqual(e.op)&&this.field.isEqual(e.field)&&this.value.isEqual(e.value)},t.prototype.toString=function(){return this.field.canonicalString()+" "+this.op+" "+this.value.value()},t}(Tn),In=function(e){function t(t){var n=e.call(this)||this;return n.field=t,n}return Ct.__extends(t,e),t.prototype.matches=function(e){var t=e.field(this.field);return void 0!==t&&null===t.value()},t.prototype.canonicalId=function(){return this.field.canonicalString()+" IS null"},t.prototype.toString=function(){return this.field.canonicalString()+" IS null"},t.prototype.isEqual=function(e){return e instanceof t&&this.field.isEqual(e.field)},t}(Tn),Nn=function(e){function t(t){var n=e.call(this)||this;return n.field=t,n}return Ct.__extends(t,e),t.prototype.matches=function(e){var t=e.field(this.field),n=t&&t.value();return"number"==typeof n&&isNaN(n)},t.prototype.canonicalId=function(){return this.field.canonicalString()+" IS NaN"},t.prototype.toString=function(){return this.field.canonicalString()+" IS NaN"},t.prototype.isEqual=function(e){return e instanceof t&&this.field.isEqual(e.field)},t}(Tn),Dn=function(){function e(e){this.name=e}return e.prototype.toString=function(){return this.name},e.ASCENDING=new e("asc"),e.DESCENDING=new e("desc"),e}(),An=function(){function e(e,t){this.position=e,this.before=t}return e.prototype.canonicalId=function(){for(var e=this.before?"b:":"a:",t=0,n=this.position;t<n.length;t++)e+=n[t].toString();return e},e.prototype.sortsBeforeDocument=function(e,t){l(this.position.length<=e.length,"Bound has more components than query's orderBy");for(var n=0,r=0;r<this.position.length;r++){var i=e[r],o=this.position[r];if(i.field.isKeyField())l(o instanceof mn,"Bound has a non-key value where the key path is being used."),n=Ht.comparator(o.key,t.key);else{var a=t.field(i.field);l(void 0!==a,"Field should exist since document matched the orderBy already."),n=o.compareTo(a)}if(i.dir===Dn.DESCENDING&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},e.prototype.isEqual=function(e){if(null===e)return!1;if(this.before!==e.before||this.position.length!==e.position.length)return!1;for(var t=0;t<this.position.length;t++){var n=this.position[t],r=e.position[t];return n.isEqual(r)}return!0},e}(),xn=function(){function e(e,t){this.field=e,void 0===t&&(t=Dn.ASCENDING),this.dir=t,this.isKeyOrderBy=e.isKeyField()}return e.prototype.compare=function(e,t){var n=this.isKeyOrderBy?Qt.compareByKey(e,t):Qt.compareByField(this.field,e,t);switch(this.dir){case Dn.ASCENDING:return n;case Dn.DESCENDING:return-1*n;default:return c("Unknown direction: "+this.dir)}},e.prototype.canonicalId=function(){return this.field.canonicalString()+this.dir.toString()},e.prototype.toString=function(){return this.field.canonicalString()+" ("+this.dir+")"},e.prototype.isEqual=function(e){return this.dir===e.dir&&this.field.isEqual(e.field)},e}(),On=new xn(Wt.keyField(),Dn.ASCENDING),Pn=new xn(Wt.keyField(),Dn.DESCENDING),Rn=function(){function e(e){this.timestamp=e}return e.fromMicroseconds=function(t){var n=Math.floor(t/1e6);return new e(new Vt(n,t%1e6*1e3))},e.fromTimestamp=function(t){return new e(t)},e.forDeletedDoc=function(){return e.MIN},e.prototype.compareTo=function(e){return this.timestamp._compareTo(e.timestamp)},e.prototype.isEqual=function(e){return this.timestamp.isEqual(e.timestamp)},e.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},e.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},e.prototype.toTimestamp=function(){return this.timestamp},e.MIN=new e(new Vt(0,0)),e}();!function(e){e[e.Listen=0]="Listen",e[e.ExistenceFilterMismatch=1]="ExistenceFilterMismatch",e[e.LimboResolution=2]="LimboResolution"}(nn||(nn={}));var Ln,Mn=function(){function e(e,t,n,r,i,o){void 0===i&&(i=Rn.MIN),void 0===o&&(o=h()),this.query=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.resumeToken=o}return e.prototype.copy=function(t){return new e(this.query,this.targetId,this.purpose,void 0===t.sequenceNumber?this.sequenceNumber:t.sequenceNumber,void 0===t.snapshotVersion?this.snapshotVersion:t.snapshotVersion,void 0===t.resumeToken?this.resumeToken:t.resumeToken)},e.prototype.isEqual=function(e){return this.targetId===e.targetId&&this.purpose===e.purpose&&this.sequenceNumber===e.sequenceNumber&&this.snapshotVersion.isEqual(e.snapshotVersion)&&this.resumeToken===e.resumeToken&&this.query.isEqual(e.query)},e}(),Vn=function(){function e(e){this.fields=e}return e.prototype.covers=function(e){for(var t=0,n=this.fields;t<n.length;t++)if(n[t].isPrefixOf(e))return!0;return!1},e.prototype.isEqual=function(e){return K(this.fields,e.fields)},e}(),jn=function(){function e(e,t){this.field=e,this.transform=t}return e.prototype.isEqual=function(e){return this.field.isEqual(e.field)&&this.transform.isEqual(e.transform)},e}(),Un=function(e,t){this.version=e,this.transformResults=t};!function(e){e[e.Set=0]="Set",e[e.Patch=1]="Patch",e[e.Transform=2]="Transform",e[e.Delete=3]="Delete"}(Ln||(Ln={}));var qn,Fn=function(){function e(e,t){this.updateTime=e,this.exists=t,l(void 0===e||void 0===t,'Precondition can specify "exists" or "updateTime" but not both')}return e.exists=function(t){return new e(void 0,t)},e.updateTime=function(t){return new e(t)},Object.defineProperty(e.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),e.prototype.isValidFor=function(e){return void 0!==this.updateTime?e instanceof Qt&&e.version.isEqual(this.updateTime):void 0!==this.exists?this.exists===e instanceof Qt:(l(this.isNone,"Precondition should be empty"),!0)},e.prototype.isEqual=function(e){return B(this.updateTime,e.updateTime)&&this.exists===e.exists},e.NONE=new e,e}(),Bn=function(){function e(){}return e.prototype.verifyKeyMatches=function(e){null!=e&&l(e.key.isEqual(this.key),"Can only apply a mutation to a document with the same key")},e.getPostMutationVersion=function(e){return e instanceof Qt?e.version:Rn.MIN},e}(),Kn=function(e){function t(t,n,r){var i=e.call(this)||this;return i.key=t,i.value=n,i.precondition=r,i.type=Ln.Set,i}return Ct.__extends(t,e),t.prototype.applyToRemoteDocument=function(e,t){this.verifyKeyMatches(e),l(null==t.transformResults,"Transform results received by SetMutation.");var n=t.version;return new Qt(this.key,n,this.value,{hasCommittedMutations:!0})},t.prototype.applyToLocalView=function(e,t,n){if(this.verifyKeyMatches(e),!this.precondition.isValidFor(e))return e;var r=Bn.getPostMutationVersion(e);return new Qt(this.key,r,this.value,{hasLocalMutations:!0})},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.value.isEqual(e.value)&&this.precondition.isEqual(e.precondition)},t}(Bn),Wn=function(e){function t(t,n,r,i){var o=e.call(this)||this;return o.key=t,o.data=n,o.fieldMask=r,o.precondition=i,o.type=Ln.Patch,o}return Ct.__extends(t,e),t.prototype.applyToRemoteDocument=function(e,t){if(this.verifyKeyMatches(e),l(null==t.transformResults,"Transform results received by PatchMutation."),!this.precondition.isValidFor(e))return new Xt(this.key,t.version);var n=this.patchDocument(e);return new Qt(this.key,t.version,n,{hasCommittedMutations:!0})},t.prototype.applyToLocalView=function(e,t,n){if(this.verifyKeyMatches(e),!this.precondition.isValidFor(e))return e;var r=Bn.getPostMutationVersion(e),i=this.patchDocument(e);return new Qt(this.key,r,i,{hasLocalMutations:!0})},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.fieldMask.isEqual(e.fieldMask)&&this.precondition.isEqual(e.precondition)},t.prototype.patchDocument=function(e){var t;return t=e instanceof Qt?e.data:yn.EMPTY,this.patchObject(t)},t.prototype.patchObject=function(e){for(var t=0,n=this.fieldMask.fields;t<n.length;t++){var r=n[t];if(!r.isEmpty()){var i=this.data.field(r);e=void 0!==i?e.set(r,i):e.delete(r)}}return e},t}(Bn),Hn=function(e){function t(t,n){var r=e.call(this)||this;return r.key=t,r.fieldTransforms=n,r.type=Ln.Transform,r.precondition=Fn.exists(!0),r}return Ct.__extends(t,e),t.prototype.applyToRemoteDocument=function(e,t){if(this.verifyKeyMatches(e),l(null!=t.transformResults,"Transform results missing for TransformMutation."),!this.precondition.isValidFor(e))return new Xt(this.key,t.version);var n=this.requireDocument(e),r=this.serverTransformResults(e,t.transformResults),i=t.version,o=this.transformObject(n.data,r);return new Qt(this.key,i,o,{hasCommittedMutations:!0})},t.prototype.applyToLocalView=function(e,t,n){if(this.verifyKeyMatches(e),!this.precondition.isValidFor(e))return e;var r=this.requireDocument(e),i=this.localTransformResults(n,t),o=this.transformObject(r.data,i);return new Qt(this.key,r.version,o,{hasLocalMutations:!0})},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&K(this.fieldTransforms,e.fieldTransforms)&&this.precondition.isEqual(e.precondition)},t.prototype.requireDocument=function(e){l(e instanceof Qt,"Unknown MaybeDocument type "+e);var t=e;return l(t.key.isEqual(this.key),"Can only transform a document with the same key"),t},t.prototype.serverTransformResults=function(e,t){var n=[];l(this.fieldTransforms.length===t.length,"server transform result count ("+t.length+") should match field transform count ("+this.fieldTransforms.length+")");for(var r=0;r<t.length;r++){var i=this.fieldTransforms[r],o=i.transform,a=null;e instanceof Qt&&(a=e.field(i.field)||null),n.push(o.applyToRemoteDocument(a,t[r]))}return n},t.prototype.localTransformResults=function(e,t){for(var n=[],r=0,i=this.fieldTransforms;r<i.length;r++){var o=i[r],a=o.transform,s=null;t instanceof Qt&&(s=t.field(o.field)||null),n.push(a.applyToLocalView(s,e))}return n},t.prototype.transformObject=function(e,t){l(t.length===this.fieldTransforms.length,"TransformResults length mismatch.");for(var n=0;n<this.fieldTransforms.length;n++){var r=this.fieldTransforms[n].field;e=e.set(r,t[n])}return e},t}(Bn),zn=function(e){function t(t,n){var r=e.call(this)||this;return r.key=t,r.precondition=n,r.type=Ln.Delete,r}return Ct.__extends(t,e),t.prototype.applyToRemoteDocument=function(e,t){return this.verifyKeyMatches(e),l(null==t.transformResults,"Transform results received by DeleteMutation."),new Gt(this.key,t.version,{hasCommittedMutations:!0})},t.prototype.applyToLocalView=function(e,t,n){return this.verifyKeyMatches(e),this.precondition.isValidFor(e)?(e&&l(e.key.isEqual(this.key),"Can only apply mutation to document with same key"),new Gt(this.key,Rn.forDeletedDoc())):e},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.precondition.isEqual(e.precondition)},t}(Bn),Qn=function(){function e(){}return e.prototype.applyToLocalView=function(e,t){return new fn(t,e)},e.prototype.applyToRemoteDocument=function(e,t){return t},e.prototype.isEqual=function(t){return t instanceof e},e.instance=new e,e}(),Gn=function(){function e(e){this.elements=e}return e.prototype.applyToLocalView=function(e,t){return this.apply(e)},e.prototype.applyToRemoteDocument=function(e,t){return this.apply(e)},e.prototype.apply=function(e){for(var t=$(e),n=0,r=this.elements;n<r.length;n++)!function(e){t.find(function(t){return t.isEqual(e)})||t.push(e)}(r[n]);return new vn(t)},e.prototype.isEqual=function(t){return t instanceof e&&K(t.elements,this.elements)},e}(),Xn=function(){function e(e){this.elements=e}return e.prototype.applyToLocalView=function(e,t){return this.apply(e)},e.prototype.applyToRemoteDocument=function(e,t){return this.apply(e)},e.prototype.apply=function(e){for(var t=$(e),n=0,r=this.elements;n<r.length;n++)!function(e){t=t.filter(function(t){return!t.isEqual(e)})}(r[n]);return new vn(t)},e.prototype.isEqual=function(t){return t instanceof e&&K(t.elements,this.elements)},e}(),Yn=function(){function e(e){this.count=e}return e.prototype.isEqual=function(e){return e&&e.count===this.count},e}();!function(e){e[e.OK=0]="OK",e[e.CANCELLED=1]="CANCELLED",e[e.UNKNOWN=2]="UNKNOWN",e[e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",e[e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",e[e.NOT_FOUND=5]="NOT_FOUND",e[e.ALREADY_EXISTS=6]="ALREADY_EXISTS",e[e.PERMISSION_DENIED=7]="PERMISSION_DENIED",e[e.UNAUTHENTICATED=16]="UNAUTHENTICATED",e[e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",e[e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",e[e.ABORTED=10]="ABORTED",e[e.OUT_OF_RANGE=11]="OUT_OF_RANGE",e[e.UNIMPLEMENTED=12]="UNIMPLEMENTED",e[e.INTERNAL=13]="INTERNAL",e[e.UNAVAILABLE=14]="UNAVAILABLE",e[e.DATA_LOSS=15]="DATA_LOSS"}(qn||(qn={}));var $n,Jn=function(){function e(e){this.comparator=e,this.data=new Yt(this.comparator)}return e.fromMapKeys=function(t){var n=new e(t.comparator);return t.forEach(function(e){n=n.add(e)}),n},e.prototype.has=function(e){return null!==this.data.get(e)},e.prototype.first=function(){return this.data.minKey()},e.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(e.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),e.prototype.indexOf=function(e){return this.data.indexOf(e)},e.prototype.forEach=function(e){this.data.inorderTraversal(function(t,n){return e(t),!1})},e.prototype.forEachInRange=function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}},e.prototype.forEachWhile=function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return},e.prototype.firstAfterOrEqual=function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null},e.prototype.add=function(e){return this.copy(this.data.remove(e).insert(e,!0))},e.prototype.delete=function(e){return this.has(e)?this.copy(this.data.remove(e)):this},e.prototype.isEmpty=function(){return this.data.isEmpty()},e.prototype.unionWith=function(e){var t=this;return e.forEach(function(e){t=t.add(e)}),t},e.prototype.isEqual=function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.data.getIterator(),r=t.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},e.prototype.toArray=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},e.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},e.prototype.copy=function(t){var n=new e(this.comparator);return n.data=t,n},e}(),Zn=new Yt(Ht.comparator),er=new Yt(Ht.comparator),tr=new Yt(Ht.comparator),nr=new Jn(Ht.comparator),rr=new Jn(F),ir=function(){function e(e){this.comparator=e?function(t,n){return e(t,n)||Ht.comparator(t.key,n.key)}:function(e,t){return Ht.comparator(e.key,t.key)},this.keyedMap=ie(),this.sortedSet=new Yt(this.comparator)}return e.emptySet=function(t){return new e(t.comparator)},e.prototype.has=function(e){return null!=this.keyedMap.get(e)},e.prototype.get=function(e){return this.keyedMap.get(e)},e.prototype.first=function(){return this.sortedSet.minKey()},e.prototype.last=function(){return this.sortedSet.maxKey()},e.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},e.prototype.indexOf=function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1},Object.defineProperty(e.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!0,configurable:!0}),e.prototype.forEach=function(e){this.sortedSet.inorderTraversal(function(t,n){return e(t),!1})},e.prototype.add=function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))},e.prototype.delete=function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this},e.prototype.isEqual=function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},e.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},e.prototype.copy=function(t,n){var r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r},e}();!function(e){e[e.Added=0]="Added",e[e.Removed=1]="Removed",e[e.Modified=2]="Modified",e[e.Metadata=3]="Metadata"}($n||($n={}));var or;!function(e){e[e.Local=0]="Local",e[e.Synced=1]="Synced"}(or||(or={}));var ar,sr=function(){function e(){this.changeMap=new Yt(Ht.comparator)}return e.prototype.track=function(e){var t=e.doc.key,n=this.changeMap.get(t);n?e.type!==$n.Added&&n.type===$n.Metadata?this.changeMap=this.changeMap.insert(t,e):e.type===$n.Metadata&&n.type!==$n.Removed?this.changeMap=this.changeMap.insert(t,{type:n.type,doc:e.doc}):e.type===$n.Modified&&n.type===$n.Modified?this.changeMap=this.changeMap.insert(t,{type:$n.Modified,doc:e.doc}):e.type===$n.Modified&&n.type===$n.Added?this.changeMap=this.changeMap.insert(t,{type:$n.Added,doc:e.doc}):e.type===$n.Removed&&n.type===$n.Added?this.changeMap=this.changeMap.remove(t):e.type===$n.Removed&&n.type===$n.Modified?this.changeMap=this.changeMap.insert(t,{type:$n.Removed,doc:n.doc}):e.type===$n.Added&&n.type===$n.Removed?this.changeMap=this.changeMap.insert(t,{type:$n.Modified,doc:e.doc}):c("unsupported combination of changes: "+JSON.stringify(e)+" after "+JSON.stringify(n)):this.changeMap=this.changeMap.insert(t,e)},e.prototype.getChanges=function(){var e=[];return this.changeMap.inorderTraversal(function(t,n){e.push(n)}),e},e}(),ur=function(){function e(e,t,n,r,i,o,a,s){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=s}return e.fromInitialDocuments=function(t,n,r,i){var o=[];return n.forEach(function(e){o.push({type:$n.Added,doc:e})}),new e(t,n,ir.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&this.query.isEqual(e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0},e}(),cr=function(){function e(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return e.createSynthesizedRemoteEventForCurrentChange=function(t,n){var r=(i={},i[t]=lr.createSynthesizedTargetChangeForCurrentChange(t,n),i);return new e(Rn.MIN,r,se(),re(),ae());var i},e}(),lr=function(){function e(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return e.createSynthesizedTargetChangeForCurrentChange=function(t,n){return new e(h(),n,ae(),ae(),ae())},e}(),hr=function(e,t,n,r){this.updatedTargetIds=e,this.removedTargetIds=t,this.key=n,this.newDoc=r},pr=function(e,t){this.targetId=e,this.existenceFilter=t};!function(e){e[e.NoChange=0]="NoChange",e[e.Added=1]="Added",e[e.Removed=2]="Removed",e[e.Current=3]="Current",e[e.Reset=4]="Reset"}(ar||(ar={}));var fr=function(e,t,n,r){void 0===n&&(n=h()),void 0===r&&(r=null),this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r},dr=function(){function e(){this.pendingResponses=0,this.documentChanges=ce(),this._resumeToken=h(),this._current=!1,this._hasPendingChanges=!0}return Object.defineProperty(e.prototype,"current",{get:function(){return this._current},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"resumeToken",{get:function(){return this._resumeToken},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPending",{get:function(){return 0!==this.pendingResponses},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasPendingChanges",{get:function(){return this._hasPendingChanges},enumerable:!0,configurable:!0}),e.prototype.updateResumeToken=function(e){e.length>0&&(this._hasPendingChanges=!0,this._resumeToken=e)},e.prototype.toTargetChange=function(){var e=ae(),t=ae(),n=ae();return this.documentChanges.forEach(function(r,i){switch(i){case $n.Added:e=e.add(r);break;case $n.Modified:t=t.add(r);break;case $n.Removed:n=n.add(r);break;default:c("Encountered invalid change type: "+i)}}),new lr(this._resumeToken,this._current,e,t,n)},e.prototype.clearPendingChanges=function(){this._hasPendingChanges=!1,this.documentChanges=ce()},e.prototype.addDocumentChange=function(e,t){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(e,t)},e.prototype.removeDocumentChange=function(e){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(e)},e.prototype.recordPendingTargetRequest=function(){this.pendingResponses+=1},e.prototype.recordTargetResponse=function(){this.pendingResponses-=1},e.prototype.markCurrent=function(){this._hasPendingChanges=!0,this._current=!0},e}(),mr=function(){function e(e){this.metadataProvider=e,this.targetStates={},this.pendingDocumentUpdates=re(),this.pendingDocumentTargetMapping=ue(),this.pendingTargetResets=new Jn(F)}return e.prototype.handleDocumentChange=function(e){for(var t=0,n=e.updatedTargetIds;t<n.length;t++)o=n[t],e.newDoc instanceof Qt?this.addDocumentToTarget(o,e.newDoc):e.newDoc instanceof Gt&&this.removeDocumentFromTarget(o,e.key,e.newDoc);for(var r=0,i=e.removedTargetIds;r<i.length;r++){var o=i[r];this.removeDocumentFromTarget(o,e.key,e.newDoc)}},e.prototype.handleTargetChange=function(e){var t=this;this.forEachTarget(e,function(n){var r=t.ensureTargetState(n);switch(e.state){case ar.NoChange:t.isActiveTarget(n)&&r.updateResumeToken(e.resumeToken);break;case ar.Added:r.recordTargetResponse(),r.isPending||r.clearPendingChanges(),r.updateResumeToken(e.resumeToken);break;case ar.Removed:r.recordTargetResponse(),r.isPending||t.removeTarget(n),l(!e.cause,"WatchChangeAggregator does not handle errored targets");break;case ar.Current:t.isActiveTarget(n)&&(r.markCurrent(),r.updateResumeToken(e.resumeToken));break;case ar.Reset:t.isActiveTarget(n)&&(t.resetTarget(n),r.updateResumeToken(e.resumeToken));break;default:c("Unknown target watch change state: "+e.state)}})},e.prototype.forEachTarget=function(e,t){e.targetIds.length>0?e.targetIds.forEach(t):m(this.targetStates,t)},e.prototype.handleExistenceFilter=function(e){var t=e.targetId,n=e.existenceFilter.count,r=this.queryDataForActiveTarget(t);if(r){var i=r.query;if(i.isDocumentQuery())if(0===n){var o=new Ht(i.path);this.removeDocumentFromTarget(t,o,new Gt(o,Rn.forDeletedDoc()))}else l(1===n,"Single document existence filter with count: "+n);else this.getCurrentDocumentCountForTarget(t)!==n&&(this.resetTarget(t),this.pendingTargetResets=this.pendingTargetResets.add(t))}},e.prototype.createRemoteEvent=function(e){var t=this,n={};m(this.targetStates,function(r,i){var o=t.queryDataForActiveTarget(r);if(o){if(i.current&&o.query.isDocumentQuery()){var a=new Ht(o.query.path);null!==t.pendingDocumentUpdates.get(a)||t.targetContainsDocument(r,a)||t.removeDocumentFromTarget(r,a,new Gt(a,e))}i.hasPendingChanges&&(n[r]=i.toTargetChange(),i.clearPendingChanges())}});var r=ae();this.pendingDocumentTargetMapping.forEach(function(e,n){var i=!0;n.forEachWhile(function(e){var n=t.queryDataForActiveTarget(e);return!n||n.purpose===nn.LimboResolution||(i=!1,!1)}),i&&(r=r.add(e))});var i=new cr(e,n,this.pendingTargetResets,this.pendingDocumentUpdates,r);return this.pendingDocumentUpdates=re(),this.pendingDocumentTargetMapping=ue(),this.pendingTargetResets=new Jn(F),i},e.prototype.addDocumentToTarget=function(e,t){if(this.isActiveTarget(e)){var n=this.targetContainsDocument(e,t.key)?$n.Modified:$n.Added;this.ensureTargetState(e).addDocumentChange(t.key,n),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(t.key,t),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t.key,this.ensureDocumentTargetMapping(t.key).add(e))}},e.prototype.removeDocumentFromTarget=function(e,t,n){if(this.isActiveTarget(e)){var r=this.ensureTargetState(e);this.targetContainsDocument(e,t)?r.addDocumentChange(t,$n.Removed):r.removeDocumentChange(t),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t,this.ensureDocumentTargetMapping(t).delete(e)),n&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(t,n))}},e.prototype.removeTarget=function(e){delete this.targetStates[e]},e.prototype.getCurrentDocumentCountForTarget=function(e){var t=this.ensureTargetState(e).toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size},e.prototype.recordPendingTargetRequest=function(e){this.ensureTargetState(e).recordPendingTargetRequest()},e.prototype.ensureTargetState=function(e){return this.targetStates[e]||(this.targetStates[e]=new dr),this.targetStates[e]},e.prototype.ensureDocumentTargetMapping=function(e){var t=this.pendingDocumentTargetMapping.get(e);return t||(t=new Jn(F),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e,t)),t},e.prototype.isActiveTarget=function(e){return null!==this.queryDataForActiveTarget(e)},e.prototype.queryDataForActiveTarget=function(e){var t=this.targetStates[e];return t&&t.isPending?null:this.metadataProvider.getQueryDataForTarget(e)},e.prototype.resetTarget=function(e){var t=this;l(!this.targetStates[e].isPending,"Should only reset active targets"),this.targetStates[e]=new dr,this.metadataProvider.getRemoteKeysForTarget(e).forEach(function(n){t.removeDocumentFromTarget(e,n,null)})},e.prototype.targetContainsDocument=function(e,t){return this.metadataProvider.getRemoteKeysForTarget(e).has(t)},e}(),gr=function(){var e={};return e[Dn.ASCENDING.name]="ASCENDING",e[Dn.DESCENDING.name]="DESCENDING",e}(),yr=function(){var e={};return e[Sn.LESS_THAN.name]="LESS_THAN",e[Sn.LESS_THAN_OR_EQUAL.name]="LESS_THAN_OR_EQUAL",e[Sn.GREATER_THAN.name]="GREATER_THAN",e[Sn.GREATER_THAN_OR_EQUAL.name]="GREATER_THAN_OR_EQUAL",e[Sn.EQUAL.name]="EQUAL",e[Sn.ARRAY_CONTAINS.name]="ARRAY_CONTAINS",e}(),vr=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/),br=function(){function e(e,t){this.databaseId=e,this.options=t}return e.prototype.emptyByteString=function(){return this.options.useProto3Json?"":new Uint8Array(0)},e.prototype.unsafeCastProtoByteString=function(e){return e},e.prototype.fromRpcStatus=function(e){var t=void 0===e.code?xt.UNKNOWN:ee(e.code);return new Ot(t,e.message||"")},e.prototype.toInt32Value=function(e){return X(e)?void 0:{value:e}},e.prototype.fromInt32Value=function(e){var t;return t="object"==typeof e?e.value:e,X(t)?null:t},e.prototype.toTimestamp=function(e){return{seconds:e.seconds,nanos:e.nanoseconds}},e.prototype.fromTimestamp=function(e){if("string"==typeof e)return this.fromIso8601String(e);l(!!e,"Cannot deserialize null or undefined timestamp.");var t=he(e.seconds||"0"),n=e.nanos||0;return new Vt(t,n)},e.prototype.fromIso8601String=function(e){var t=0,n=vr.exec(e);if(l(!!n,"invalid timestamp: "+e),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var i=new Date(e),o=Math.floor(i.getTime()/1e3);return new Vt(o,t)},e.prototype.toBytes=function(e){return this.options.useProto3Json?e.toBase64():this.unsafeCastProtoByteString(e.toUint8Array())},e.prototype.fromBlob=function(e){return"string"==typeof e?(l(this.options.useProto3Json,"Expected bytes to be passed in as Uint8Array, but got a string instead."),Rt.fromBase64String(e)):(l(!this.options.useProto3Json,"Expected bytes to be passed in as string, but got something else instead."),Rt.fromUint8Array(e))},e.prototype.toVersion=function(e){return this.toTimestamp(e.toTimestamp())},e.prototype.fromVersion=function(e){return l(!!e,"Trying to deserialize version that isn't set"),Rn.fromTimestamp(this.fromTimestamp(e))},e.prototype.toResourceName=function(e,t){return this.fullyQualifiedPrefixPath(e).child("documents").child(t).canonicalString()},e.prototype.fromResourceName=function(e){var t=Bt.fromString(e);return l(this.isValidResourceName(t),"Tried to deserialize invalid key "+t.toString()),t},e.prototype.toName=function(e){return this.toResourceName(this.databaseId,e.path)},e.prototype.fromName=function(e){var t=this.fromResourceName(e);return l(t.get(1)===this.databaseId.projectId,"Tried to deserialize key from different project: "+t.get(1)+" vs "+this.databaseId.projectId),l(!t.get(3)&&!this.databaseId.database||t.get(3)===this.databaseId.database,"Tried to deserialize key from different database: "+t.get(3)+" vs "+this.databaseId.database),new Ht(this.extractLocalPathFromResourceName(t))},e.prototype.toQueryPath=function(e){return 0===e.length?this.encodedDatabaseId:this.toResourceName(this.databaseId,e)},e.prototype.fromQueryPath=function(e){var t=this.fromResourceName(e);return 4===t.length?Bt.EMPTY_PATH:this.extractLocalPathFromResourceName(t)},Object.defineProperty(e.prototype,"encodedDatabaseId",{get:function(){return new Bt(["projects",this.databaseId.projectId,"databases",this.databaseId.database]).canonicalString()},enumerable:!0,configurable:!0}),e.prototype.fullyQualifiedPrefixPath=function(e){return new Bt(["projects",e.projectId,"databases",e.database])},e.prototype.extractLocalPathFromResourceName=function(e){return l(e.length>4&&"documents"===e.get(4),"tried to deserialize invalid key "+e.toString()),e.popFirst(5)},e.prototype.isValidResourceName=function(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)},e.prototype.toValue=function(e){if(e instanceof an)return{nullValue:"NULL_VALUE"};if(e instanceof sn)return{booleanValue:e.value()};if(e instanceof cn)return{integerValue:""+e.value()};if(e instanceof ln){var t=e.value();if(this.options.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:e.value()}}return e instanceof hn?{stringValue:e.value()}:e instanceof yn?{mapValue:this.toMapValue(e)}:e instanceof vn?{arrayValue:this.toArrayValue(e)}:e instanceof pn?{timestampValue:this.toTimestamp(e.internalValue)}:e instanceof gn?{geoPointValue:{latitude:e.value().latitude,longitude:e.value().longitude}}:e instanceof dn?{bytesValue:this.toBytes(e.value())}:e instanceof mn?{referenceValue:this.toResourceName(e.databaseId,e.key.path)}:c("Unknown FieldValue "+JSON.stringify(e))},e.prototype.fromValue=function(e){var t=this,n=e.value_type;if(pe(e,n,"nullValue"))return an.INSTANCE;if(pe(e,n,"booleanValue"))return sn.of(e.booleanValue);if(pe(e,n,"integerValue"))return new cn(he(e.integerValue));if(pe(e,n,"doubleValue")){if(this.options.useProto3Json){if("NaN"===e.doubleValue)return ln.NAN;if("Infinity"===e.doubleValue)return ln.POSITIVE_INFINITY;if("-Infinity"===e.doubleValue)return ln.NEGATIVE_INFINITY}return new ln(e.doubleValue)}if(pe(e,n,"stringValue"))return new hn(e.stringValue);if(pe(e,n,"mapValue"))return this.fromFields(e.mapValue.fields||{});if(pe(e,n,"arrayValue")){le(e.arrayValue,"arrayValue");var r=e.arrayValue.values||[];return new vn(r.map(function(e){return t.fromValue(e)}))}if(pe(e,n,"timestampValue"))return le(e.timestampValue,"timestampValue"),new pn(this.fromTimestamp(e.timestampValue));if(pe(e,n,"geoPointValue")){le(e.geoPointValue,"geoPointValue");var i=e.geoPointValue.latitude||0,o=e.geoPointValue.longitude||0;return new gn(new Mt(i,o))}if(pe(e,n,"bytesValue")){le(e.bytesValue,"bytesValue");var a=this.fromBlob(e.bytesValue);return new dn(a)}if(pe(e,n,"referenceValue")){le(e.referenceValue,"referenceValue");var s=this.fromResourceName(e.referenceValue),u=new qt(s.get(1),s.get(3)),l=new Ht(this.extractLocalPathFromResourceName(s));return new mn(u,l)}return c("Unknown Value proto "+JSON.stringify(e))},e.prototype.toMutationDocument=function(e,t){return{name:this.toName(e),fields:this.toFields(t)}},e.prototype.toDocument=function(e){return l(!e.hasLocalMutations,"Can't serialize documents with mutations."),{name:this.toName(e.key),fields:this.toFields(e.data),updateTime:this.toTimestamp(e.version.toTimestamp())}},e.prototype.fromDocument=function(e,t){return new Qt(this.fromName(e.name),this.fromVersion(e.updateTime),this.fromFields(e.fields||{}),{hasCommittedMutations:!!t})},e.prototype.toFields=function(e){var t=this,n={};return e.forEach(function(e,r){n[e]=t.toValue(r)}),n},e.prototype.fromFields=function(e){var t=this,n=e,r=yn.EMPTY;return y(n,function(e,n){r=r.set(new Wt([e]),t.fromValue(n))}),r},e.prototype.toMapValue=function(e){return{fields:this.toFields(e)}},e.prototype.toArrayValue=function(e){var t=this,n=[];return e.forEach(function(e){n.push(t.toValue(e))}),{values:n}},e.prototype.fromFound=function(e){l(!!e.found,"Tried to deserialize a found document from a missing document."),le(e.found.name,"doc.found.name"),le(e.found.updateTime,"doc.found.updateTime");var t=this.fromName(e.found.name),n=this.fromVersion(e.found.updateTime),r=this.fromFields(e.found.fields||{});return new Qt(t,n,r,{})},e.prototype.fromMissing=function(e){l(!!e.missing,"Tried to deserialize a missing document from a found document."),l(!!e.readTime,"Tried to deserialize a missing document without a read time.");var t=this.fromName(e.missing),n=this.fromVersion(e.readTime);return new Gt(t,n)},e.prototype.fromMaybeDocument=function(e){var t=e.result;return pe(e,t,"found")?this.fromFound(e):pe(e,t,"missing")?this.fromMissing(e):c("invalid batch get response: "+JSON.stringify(e))},e.prototype.toWatchTargetChangeState=function(e){switch(e){case ar.Added:return"ADD";case ar.Current:return"CURRENT";case ar.NoChange:return"NO_CHANGE";case ar.Removed:return"REMOVE";case ar.Reset:return"RESET";default:return c("Unknown WatchTargetChangeState: "+e)}},e.prototype.toTestWatchChange=function(e){if(e instanceof pr)return{filter:{count:e.existenceFilter.count,targetId:e.targetId}};if(e instanceof hr){if(e.newDoc instanceof Qt)return t=e.newDoc,{documentChange:{document:{name:this.toName(t.key),fields:this.toFields(t.data),updateTime:this.toVersion(t.version)},targetIds:e.updatedTargetIds,removedTargetIds:e.removedTargetIds}};if(e.newDoc instanceof Gt){var t=e.newDoc;return{documentDelete:{document:this.toName(t.key),readTime:this.toVersion(t.version),removedTargetIds:e.removedTargetIds}}}if(null===e.newDoc)return{documentRemove:{document:this.toName(e.key),removedTargetIds:e.removedTargetIds}}}if(e instanceof fr){var n=void 0;return e.cause&&(n={code:te(e.cause.code),message:e.cause.message}),{targetChange:{targetChangeType:this.toWatchTargetChangeState(e.state),targetIds:e.targetIds,resumeToken:this.unsafeCastProtoByteString(e.resumeToken),cause:n}}}return c("Unrecognized watch change: "+JSON.stringify(e))},e.prototype.fromWatchChange=function(e){var t,n=e.response_type;if(pe(e,n,"targetChange")){le(e.targetChange,"targetChange");var r=this.fromWatchTargetChangeState(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=e.targetChange.resumeToken||this.emptyByteString(),a=e.targetChange.cause,s=a&&this.fromRpcStatus(a);t=new fr(r,i,o,s||null)}else if(pe(e,n,"documentChange")){le(e.documentChange,"documentChange"),le(e.documentChange.document,"documentChange.name"),le(e.documentChange.document.name,"documentChange.document.name"),le(e.documentChange.document.updateTime,"documentChange.document.updateTime");var u=e.documentChange,l=this.fromName(u.document.name),h=this.fromVersion(u.document.updateTime),p=this.fromFields(u.document.fields||{}),f=new Qt(l,h,p,{}),d=u.targetIds||[],m=u.removedTargetIds||[];t=new hr(d,m,f.key,f)}else if(pe(e,n,"documentDelete")){le(e.documentDelete,"documentDelete"),le(e.documentDelete.document,"documentDelete.document");var g=e.documentDelete,l=this.fromName(g.document),h=g.readTime?this.fromVersion(g.readTime):Rn.forDeletedDoc(),f=new Gt(l,h),m=g.removedTargetIds||[];t=new hr([],m,f.key,f)}else if(pe(e,n,"documentRemove")){le(e.documentRemove,"documentRemove"),le(e.documentRemove.document,"documentRemove");var y=e.documentRemove,l=this.fromName(y.document),m=y.removedTargetIds||[];t=new hr([],m,l,null)}else{if(!pe(e,n,"filter"))return c("Unknown change type "+JSON.stringify(e));le(e.filter,"filter"),le(e.filter.targetId,"filter.targetId");var v=e.filter,b=v.count||0,_=new Yn(b),w=v.targetId;t=new pr(w,_)}return t},e.prototype.fromWatchTargetChangeState=function(e){return"NO_CHANGE"===e?ar.NoChange:"ADD"===e?ar.Added:"REMOVE"===e?ar.Removed:"CURRENT"===e?ar.Current:"RESET"===e?ar.Reset:c("Got unexpected TargetChange.state: "+e)},e.prototype.versionFromListenResponse=function(e){if(!pe(e,e.response_type,"targetChange"))return Rn.MIN;var t=e.targetChange;return t.targetIds&&t.targetIds.length?Rn.MIN:t.readTime?this.fromVersion(t.readTime):Rn.MIN},e.prototype.toMutation=function(e){var t,n=this;if(e instanceof Kn)t={update:this.toMutationDocument(e.key,e.value)};else if(e instanceof zn)t={delete:this.toName(e.key)};else if(e instanceof Wn)t={update:this.toMutationDocument(e.key,e.data),updateMask:this.toDocumentMask(e.fieldMask)};else{if(!(e instanceof Hn))return c("Unknown mutation type "+e.type);t={transform:{document:this.toName(e.key),fieldTransforms:e.fieldTransforms.map(function(e){return n.toFieldTransform(e)})}}}return e.precondition.isNone||(t.currentDocument=this.toPrecondition(e.precondition)),t},e.prototype.fromMutation=function(e){var t=this,n=e.currentDocument?this.fromPrecondition(e.currentDocument):Fn.NONE;if(e.update){le(e.update.name,"name");var r=this.fromName(e.update.name),i=this.fromFields(e.update.fields||{});if(e.updateMask){var o=this.fromDocumentMask(e.updateMask);return new Wn(r,i,o,n)}return new Kn(r,i,n)}if(e.delete)return r=this.fromName(e.delete),new zn(r,n);if(e.transform){var r=this.fromName(e.transform.document),a=e.transform.fieldTransforms.map(function(e){return t.fromFieldTransform(e)});return l(!0===n.exists,'Transforms only support precondition "exists == true"'),new Hn(r,a)}return c("unknown mutation proto: "+JSON.stringify(e))},e.prototype.toPrecondition=function(e){return l(!e.isNone,"Can't serialize an empty precondition"),void 0!==e.updateTime?{updateTime:this.toVersion(e.updateTime)}:void 0!==e.exists?{exists:e.exists}:c("Unknown precondition")},e.prototype.fromPrecondition=function(e){return void 0!==e.updateTime?Fn.updateTime(this.fromVersion(e.updateTime)):void 0!==e.exists?Fn.exists(e.exists):Fn.NONE},e.prototype.fromWriteResult=function(e,t){var n=this,r=e.updateTime?this.fromVersion(e.updateTime):this.fromVersion(t),i=null;return e.transformResults&&e.transformResults.length>0&&(i=e.transformResults.map(function(e){return n.fromValue(e)})),new Un(r,i)},e.prototype.fromWriteResults=function(e,t){var n=this;return e&&e.length>0?(l(void 0!==t,"Received a write result without a commit time"),e.map(function(e){return n.fromWriteResult(e,t)})):[]},e.prototype.toFieldTransform=function(e){var t=this,n=e.transform;if(n instanceof Qn)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Gn)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements.map(function(e){return t.toValue(e)})}};if(n instanceof Xn)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements.map(function(e){return t.toValue(e)})}};throw c("Unknown transform: "+e.transform)},e.prototype.fromFieldTransform=function(e){var t=this,n=e.transform_type,r=null;if(pe(e,n,"setToServerValue"))l("REQUEST_TIME"===e.setToServerValue,"Unknown server value transform proto: "+JSON.stringify(e)),r=Qn.instance;else if(pe(e,n,"appendMissingElements"))i=e.appendMissingElements.values||[],r=new Gn(i.map(function(e){return t.fromValue(e)}));else if(pe(e,n,"removeAllFromArray")){var i=e.removeAllFromArray.values||[];r=new Xn(i.map(function(e){return t.fromValue(e)}))}else c("Unknown transform proto: "+JSON.stringify(e));var o=Wt.fromServerFormat(e.fieldPath);return new jn(o,r)},e.prototype.toDocumentsTarget=function(e){return{documents:[this.toQueryPath(e.path)]}},e.prototype.fromDocumentsTarget=function(e){var t=e.documents.length;l(1===t,"DocumentsTarget contained other than 1 document: "+t);var n=e.documents[0];return En.atPath(this.fromQueryPath(n))},e.prototype.toQueryTarget=function(e){var t={structuredQuery:{}};if(e.path.isEmpty())t.parent=this.toQueryPath(Bt.EMPTY_PATH);else{var n=e.path;l(n.length%2!=0,"Document queries with filters are not supported."),t.parent=this.toQueryPath(n.popLast()),t.structuredQuery.from=[{collectionId:n.lastSegment()}]}var r=this.toFilter(e.filters);r&&(t.structuredQuery.where=r);var i=this.toOrder(e.orderBy);i&&(t.structuredQuery.orderBy=i);var o=this.toInt32Value(e.limit);return void 0!==o&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt=this.toCursor(e.startAt)),e.endAt&&(t.structuredQuery.endAt=this.toCursor(e.endAt)),t},e.prototype.fromQueryTarget=function(e){var t=this.fromQueryPath(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0;if(r>0){l(1===r,"StructuredQuery.from with more than one collection is not supported.");var i=n.from[0];t=t.child(i.collectionId)}var o=[];n.where&&(o=this.fromFilter(n.where));var a=[];n.orderBy&&(a=this.fromOrder(n.orderBy));var s=null;n.limit&&(s=this.fromInt32Value(n.limit));var u=null;n.startAt&&(u=this.fromCursor(n.startAt));var c=null;return n.endAt&&(c=this.fromCursor(n.endAt)),new En(t,a,o,s,u,c)},e.prototype.toListenRequestLabels=function(e){var t=this.toLabel(e.purpose);return null==t?null:{"goog-listen-tags":t}},e.prototype.toLabel=function(e){switch(e){case nn.Listen:return null;case nn.ExistenceFilterMismatch:return"existence-filter-mismatch";case nn.LimboResolution:return"limbo-document";default:return c("Unrecognized query purpose: "+e)}},e.prototype.toTarget=function(e){var t,n=e.query;return t=n.isDocumentQuery()?{documents:this.toDocumentsTarget(n)}:{query:this.toQueryTarget(n)},t.targetId=e.targetId,e.resumeToken.length>0&&(t.resumeToken=this.unsafeCastProtoByteString(e.resumeToken)),t},e.prototype.toFilter=function(e){var t=this;if(0!==e.length){var n=e.map(function(e){return e instanceof Cn?t.toRelationFilter(e):t.toUnaryFilter(e)});return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},e.prototype.fromFilter=function(e){var t=this;return e?void 0!==e.unaryFilter?[this.fromUnaryFilter(e)]:void 0!==e.fieldFilter?[this.fromRelationFilter(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(function(e){return t.fromFilter(e)}).reduce(function(e,t){return e.concat(t)}):c("Unknown filter: "+JSON.stringify(e)):[]},e.prototype.toOrder=function(e){var t=this;if(0!==e.length)return e.map(function(e){return t.toPropertyOrder(e)})},e.prototype.fromOrder=function(e){var t=this;return e.map(function(e){return t.fromPropertyOrder(e)})},e.prototype.toCursor=function(e){var t=this;return{before:e.before,values:e.position.map(function(e){return t.toValue(e)})}},e.prototype.fromCursor=function(e){var t=this,n=!!e.before,r=e.values.map(function(e){return t.fromValue(e)});return new An(r,n)},e.prototype.toDirection=function(e){return gr[e.name]},e.prototype.fromDirection=function(e){switch(e){case"ASCENDING":return Dn.ASCENDING;case"DESCENDING":return Dn.DESCENDING;default:return}},e.prototype.toOperatorName=function(e){return yr[e.name]},e.prototype.fromOperatorName=function(e){switch(e){case"EQUAL":return Sn.EQUAL;case"GREATER_THAN":return Sn.GREATER_THAN;case"GREATER_THAN_OR_EQUAL":return Sn.GREATER_THAN_OR_EQUAL;case"LESS_THAN":return Sn.LESS_THAN;case"LESS_THAN_OR_EQUAL":return Sn.LESS_THAN_OR_EQUAL;case"ARRAY_CONTAINS":return Sn.ARRAY_CONTAINS;case"OPERATOR_UNSPECIFIED":return c("Unspecified relation");default:return c("Unknown relation")}},e.prototype.toFieldPathReference=function(e){return{fieldPath:e.canonicalString()}},e.prototype.fromFieldPathReference=function(e){return Wt.fromServerFormat(e.fieldPath)},e.prototype.toPropertyOrder=function(e){return{field:this.toFieldPathReference(e.field),direction:this.toDirection(e.dir)}},e.prototype.fromPropertyOrder=function(e){return new xn(this.fromFieldPathReference(e.field),this.fromDirection(e.direction))},e.prototype.toRelationFilter=function(e){return e instanceof Cn?{fieldFilter:{field:this.toFieldPathReference(e.field),op:this.toOperatorName(e.op),value:this.toValue(e.value)}}:c("Unrecognized filter: "+JSON.stringify(e))},e.prototype.fromRelationFilter=function(e){return new Cn(this.fromFieldPathReference(e.fieldFilter.field),this.fromOperatorName(e.fieldFilter.op),this.fromValue(e.fieldFilter.value))},e.prototype.toUnaryFilter=function(e){return e instanceof Nn?{unaryFilter:{field:this.toFieldPathReference(e.field),op:"IS_NAN"}}:e instanceof In?{unaryFilter:{field:this.toFieldPathReference(e.field),op:"IS_NULL"}}:c("Unrecognized filter: "+JSON.stringify(e))},e.prototype.fromUnaryFilter=function(e){switch(e.unaryFilter.op){case"IS_NAN":var t=this.fromFieldPathReference(e.unaryFilter.field);return new Nn(t);case"IS_NULL":var n=this.fromFieldPathReference(e.unaryFilter.field);return new In(n);case"OPERATOR_UNSPECIFIED":return c("Unspecified filter");default:return c("Unknown filter")}},e.prototype.toDocumentMask=function(e){return{fieldPaths:e.fields.map(function(e){return e.canonicalString()})}},e.prototype.fromDocumentMask=function(e){var t=(e.fieldPaths||[]).map(function(e){return Wt.fromServerFormat(e)});return new Vn(t)},e}(),_r=function(){return"object"==typeof navigator&&"ReactNative"===navigator.product},wr="FirebaseError",kr=Error.captureStackTrace,Er=function(e,t){if(this.code=e,this.message=t,kr)kr(this,Tr.prototype.create);else try{throw Error.apply(this,arguments)}catch(e){this.name=wr,Object.defineProperty(this,"stack",{get:function(){return e.stack}})}};Er.prototype=Object.create(Error.prototype),Er.prototype.constructor=Er,Er.prototype.name=wr;var Tr=function(){function e(e,t,n){this.service=e,this.serviceName=t,this.errors=n,this.pattern=/\{\$([^}]+)}/g}return e.prototype.create=function(e,t){void 0===t&&(t={});var n,r=this.errors[e],i=this.service+"/"+e;n=void 0===r?"Error":r.replace(this.pattern,function(e,n){var r=t[n];return void 0!==r?r.toString():"<"+n+"?>"}),n=this.serviceName+": "+n+" ("+i+").";var o=new Er(i,n);for(var a in t)t.hasOwnProperty(a)&&"_"!==a.slice(-1)&&(o[a]=t[a]);return o},e}(),Sr=(function(e){function t(){var t=e.call(this)||this;t.chain_=[],t.buf_=[],t.W_=[],t.pad_=[],t.inbuf_=0,t.total_=0,t.blockSize=64,t.pad_[0]=128;for(var n=1;n<t.blockSize;++n)t.pad_[n]=0;return t.reset(),t}Ct.__extends(t,e),t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(e,t){t||(t=0);var n=this.W_;if("string"==typeof e)for(l=0;l<16;l++)n[l]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(l=0;l<16;l++)n[l]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(l=16;l<80;l++)h=n[l-3]^n[l-8]^n[l-14]^n[l-16],n[l]=4294967295&(h<<1|h>>>31);for(var r,i,o=this.chain_[0],a=this.chain_[1],s=this.chain_[2],u=this.chain_[3],c=this.chain_[4],l=0;l<80;l++){l<40?l<20?(r=u^a&(s^u),i=1518500249):(r=a^s^u,i=1859775393):l<60?(r=a&s|u&(a|s),i=2400959708):(r=a^s^u,i=3395469782);var h=(o<<5|o>>>27)+r+c+i+n[l]&4294967295;c=u,u=s,s=4294967295&(a<<30|a>>>2),a=o,o=h}this.chain_[0]=this.chain_[0]+o&4294967295,this.chain_[1]=this.chain_[1]+a&4294967295,this.chain_[2]=this.chain_[2]+s&4294967295,this.chain_[3]=this.chain_[3]+u&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295},t.prototype.update=function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<t;){if(0==o)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[o]=e.charCodeAt(r),++o,++r,o==this.blockSize){this.compress_(i),o=0;break}}else for(;r<t;)if(i[o]=e[r],++o,++r,o==this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=t}},t.prototype.digest=function(){var e=[],t=8*this.total_;for(this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56)),r=this.blockSize-1;r>=56;r--)this.buf_[r]=255&t,t/=256;this.compress_(this.buf_);for(var n=0,r=0;r<5;r++)for(var i=24;i>=0;i-=8)e[n]=this.chain_[r]>>i&255,++n;return e}}(function(){this.blockSize=-1}),function(){function e(e){this.sendFn=e.sendFn,this.closeFn=e.closeFn}return e.prototype.onOpen=function(e){l(!this.wrappedOnOpen,"Called onOpen on stream twice!"),this.wrappedOnOpen=e},e.prototype.onClose=function(e){l(!this.wrappedOnClose,"Called onClose on stream twice!"),this.wrappedOnClose=e},e.prototype.onMessage=function(e){l(!this.wrappedOnMessage,"Called onMessage on stream twice!"),this.wrappedOnMessage=e},e.prototype.close=function(){this.closeFn()},e.prototype.send=function(e){this.sendFn(e)},e.prototype.callOnOpen=function(){l(void 0!==this.wrappedOnOpen,"Cannot call onOpen because no callback was set"),this.wrappedOnOpen()},e.prototype.callOnClose=function(e){l(void 0!==this.wrappedOnClose,"Cannot call onClose because no callback was set"),this.wrappedOnClose(e)},e.prototype.callOnMessage=function(e){l(void 0!==this.wrappedOnMessage,"Cannot call onMessage because no callback was set"),this.wrappedOnMessage(e)},e}()),Cr="Connection",Ir={BatchGetDocuments:"batchGet",Commit:"commit"},Nr="gl-js/ fire/"+Nt,Dr=function(){function e(e){this.databaseId=e.databaseId,this.pool=new It.XhrIoPool;var t=e.ssl?"https":"http";this.baseUrl=t+"://"+e.host}return e.prototype.modifyHeadersForRequest=function(e,t){if(t)for(var n in t.authHeaders)t.authHeaders.hasOwnProperty(n)&&(e[n]=t.authHeaders[n]);e["X-Goog-Api-Client"]=Nr},e.prototype.invokeRPC=function(e,t,n){var r=this,i=this.makeUrl(e);return new Promise(function(o,s){r.pool.getObject(function(u){u.listenOnce(It.EventType.COMPLETE,function(){try{switch(u.getLastErrorCode()){case It.ErrorCode.NO_ERROR:var t=u.getResponseJson();a(Cr,"XHR received:",JSON.stringify(t)),o(t);break;case It.ErrorCode.TIMEOUT:a(Cr,'RPC "'+e+'" timed out'),s(new Ot(xt.DEADLINE_EXCEEDED,"Request time out"));break;case It.ErrorCode.HTTP_ERROR:var n=u.getStatus();a(Cr,'RPC "'+e+'" failed with status:',n,"response text:",u.getResponseText()),n>0?s(new Ot(ne(n),"Server responded with status "+u.getStatusText())):(a(Cr,'RPC "'+e+'" failed'),s(new Ot(xt.UNAVAILABLE,"Connection failed.")));break;default:c('RPC "'+e+'" failed with unanticipated webchannel error '+u.getLastErrorCode()+": "+u.getLastError()+", giving up.")}}finally{a(Cr,'RPC "'+e+'" completed.'),r.pool.releaseObject(u)}});var l=JSON.stringify(t);a(Cr,"XHR sending: ",i+" "+l);var h={"Content-Type":"text/plain"};r.modifyHeadersForRequest(h,n),u.send(i,"POST",l,h,15)})})},e.prototype.invokeStreamingRPC=function(e,t,n){return this.invokeRPC(e,t,n)},e.prototype.openStream=function(e,t){var n=[this.baseUrl,"/","google.firestore.v1beta1.Firestore","/",e,"/channel"],r=It.createWebChannelTransport(),i={backgroundChannelTest:!0,httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0};this.modifyHeadersForRequest(i.initMessageHeaders,t),_r()||(i.httpHeadersOverwriteParam="$httpHeaders");var o=n.join("");a(Cr,"Creating WebChannel: "+o+" "+i);var s=r.createWebChannel(o,i),u=!1,c=!1,h=new Sr({sendFn:function(e){c?a(Cr,"Not sending because WebChannel is closed:",e):(u||(a(Cr,"Opening WebChannel transport."),s.open(),u=!0),a(Cr,"WebChannel sending:",e),s.send(e))},closeFn:function(){return s.close()}}),p=function(e,t){s.listen(e,function(e){try{t(e)}catch(e){setTimeout(function(){throw e},0)}})};return p(It.WebChannel.EventType.OPEN,function(){c||a(Cr,"WebChannel transport opened.")}),p(It.WebChannel.EventType.CLOSE,function(){c||(c=!0,a(Cr,"WebChannel transport closed"),h.callOnClose())}),p(It.WebChannel.EventType.ERROR,function(e){c||(c=!0,a(Cr,"WebChannel transport errored:",e),h.callOnClose(new Ot(xt.UNAVAILABLE,"The operation could not be completed")))}),p(It.WebChannel.EventType.MESSAGE,function(e){if(!c){var t=e.data[0];l(!!t,"Got a webchannel message without data.");var n=t.error||t[0]&&t[0].error;if(n){a(Cr,"WebChannel received error:",n);var r=n.status,i=Z(r),o=n.message;void 0===i&&(i=xt.INTERNAL,o="Unknown error status: "+r+" with message "+n.message),c=!0,h.callOnClose(new Ot(i,o)),s.close()}else a(Cr,"WebChannel received:",t),h.callOnMessage(t)}}),setTimeout(function(){h.callOnOpen()},0),h},e.prototype.makeUrl=function(e){var t=Ir[e];l(void 0!==t,"Unknown REST mapping for: "+e);var n=[this.baseUrl,"/","v1beta1"];return n.push("/projects/"),n.push(this.databaseId.projectId),n.push("/databases/"),n.push(this.databaseId.database),n.push("/documents"),n.push(":"),n.push(t),n.join("")},e}(),Ar=function(){function e(){this.emptyByteString="",this.base64Available="undefined"!=typeof atob}return Object.defineProperty(e.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),e.prototype.loadConnection=function(e){return Promise.resolve(new Dr(e))},e.prototype.newSerializer=function(e){return new br(e,{useProto3Json:!0})},e.prototype.formatJSON=function(e){return JSON.stringify(e)},e.prototype.atob=function(e){return atob(e)},e.prototype.btoa=function(e){return btoa(e)},e}();At.setPlatform(new Ar);var xr,Or=function(){function e(e,t){var n=this;this.previousValue=e,t&&(t.sequenceNumberHandler=function(e){return n.setPreviousValue(e)},this.writeNewSequenceNumber=function(e){return t.writeSequenceNumber(e)})}return e.prototype.setPreviousValue=function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue},e.prototype.next=function(){var e=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(e),e},e.INVALID=-1,e}(),Pr=function(){var e=this;this.promise=new Promise(function(t,n){e.resolve=t,e.reject=n})};!function(e){e.All="all",e.ListenStreamIdle="listen_stream_idle",e.ListenStreamConnectionBackoff="listen_stream_connection_backoff",e.WriteStreamIdle="write_stream_idle",e.WriteStreamConnectionBackoff="write_stream_connection_backoff",e.OnlineStateTimeout="online_state_timeout",e.ClientMetadataRefresh="client_metadata_refresh"}(xr||(xr={}));var Rr,Lr=function(){function e(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Pr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.catch=this.deferred.promise.catch.bind(this.deferred.promise),this.deferred.promise.catch(function(e){})}return e.createAndSchedule=function(t,n,r,i,o){var a=new e(t,n,Date.now()+r,i,o);return a.start(r),a},e.prototype.start=function(e){var t=this;this.timerHandle=setTimeout(function(){return t.handleDelayElapsed()},e)},e.prototype.skipDelay=function(){return this.handleDelayElapsed()},e.prototype.cancel=function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Ot(xt.CANCELLED,"Operation cancelled"+(e?": "+e:""))))},e.prototype.handleDelayElapsed=function(){var e=this;this.asyncQueue.enqueueAndForget(function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then(function(t){return e.deferred.resolve(t)})):Promise.resolve()})},e.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},e}(),Mr=function(){function e(){this.tail=Promise.resolve(),this.delayedOperations=[],this.operationInProgress=!1}return e.prototype.enqueueAndForget=function(e){this.enqueue(e)},e.prototype.enqueue=function(e){var t=this;this.verifyNotFailed();var n=this.tail.then(function(){return t.operationInProgress=!0,e().catch(function(e){t.failure=e,t.operationInProgress=!1;var n=e.stack||e.message||"";throw s("INTERNAL UNHANDLED ERROR: ",n),n.indexOf("Firestore Test Simulated Error")<0&&setTimeout(function(){throw e},0),e}).then(function(e){return t.operationInProgress=!1,e})});return this.tail=n,n},e.prototype.enqueueAfterDelay=function(e,t,n){var r=this;this.verifyNotFailed(),l(t>=0,"Attempted to schedule an operation with a negative delay of "+t),l(!this.containsDelayedOperation(e),"Attempted to schedule multiple operations with timer id "+e+".");var i=Lr.createAndSchedule(this,e,t,n,function(e){return r.removeDelayedOperation(e)});return this.delayedOperations.push(i),i},e.prototype.verifyNotFailed=function(){this.failure&&c("AsyncQueue is already failed: "+(this.failure.stack||this.failure.message))},e.prototype.verifyOperationInProgress=function(){l(this.operationInProgress,"verifyOpInProgress() called when no op in progress on this queue.")},e.prototype.drain=function(){return this.enqueue(function(){return Promise.resolve()})},e.prototype.containsDelayedOperation=function(e){for(var t=0,n=this.delayedOperations;t<n.length;t++)if(n[t].timerId===e)return!0;return!1},e.prototype.runDelayedOperationsEarly=function(e){var t=this;return this.drain().then(function(){l(e===xr.All||t.containsDelayedOperation(e),"Attempted to drain to missing operation "+e),t.delayedOperations.sort(function(e,t){return e.targetTimeMs-t.targetTimeMs});for(var n=0,r=t.delayedOperations;n<r.length;n++){var i=r[n];if(i.skipDelay(),e!==xr.All&&i.timerId===e)break}return t.drain()})},e.prototype.removeDelayedOperation=function(e){var t=this.delayedOperations.indexOf(e);l(t>=0,"Delayed operation not found."),this.delayedOperations.splice(t,1)},e}(),Vr="",jr="",Ur="",qr="",Fr=-1,Br=function(){function e(e,t,n){this.batchId=e,this.localWriteTime=t,this.mutations=n,l(n.length>0,"Cannot create an empty mutation batch")}return e.prototype.applyToRemoteDocument=function(e,t,n){t&&l(t.key.isEqual(e),"applyToRemoteDocument: key "+e+" should match maybeDoc key\n        "+t.key);var r=n.mutationResults;l(r.length===this.mutations.length,"Mismatch between mutations length\n      ("+this.mutations.length+") and mutation results length\n      ("+r.length+").");for(var i=0;i<this.mutations.length;i++){var o=this.mutations[i];if(o.key.isEqual(e)){var a=r[i];t=o.applyToRemoteDocument(t,a)}}return t},e.prototype.applyToLocalView=function(e,t){t&&l(t.key.isEqual(e),"applyToLocalDocument: key "+e+" should match maybeDoc key\n        "+t.key);for(var n=t,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(e)&&(t=i.applyToLocalView(t,n,this.localWriteTime))}return t},e.prototype.keys=function(){for(var e=ae(),t=0,n=this.mutations;t<n.length;t++){var r=n[t];e=e.add(r.key)}return e},e.prototype.isEqual=function(e){return this.batchId===e.batchId&&K(this.mutations,e.mutations)},e}(),Kr=function(){function e(e,t,n,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.streamToken=r,this.docVersions=i}return e.from=function(t,n,r,i){l(t.mutations.length===r.length,"Mutations sent "+t.mutations.length+" must equal results received "+r.length);for(var o=oe(),a=t.mutations,s=0;s<a.length;s++)o=o.insert(a[s].key,r[s].version);return new e(t,n,r,i,o)},e}(),Wr=1;!function(e){e[e.QueryCache=0]="QueryCache",e[e.SyncEngine=1]="SyncEngine"}(Rr||(Rr={}));var Hr,zr=function(){function e(e,t){this.generatorId=e,l((e&Wr)===e,"Generator ID "+e+" contains more than "+Wr+" reserved bits"),this.seek(void 0!==t?t:this.generatorId)}return e.prototype.next=function(){var e=this.nextId;return this.nextId+=1<<Wr,e},e.prototype.after=function(e){return this.seek(e+(1<<Wr)),this.next()},e.prototype.seek=function(e){l((e&Wr)===this.generatorId,"Cannot supply target ID from different generator ID"),this.nextId=e},e.forQueryCache=function(){return new e(Rr.QueryCache,2)},e.forSyncEngine=function(){return new e(Rr.SyncEngine)},e}(),Qr=function(){function e(e){var t=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(function(e){t.isDone=!0,t.result=e,t.nextCallback&&t.nextCallback(e)},function(e){t.isDone=!0,t.error=e,t.catchCallback&&t.catchCallback(e)})}return e.prototype.catch=function(e){return this.next(void 0,e)},e.prototype.next=function(t,n){var r=this;return this.callbackAttached&&c("Called next() or catch() twice for PersistencePromise"),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e(function(e,i){r.nextCallback=function(n){r.wrapSuccess(t,n).next(e,i)},r.catchCallback=function(t){r.wrapFailure(n,t).next(e,i)}})},e.prototype.toPromise=function(){var e=this;return new Promise(function(t,n){e.next(t,n)})},e.prototype.wrapUserFunction=function(t){try{var n=t();return n instanceof e?n:e.resolve(n)}catch(t){return e.reject(t)}},e.prototype.wrapSuccess=function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.resolve(n)},e.prototype.wrapFailure=function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.reject(n)},e.resolve=function(t){return new e(function(e,n){e(t)})},e.reject=function(t){return new e(function(e,n){n(t)})},e.waitFor=function(t){return new e(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(e){return n(e)})}),o=!0,i===r&&e()})},e.or=function(t){for(var n=e.resolve(!1),r=0,i=t;r<i.length;r++)!function(t){n=n.next(function(n){return n?e.resolve(n):t()})}(i[r]);return n},e.forEach=function(e,t){var n=this,r=[];return e.forEach(function(e,i){r.push(t.call(n,e,i))}),this.waitFor(r)},e}(),Gr=function(){function e(e){this.db=e}return e.openOrCreate=function(t,n,r){return l(e.isAvailable(),"IndexedDB not supported in current environment."),a("SimpleDb","Opening database:",t),new Qr(function(i,o){var s=window.indexedDB.open(t,n);s.onsuccess=function(t){var n=t.target.result;i(new e(n))},s.onblocked=function(){o(new Ot(xt.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=function(e){o(e.target.error)},s.onupgradeneeded=function(e){a("SimpleDb",'Database "'+t+'" requires upgrade from version:',e.oldVersion);var n=e.target.result,i=new Yr(s.transaction);r.createOrUpgrade(n,i,e.oldVersion,ii).next(function(){a("SimpleDb","Database upgrade to version "+ii+" complete")})}}).toPromise()},e.delete=function(e){return a("SimpleDb","Removing database:",e),ye(window.indexedDB.deleteDatabase(e)).toPromise()},e.isAvailable=function(){if("undefined"==typeof window||null==window.indexedDB)return!1;if(void 0===window.navigator)return"YES"===process.env.USE_MOCK_PERSISTENCE;var e=window.navigator.userAgent;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0)},e.getStore=function(e,t){return e.store(t)},e.prototype.runTransaction=function(e,t,n){var r=Yr.open(this.db,e,t),i=n(r).catch(function(e){r.abort(e)}).toPromise();return r.completionPromise.then(function(){return i})},e.prototype.close=function(){this.db.close()},e}(),Xr=function(){function e(e){this.dbCursor=e,this.shouldStop=!1,this.nextKey=null}return Object.defineProperty(e.prototype,"isDone",{get:function(){return this.shouldStop},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"skipToKey",{get:function(){return this.nextKey},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cursor",{set:function(e){this.dbCursor=e},enumerable:!0,configurable:!0}),e.prototype.done=function(){this.shouldStop=!0},e.prototype.skip=function(e){this.nextKey=e},e.prototype.delete=function(){return ye(this.dbCursor.delete())},e}(),Yr=function(){function e(e){var t=this;this.transaction=e,this.aborted=!1,this.completionDeferred=new Pr,this.transaction.oncomplete=function(){t.completionDeferred.resolve()},this.transaction.onabort=function(){e.error?t.completionDeferred.reject(e.error):t.completionDeferred.resolve()},this.transaction.onerror=function(e){t.completionDeferred.reject(e.target.error)}}return e.open=function(t,n,r){return new e(t.transaction(r,n))},Object.defineProperty(e.prototype,"completionPromise",{get:function(){return this.completionDeferred.promise},enumerable:!0,configurable:!0}),e.prototype.abort=function(e){e&&this.completionDeferred.reject(e),this.aborted||(a("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},e.prototype.store=function(e){var t=this.transaction.objectStore(e);return l(!!t,"Object store not part of transaction: "+e),new $r(t)},e}(),$r=function(){function e(e){this.store=e}return e.prototype.put=function(e,t){var n;return void 0!==t?(a("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(a("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),ye(n)},e.prototype.add=function(e){return a("SimpleDb","ADD",this.store.name,e,e),ye(this.store.add(e))},e.prototype.get=function(e){var t=this;return ye(this.store.get(e)).next(function(n){return void 0===n&&(n=null),a("SimpleDb","GET",t.store.name,e,n),n})},e.prototype.delete=function(e){return a("SimpleDb","DELETE",this.store.name,e),ye(this.store.delete(e))},e.prototype.count=function(){return a("SimpleDb","COUNT",this.store.name),ye(this.store.count())},e.prototype.loadAll=function(e,t){var n=this.cursor(this.options(e,t)),r=[];return this.iterateCursor(n,function(e,t){r.push(t)}).next(function(){return r})},e.prototype.deleteAll=function(e,t){a("SimpleDb","DELETE ALL",this.store.name);var n=this.options(e,t);n.keysOnly=!1;var r=this.cursor(n);return this.iterateCursor(r,function(e,t,n){return n.delete()})},e.prototype.iterate=function(e,t){var n;t?n=e:(n={},t=e);var r=this.cursor(n);return this.iterateCursor(r,t)},e.prototype.iterateSerial=function(e){var t=this.cursor({});return new Qr(function(n,r){t.onerror=function(e){r(e.target.error)},t.onsuccess=function(t){var r=t.target.result;r?e(r.primaryKey,r.value).next(function(e){e?r.continue():n()}):n()}})},e.prototype.iterateCursor=function(e,t){var n=[];return new Qr(function(r,i){e.onerror=function(e){i(e.target.error)},e.onsuccess=function(e){var i=e.target.result;if(i){var o=new Xr(i),a=t(i.primaryKey,i.value,o);if(a instanceof Qr){var s=a.catch(function(e){return o.done(),Qr.reject(e)});n.push(s)}o.isDone?r():null===o.skipToKey?i.continue():i.continue(o.skipToKey)}else r()}}).next(function(){return Qr.waitFor(n)})},e.prototype.options=function(e,t){var n=void 0;return void 0!==e&&("string"==typeof e?n=e:(l(void 0===t,"3rd argument must not be defined if 2nd is a range."),t=e)),{index:n,range:t}},e.prototype.cursor=function(e){var t="next";if(e.reverse&&(t="prev"),e.index){var n=this.store.index(e.index);return e.keysOnly?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)},e}(),Jr=function(){function e(e,t){this.referenceDelegate=e,this.serializer=t,this.targetIdGenerator=zr.forQueryCache()}return e.prototype.allocateTargetId=function(e){var t=this;return this.retrieveMetadata(e).next(function(n){return n.highestTargetId=t.targetIdGenerator.after(n.highestTargetId),t.saveMetadata(e,n).next(function(){return n.highestTargetId})})},e.prototype.getLastRemoteSnapshotVersion=function(e){return this.retrieveMetadata(e).next(function(e){return Rn.fromTimestamp(new Vt(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))})},e.prototype.getHighestSequenceNumber=function(e){return we(e.simpleDbTransaction)},e.prototype.setTargetsMetadata=function(e,t,n){var r=this;return this.retrieveMetadata(e).next(function(i){return i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),r.saveMetadata(e,i)})},e.prototype.addQueryData=function(e,t){var n=this;return this.saveQueryData(e,t).next(function(){return n.retrieveMetadata(e).next(function(r){return r.targetCount+=1,n.updateMetadataFromQueryData(t,r),n.saveMetadata(e,r)})})},e.prototype.updateQueryData=function(e,t){return this.saveQueryData(e,t)},e.prototype.removeQueryData=function(e,t){var n=this;return this.removeMatchingKeysForTargetId(e,t.targetId).next(function(){return ve(e).delete(t.targetId)}).next(function(){return n.retrieveMetadata(e)}).next(function(t){return l(t.targetCount>0,"Removing from an empty query cache"),t.targetCount-=1,n.saveMetadata(e,t)})},e.prototype.removeTargets=function(e,t,n){var r=this,i=0,o=[];return ve(e).iterate(function(a,s){var u=r.serializer.fromDbTarget(s);u.sequenceNumber<=t&&void 0===n[u.targetId]&&(i++,o.push(r.removeQueryData(e,u)))}).next(function(){return Qr.waitFor(o)}).next(function(){return i})},e.prototype.forEachTarget=function(e,t){var n=this;return ve(e).iterate(function(e,r){var i=n.serializer.fromDbTarget(r);t(i)})},e.prototype.retrieveMetadata=function(e){return _e(e.simpleDbTransaction)},e.prototype.saveMetadata=function(e,t){return be(e).put(yi.key,t)},e.prototype.saveQueryData=function(e,t){return ve(e).put(this.serializer.toDbTarget(t))},e.prototype.updateMetadataFromQueryData=function(e,t){var n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n},e.prototype.getQueryCount=function(e){return this.retrieveMetadata(e).next(function(e){return e.targetCount})},e.prototype.getQueryData=function(e,t){var n=this,r=t.canonicalId(),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return ve(e).iterate({range:i,index:mi.queryTargetsIndexName},function(e,r,i){var a=n.serializer.fromDbTarget(r);t.isEqual(a.query)&&(o=a,i.done())}).next(function(){return o})},e.prototype.addMatchingKeys=function(e,t,n){var r=this,i=[],o=ke(e);return t.forEach(function(t){var a=fe(t.path);i.push(o.put(new gi(n,a))),i.push(r.referenceDelegate.addReference(e,t))}),Qr.waitFor(i)},e.prototype.removeMatchingKeys=function(e,t,n){var r=this,i=ke(e);return Qr.forEach(t,function(t){var o=fe(t.path);return Qr.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(e,t)])})},e.prototype.removeMatchingKeysForTargetId=function(e,t){var n=ke(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)},e.prototype.getMatchingKeysForTargetId=function(e,t){var n=IDBKeyRange.bound([t],[t+1],!1,!0),r=ke(e),i=ae();return r.iterate({range:n,keysOnly:!0},function(e,t,n){var r=ge(e[1]),o=new Ht(r);i=i.add(o)}).next(function(){return i})},e.prototype.containsKey=function(e,t){var n=fe(t.path),r=IDBKeyRange.bound([n],[W(n)],!1,!0),i=0;return ke(e).iterate({index:gi.documentTargetsIndex,keysOnly:!0,range:r},function(e,t,n){var r=e[0];e[1],0!==r&&(i++,n.done())}).next(function(){return i>0})},e.prototype.getQueryDataForTarget=function(e,t){var n=this;return ve(e).get(t).next(function(e){return e?n.serializer.fromDbTarget(e):null})},e}(),Zr=function(){function e(e){this.mapKeyFn=e,this.inner={}}return e.prototype.get=function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];if(a.isEqual(e))return s}},e.prototype.has=function(e){return void 0!==this.get(e)},e.prototype.set=function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(r[i][0].isEqual(e))return void(r[i]=[e,t]);r.push([e,t])}else this.inner[n]=[[e,t]]},e.prototype.delete=function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(n[r][0].isEqual(e))return 1===n.length?delete this.inner[t]:n.splice(r,1),!0;return!1},e.prototype.forEach=function(e){y(this.inner,function(t,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];e(a,s)}})},e.prototype.isEmpty=function(){return v(this.inner)},e}(),ei=function(){function e(){this.changes=re(),this.documentSizes=new Zr(function(e){return e.toString()})}return e.prototype.addEntry=function(e){var t=this.assertChanges();this.changes=t.insert(e.key,e)},e.prototype.getEntry=function(e,t){var n=this,r=this.assertChanges().get(t);return r?Qr.resolve(r):this.getFromCache(e,t).next(function(e){return null===e?(n.documentSizes.set(t,0),null):(n.documentSizes.set(t,e.size),e.maybeDocument)})},e.prototype.apply=function(e){var t=this.applyChanges(e);return this.changes=null,t},e.prototype.assertChanges=function(){return l(null!==this.changes,"Changes have already been applied."),this.changes},e}(),ti="The remote document changelog no longer contains all changes for all local query views. It may be necessary to rebuild these views.",ni=function(){function e(e,t){this.serializer=e,this.keepDocumentChangeLog=t,this._lastProcessedDocumentChangeId=0}return Object.defineProperty(e.prototype,"lastProcessedDocumentChangeId",{get:function(){return this._lastProcessedDocumentChangeId},enumerable:!0,configurable:!0}),e.prototype.start=function(e){var t=Gr.getStore(e,vi.store);return this.synchronizeLastDocumentChangeId(t)},e.prototype.addEntries=function(e,t,n){var r=[];if(t.length>0){for(var i=Se(e),o=ae(),a=0,s=t;a<s.length;a++){var u=s[a],c=u.key,l=u.doc;r.push(i.put(Ie(c),l)),o=o.add(c)}this.keepDocumentChangeLog&&r.push(Ce(e).put({changes:this.serializer.toDbResourcePaths(o)})),r.push(this.updateSize(e,n))}return Qr.waitFor(r)},e.prototype.removeEntry=function(e,t){var n=Se(e),r=Ie(t);return n.get(r).next(function(e){return e?n.delete(r).next(function(){return Ne(e)}):Qr.resolve(0)})},e.prototype.getEntry=function(e,t){var n=this;return Se(e).get(Ie(t)).next(function(e){return e?n.serializer.fromDbRemoteDocument(e):null})},e.prototype.getSizedEntry=function(e,t){var n=this;return Se(e).get(Ie(t)).next(function(e){return e?{maybeDocument:n.serializer.fromDbRemoteDocument(e),size:Ne(e)}:null})},e.prototype.getDocumentsMatchingQuery=function(e,t){var n=this,r=ie(),i=t.path.toArray(),o=IDBKeyRange.lowerBound(i);return Se(e).iterate({range:o},function(e,i,o){var a=n.serializer.fromDbRemoteDocument(i);t.path.isPrefixOf(a.key.path)?a instanceof Qt&&t.matches(a)&&(r=r.insert(a.key,a)):o.done()}).next(function(){return r})},e.prototype.getNewDocumentChanges=function(e){var t=this;l(this.keepDocumentChangeLog,"Can only call getNewDocumentChanges() when document change log is enabled");var n=ae(),r=re(),i=IDBKeyRange.lowerBound(this._lastProcessedDocumentChangeId+1),o=!0,a=Ce(e);return a.iterate({range:i},function(e,r){if(o&&(o=!1,t._lastProcessedDocumentChangeId+1!==r.id))return t.synchronizeLastDocumentChangeId(a).next(function(){return Qr.reject(new Ot(xt.DATA_LOSS,ti))});n=n.unionWith(t.serializer.fromDbResourcePaths(r.changes)),t._lastProcessedDocumentChangeId=r.id}).next(function(){var i=[];return n.forEach(function(n){i.push(t.getEntry(e,n).next(function(e){var t=e||new Gt(n,Rn.forDeletedDoc());r=r.insert(n,t)}))}),Qr.waitFor(i)}).next(function(){return r})},e.prototype.removeDocumentChangesThroughChangeId=function(e,t){var n=IDBKeyRange.upperBound(t);return Ce(e).delete(n)},e.prototype.synchronizeLastDocumentChangeId=function(e){var t=this;return this._lastProcessedDocumentChangeId=0,e.iterate({keysOnly:!0,reverse:!0},function(e,n,r){t._lastProcessedDocumentChangeId=e,r.done()})},e.prototype.newChangeBuffer=function(){return new ri(this)},e.prototype.getSize=function(e){return this.getMetadata(e).next(function(e){return e.byteSize})},e.prototype.getMetadata=function(e){return Ee(e).get(di.key).next(function(e){return l(!!e,"Missing document cache metadata"),e})},e.prototype.setMetadata=function(e,t){return Ee(e).put(di.key,t)},e.prototype.updateSize=function(e,t){var n=this;return this.getMetadata(e).next(function(r){return r.byteSize+=t,n.setMetadata(e,r)})},e}(),ri=function(e){function t(t){var n=e.call(this)||this;return n.documentCache=t,n}return Ct.__extends(t,e),t.prototype.applyChanges=function(e){var t=this,n=0,r=[];return this.assertChanges().forEach(function(e,i){var o=t.documentCache.serializer.toDbRemoteDocument(i),a=t.documentSizes.get(e);l(void 0!==a,"Attempting to change document "+e.toString()+" without having read it first");var s=Ne(o);n+=s-a,r.push({key:e,doc:o})}),this.documentCache.addEntries(e,r,n)},t.prototype.getFromCache=function(e,t){return this.documentCache.getSizedEntry(e,t)},t}(ei),ii=7,oi=function(){function e(e){this.serializer=e}return e.prototype.createOrUpgrade=function(e,t,n,r){var i=this;l(n<r&&n>=0&&r<=ii,"Unexpected schema upgrade from v"+n+" to v{toVersion}."),n<1&&r>=1&&(Ae(e),xe(e),Le(e),Pe(e));var o=Qr.resolve();return n<3&&r>=3&&(0!==n&&(Me(e),Le(e)),o=o.next(function(){return Ve(t)})),n<4&&r>=4&&(0!==n&&(o=o.next(function(){return Oe(e,t)})),o=o.next(function(){Ue(e),je(e)})),n<5&&r>=5&&(o=o.next(function(){return i.removeAcknowledgedMutations(t)})),n<6&&r>=6&&(o=o.next(function(){return Re(e),i.addDocumentGlobal(t)})),n<7&&r>=7&&(o=o.next(function(){return i.ensureSequenceNumbers(t)})),o},e.prototype.addDocumentGlobal=function(e){var t=0;return e.store(fi.store).iterate(function(e,n){t+=Ne(n)}).next(function(){var n=new di(t);return e.store(di.store).put(di.key,n)})},e.prototype.removeAcknowledgedMutations=function(e){var t=this,n=e.store(ui.store),r=e.store(ci.store);return n.loadAll().next(function(n){return Qr.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,Fr],[n.userId,n.lastAcknowledgedBatchId]);return r.loadAll(ci.userMutationsIndex,i).next(function(r){return Qr.forEach(r,function(r){l(r.userId===n.userId,"Cannot process batch "+r.batchId+" from unexpected user");var i=t.serializer.fromDbMutationBatch(r);return Be(e,n.userId,i).next(function(){})})})})})},e.prototype.ensureSequenceNumbers=function(e){var t=e.store(gi.store),n=e.store(fi.store);return we(e).next(function(e){var r=function(n){return t.put(new gi(0,fe(n),e))},i=[];return n.iterate(function(e,n){var o=new Bt(e),a=De(o);i.push(t.get(a).next(function(e){return e?Qr.resolve():r(o)}))}).next(function(){return Qr.waitFor(i)})})},e}(),ai=function(e,t){this.seconds=e,this.nanoseconds=t},si=function(){function e(e,t,n){this.ownerId=e,this.allowTabSynchronization=t,this.leaseTimestampMs=n}return e.store="owner",e.key="owner",e}(),ui=function(){function e(e,t,n){this.userId=e,this.lastAcknowledgedBatchId=t,this.lastStreamToken=n}return e.store="mutationQueues",e.keyPath="userId",e}(),ci=function(){function e(e,t,n,r){this.userId=e,this.batchId=t,this.localWriteTimeMs=n,this.mutations=r}return e.store="mutations",e.keyPath="batchId",e.userMutationsIndex="userMutationsIndex",e.userMutationsKeyPath=["userId","batchId"],e}(),li=function(){function e(){}return e.prefixForUser=function(e){return[e]},e.prefixForPath=function(e,t){return[e,fe(t)]},e.key=function(e,t,n){return[e,fe(t),n]},e.store="documentMutations",e.PLACEHOLDER=new e,e}(),hi=function(e,t){this.path=e,this.readTime=t},pi=function(e,t){this.path=e,this.version=t},fi=function(){function e(e,t,n,r){this.unknownDocument=e,this.noDocument=t,this.document=n,this.hasCommittedMutations=r}return e.store="remoteDocuments",e}(),di=function(){function e(e){this.byteSize=e}return e.store="remoteDocumentGlobal",e.key="remoteDocumentGlobalKey",e}(),mi=function(){function e(e,t,n,r,i,o){this.targetId=e,this.canonicalId=t,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.query=o}return e.store="targets",e.keyPath="targetId",e.queryTargetsIndexName="queryTargetsIndex",e.queryTargetsKeyPath=["canonicalId","targetId"],e}(),gi=function(){function e(e,t,n){this.targetId=e,this.path=t,this.sequenceNumber=n,l(0===e==(void 0!==n),"A target-document row must either have targetId == 0 and a defined sequence number, or a non-zero targetId and no sequence number")}return e.store="targetDocuments",e.keyPath=["targetId","path"],e.documentTargetsIndex="documentTargetsIndex",e.documentTargetsKeyPath=["path","targetId"],e}(),yi=function(){function e(e,t,n,r){this.highestTargetId=e,this.highestListenSequenceNumber=t,this.lastRemoteSnapshotVersion=n,this.targetCount=r}return e.key="targetGlobalKey",e.store="targetGlobal",e}(),vi=function(){function e(e){this.changes=e}return e.store="remoteDocumentChanges",e.keyPath="id",e}(),bi=function(){function e(e,t,n,r,i){this.clientId=e,this.updateTimeMs=t,this.networkEnabled=n,this.inForeground=r,this.lastProcessedDocumentChangeId=i}return e.store="clientMetadata",e.keyPath="clientId",e}(),_i=[ui.store,ci.store,li.store,fi.store,mi.store,si.store,yi.store,gi.store].concat([bi.store,vi.store]).concat([di.store]),wi=function(){function e(e,t,n){this.userId=e,this.serializer=t,this.referenceDelegate=n,this.documentKeysByBatchId={}}return e.forUser=function(t,n,r){return l(""!==t.uid,"UserID must not be an empty string."),new e(t.isAuthenticated()?t.uid:"",n,r)},e.prototype.checkEmpty=function(e){var t=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return We(e).iterate({index:ci.userMutationsIndex,range:n},function(e,n,r){t=!1,r.done()}).next(function(){return t})},e.prototype.acknowledgeBatch=function(e,t,n){return this.getMutationQueueMetadata(e).next(function(r){var i=t.batchId;return l(i>r.lastAcknowledgedBatchId,"Mutation batchIDs must be acknowledged in order"),r.lastAcknowledgedBatchId=i,r.lastStreamToken=Ke(n),ze(e).put(r)})},e.prototype.getLastStreamToken=function(e){return this.getMutationQueueMetadata(e).next(function(e){return e.lastStreamToken})},e.prototype.setLastStreamToken=function(e,t){return this.getMutationQueueMetadata(e).next(function(n){return n.lastStreamToken=Ke(t),ze(e).put(n)})},e.prototype.addMutationBatch=function(e,t,n){var r=this,i=He(e),o=We(e);return o.add({}).next(function(e){l("number"==typeof e,"Auto-generated key is not a number");var a=new Br(e,t,n),s=r.serializer.toDbMutationBatch(r.userId,a);r.documentKeysByBatchId[e]=a.keys();for(var u=[],c=0,h=n;c<h.length;c++){var p=h[c],f=li.key(r.userId,p.key.path,e);u.push(o.put(s)),u.push(i.put(f,li.PLACEHOLDER))}return Qr.waitFor(u).next(function(){return a})})},e.prototype.lookupMutationBatch=function(e,t){var n=this;return We(e).get(t).next(function(e){return e?(l(e.userId===n.userId,"Unexpected user '"+e.userId+"' for mutation batch "+t),n.serializer.fromDbMutationBatch(e)):null})},e.prototype.lookupMutationKeys=function(e,t){var n=this;return this.documentKeysByBatchId[t]?Qr.resolve(this.documentKeysByBatchId[t]):this.lookupMutationBatch(e,t).next(function(e){if(e){var r=e.keys();return n.documentKeysByBatchId[t]=r,r}return null})},e.prototype.getNextMutationBatchAfterBatchId=function(e,t){var n=this;return this.getMutationQueueMetadata(e).next(function(r){var i=Math.max(t,r.lastAcknowledgedBatchId)+1,o=IDBKeyRange.lowerBound([n.userId,i]),a=null;return We(e).iterate({index:ci.userMutationsIndex,range:o},function(e,t,r){t.userId===n.userId&&(l(t.batchId>=i,"Should have found mutation after "+i),a=n.serializer.fromDbMutationBatch(t)),r.done()}).next(function(){return a})})},e.prototype.getAllMutationBatches=function(e){var t=this,n=IDBKeyRange.bound([this.userId,Fr],[this.userId,Number.POSITIVE_INFINITY]);return We(e).loadAll(ci.userMutationsIndex,n).next(function(e){return e.map(function(e){return t.serializer.fromDbMutationBatch(e)})})},e.prototype.getAllMutationBatchesAffectingDocumentKey=function(e,t){var n=this,r=li.prefixForPath(this.userId,t.path),i=IDBKeyRange.lowerBound(r),o=[];return He(e).iterate({range:i},function(r,i,a){var s=r[0],u=r[1],h=r[2],p=ge(u);if(s===n.userId&&t.path.isEqual(p))return We(e).get(h).next(function(e){if(!e)throw c("Dangling document-mutation reference found: "+r+" which points to "+h);l(e.userId===n.userId,"Unexpected user '"+e.userId+"' for mutation batch "+h),o.push(n.serializer.fromDbMutationBatch(e))});a.done()}).next(function(){return o})},e.prototype.getAllMutationBatchesAffectingDocumentKeys=function(e,t){var n=this,r=new Jn(F),i=[];return t.forEach(function(t){var o=li.prefixForPath(n.userId,t.path),a=IDBKeyRange.lowerBound(o),s=He(e).iterate({range:a},function(e,i,o){var a=e[0],s=e[1],u=e[2],c=ge(s);a===n.userId&&t.path.isEqual(c)?r=r.add(u):o.done()});i.push(s)}),Qr.waitFor(i).next(function(){return n.lookupMutationBatches(e,r)})},e.prototype.getAllMutationBatchesAffectingQuery=function(e,t){var n=this;l(!t.isDocumentQuery(),"Document queries shouldn't go down this path");var r=t.path,i=r.length+1,o=li.prefixForPath(this.userId,r),a=IDBKeyRange.lowerBound(o),s=new Jn(F);return He(e).iterate({range:a},function(e,t,o){var a=e[0],u=e[1],c=e[2],l=ge(u);a===n.userId&&r.isPrefixOf(l)?l.length===i&&(s=s.add(c)):o.done()}).next(function(){return n.lookupMutationBatches(e,s)})},e.prototype.lookupMutationBatches=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(We(e).get(t).next(function(e){if(null===e)throw c("Dangling document-mutation reference found, which points to "+t);l(e.userId===n.userId,"Unexpected user '"+e.userId+"' for mutation batch "+t),r.push(n.serializer.fromDbMutationBatch(e))}))}),Qr.waitFor(i).next(function(){return r})},e.prototype.removeMutationBatch=function(e,t){var n=this;return Be(e.simpleDbTransaction,this.userId,t).next(function(r){return n.removeCachedMutationKeys(t.batchId),Qr.forEach(r,function(t){return n.referenceDelegate.removeMutationReference(e,t)})})},e.prototype.removeCachedMutationKeys=function(e){delete this.documentKeysByBatchId[e]},e.prototype.performConsistencyCheck=function(e){var t=this;return this.checkEmpty(e).next(function(n){if(!n)return Qr.resolve();var r=IDBKeyRange.lowerBound(li.prefixForUser(t.userId)),i=[];return He(e).iterate({range:r},function(e,n,r){if(e[0]===t.userId){var o=ge(e[1]);i.push(o)}else r.done()}).next(function(){l(0===i.length,"Document leak -- detected dangling mutation references when queue is empty. Dangling keys: "+i.map(function(e){return e.canonicalString()}))})})},e.prototype.containsKey=function(e,t){return qe(e,this.userId,t)},e.prototype.getMutationQueueMetadata=function(e){var t=this;return ze(e).get(this.userId).next(function(e){return e||new ui(t.userId,Fr,"")})},e}(),ki=function(){function e(e){this.remoteSerializer=e}return e.prototype.fromDbRemoteDocument=function(e){if(e.document)return this.remoteSerializer.fromDocument(e.document,!!e.hasCommittedMutations);if(e.noDocument){var t=Ht.fromSegments(e.noDocument.path),n=this.fromDbTimestamp(e.noDocument.readTime);return new Gt(t,n,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var t=Ht.fromSegments(e.unknownDocument.path),n=this.fromDbTimestamp(e.unknownDocument.version);return new Xt(t,n)}return c("Unexpected DbRemoteDocument")},e.prototype.toDbRemoteDocument=function(e){if(e instanceof Qt){var t=this.remoteSerializer.toDocument(e),n=e.hasCommittedMutations;return new fi(null,null,t,n)}if(e instanceof Gt){var r=e.key.path.toArray(),i=this.toDbTimestamp(e.version),n=e.hasCommittedMutations;return new fi(null,new hi(r,i),null,n)}if(e instanceof Xt){var r=e.key.path.toArray(),i=this.toDbTimestamp(e.version);return new fi(new pi(r,i),null,null,!0)}return c("Unexpected MaybeDocumment")},e.prototype.toDbTimestamp=function(e){var t=e.toTimestamp();return new ai(t.seconds,t.nanoseconds)},e.prototype.fromDbTimestamp=function(e){var t=new Vt(e.seconds,e.nanoseconds);return Rn.fromTimestamp(t)},e.prototype.toDbMutationBatch=function(e,t){var n=this,r=t.mutations.map(function(e){return n.remoteSerializer.toMutation(e)});return new ci(e,t.batchId,t.localWriteTime.toMillis(),r)},e.prototype.fromDbMutationBatch=function(e){var t=this,n=e.mutations.map(function(e){return t.remoteSerializer.fromMutation(e)}),r=Vt.fromMillis(e.localWriteTimeMs);return new Br(e.batchId,r,n)},e.prototype.toDbResourcePaths=function(e){var t=[];return e.forEach(function(e){t.push(fe(e.path))}),t},e.prototype.fromDbResourcePaths=function(e){for(var t=ae(),n=0,r=e;n<r.length;n++){var i=r[n];t=t.add(new Ht(ge(i)))}return t},e.prototype.fromDbTarget=function(e){var t,n=this.fromDbTimestamp(e.readTime);return t=Qe(e.query)?this.remoteSerializer.fromDocumentsTarget(e.query):this.remoteSerializer.fromQueryTarget(e.query),new Mn(t,e.targetId,nn.Listen,e.lastListenSequenceNumber,n,e.resumeToken)},e.prototype.toDbTarget=function(e){l(nn.Listen===e.purpose,"Only queries with purpose "+nn.Listen+" may be stored, got "+e.purpose);var t,n=this.toDbTimestamp(e.snapshotVersion);t=e.query.isDocumentQuery()?this.remoteSerializer.toDocumentsTarget(e.query):this.remoteSerializer.toQueryTarget(e.query);var r;return e.resumeToken instanceof Uint8Array?(l("YES"===process.env.USE_MOCK_PERSISTENCE,"Persisting non-string stream tokens is only supported with mock persistence ."),r=e.resumeToken.toString()):r=e.resumeToken,new mi(e.targetId,e.query.canonicalId(),n,r,e.sequenceNumber,t)},e}(),Ei=function(){function e(e){this.maxElements=e,this.buffer=new Jn(Ge),this.previousIndex=0}return e.prototype.nextIndex=function(){return++this.previousIndex},e.prototype.addElement=function(e){var t=[e,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(t);else{var n=this.buffer.last();Ge(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}},Object.defineProperty(e.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!0,configurable:!0}),e}(),Ti=function(){function e(e){this.delegate=e}return e.prototype.calculateTargetCount=function(e,t){return this.delegate.getSequenceNumberCount(e).next(function(e){return Math.floor(t/100*e)})},e.prototype.nthSequenceNumber=function(e,t){var n=this;if(0===t)return Qr.resolve(Or.INVALID);var r=new Ei(t);return this.delegate.forEachTarget(e,function(e){return r.addElement(e.sequenceNumber)}).next(function(){return n.delegate.forEachOrphanedDocumentSequenceNumber(e,function(e){return r.addElement(e)})}).next(function(){return r.maxValue})},e.prototype.removeTargets=function(e,t,n){return this.delegate.removeTargets(e,t,n)},e.prototype.removeOrphanedDocuments=function(e,t){return this.delegate.removeOrphanedDocuments(e,t)},e}(),Si="IndexedDbPersistence",Ci="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ii="Another tab has exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `experimentalTabSynchronization:true` in all tabs.",Ni="This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.",Di=function(e){function t(t,n){var r=e.call(this)||this;return r.simpleDbTransaction=t,r.currentSequenceNumber=n,r}return Ct.__extends(t,e),t}(function(){}),Ai=function(){function e(t,n,r,i,o,a){if(this.persistenceKey=t,this.clientId=n,this.queue=i,this.multiClientParams=a,this._started=!1,this.isPrimary=!1,this.networkEnabled=!0,this.inForeground=!1,this.lastGarbageCollectionTime=Number.NEGATIVE_INFINITY,this.primaryStateListener=function(e){return Promise.resolve()},!e.isAvailable())throw new Ot(xt.UNIMPLEMENTED,Ni);if(this.referenceDelegate=new xi(this),this.dbName=t+e.MAIN_DATABASE,this.serializer=new ki(o),this.document=r.document,this.allowTabSynchronization=void 0!==a,this.queryCache=new Jr(this.referenceDelegate,this.serializer),this.remoteDocumentCache=new ni(this.serializer,this.allowTabSynchronization),!r.window||!r.window.localStorage)throw new Ot(xt.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");this.window=r.window,this.webStorage=this.window.localStorage}return e.getStore=function(e,t){if(e instanceof Di)return Gr.getStore(e.simpleDbTransaction,t);throw c("IndexedDbPersistence must use instances of IndexedDbTransaction")},e.createIndexedDbPersistence=function(t,n,r,i,o){return Ct.__awaiter(this,void 0,void 0,function(){var a;return Ct.__generator(this,function(s){switch(s.label){case 0:return a=new e(t,n,r,i,o),[4,a.start()];case 1:return s.sent(),[2,a]}})})},e.createMultiClientIndexedDbPersistence=function(t,n,r,i,o,a){return Ct.__awaiter(this,void 0,void 0,function(){var s;return Ct.__generator(this,function(u){switch(u.label){case 0:return s=new e(t,n,r,i,o,a),[4,s.start()];case 1:return u.sent(),[2,s]}})})},e.prototype.start=function(){var e=this;return l(!this.started,"IndexedDbPersistence double-started!"),l(null!==this.window,"Expected 'window' to be defined"),Gr.openOrCreate(this.dbName,ii,new oi(this.serializer)).then(function(t){e.simpleDb=t}).then(function(){return e.startRemoteDocumentCache()}).then(function(){return e.attachVisibilityHandler(),e.attachWindowUnloadHook(),e.updateClientMetadataAndTryBecomePrimary().then(function(){return e.scheduleClientMetadataAndPrimaryLeaseRefreshes()})}).then(function(){return e.simpleDb.runTransaction("readonly",[yi.store],function(t){return we(t).next(function(t){var n=e.multiClientParams?e.multiClientParams.sequenceNumberSyncer:void 0;e.listenSequence=new Or(t,n)})})}).then(function(){e._started=!0}).catch(function(t){return e.simpleDb&&e.simpleDb.close(),Promise.reject(t)})},e.prototype.startRemoteDocumentCache=function(){var e=this;return this.simpleDb.runTransaction("readonly",_i,function(t){return e.remoteDocumentCache.start(t)})},e.prototype.setPrimaryStateListener=function(e){var t=this;return this.primaryStateListener=function(n){return Ct.__awaiter(t,void 0,void 0,function(){return Ct.__generator(this,function(t){return this.started?[2,e(n)]:[2]})})},e(this.isPrimary)},e.prototype.setNetworkEnabled=function(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.queue.enqueueAndForget(function(){return Ct.__awaiter(t,void 0,void 0,function(){return Ct.__generator(this,function(e){switch(e.label){case 0:return this.started?[4,this.updateClientMetadataAndTryBecomePrimary()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})}))},e.prototype.updateClientMetadataAndTryBecomePrimary=function(){var e=this;return this.simpleDb.runTransaction("readwrite",_i,function(t){return $e(t).put(new bi(e.clientId,Date.now(),e.networkEnabled,e.inForeground,e.remoteDocumentCache.lastProcessedDocumentChangeId)).next(function(){if(e.isPrimary)return e.verifyPrimaryLease(t).next(function(t){t||(e.isPrimary=!1,e.queue.enqueueAndForget(function(){return e.primaryStateListener(!1)}))})}).next(function(){return e.canActAsPrimary(t)}).next(function(n){var r=e.isPrimary;return e.isPrimary=n,r!==e.isPrimary&&e.queue.enqueueAndForget(function(){return e.primaryStateListener(e.isPrimary)}),r&&!e.isPrimary?e.releasePrimaryLeaseIfHeld(t):e.isPrimary?e.acquireOrExtendPrimaryLease(t):void 0})})},e.prototype.verifyPrimaryLease=function(e){var t=this;return Ye(e).get(si.key).next(function(e){return Qr.resolve(t.isLocalClient(e))})},e.prototype.removeClientMetadata=function(e){return $e(e).delete(this.clientId)},e.prototype.maybeGarbageCollectMultiClientState=function(){return Ct.__awaiter(this,void 0,void 0,function(){var t,n,r=this;return Ct.__generator(this,function(i){switch(i.label){case 0:return!this.isPrimary||this.isWithinAge(this.lastGarbageCollectionTime,18e5)?[3,2]:(this.lastGarbageCollectionTime=Date.now(),n=[],[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(i){var o=e.getStore(i,bi.store);return o.loadAll().next(function(e){t=r.filterActiveClients(e,18e5),n=e.filter(function(e){return-1===t.indexOf(e)})}).next(function(){return Qr.forEach(n,function(e){return o.delete(e.clientId)})}).next(function(){if((t=t.filter(function(e){return e.clientId!==r.clientId})).length>0){var e=t.map(function(e){return e.lastProcessedDocumentChangeId||0}),n=Math.min.apply(Math,e);return r.remoteDocumentCache.removeDocumentChangesThroughChangeId(i,n)}})})]);case 1:i.sent(),n.forEach(function(e){r.window.localStorage.removeItem(r.zombiedClientLocalStorageKey(e.clientId))}),i.label=2;case 2:return[2]}})})},e.prototype.scheduleClientMetadataAndPrimaryLeaseRefreshes=function(){var e=this;this.clientMetadataRefresher=this.queue.enqueueAfterDelay(xr.ClientMetadataRefresh,4e3,function(){return e.updateClientMetadataAndTryBecomePrimary().then(function(){return e.maybeGarbageCollectMultiClientState()}).then(function(){return e.scheduleClientMetadataAndPrimaryLeaseRefreshes()})})},e.prototype.isLocalClient=function(e){return!!e&&e.ownerId===this.clientId},e.prototype.canActAsPrimary=function(e){var t=this;return Ye(e).get(si.key).next(function(n){if(null!==n&&t.isWithinAge(n.leaseTimestampMs,5e3)&&!t.isClientZombied(n.ownerId)){if(t.isLocalClient(n)&&t.networkEnabled)return!0;if(!t.isLocalClient(n)){if(!n.allowTabSynchronization)throw new Ot(xt.FAILED_PRECONDITION,Ii);return!1}}return!(!t.networkEnabled||!t.inForeground)||$e(e).loadAll().next(function(e){return void 0===t.filterActiveClients(e,5e3).find(function(e){if(t.clientId!==e.clientId){var n=!t.networkEnabled&&e.networkEnabled,r=!t.inForeground&&e.inForeground,i=t.networkEnabled===e.networkEnabled;if(n||r&&i)return!0}return!1})})}).next(function(e){return t.isPrimary!==e&&a(Si,"Client "+(e?"is":"is not")+" eligible for a primary lease."),e})},e.prototype.shutdown=function(e){return Ct.__awaiter(this,void 0,void 0,function(){var t=this;return Ct.__generator(this,function(n){switch(n.label){case 0:return this._started=!1,this.markClientZombied(),this.clientMetadataRefresher&&this.clientMetadataRefresher.cancel(),this.detachVisibilityHandler(),this.detachWindowUnloadHook(),[4,this.simpleDb.runTransaction("readwrite",[si.store,bi.store],function(e){return t.releasePrimaryLeaseIfHeld(e).next(function(){return t.removeClientMetadata(e)})})];case 1:return n.sent(),this.simpleDb.close(),this.removeClientZombiedEntry(),e?[4,Gr.delete(this.dbName)]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}})})},e.prototype.filterActiveClients=function(e,t){var n=this;return e.filter(function(e){return n.isWithinAge(e.updateTimeMs,t)&&!n.isClientZombied(e.clientId)})},e.prototype.getActiveClients=function(){var e=this;return this.simpleDb.runTransaction("readonly",[bi.store],function(t){return $e(t).loadAll().next(function(t){return e.filterActiveClients(t,18e5).map(function(e){return e.clientId})})})},Object.defineProperty(e.prototype,"started",{get:function(){return this._started},enumerable:!0,configurable:!0}),e.prototype.getMutationQueue=function(e){return l(this.started,"Cannot initialize MutationQueue before persistence is started."),wi.forUser(e,this.serializer,this.referenceDelegate)},e.prototype.getQueryCache=function(){return l(this.started,"Cannot initialize QueryCache before persistence is started."),this.queryCache},e.prototype.getRemoteDocumentCache=function(){return l(this.started,"Cannot initialize RemoteDocumentCache before persistence is started."),this.remoteDocumentCache},e.prototype.runTransaction=function(e,t,n){var r=this;return a(Si,"Starting transaction:",e),this.simpleDb.runTransaction("readonly"===t?"readonly":"readwrite",_i,function(i){return"readwrite-primary"===t?r.verifyPrimaryLease(i).next(function(t){if(!t)throw s("Failed to obtain primary lease for action '"+e+"'."),r.isPrimary=!1,r.queue.enqueueAndForget(function(){return r.primaryStateListener(!1)}),new Ot(xt.FAILED_PRECONDITION,Ci);return n(new Di(i,r.listenSequence.next()))}).next(function(e){return r.acquireOrExtendPrimaryLease(i).next(function(){return e})}):r.verifyAllowTabSynchronization(i).next(function(){return n(new Di(i,r.listenSequence.next()))})})},e.prototype.verifyAllowTabSynchronization=function(e){var t=this;return Ye(e).get(si.key).next(function(e){if(null!==e&&t.isWithinAge(e.leaseTimestampMs,5e3)&&!t.isClientZombied(e.ownerId)&&!t.isLocalClient(e)&&!e.allowTabSynchronization)throw new Ot(xt.FAILED_PRECONDITION,Ii)})},e.prototype.acquireOrExtendPrimaryLease=function(e){var t=new si(this.clientId,this.allowTabSynchronization,Date.now());return Ye(e).put(si.key,t)},e.isAvailable=function(){return Gr.isAvailable()},e.buildStoragePrefix=function(e){var t=e.databaseId.projectId;return e.databaseId.isDefaultDatabase||(t+="."+e.databaseId.database),"firestore/"+e.persistenceKey+"/"+t+"/"},e.prototype.releasePrimaryLeaseIfHeld=function(e){var t=this,n=Ye(e);return n.get(si.key).next(function(e){return t.isLocalClient(e)?(a(Si,"Releasing primary lease."),n.delete(si.key)):Qr.resolve()})},e.prototype.isWithinAge=function(e,t){var n=Date.now(),r=n;return!(e<n-t||e>r&&(s("Detected an update time that is in the future: "+e+" > "+r),1))},e.prototype.attachVisibilityHandler=function(){var e=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.documentVisibilityHandler=function(){e.queue.enqueueAndForget(function(){return e.inForeground="visible"===e.document.visibilityState,e.updateClientMetadataAndTryBecomePrimary()})},this.document.addEventListener("visibilitychange",this.documentVisibilityHandler),this.inForeground="visible"===this.document.visibilityState)},e.prototype.detachVisibilityHandler=function(){this.documentVisibilityHandler&&(l(null!==this.document&&"function"==typeof this.document.addEventListener,"Expected 'document.addEventListener' to be a function"),this.document.removeEventListener("visibilitychange",this.documentVisibilityHandler),this.documentVisibilityHandler=null)},e.prototype.attachWindowUnloadHook=function(){var e=this;"function"==typeof this.window.addEventListener&&(this.windowUnloadHandler=function(){e.markClientZombied(),e.queue.enqueueAndForget(function(){return e.shutdown()})},this.window.addEventListener("unload",this.windowUnloadHandler))},e.prototype.detachWindowUnloadHook=function(){this.windowUnloadHandler&&(l("function"==typeof this.window.removeEventListener,"Expected 'window.removeEventListener' to be a function"),this.window.removeEventListener("unload",this.windowUnloadHandler),this.windowUnloadHandler=null)},e.prototype.isClientZombied=function(e){try{var t=null!==this.webStorage.getItem(this.zombiedClientLocalStorageKey(e));return a(Si,"Client '"+e+"' "+(t?"is":"is not")+" zombied in LocalStorage"),t}catch(e){return s(Si,"Failed to get zombied client id.",e),!1}},e.prototype.markClientZombied=function(){try{this.webStorage.setItem(this.zombiedClientLocalStorageKey(this.clientId),String(Date.now()))}catch(e){s("Failed to set zombie client id.",e)}},e.prototype.removeClientZombiedEntry=function(){try{this.webStorage.removeItem(this.zombiedClientLocalStorageKey(this.clientId))}catch(e){}},e.prototype.zombiedClientLocalStorageKey=function(e){return"firestore_zombie_"+this.persistenceKey+"_"+e},e.MAIN_DATABASE="main",e}(),xi=function(){function e(e){this.db=e,this.garbageCollector=new Ti(this)}return e.prototype.getSequenceNumberCount=function(e){var t=this.orphanedDocmentCount(e);return this.db.getQueryCache().getQueryCount(e).next(function(e){return t.next(function(t){return e+t})})},e.prototype.orphanedDocmentCount=function(e){var t=0;return this.forEachOrphanedDocumentSequenceNumber(e,function(e){t++}).next(function(){return t})},e.prototype.forEachTarget=function(e,t){return this.db.getQueryCache().forEachTarget(e,t)},e.prototype.forEachOrphanedDocumentSequenceNumber=function(e,t){return this.forEachOrphanedDocument(e,function(e,n){return t(n)})},e.prototype.setInMemoryPins=function(e){this.inMemoryPins=e},e.prototype.addReference=function(e,t){return et(e,t)},e.prototype.removeReference=function(e,t){return et(e,t)},e.prototype.removeTargets=function(e,t,n){return this.db.getQueryCache().removeTargets(e,t,n)},e.prototype.removeMutationReference=function(e,t){return et(e,t)},e.prototype.isPinned=function(e,t){return this.inMemoryPins.containsKey(t)?Qr.resolve(!0):Fe(e,t)},e.prototype.removeOrphanedDocuments=function(e,t){var n=this,r=0,i=0,o=[];return this.forEachOrphanedDocument(e,function(a,s){if(s<=t){var u=n.isPinned(e,a).next(function(t){if(!t)return r++,n.removeOrphanedDocument(e,a).next(function(e){i+=e})});o.push(u)}}).next(function(){return Qr.waitFor(o)}).next(function(){return n.db.getRemoteDocumentCache().updateSize(e,-i)}).next(function(){return r})},e.prototype.removeOrphanedDocument=function(e,t){var n=0,r=this.db.getRemoteDocumentCache();return Qr.waitFor([ke(e).delete(Je(t)),r.removeEntry(e,t).next(function(e){n+=e})]).next(function(){return n})},e.prototype.removeTarget=function(e,t){var n=t.copy({sequenceNumber:e.currentSequenceNumber});return this.db.getQueryCache().updateQueryData(e,n)},e.prototype.updateLimboDocument=function(e,t){return et(e,t)},e.prototype.forEachOrphanedDocument=function(e,t){var n,r=ke(e),i=Or.INVALID;return r.iterate({index:gi.documentTargetsIndex},function(e,r){var o=e[0],a=(e[1],r.path),s=r.sequenceNumber;0===o?(i!==Or.INVALID&&t(new Ht(ge(n)),i),i=s,n=a):i=Or.INVALID}).next(function(){i!==Or.INVALID&&t(new Ht(ge(n)),i)})},e}(),Oi=function(){function e(e,t){this.remoteDocumentCache=e,this.mutationQueue=t}return e.prototype.getDocument=function(e,t){var n=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKey(e,t).next(function(r){return n.getDocumentInternal(e,t,r)})},e.prototype.getDocumentInternal=function(e,t,n){return this.remoteDocumentCache.getEntry(e,t).next(function(e){for(var r=0,i=n;r<i.length;r++)e=i[r].applyToLocalView(t,e);return e})},e.prototype.getDocuments=function(e,t){var n=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(function(r){var i=[],o=re();return t.forEach(function(t){i.push(n.getDocumentInternal(e,t,r).next(function(e){e||(e=new Gt(t,Rn.forDeletedDoc())),o=o.insert(t,e)}))}),Qr.waitFor(i).next(function(){return o})})},e.prototype.getDocumentsMatchingQuery=function(e,t){return Ht.isDocumentKey(t.path)?this.getDocumentsMatchingDocumentQuery(e,t.path):this.getDocumentsMatchingCollectionQuery(e,t)},e.prototype.getDocumentsMatchingDocumentQuery=function(e,t){return this.getDocument(e,new Ht(t)).next(function(e){var t=ie();return e instanceof Qt&&(t=t.insert(e.key,e)),t})},e.prototype.getDocumentsMatchingCollectionQuery=function(e,t){var n,r=this;return this.remoteDocumentCache.getDocumentsMatchingQuery(e,t).next(function(i){return n=i,r.mutationQueue.getAllMutationBatchesAffectingQuery(e,t)}).next(function(e){for(var r=0,i=e;r<i.length;r++)for(var o=i[r],a=0,s=o.mutations;a<s.length;a++){var u=s[a],c=u.key;if(t.path.isImmediateParentOf(c.path)){var l=n.get(c),h=u.applyToLocalView(l,l,o.localWriteTime);n=h instanceof Qt?n.insert(c,h):n.remove(c)}}}).next(function(){return n.forEach(function(e,r){t.matches(r)||(n=n.remove(e))}),n})},e}(),Pi=function(){function e(){this.refsByKey=new Jn(Ri.compareByKey),this.refsByTarget=new Jn(Ri.compareByTargetId)}return e.prototype.isEmpty=function(){return this.refsByKey.isEmpty()},e.prototype.addReference=function(e,t){var n=new Ri(e,t);this.refsByKey=this.refsByKey.add(n),this.refsByTarget=this.refsByTarget.add(n)},e.prototype.addReferences=function(e,t){var n=this;e.forEach(function(e){return n.addReference(e,t)})},e.prototype.removeReference=function(e,t){this.removeRef(new Ri(e,t))},e.prototype.removeReferences=function(e,t){var n=this;e.forEach(function(e){return n.removeReference(e,t)})},e.prototype.removeReferencesForId=function(e){var t=this,n=Ht.EMPTY,r=new Ri(n,e),i=new Ri(n,e+1),o=[];return this.refsByTarget.forEachInRange([r,i],function(e){t.removeRef(e),o.push(e.key)}),o},e.prototype.removeAllReferences=function(){var e=this;this.refsByKey.forEach(function(t){return e.removeRef(t)})},e.prototype.removeRef=function(e){this.refsByKey=this.refsByKey.delete(e),this.refsByTarget=this.refsByTarget.delete(e)},e.prototype.referencesForId=function(e){var t=Ht.EMPTY,n=new Ri(t,e),r=new Ri(t,e+1),i=ae();return this.refsByTarget.forEachInRange([n,r],function(e){i=i.add(e.key)}),i},e.prototype.containsKey=function(e){var t=new Ri(e,0),n=this.refsByKey.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)},e}(),Ri=function(){function e(e,t){this.key=e,this.targetOrBatchId=t}return e.compareByKey=function(e,t){return Ht.comparator(e.key,t.key)||F(e.targetOrBatchId,t.targetOrBatchId)},e.compareByTargetId=function(e,t){return F(e.targetOrBatchId,t.targetOrBatchId)||Ht.comparator(e.key,t.key)},e}(),Li=function(){function e(e,t){this.persistence=e,this.localViewReferences=new Pi,this.queryDataByTarget={},l(e.started,"LocalStore was passed an unstarted persistence implementation"),this.persistence.referenceDelegate.setInMemoryPins(this.localViewReferences),this.mutationQueue=e.getMutationQueue(t),this.remoteDocuments=e.getRemoteDocumentCache(),this.queryCache=e.getQueryCache(),this.localDocuments=new Oi(this.remoteDocuments,this.mutationQueue)}return e.prototype.handleUserChange=function(e){var t=this;return this.persistence.runTransaction("Handle user change","readonly",function(n){var r;return t.mutationQueue.getAllMutationBatches(n).next(function(i){return r=i,t.mutationQueue=t.persistence.getMutationQueue(e),t.localDocuments=new Oi(t.remoteDocuments,t.mutationQueue),t.mutationQueue.getAllMutationBatches(n)}).next(function(e){for(var i=[],o=[],a=ae(),s=0,u=r;s<u.length;s++){f=u[s],i.push(f.batchId);for(var c=0,l=f.mutations;c<l.length;c++)g=l[c],a=a.add(g.key)}for(var h=0,p=e;h<p.length;h++){var f=p[h];o.push(f.batchId);for(var d=0,m=f.mutations;d<m.length;d++){var g=m[d];a=a.add(g.key)}}return t.localDocuments.getDocuments(n,a).next(function(e){return{affectedDocuments:e,removedBatchIds:i,addedBatchIds:o}})})})},e.prototype.localWrite=function(e){var t=this;return this.persistence.runTransaction("Locally write mutations","readwrite",function(n){var r,i=Vt.now();return t.mutationQueue.addMutationBatch(n,i,e).next(function(e){var i=(r=e).keys();return t.localDocuments.getDocuments(n,i)}).next(function(e){return{batchId:r.batchId,changes:e}})})},e.prototype.lookupMutationDocuments=function(e){var t=this;return this.persistence.runTransaction("Lookup mutation documents","readonly",function(n){return t.mutationQueue.lookupMutationKeys(n,e).next(function(e){return e?t.localDocuments.getDocuments(n,e):Qr.resolve(null)})})},e.prototype.acknowledgeBatch=function(e){var t=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(n){var r=e.batch.keys(),i=t.remoteDocuments.newChangeBuffer();return t.mutationQueue.acknowledgeBatch(n,e.batch,e.streamToken).next(function(){return t.applyWriteToRemoteDocuments(n,e,i)}).next(function(){return i.apply(n)}).next(function(){return t.mutationQueue.performConsistencyCheck(n)}).next(function(){return t.localDocuments.getDocuments(n,r)})})},e.prototype.rejectBatch=function(e){var t=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(n){var r;return t.mutationQueue.lookupMutationBatch(n,e).next(function(e){return l(null!==e,"Attempt to reject nonexistent batch!"),r=e.keys(),t.mutationQueue.removeMutationBatch(n,e)}).next(function(){return t.mutationQueue.performConsistencyCheck(n)}).next(function(){return t.localDocuments.getDocuments(n,r)})})},e.prototype.getLastStreamToken=function(){var e=this;return this.persistence.runTransaction("Get last stream token","readonly",function(t){return e.mutationQueue.getLastStreamToken(t)})},e.prototype.setLastStreamToken=function(e){var t=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary",function(n){return t.mutationQueue.setLastStreamToken(n,e)})},e.prototype.getLastRemoteSnapshotVersion=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.queryCache.getLastRemoteSnapshotVersion(t)})},e.prototype.applyRemoteEvent=function(t){var n=this,r=this.remoteDocuments.newChangeBuffer();return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(i){var o=[],s=ae();m(t.targetChanges,function(r,a){var u=n.queryDataByTarget[r];if(u){a.addedDocuments.forEach(function(e){s=s.add(e)}),a.modifiedDocuments.forEach(function(e){s=s.add(e)}),o.push(n.queryCache.removeMatchingKeys(i,a.removedDocuments,r).next(function(){return n.queryCache.addMatchingKeys(i,a.addedDocuments,r)}));var c=a.resumeToken;if(c.length>0){var l=u;u=u.copy({resumeToken:c,snapshotVersion:t.snapshotVersion}),n.queryDataByTarget[r]=u,e.shouldPersistQueryData(l,u,a)&&o.push(n.queryCache.updateQueryData(i,u))}}});var u=ae();t.documentUpdates.forEach(function(e,c){u=u.add(e),o.push(r.getEntry(i,e).next(function(t){null==t||c.version.isEqual(Rn.MIN)||s.has(c.key)&&!t.hasPendingWrites||c.version.compareTo(t.version)>=0?r.addEntry(c):a("LocalStore","Ignoring outdated watch update for ",e,". Current version:",t.version," Watch version:",c.version)})),t.resolvedLimboDocuments.has(e)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(i,e))});var c=t.snapshotVersion;if(!c.isEqual(Rn.MIN)){var h=n.queryCache.getLastRemoteSnapshotVersion(i).next(function(e){return l(c.compareTo(e)>=0,"Watch stream reverted to previous snapshot?? "+c+" < "+e),n.queryCache.setTargetsMetadata(i,i.currentSequenceNumber,c)});o.push(h)}return Qr.waitFor(o).next(function(){return r.apply(i)}).next(function(){return n.localDocuments.getDocuments(i,u)})})},e.shouldPersistQueryData=function(e,t,n){return 0!==t.resumeToken.length&&(0===e.resumeToken.length||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=this.RESUME_TOKEN_MAX_AGE_MICROS||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)},e.prototype.notifyLocalViewChanges=function(e){var t=this;return this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Qr.forEach(e,function(e){return t.localViewReferences.addReferences(e.addedKeys,e.targetId),t.localViewReferences.removeReferences(e.removedKeys,e.targetId),Qr.forEach(e.removedKeys,function(e){return t.persistence.referenceDelegate.removeReference(n,e)})})})},e.prototype.nextMutationBatch=function(e){var t=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(n){return void 0===e&&(e=Fr),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)})},e.prototype.readDocument=function(e){var t=this;return this.persistence.runTransaction("read document","readonly",function(n){return t.localDocuments.getDocument(n,e)})},e.prototype.allocateQuery=function(e){var t=this;return this.persistence.runTransaction("Allocate query","readwrite",function(n){var r;return t.queryCache.getQueryData(n,e).next(function(i){return i?(r=i,Qr.resolve()):t.queryCache.allocateTargetId(n).next(function(i){return r=new Mn(e,i,nn.Listen,n.currentSequenceNumber),t.queryCache.addQueryData(n,r)})}).next(function(){return l(!t.queryDataByTarget[r.targetId],"Tried to allocate an already allocated query: "+e),t.queryDataByTarget[r.targetId]=r,r})})},e.prototype.releaseQuery=function(e,t){var n=this,r=t?"readwrite":"readwrite-primary";return this.persistence.runTransaction("Release query",r,function(r){return n.queryCache.getQueryData(r,e).next(function(i){l(null!=i,"Tried to release nonexistent query: "+e);var o=i.targetId,a=n.queryDataByTarget[o],s=n.localViewReferences.removeReferencesForId(o);return delete n.queryDataByTarget[o],t?Qr.resolve():Qr.forEach(s,function(e){return n.persistence.referenceDelegate.removeReference(r,e)}).next(function(){return n.persistence.referenceDelegate.removeTarget(r,a)})})})},e.prototype.executeQuery=function(e){var t=this;return this.persistence.runTransaction("Execute query","readonly",function(n){return t.localDocuments.getDocumentsMatchingQuery(n,e)})},e.prototype.remoteDocumentKeys=function(e){var t=this;return this.persistence.runTransaction("Remote document keys","readonly",function(n){return t.queryCache.getMatchingKeysForTargetId(n,e)})},e.prototype.getActiveClients=function(){return this.persistence.getActiveClients()},e.prototype.removeCachedMutationBatchMetadata=function(e){this.mutationQueue.removeCachedMutationKeys(e)},e.prototype.setNetworkEnabled=function(e){this.persistence.setNetworkEnabled(e)},e.prototype.applyWriteToRemoteDocuments=function(e,t,n){var r=this,i=t.batch,o=i.keys(),a=Qr.resolve();return o.forEach(function(r){a=a.next(function(){return n.getEntry(e,r)}).next(function(e){var o=e,a=t.docVersions.get(r);l(null!==a,"ackVersions should contain every doc in the write."),(!o||o.version.compareTo(a)<0)&&((o=i.applyToRemoteDocument(r,o,t))?n.addEntry(o):l(!e,"Mutation batch "+i+" applied to document "+e+" resulted in null"))})}),a.next(function(){return r.mutationQueue.removeMutationBatch(e,i)})},e.prototype.getQueryForTarget=function(e){var t=this;return this.queryDataByTarget[e]?Promise.resolve(this.queryDataByTarget[e].query):this.persistence.runTransaction("Get query data","readonly",function(n){return t.queryCache.getQueryDataForTarget(n,e).next(function(e){return e?e.query:null})})},e.prototype.getNewDocumentChanges=function(){var e=this;return this.persistence.runTransaction("Get new document changes","readonly",function(t){return e.remoteDocuments.getNewDocumentChanges(t)})},e.RESUME_TOKEN_MAX_AGE_MICROS=3e8,e}(),Mi=function(){function e(e){this.referenceDelegate=e,this.mutationQueue=[],this.nextBatchId=1,this.highestAcknowledgedBatchId=Fr,this.lastStreamToken=h(),this.batchesByDocumentKey=new Jn(Ri.compareByKey)}return e.prototype.checkEmpty=function(e){return Qr.resolve(0===this.mutationQueue.length)},e.prototype.acknowledgeBatch=function(e,t,n){var r=t.batchId;l(r>this.highestAcknowledgedBatchId,"Mutation batchIDs must be acknowledged in order");var i=this.indexOfExistingBatchId(r,"acknowledged");l(0===i,"Can only acknowledge the first batch in the mutation queue");var o=this.mutationQueue[i];return l(r===o.batchId,"Queue ordering failure: expected batch "+r+", got batch "+o.batchId),this.highestAcknowledgedBatchId=r,this.lastStreamToken=n,Qr.resolve()},e.prototype.getLastStreamToken=function(e){return Qr.resolve(this.lastStreamToken)},e.prototype.setLastStreamToken=function(e,t){return this.lastStreamToken=t,Qr.resolve()},e.prototype.addMutationBatch=function(e,t,n){l(0!==n.length,"Mutation batches should not be empty");var r=this.nextBatchId;this.nextBatchId++,this.mutationQueue.length>0&&l(this.mutationQueue[this.mutationQueue.length-1].batchId<r,"Mutation batchIDs must be monotonically increasing order");var i=new Br(r,t,n);this.mutationQueue.push(i);for(var o=0,a=n;o<a.length;o++){var s=a[o];this.batchesByDocumentKey=this.batchesByDocumentKey.add(new Ri(s.key,r))}return Qr.resolve(i)},e.prototype.lookupMutationBatch=function(e,t){return Qr.resolve(this.findMutationBatch(t))},e.prototype.lookupMutationKeys=function(e,t){var n=this.findMutationBatch(t);return l(null!=n,"Failed to find local mutation batch."),Qr.resolve(n.keys())},e.prototype.getNextMutationBatchAfterBatchId=function(e,t){var n=Math.max(t,this.highestAcknowledgedBatchId)+1,r=this.indexOfBatchId(n),i=r<0?0:r;return Qr.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)},e.prototype.getAllMutationBatches=function(e){return Qr.resolve(this.mutationQueue.slice())},e.prototype.getAllMutationBatchesAffectingDocumentKey=function(e,t){var n=this,r=new Ri(t,0),i=new Ri(t,Number.POSITIVE_INFINITY),o=[];return this.batchesByDocumentKey.forEachInRange([r,i],function(e){l(t.isEqual(e.key),"Should only iterate over a single key's batches");var r=n.findMutationBatch(e.targetOrBatchId);l(null!==r,"Batches in the index must exist in the main table"),o.push(r)}),Qr.resolve(o)},e.prototype.getAllMutationBatchesAffectingDocumentKeys=function(e,t){var n=this,r=new Jn(F);return t.forEach(function(e){var t=new Ri(e,0),i=new Ri(e,Number.POSITIVE_INFINITY);n.batchesByDocumentKey.forEachInRange([t,i],function(t){l(e.isEqual(t.key),"For each key, should only iterate over a single key's batches"),r=r.add(t.targetOrBatchId)})}),Qr.resolve(this.findMutationBatches(r))},e.prototype.getAllMutationBatchesAffectingQuery=function(e,t){var n=t.path,r=n.length+1,i=n;Ht.isDocumentKey(i)||(i=i.child(""));var o=new Ri(new Ht(i),0),a=new Jn(F);return this.batchesByDocumentKey.forEachWhile(function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(a=a.add(e.targetOrBatchId)),!0)},o),Qr.resolve(this.findMutationBatches(a))},e.prototype.findMutationBatches=function(e){var t=this,n=[];return e.forEach(function(e){var r=t.findMutationBatch(e);null!==r&&n.push(r)}),n},e.prototype.removeMutationBatch=function(e,t){var n=this;l(0===this.indexOfExistingBatchId(t.batchId,"removed"),"Can only remove the first entry of the mutation queue"),this.mutationQueue.shift();var r=this.batchesByDocumentKey;return Qr.forEach(t.mutations,function(i){var o=new Ri(i.key,t.batchId);return r=r.delete(o),n.referenceDelegate.removeMutationReference(e,i.key)}).next(function(){n.batchesByDocumentKey=r})},e.prototype.removeCachedMutationKeys=function(e){},e.prototype.containsKey=function(e,t){var n=new Ri(t,0),r=this.batchesByDocumentKey.firstAfterOrEqual(n);return Qr.resolve(t.isEqual(r&&r.key))},e.prototype.performConsistencyCheck=function(e){return 0===this.mutationQueue.length&&l(this.batchesByDocumentKey.isEmpty(),"Document leak -- detected dangling mutation references when queue is empty."),Qr.resolve()},e.prototype.indexOfExistingBatchId=function(e,t){var n=this.indexOfBatchId(e);return l(n>=0&&n<this.mutationQueue.length,"Batches must exist to be "+t),n},e.prototype.indexOfBatchId=function(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId},e.prototype.findMutationBatch=function(e){var t=this.indexOfBatchId(e);if(t<0||t>=this.mutationQueue.length)return null;var n=this.mutationQueue[t];return l(n.batchId===e,"If found batch must match"),n},e}(),Vi=function(){function e(e){this.persistence=e,this.queries=new Zr(function(e){return e.canonicalId()}),this.lastRemoteSnapshotVersion=Rn.MIN,this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new Pi,this.targetCount=0,this.targetIdGenerator=zr.forQueryCache()}return e.prototype.getTargetCount=function(e){return Qr.resolve(this.targetCount)},e.prototype.forEachTarget=function(e,t){return this.queries.forEach(function(e,n){return t(n)}),Qr.resolve()},e.prototype.getLastRemoteSnapshotVersion=function(e){return Qr.resolve(this.lastRemoteSnapshotVersion)},e.prototype.getHighestSequenceNumber=function(e){return Qr.resolve(this.highestSequenceNumber)},e.prototype.allocateTargetId=function(e){var t=this.targetIdGenerator.after(this.highestTargetId);return this.highestTargetId=t,Qr.resolve(t)},e.prototype.setTargetsMetadata=function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.highestSequenceNumber&&(this.highestSequenceNumber=t),Qr.resolve()},e.prototype.saveQueryData=function(e){this.queries.set(e.query,e);var t=e.targetId;t>this.highestTargetId&&(this.highestTargetId=t),e.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=e.sequenceNumber)},e.prototype.addQueryData=function(e,t){return l(!this.queries.has(t.query),"Adding a query that already exists"),this.saveQueryData(t),this.targetCount+=1,Qr.resolve()},e.prototype.updateQueryData=function(e,t){return l(this.queries.has(t.query),"Updating a non-existent query"),this.saveQueryData(t),Qr.resolve()},e.prototype.removeQueryData=function(e,t){return l(this.targetCount>0,"Removing a target from an empty cache"),l(this.queries.has(t.query),"Removing a non-existent target from the cache"),this.queries.delete(t.query),this.references.removeReferencesForId(t.targetId),this.targetCount-=1,Qr.resolve()},e.prototype.removeTargets=function(e,t,n){var r=this,i=0,o=[];return this.queries.forEach(function(a,s){s.sequenceNumber<=t&&!n[s.targetId]&&(r.queries.delete(a),o.push(r.removeMatchingKeysForTargetId(e,s.targetId)),i++)}),Qr.waitFor(o).next(function(){return i})},e.prototype.getQueryCount=function(e){return Qr.resolve(this.targetCount)},e.prototype.getQueryData=function(e,t){var n=this.queries.get(t)||null;return Qr.resolve(n)},e.prototype.getQueryDataForTarget=function(e,t){return c("Not yet implemented.")},e.prototype.addMatchingKeys=function(e,t,n){this.references.addReferences(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(function(t){i.push(r.addReference(e,t))}),Qr.waitFor(i)},e.prototype.removeMatchingKeys=function(e,t,n){this.references.removeReferences(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(function(t){i.push(r.removeReference(e,t))}),Qr.waitFor(i)},e.prototype.removeMatchingKeysForTargetId=function(e,t){return this.references.removeReferencesForId(t),Qr.resolve()},e.prototype.getMatchingKeysForTargetId=function(e,t){var n=this.references.referencesForId(t);return Qr.resolve(n)},e.prototype.containsKey=function(e,t){return Qr.resolve(this.references.containsKey(t))},e}(),ji=function(){function e(e){this.sizer=e,this.docs=tt(),this.newDocumentChanges=ae(),this.size=0}return e.prototype.addEntries=function(e,t,n){for(var r=0,i=t;r<i.length;r++){var o=i[r],a=o.maybeDocument.key;this.docs=this.docs.insert(a,o),this.newDocumentChanges=this.newDocumentChanges.add(a)}return this.size+=n,Qr.resolve()},e.prototype.removeEntry=function(e,t){var n=this.docs.get(t);return n?(this.docs=this.docs.remove(t),this.size-=n.size,Qr.resolve(n.size)):Qr.resolve(0)},e.prototype.getEntry=function(e,t){var n=this.docs.get(t);return Qr.resolve(n?n.maybeDocument:null)},e.prototype.getSizedEntry=function(e,t){return Qr.resolve(this.docs.get(t))},e.prototype.getDocumentsMatchingQuery=function(e,t){for(var n=ie(),r=new Ht(t.path.child("")),i=this.docs.getIteratorFrom(r);i.hasNext();){var o=i.getNext(),a=o.key,s=o.value.maybeDocument;if(!t.path.isPrefixOf(a.path))break;s instanceof Qt&&t.matches(s)&&(n=n.insert(s.key,s))}return Qr.resolve(n)},e.prototype.forEachDocumentKey=function(e,t){return Qr.forEach(this.docs,function(e){return t(e)})},e.prototype.getNewDocumentChanges=function(e){var t=this,n=re();return this.newDocumentChanges.forEach(function(e){var r=t.docs.get(e),i=r?r.maybeDocument:new Gt(e,Rn.forDeletedDoc());n=n.insert(e,i)}),this.newDocumentChanges=ae(),Qr.resolve(n)},e.prototype.newChangeBuffer=function(){return new Ui(this.sizer,this)},e.prototype.getSize=function(e){return Qr.resolve(this.size)},e}(),Ui=function(e){function t(t,n){var r=e.call(this)||this;return r.sizer=t,r.documentCache=n,r}return Ct.__extends(t,e),t.prototype.applyChanges=function(e){var t=this,n=0,r=[];return this.assertChanges().forEach(function(e,i){var o=t.documentSizes.get(e);l(void 0!==o,"Attempting to change document "+e.toString()+" without having read it first");var a=t.sizer(i);n+=a-o,r.push({maybeDocument:i,size:a})}),this.documentCache.addEntries(e,r,n)},t.prototype.getFromCache=function(e,t){return this.documentCache.getSizedEntry(e,t)},t}(ei),qi=function(){function e(e,t,n){var r=this;this.clientId=e,this.mutationQueues={},this.listenSequence=new Or(0),this._started=!1,this._started=!0,this.referenceDelegate=t?new Bi(this):new Ki(this,new ki(n)),this.queryCache=new Vi(this),this.remoteDocumentCache=new ji(function(e){return r.referenceDelegate.documentSize(e)})}return e.createLruPersistence=function(t,n){return new e(t,!1,n)},e.createEagerPersistence=function(t,n){return new e(t,!0,n)},e.prototype.shutdown=function(e){return this._started=!1,Promise.resolve()},Object.defineProperty(e.prototype,"started",{get:function(){return this._started},enumerable:!0,configurable:!0}),e.prototype.getActiveClients=function(){return Ct.__awaiter(this,void 0,void 0,function(){return Ct.__generator(this,function(e){return[2,[this.clientId]]})})},e.prototype.setPrimaryStateListener=function(e){return e(!0)},e.prototype.setNetworkEnabled=function(e){},e.prototype.getMutationQueue=function(e){var t=this.mutationQueues[e.toKey()];return t||(t=new Mi(this.referenceDelegate),this.mutationQueues[e.toKey()]=t),t},e.prototype.getQueryCache=function(){return this.queryCache},e.prototype.getRemoteDocumentCache=function(){return this.remoteDocumentCache},e.prototype.runTransaction=function(e,t,n){var r=this;a("MemoryPersistence","Starting transaction:",e);var i=new Fi(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),n(i).next(function(e){return r.referenceDelegate.onTransactionCommitted(i).next(function(){return e})}).toPromise()},e.prototype.mutationQueuesContainKey=function(e,t){return Qr.or(g(this.mutationQueues).map(function(n){return function(){return n.containsKey(e,t)}}))},e}(),Fi=function(e){this.currentSequenceNumber=e},Bi=function(){function e(e){this.persistence=e}return e.prototype.setInMemoryPins=function(e){this.inMemoryPins=e},e.prototype.addReference=function(e,t){return this.orphanedDocuments.delete(t),Qr.resolve()},e.prototype.removeReference=function(e,t){return this.orphanedDocuments.add(t),Qr.resolve()},e.prototype.removeMutationReference=function(e,t){return this.orphanedDocuments.add(t),Qr.resolve()},e.prototype.removeTarget=function(e,t){var n=this,r=this.persistence.getQueryCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(function(e){e.forEach(function(e){return n.orphanedDocuments.add(e)})}).next(function(){return r.removeQueryData(e,t)})},e.prototype.onTransactionStarted=function(){this.orphanedDocuments=new Set},e.prototype.onTransactionCommitted=function(e){var t=this,n=this.persistence.getRemoteDocumentCache();return Qr.forEach(this.orphanedDocuments,function(r){return t.isReferenced(e,r).next(function(t){return t?Qr.resolve():n.removeEntry(e,r).next(function(){})})})},e.prototype.updateLimboDocument=function(e,t){var n=this;return this.isReferenced(e,t).next(function(e){e?n.orphanedDocuments.delete(t):n.orphanedDocuments.add(t)})},e.prototype.documentSize=function(e){return 0},e.prototype.isReferenced=function(e,t){var n=this;return Qr.or([function(){return n.persistence.getQueryCache().containsKey(e,t)},function(){return n.persistence.mutationQueuesContainKey(e,t)},function(){return Qr.resolve(n.inMemoryPins.containsKey(t))}])},e}(),Ki=function(){function e(e,t){this.persistence=e,this.serializer=t,this.orphanedSequenceNumbers=new Zr(function(e){return fe(e.path)}),this.garbageCollector=new Ti(this)}return e.prototype.onTransactionStarted=function(){},e.prototype.onTransactionCommitted=function(e){return Qr.resolve()},e.prototype.forEachTarget=function(e,t){return this.persistence.getQueryCache().forEachTarget(e,t)},e.prototype.getSequenceNumberCount=function(e){var t=this.orphanedDocumentCount(e);return this.persistence.getQueryCache().getTargetCount(e).next(function(e){return t.next(function(t){return e+t})})},e.prototype.orphanedDocumentCount=function(e){var t=0;return this.forEachOrphanedDocumentSequenceNumber(e,function(e){t++}).next(function(){return t})},e.prototype.forEachOrphanedDocumentSequenceNumber=function(e,t){var n=this;return Qr.forEach(this.orphanedSequenceNumbers,function(r,i){return n.isPinned(e,r,i).next(function(e){return e?Qr.resolve():t(i)})})},e.prototype.setInMemoryPins=function(e){this.inMemoryPins=e},e.prototype.removeTargets=function(e,t,n){return this.persistence.getQueryCache().removeTargets(e,t,n)},e.prototype.removeOrphanedDocuments=function(e,t){var n=this,r=0,i=this.persistence.getRemoteDocumentCache();return i.forEachDocumentKey(e,function(o){return n.isPinned(e,o,t).next(function(t){return t?Qr.resolve():(r++,i.removeEntry(e,o).next())})}).next(function(){return r})},e.prototype.removeMutationReference=function(e,t){return this.orphanedSequenceNumbers.set(t,e.currentSequenceNumber),Qr.resolve()},e.prototype.removeTarget=function(e,t){var n=t.copy({sequenceNumber:e.currentSequenceNumber});return this.persistence.getQueryCache().updateQueryData(e,n)},e.prototype.addReference=function(e,t){return this.orphanedSequenceNumbers.set(t,e.currentSequenceNumber),Qr.resolve()},e.prototype.removeReference=function(e,t){return this.orphanedSequenceNumbers.set(t,e.currentSequenceNumber),Qr.resolve()},e.prototype.updateLimboDocument=function(e,t){return this.orphanedSequenceNumbers.set(t,e.currentSequenceNumber),Qr.resolve()},e.prototype.documentSize=function(e){var t,n=this.serializer.toDbRemoteDocument(e);if(n.document)t=n.document;else if(n.unknownDocument)t=n.unknownDocument;else{if(!n.noDocument)throw c("Unknown remote document type");t=n.noDocument}return JSON.stringify(t).length},e.prototype.isPinned=function(e,t,n){var r=this;return Qr.or([function(){return r.persistence.mutationQueuesContainKey(e,t)},function(){return Qr.resolve(r.inMemoryPins.containsKey(t))},function(){return r.persistence.getQueryCache().containsKey(e,t)},function(){var e=r.orphanedSequenceNumbers.get(t);return Qr.resolve(void 0!==e&&e>n)}])},e}(),Wi=function(){function e(e,t,n,r,i){this.queue=e,this.timerId=t,this.initialDelayMs=n,this.backoffFactor=r,this.maxDelayMs=i,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}return e.prototype.reset=function(){this.currentBaseMs=0},e.prototype.resetToMax=function(){this.currentBaseMs=this.maxDelayMs},e.prototype.backoffAndRun=function(e){var t=this;this.cancel();var n=Math.floor(this.currentBaseMs+this.jitterDelayMs()),r=Math.max(0,Date.now()-this.lastAttemptTime),i=Math.max(0,n-r);this.currentBaseMs>0&&a("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.currentBaseMs+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,i,function(){return t.lastAttemptTime=Date.now(),e()}),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)},e.prototype.cancel=function(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)},e.prototype.jitterDelayMs=function(){return(Math.random()-.5)*this.currentBaseMs},e}();!function(e){e[e.Initial=0]="Initial",e[e.Starting=1]="Starting",e[e.Open=2]="Open",e[e.Error=3]="Error",e[e.Backoff=4]="Backoff"}(Hr||(Hr={}));var Hi,zi=1e3,Qi=6e4,Gi=1.5,Xi=function(){function e(e,t,n,r,i,o){this.queue=e,this.idleTimerId=n,this.connection=r,this.credentialsProvider=i,this.listener=o,this.state=Hr.Initial,this.closeCount=0,this.idleTimer=null,this.stream=null,this.backoff=new Wi(e,t,zi,Gi,Qi)}return e.prototype.isStarted=function(){return this.state===Hr.Starting||this.state===Hr.Open||this.state===Hr.Backoff},e.prototype.isOpen=function(){return this.state===Hr.Open},e.prototype.start=function(){this.state!==Hr.Error?(l(this.state===Hr.Initial,"Already started"),this.auth()):this.performBackoff()},e.prototype.stop=function(){return Ct.__awaiter(this,void 0,void 0,function(){return Ct.__generator(this,function(e){switch(e.label){case 0:return this.isStarted()?[4,this.close(Hr.Initial)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},e.prototype.inhibitBackoff=function(){l(!this.isStarted(),"Can only inhibit backoff in a stopped state"),this.state=Hr.Initial,this.backoff.reset()},e.prototype.markIdle=function(){var e=this;this.isOpen()&&null===this.idleTimer&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,6e4,function(){return e.handleIdleCloseTimer()}))},e.prototype.sendRequest=function(e){this.cancelIdleCheck(),this.stream.send(e)},e.prototype.handleIdleCloseTimer=function(){return Ct.__awaiter(this,void 0,void 0,function(){return Ct.__generator(this,function(e){return this.isOpen()?[2,this.close(Hr.Initial)]:[2]})})},e.prototype.cancelIdleCheck=function(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)},e.prototype.close=function(e,t){return Ct.__awaiter(this,void 0,void 0,function(){return Ct.__generator(this,function(n){switch(n.label){case 0:return l(this.isStarted(),"Only started streams should be closed."),l(e===Hr.Error||X(t),"Can't provide an error when not in an error state."),this.cancelIdleCheck(),this.backoff.cancel(),this.closeCount++,e!==Hr.Error?this.backoff.reset():t&&t.code===xt.RESOURCE_EXHAUSTED?(s(t.toString()),s("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()):t&&t.code===xt.UNAUTHENTICATED&&this.credentialsProvider.invalidateToken(),null!==this.stream&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.onClose(t)];case 1:return n.sent(),[2]}})})},e.prototype.tearDown=function(){},e.prototype.auth=function(){var e=this;l(this.state===Hr.Initial,"Must be in initial state to auth"),this.state=Hr.Starting;var t=this.getCloseGuardedDispatcher(this.closeCount),n=this.closeCount;this.credentialsProvider.getToken().then(function(t){e.closeCount===n&&e.startStream(t)},function(n){t(function(){var t=new Ot(xt.UNKNOWN,"Fetching auth token failed: "+n.message);return e.handleStreamClose(t)})})},e.prototype.startStream=function(e){var t=this;l(this.state===Hr.Starting,"Trying to start stream in a non-starting state");var n=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(e),this.stream.onOpen(function(){n(function(){return l(t.state===Hr.Starting,"Expected stream to be in state Starting, but was "+t.state),t.state=Hr.Open,t.listener.onOpen()})}),this.stream.onClose(function(e){n(function(){return t.handleStreamClose(e)})}),this.stream.onMessage(function(e){n(function(){return t.onMessage(e)})})},e.prototype.performBackoff=function(){var e=this;l(this.state===Hr.Error,"Should only perform backoff when in Error state"),this.state=Hr.Backoff,this.backoff.backoffAndRun(function(){return Ct.__awaiter(e,void 0,void 0,function(){return Ct.__generator(this,function(e){return l(this.state===Hr.Backoff,"Backoff elapsed but state is now: "+this.state),this.state=Hr.Initial,this.start(),l(this.isStarted(),"PersistentStream should have started"),[2]})})})},e.prototype.handleStreamClose=function(e){return l(this.isStarted(),"Can't handle server close on non-started stream"),a("PersistentStream","close with error: "+e),this.stream=null,this.close(Hr.Error,e)},e.prototype.getCloseGuardedDispatcher=function(e){var t=this;return function(n){t.queue.enqueueAndForget(function(){return t.closeCount===e?n():(a("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},e}(),Yi=function(e){function t(t,n,r,i,o){var a=e.call(this,t,xr.ListenStreamConnectionBackoff,xr.ListenStreamIdle,n,r,o)||this;return a.serializer=i,a}return Ct.__extends(t,e),t.prototype.startRpc=function(e){return this.connection.openStream("Listen",e)},t.prototype.onMessage=function(e){this.backoff.reset();var t=this.serializer.fromWatchChange(e),n=this.serializer.versionFromListenResponse(e);return this.listener.onWatchChange(t,n)},t.prototype.watch=function(e){var t={};t.database=this.serializer.encodedDatabaseId,t.addTarget=this.serializer.toTarget(e);var n=this.serializer.toListenRequestLabels(e);n&&(t.labels=n),this.sendRequest(t)},t.prototype.unwatch=function(e){var t={};t.database=this.serializer.encodedDatabaseId,t.removeTarget=e,this.sendRequest(t)},t}(Xi),$i=function(e){function t(t,n,r,i,o){var a=e.call(this,t,xr.WriteStreamConnectionBackoff,xr.WriteStreamIdle,n,r,o)||this;return a.serializer=i,a.handshakeComplete_=!1,a}return Ct.__extends(t,e),Object.defineProperty(t.prototype,"handshakeComplete",{get:function(){return this.handshakeComplete_},enumerable:!0,configurable:!0}),t.prototype.start=function(){this.handshakeComplete_=!1,e.prototype.start.call(this)},t.prototype.tearDown=function(){this.handshakeComplete_&&this.writeMutations([])},t.prototype.startRpc=function(e){return this.connection.openStream("Write",e)},t.prototype.onMessage=function(e){if(l(!!e.streamToken,"Got a write response without a stream token"),this.lastStreamToken=e.streamToken,this.handshakeComplete_){this.backoff.reset();var t=this.serializer.fromWriteResults(e.writeResults,e.commitTime),n=this.serializer.fromVersion(e.commitTime);return this.listener.onMutationResult(n,t)}return l(!e.writeResults||0===e.writeResults.length,"Got mutation results for handshake"),this.handshakeComplete_=!0,this.listener.onHandshakeComplete()},t.prototype.writeHandshake=function(){l(this.isOpen(),"Writing handshake requires an opened stream"),l(!this.handshakeComplete_,"Handshake already completed");var e={};e.database=this.serializer.encodedDatabaseId,this.sendRequest(e)},t.prototype.writeMutations=function(e){var t=this;l(this.isOpen(),"Writing mutations requires an opened stream"),l(this.handshakeComplete_,"Handshake must be complete before writing mutations"),l(this.lastStreamToken.length>0,"Trying to write mutation without a token");var n={streamToken:this.lastStreamToken,writes:e.map(function(e){return t.serializer.toMutation(e)})};this.sendRequest(n)},t}(Xi),Ji=function(){function e(e,t,n,r){this.queue=e,this.connection=t,this.credentials=n,this.serializer=r}return e.prototype.newPersistentWriteStream=function(e){return new $i(this.queue,this.connection,this.credentials,this.serializer,e)},e.prototype.newPersistentWatchStream=function(e){return new Yi(this.queue,this.connection,this.credentials,this.serializer,e)},e.prototype.commit=function(e){var t=this,n={database:this.serializer.encodedDatabaseId,writes:e.map(function(e){return t.serializer.toMutation(e)})};return this.invokeRPC("Commit",n).then(function(e){return t.serializer.fromWriteResults(e.writeResults,e.commitTime)})},e.prototype.lookup=function(e){var t=this,n={database:this.serializer.encodedDatabaseId,documents:e.map(function(e){return t.serializer.toName(e)})};return this.invokeStreamingRPC("BatchGetDocuments",n).then(function(n){var r=re();n.forEach(function(e){var n=t.serializer.fromMaybeDocument(e);r=r.insert(n.key,n)});var i=[];return e.forEach(function(e){var t=r.get(e);l(!!t,"Missing entity in write response for "+e),i.push(t)}),i})},e.prototype.invokeRPC=function(e,t){var n=this;return this.credentials.getToken().then(function(r){return n.connection.invokeRPC(e,t,r)}).catch(function(e){throw e.code===xt.UNAUTHENTICATED&&n.credentials.invalidateToken(),e})},e.prototype.invokeStreamingRPC=function(e,t){var n=this;return this.credentials.getToken().then(function(r){return n.connection.invokeStreamingRPC(e,t,r)}).catch(function(e){throw e.code===xt.UNAUTHENTICATED&&n.credentials.invalidateToken(),e})},e}(),Zi=function(){function e(e){this.datastore=e,this.readVersions=oe(),this.mutations=[],this.committed=!1}return e.prototype.recordVersion=function(e){var t;if(e instanceof Qt)t=e.version;else{if(!(e instanceof Gt))throw c("Document in a transaction was a "+e.constructor.name);t=Rn.forDeletedDoc()}var n=this.readVersions.get(e.key);if(null!==n){if(!t.isEqual(n))throw new Ot(xt.ABORTED,"Document version changed between two reads.")}else this.readVersions=this.readVersions.insert(e.key,t)},e.prototype.lookup=function(e){var t=this;return this.committed?Promise.reject("Transaction has already completed."):this.mutations.length>0?Promise.reject("Transactions lookups are invalid after writes."):this.datastore.lookup(e).then(function(e){return e.forEach(function(e){e instanceof Gt||e instanceof Qt?t.recordVersion(e):c("Document in a transaction was a "+e.constructor.name)}),e})},e.prototype.write=function(e){if(this.committed)throw new Ot(xt.FAILED_PRECONDITION,"Transaction has already completed.");this.mutations=this.mutations.concat(e)},e.prototype.precondition=function(e){var t=this.readVersions.get(e);return t?Fn.updateTime(t):Fn.NONE},e.prototype.preconditionForUpdate=function(e){var t=this.readVersions.get(e);if(t&&t.isEqual(Rn.forDeletedDoc()))throw new Ot(xt.FAILED_PRECONDITION,"Can't update a document that doesn't exist.");return t?Fn.updateTime(t):Fn.exists(!0)},e.prototype.set=function(e,t){this.write(t.toMutations(e,this.precondition(e)))},e.prototype.update=function(e,t){this.write(t.toMutations(e,this.preconditionForUpdate(e)))},e.prototype.delete=function(e){this.write([new zn(e,this.precondition(e))]),this.readVersions=this.readVersions.insert(e,Rn.forDeletedDoc())},e.prototype.commit=function(){var e=this,t=this.readVersions;return this.mutations.forEach(function(e){t=t.remove(e.key)}),t.isEmpty()?this.datastore.commit(this.mutations).then(function(){e.committed=!0}):Promise.reject(Error("Every document read in a transaction must also be written."))},e}();!function(e){e[e.Unknown=0]="Unknown",e[e.Online=1]="Online",e[e.Offline=2]="Offline"}(Hi||(Hi={}));var eo;!function(e){e[e.RemoteStore=0]="RemoteStore",e[e.SharedClientState=1]="SharedClientState"}(eo||(eo={}));var to,no=function(){function e(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state=Hi.Unknown,this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}return e.prototype.handleWatchStreamStart=function(){var e=this;0===this.watchStreamFailures&&(this.setAndBroadcast(Hi.Unknown),l(null===this.onlineStateTimer,"onlineStateTimer shouldn't be started yet"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay(xr.OnlineStateTimeout,1e4,function(){return e.onlineStateTimer=null,l(e.state===Hi.Unknown,"Timer should be canceled if we transitioned to a different state."),e.logClientOfflineWarningIfNecessary("Backend didn't respond within 10 seconds."),e.setAndBroadcast(Hi.Offline),Promise.resolve()}))},e.prototype.handleWatchStreamFailure=function(e){this.state===Hi.Online?(this.setAndBroadcast(Hi.Unknown),l(0===this.watchStreamFailures,"watchStreamFailures must be 0"),l(null===this.onlineStateTimer,"onlineStateTimer must be null")):(this.watchStreamFailures++,this.watchStreamFailures>=1&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary("Connection failed 1 times. Most recent error: "+e.toString()),this.setAndBroadcast(Hi.Offline)))},e.prototype.set=function(e){this.clearOnlineStateTimer(),this.watchStreamFailures=0,e===Hi.Online&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(e)},e.prototype.setAndBroadcast=function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))},e.prototype.logClientOfflineWarningIfNecessary=function(e){var t="Could not reach Cloud Firestore backend. "+e+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.shouldWarnClientIsOffline?(s(t),this.shouldWarnClientIsOffline=!1):a("OnlineStateTracker",t)},e.prototype.clearOnlineStateTimer=function(){null!==this.onlineStateTimer&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)},e}(),ro=function(){function e(e,t,n,r){this.localStore=e,this.datastore=t,this.writePipeline=[],this.listenTargets={},this.watchChangeAggregator=null,this.networkEnabled=!1,this.isPrimary=!1,this.onlineStateTracker=new no(n,r),this.watchStream=this.datastore.newPersistentWatchStream({onOpen:this.onWatchStreamOpen.bind(this),onClose:this.onWatchStreamClose.bind(this),onWatchChange:this.onWatchStreamChange.bind(this)}),this.writeStream=this.datastore.newPersistentWriteStream({onOpen:this.onWriteStreamOpen.bind(this),onClose:this.onWriteStreamClose.bind(this),onHandshakeComplete:this.onWriteHandshakeComplete.bind(this),onMutationResult:this.onMutationResult.bind(this)})}return e.prototype.start=function(){return this.enableNetwork()},e.prototype.enableNetwork=function(){return Ct.__awaiter(this,void 0,void 0,function(){var e;return Ct.__generator(this,function(t){switch(t.label){case 0:return this.networkEnabled=!0,this.canUseNetwork()?(e=this.writeStream,[4,this.localStore.getLastStreamToken()]):[3,3];case 1:return e.lastStreamToken=t.sent(),this.shouldStartWatchStream()?this.startWatchStream():this.onlineStateTracker.set(Hi.Unknown),[4,this.fillWritePipeline()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},e.prototype.disableNetwork=function(){return Ct.__awaiter(this,void 0,void 0,function(){return Ct.__generator(this,function(e){switch(e.label){case 0:return this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return e.sent(),this.onlineStateTracker.set(Hi.Offline),[2]}})})},e.prototype.disableNetworkInternal=function(){return Ct.__awaiter(this,void 0,void 0,function(){return Ct.__generator(this,function(e){switch(e.label){case 0:return[4,this.writeStream.stop()];case 1:return e.sent(),[4,this.watchStream.stop()];case 2:return e.sent(),this.writePipeline.length>0&&(a("RemoteStore","Stopping write stream with "+this.writePipeline.length+" pending writes"),this.writePipeline=[]),this.cleanUpWatchStreamState(),[2]}})})},e.prototype.shutdown=function(){return Ct.__awaiter(this,void 0,void 0,function(){return Ct.__generator(this,function(e){switch(e.label){case 0:return a("RemoteStore","RemoteStore shutting down."),this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return e.sent(),this.onlineStateTracker.set(Hi.Unknown),[2]}})})},e.prototype.listen=function(e){l(!f(this.listenTargets,e.targetId),"listen called with duplicate targetId!"),this.listenTargets[e.targetId]=e,this.shouldStartWatchStream()?this.startWatchStream():this.watchStream.isOpen()&&this.sendWatchRequest(e)},e.prototype.unlisten=function(e){l(f(this.listenTargets,e),"unlisten called without assigned target ID!"),delete this.listenTargets[e],this.watchStream.isOpen()&&this.sendUnwatchRequest(e),v(this.listenTargets)&&(this.watchStream.isOpen()?this.watchStream.markIdle():this.canUseNetwork()&&this.onlineStateTracker.set(Hi.Unknown))},e.prototype.getQueryDataForTarget=function(e){return this.listenTargets[e]||null},e.prototype.getRemoteKeysForTarget=function(e){return this.syncEngine.getRemoteKeysForTarget(e)},e.prototype.sendWatchRequest=function(e){this.watchChangeAggregator.recordPendingTargetRequest(e.targetId),this.watchStream.watch(e)},e.prototype.sendUnwatchRequest=function(e){this.watchChangeAggregator.recordPendingTargetRequest(e),this.watchStream.unwatch(e)},e.prototype.startWatchStream=function(){l(this.shouldStartWatchStream(),"startWatchStream() called when shouldStartWatchStream() is false."),this.watchChangeAggregator=new mr(this),this.watchStream.start(),this.onlineStateTracker.handleWatchStreamStart()},e.prototype.shouldStartWatchStream=function(){return this.canUseNetwork()&&!this.watchStream.isStarted()&&!v(this.listenTargets)},e.prototype.canUseNetwork=function(){return this.isPrimary&&this.networkEnabled},e.prototype.cleanUpWatchStreamState=function(){this.watchChangeAggregator=null},e.prototype.onWatchStreamOpen=function(){return Ct.__awaiter(this,void 0,void 0,function(){var e=this;return Ct.__generator(this,function(t){return m(this.listenTargets,function(t,n){e.sendWatchRequest(n)}),[2]})})},e.prototype.onWatchStreamClose=function(e){return Ct.__awaiter(this,void 0,void 0,function(){return Ct.__generator(this,function(t){return void 0===e&&l(!this.shouldStartWatchStream(),"Watch stream was stopped gracefully while still needed."),this.cleanUpWatchStreamState(),this.shouldStartWatchStream()?(this.onlineStateTracker.handleWatchStreamFailure(e),this.startWatchStream()):this.onlineStateTracker.set(Hi.Unknown),[2]})})},e.prototype.onWatchStreamChange=function(e,t){return Ct.__awaiter(this,void 0,void 0,function(){var n;return Ct.__generator(this,function(r){switch(r.label){case 0:return this.onlineStateTracker.set(Hi.Online),e instanceof fr&&e.state===ar.Removed&&e.cause?[2,this.handleTargetError(e)]:(e instanceof hr?this.watchChangeAggregator.handleDocumentChange(e):e instanceof pr?this.watchChangeAggregator.handleExistenceFilter(e):(l(e instanceof fr,"Expected watchChange to be an instance of WatchTargetChange"),this.watchChangeAggregator.handleTargetChange(e)),t.isEqual(Rn.MIN)?[3,3]:[4,this.localStore.getLastRemoteSnapshotVersion()]);case 1:return n=r.sent(),t.compareTo(n)>=0?[4,this.raiseWatchSnapshot(t)]:[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}})})},e.prototype.raiseWatchSnapshot=function(e){var t=this;l(!e.isEqual(Rn.MIN),"Can't raise event for unknown SnapshotVersion");var n=this.watchChangeAggregator.createRemoteEvent(e);return m(n.targetChanges,function(n,r){if(r.resumeToken.length>0){var i=t.listenTargets[n];i&&(t.listenTargets[n]=i.copy({resumeToken:r.resumeToken,snapshotVersion:e}))}}),n.targetMismatches.forEach(function(e){var n=t.listenTargets[e];if(n){t.listenTargets[e]=n.copy({resumeToken:h()}),t.sendUnwatchRequest(e);var r=new Mn(n.query,e,nn.ExistenceFilterMismatch,n.sequenceNumber);t.sendWatchRequest(r)}}),this.syncEngine.applyRemoteEvent(n)},e.prototype.handleTargetError=function(e){var t=this;l(!!e.cause,"Handling target error without a cause");var n=e.cause,r=Promise.resolve();return e.targetIds.forEach(function(e){r=r.then(function(){return Ct.__awaiter(t,void 0,void 0,function(){return Ct.__generator(this,function(t){return f(this.listenTargets,e)?(delete this.listenTargets[e],this.watchChangeAggregator.removeTarget(e),[2,this.syncEngine.rejectListen(e,n)]):[2]})})})}),r},e.prototype.fillWritePipeline=function(){return Ct.__awaiter(this,void 0,void 0,function(){var e,t;return Ct.__generator(this,function(n){switch(n.label){case 0:return this.canAddToWritePipeline()?(e=this.writePipeline.length>0?this.writePipeline[this.writePipeline.length-1].batchId:Fr,[4,this.localStore.nextMutationBatch(e)]):[3,4];case 1:return null!==(t=n.sent())?[3,2]:(0===this.writePipeline.length&&this.writeStream.markIdle(),[3,4]);case 2:return this.addToWritePipeline(t),[4,this.fillWritePipeline()];case 3:n.sent(),n.label=4;case 4:return this.shouldStartWriteStream()&&this.startWriteStream(),[2]}})})},e.prototype.canAddToWritePipeline=function(){return this.canUseNetwork()&&this.writePipeline.length<10},e.prototype.outstandingWrites=function(){return this.writePipeline.length},e.prototype.addToWritePipeline=function(e){l(this.canAddToWritePipeline(),"addToWritePipeline called when pipeline is full"),this.writePipeline.push(e),this.writeStream.isOpen()&&this.writeStream.handshakeComplete&&this.writeStream.writeMutations(e.mutations)},e.prototype.shouldStartWriteStream=function(){return this.canUseNetwork()&&!this.writeStream.isStarted()&&this.writePipeline.length>0},e.prototype.startWriteStream=function(){l(this.shouldStartWriteStream(),"startWriteStream() called when shouldStartWriteStream() is false."),this.writeStream.start()},e.prototype.onWriteStreamOpen=function(){return Ct.__awaiter(this,void 0,void 0,function(){return Ct.__generator(this,function(e){return this.writeStream.writeHandshake(),[2]})})},e.prototype.onWriteHandshakeComplete=function(){var e=this;return this.localStore.setLastStreamToken(this.writeStream.lastStreamToken).then(function(){for(var t=0,n=e.writePipeline;t<n.length;t++){var r=n[t];e.writeStream.writeMutations(r.mutations)}}).catch(function(t){return e.ignoreIfPrimaryLeaseLoss(t)})},e.prototype.ignoreIfPrimaryLeaseLoss=function(e){if(!Xe(e))throw e;a("RemoteStore","Unexpectedly lost primary lease")},e.prototype.onMutationResult=function(e,t){var n=this;l(this.writePipeline.length>0,"Got result for empty write pipeline");var r=this.writePipeline.shift(),i=Kr.from(r,e,t,this.writeStream.lastStreamToken);return this.syncEngine.applySuccessfulWrite(i).then(function(){return n.fillWritePipeline()})},e.prototype.onWriteStreamClose=function(e){return Ct.__awaiter(this,void 0,void 0,function(){var t,n=this;return Ct.__generator(this,function(r){return void 0===e&&l(!this.shouldStartWriteStream(),"Write stream was stopped gracefully while still needed."),e&&this.writePipeline.length>0?(t=void 0,t=this.writeStream.handshakeComplete?this.handleWriteError(e):this.handleHandshakeError(e),[2,t.then(function(){n.shouldStartWriteStream()&&n.startWriteStream()})]):[2]})})},e.prototype.handleHandshakeError=function(e){return Ct.__awaiter(this,void 0,void 0,function(){var t=this;return Ct.__generator(this,function(n){return J(e.code)||e.code===xt.ABORTED?(a("RemoteStore","RemoteStore error before completed handshake; resetting stream token: ",this.writeStream.lastStreamToken),this.writeStream.lastStreamToken=h(),[2,this.localStore.setLastStreamToken(h()).catch(function(e){return t.ignoreIfPrimaryLeaseLoss(e)})]):[2]})})},e.prototype.handleWriteError=function(e){return Ct.__awaiter(this,void 0,void 0,function(){var t,n=this;return Ct.__generator(this,function(r){return J(e.code)?(t=this.writePipeline.shift(),this.writeStream.inhibitBackoff(),[2,this.syncEngine.rejectFailedWrite(t.batchId,e).then(function(){return n.fillWritePipeline()})]):[2]})})},e.prototype.createTransaction=function(){return new Zi(this.datastore)},e.prototype.handleCredentialChange=function(){return Ct.__awaiter(this,void 0,void 0,function(){return Ct.__generator(this,function(e){switch(e.label){case 0:return this.canUseNetwork()?(a("RemoteStore","RemoteStore restarting streams for new credential"),this.networkEnabled=!1,[4,this.disableNetworkInternal()]):[3,3];case 1:return e.sent(),this.onlineStateTracker.set(Hi.Unknown),[4,this.enableNetwork()];case 2:e.sent(),e.label=3;case 3:return[2]}})})},e.prototype.applyPrimaryState=function(e){return Ct.__awaiter(this,void 0,void 0,function(){return Ct.__generator(this,function(t){switch(t.label){case 0:return this.isPrimary=e,e&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return t.sent(),[3,4];case 2:return e?[3,4]:[4,this.disableNetworkInternal()];case 3:t.sent(),this.onlineStateTracker.set(Hi.Unknown),t.label=4;case 4:return[2]}})})},e}(),io=function(){this.listeners=[]},oo=function(){function e(e){this.syncEngine=e,this.queries=new Zr(function(e){return e.canonicalId()}),this.onlineState=Hi.Unknown,this.syncEngine.subscribe(this)}return e.prototype.listen=function(e){var t=e.query,n=!1,r=this.queries.get(t);return r||(n=!0,r=new io,this.queries.set(t,r)),r.listeners.push(e),e.applyOnlineStateChange(this.onlineState),r.viewSnap&&e.onViewSnapshot(r.viewSnap),n?this.syncEngine.listen(t).then(function(e){return r.targetId=e,e}):Promise.resolve(r.targetId)},e.prototype.unlisten=function(e){return Ct.__awaiter(this,void 0,void 0,function(){var t,n,r,i;return Ct.__generator(this,function(o){return t=e.query,n=!1,(r=this.queries.get(t))&&(i=r.listeners.indexOf(e))>=0&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?(this.queries.delete(t),[2,this.syncEngine.unlisten(t)]):[2]})})},e.prototype.onWatchChange=function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t],i=r.query,o=this.queries.get(i);if(o){for(var a=0,s=o.listeners;a<s.length;a++)s[a].onViewSnapshot(r);o.viewSnap=r}}},e.prototype.onWatchError=function(e,t){var n=this.queries.get(e);if(n)for(var r=0,i=n.listeners;r<i.length;r++)i[r].onError(t);this.queries.delete(e)},e.prototype.onOnlineStateChange=function(e){this.onlineState=e,this.queries.forEach(function(t,n){for(var r=0,i=n.listeners;r<i.length;r++)i[r].applyOnlineStateChange(e)})},e}(),ao=function(){function e(e,t,n){this.query=e,this.queryObserver=t,this.raisedInitialEvent=!1,this.onlineState=Hi.Unknown,this.options=n||{}}return e.prototype.onViewSnapshot=function(e){if(l(e.docChanges.length>0||e.syncStateChanged,"We got a new snapshot with no changes?"),!this.options.includeMetadataChanges){for(var t=[],n=0,r=e.docChanges;n<r.length;n++){var i=r[n];i.type!==$n.Metadata&&t.push(i)}e=new ur(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}this.raisedInitialEvent?this.shouldRaiseEvent(e)&&this.queryObserver.next(e):this.shouldRaiseInitialEvent(e,this.onlineState)&&this.raiseInitialEvent(e),this.snap=e},e.prototype.onError=function(e){this.queryObserver.error(e)},e.prototype.applyOnlineStateChange=function(e){this.onlineState=e,this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,e)&&this.raiseInitialEvent(this.snap)},e.prototype.shouldRaiseInitialEvent=function(e,t){if(l(!this.raisedInitialEvent,"Determining whether to raise first event but already had first event"),!e.fromCache)return!0;var n=t!==Hi.Offline;return this.options.waitForSyncWhenOnline&&n?(l(e.fromCache,"Waiting for sync, but snapshot is not from cache"),!1):!e.docs.isEmpty()||t===Hi.Offline},e.prototype.shouldRaiseEvent=function(e){if(e.docChanges.length>0)return!0;var t=this.snap&&this.snap.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges},e.prototype.raiseInitialEvent=function(e){l(!this.raisedInitialEvent,"Trying to raise initial events for second time"),e=ur.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.raisedInitialEvent=!0,this.queryObserver.next(e)},e}(),so=function(){function e(e,t,n){this.targetId=e,this.addedKeys=t,this.removedKeys=n}return e.fromSnapshot=function(t,n){for(var r=ae(),i=ae(),o=0,a=n.docChanges;o<a.length;o++){var s=a[o];switch(s.type){case $n.Added:r=r.add(s.doc.key);break;case $n.Removed:i=i.add(s.doc.key)}}return new e(t,r,i)},e}(),uo=function(e){this.key=e},co=function(e){this.key=e},lo=function(){function e(e,t){this.query=e,this._syncedDocuments=t,this.syncState=null,this.current=!1,this.limboDocuments=ae(),this.mutatedKeys=ae(),this.documentSet=new ir(e.docComparator.bind(e))}return Object.defineProperty(e.prototype,"syncedDocuments",{get:function(){return this._syncedDocuments},enumerable:!0,configurable:!0}),e.prototype.computeDocChanges=function(e,t){var n=this,r=t?t.changeSet:new sr,i=t?t.documentSet:this.documentSet,o=t?t.mutatedKeys:this.mutatedKeys,a=i,s=!1,u=this.query.hasLimit()&&i.size===this.query.limit?i.last():null;if(e.inorderTraversal(function(e,t){var c=i.get(e),h=t instanceof Qt?t:null;h&&(l(e.isEqual(h.key),"Mismatching keys found in document changes: "+e+" != "+h.key),h=n.query.matches(h)?h:null);var p=!!c&&n.mutatedKeys.has(c.key),f=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),d=!1;c&&h?c.data.isEqual(h.data)?p!==f&&(r.track({type:$n.Metadata,doc:h}),d=!0):n.shouldWaitForSyncedDocument(c,h)||(r.track({type:$n.Modified,doc:h}),d=!0,u&&n.query.docComparator(h,u)>0&&(s=!0)):!c&&h?(r.track({type:$n.Added,doc:h}),d=!0):c&&!h&&(r.track({type:$n.Removed,doc:c}),d=!0,u&&(s=!0)),d&&(h?(a=a.add(h),o=f?o.add(e):o.delete(e)):(a=a.delete(e),o=o.delete(e)))}),this.query.hasLimit())for(;a.size>this.query.limit;){var c=a.last();a=a.delete(c.key),o=o.delete(c.key),r.track({type:$n.Removed,doc:c})}return l(!s||!t,"View was refilled using docs that themselves needed refilling."),{documentSet:a,changeSet:r,needsRefill:s,mutatedKeys:o}},e.prototype.shouldWaitForSyncedDocument=function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations},e.prototype.applyChanges=function(e,t,n){var r=this;l(!e.needsRefill,"Cannot apply changes that need a refill");var i=this.documentSet;this.documentSet=e.documentSet,this.mutatedKeys=e.mutatedKeys;var o=e.changeSet.getChanges();o.sort(function(e,t){return nt(e.type,t.type)||r.query.docComparator(e.doc,t.doc)}),this.applyTargetChange(n);var a=t?this.updateLimboDocuments():[],s=0===this.limboDocuments.size&&this.current?or.Synced:or.Local,u=s!==this.syncState;return this.syncState=s,0!==o.length||u?{snapshot:new ur(this.query,e.documentSet,i,o,e.mutatedKeys,s===or.Local,u,!1),limboChanges:a}:{limboChanges:a}},e.prototype.applyOnlineStateChange=function(e){return this.current&&e===Hi.Offline?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new sr,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}},e.prototype.shouldBeInLimbo=function(e){return!this._syncedDocuments.has(e)&&!!this.documentSet.has(e)&&!this.documentSet.get(e).hasLocalMutations},e.prototype.applyTargetChange=function(e){var t=this;e&&(e.addedDocuments.forEach(function(e){return t._syncedDocuments=t._syncedDocuments.add(e)}),e.modifiedDocuments.forEach(function(e){return l(t._syncedDocuments.has(e),"Modified document "+e+" not found in view.")}),e.removedDocuments.forEach(function(e){return t._syncedDocuments=t._syncedDocuments.delete(e)}),this.current=e.current)},e.prototype.updateLimboDocuments=function(){var e=this;if(!this.current)return[];var t=this.limboDocuments;this.limboDocuments=ae(),this.documentSet.forEach(function(t){e.shouldBeInLimbo(t.key)&&(e.limboDocuments=e.limboDocuments.add(t.key))});var n=[];return t.forEach(function(t){e.limboDocuments.has(t)||n.push(new co(t))}),this.limboDocuments.forEach(function(e){t.has(e)||n.push(new uo(e))}),n},e.prototype.synchronizeWithPersistedState=function(e,t){this._syncedDocuments=t,this.limboDocuments=ae();var n=this.computeDocChanges(e);return this.applyChanges(n,!0)},e.prototype.computeInitialSnapshot=function(){return ur.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,this.syncState===or.Local)},e}(),ho=function(e,t,n){this.query=e,this.targetId=t,this.view=n},po=function(e){this.key=e},fo=function(){function e(e,t,n,r){this.localStore=e,this.remoteStore=t,this.sharedClientState=n,this.currentUser=r,this.syncEngineListener=null,this.queryViewsByQuery=new Zr(function(e){return e.canonicalId()}),this.queryViewsByTarget={},this.limboTargetsByKey=new Yt(Ht.comparator),this.limboResolutionsByTarget={},this.limboDocumentRefs=new Pi,this.mutationUserCallbacks={},this.limboTargetIdGenerator=zr.forSyncEngine(),this.isPrimary=void 0,this.onlineState=Hi.Unknown}return Object.defineProperty(e.prototype,"isPrimaryClient",{get:function(){return!0===this.isPrimary},enumerable:!0,configurable:!0}),e.prototype.subscribe=function(e){l(null!==e,"SyncEngine listener cannot be null"),l(null===this.syncEngineListener,"SyncEngine already has a subscriber."),this.syncEngineListener=e},e.prototype.listen=function(e){return Ct.__awaiter(this,void 0,void 0,function(){var t,n,r,i,o;return Ct.__generator(this,function(a){switch(a.label){case 0:return this.assertSubscribed("listen()"),(r=this.queryViewsByQuery.get(e))?(t=r.targetId,this.sharedClientState.addLocalQueryTarget(t),n=r.view.computeInitialSnapshot(),[3,4]):[3,1];case 1:return[4,this.localStore.allocateQuery(e)];case 2:return i=a.sent(),o=this.sharedClientState.addLocalQueryTarget(i.targetId),t=i.targetId,[4,this.initializeViewAndComputeSnapshot(i,"current"===o)];case 3:n=a.sent(),this.isPrimary&&this.remoteStore.listen(i),a.label=4;case 4:return this.syncEngineListener.onWatchChange([n]),[2,t]}})})},e.prototype.initializeViewAndComputeSnapshot=function(e,t){var n=this,r=e.query;return this.localStore.executeQuery(r).then(function(i){return n.localStore.remoteDocumentKeys(e.targetId).then(function(o){var a=new lo(r,o),s=a.computeDocChanges(i),u=lr.createSynthesizedTargetChangeForCurrentChange(e.targetId,t&&n.onlineState!==Hi.Offline),c=a.applyChanges(s,!0===n.isPrimary,u);l(0===c.limboChanges.length,"View returned limbo docs before target ack from the server."),l(!!c.snapshot,"applyChanges for new view should always return a snapshot");var h=new ho(r,e.targetId,a);return n.queryViewsByQuery.set(r,h),n.queryViewsByTarget[e.targetId]=h,c.snapshot})})},e.prototype.synchronizeViewAndComputeSnapshot=function(e){var t=this;return this.localStore.executeQuery(e.query).then(function(n){return t.localStore.remoteDocumentKeys(e.targetId).then(function(r){return Ct.__awaiter(t,void 0,void 0,function(){var t;return Ct.__generator(this,function(i){return t=e.view.synchronizeWithPersistedState(n,r),this.isPrimary&&this.updateTrackedLimbos(e.targetId,t.limboChanges),[2,t]})})})})},e.prototype.unlisten=function(e){return Ct.__awaiter(this,void 0,void 0,function(){var t,n,r=this;return Ct.__generator(this,function(i){switch(i.label){case 0:return this.assertSubscribed("unlisten()"),t=this.queryViewsByQuery.get(e),l(!!t,"Trying to unlisten on query not found:"+e),this.isPrimary?(this.sharedClientState.removeLocalQueryTarget(t.targetId),(n=this.sharedClientState.isActiveQueryTarget(t.targetId))?[3,2]:[4,this.localStore.releaseQuery(e,!1).then(function(){r.sharedClientState.clearQueryState(t.targetId),r.remoteStore.unlisten(t.targetId),r.removeAndCleanupQuery(t)}).catch(function(e){return r.ignoreIfPrimaryLeaseLoss(e)})]):[3,3];case 1:i.sent(),i.label=2;case 2:return[3,5];case 3:return this.removeAndCleanupQuery(t),[4,this.localStore.releaseQuery(e,!0)];case 4:i.sent(),i.label=5;case 5:return[2]}})})},e.prototype.write=function(e,t){var n=this;return this.assertSubscribed("write()"),this.localStore.localWrite(e).then(function(e){return n.sharedClientState.addPendingMutation(e.batchId),n.addMutationCallback(e.batchId,t),n.emitNewSnapsAndNotifyLocalStore(e.changes)}).then(function(){return n.remoteStore.fillWritePipeline()})},e.prototype.wrapUpdateFunctionError=function(e){return e},e.prototype.runTransaction=function(e,t){var n=this;void 0===t&&(t=5),l(t>=0,"Got negative number of retries for transaction.");var r=this.remoteStore.createTransaction();return function(){try{var t=e(r);return!X(t)&&t.catch&&t.then?t.catch(function(e){return Promise.reject(n.wrapUpdateFunctionError(e))}):Promise.reject(Error("Transaction callback must return a Promise"))}catch(e){return Promise.reject(n.wrapUpdateFunctionError(e))}}().then(function(i){return r.commit().then(function(){return i}).catch(function(r){return 0===t?Promise.reject(r):n.runTransaction(e,t-1)})})},e.prototype.applyRemoteEvent=function(e){var t=this;return this.assertSubscribed("applyRemoteEvent()"),this.localStore.applyRemoteEvent(e).then(function(n){return y(e.targetChanges,function(e,n){var r=t.limboResolutionsByTarget[e];r&&(l(n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size<=1,"Limbo resolution for single document contains multiple changes."),n.addedDocuments.size>0?r.receivedDocument=!0:n.modifiedDocuments.size>0?l(r.receivedDocument,"Received change for limbo target document without add."):n.removedDocuments.size>0&&(l(r.receivedDocument,"Received remove for limbo target document without add."),r.receivedDocument=!1))}),t.emitNewSnapsAndNotifyLocalStore(n,e)}).catch(function(e){return t.ignoreIfPrimaryLeaseLoss(e)})},e.prototype.applyOnlineStateChange=function(e,t){if(this.isPrimary&&t===eo.RemoteStore||!this.isPrimary&&t===eo.SharedClientState){var n=[];this.queryViewsByQuery.forEach(function(t,r){var i=r.view.applyOnlineStateChange(e);l(0===i.limboChanges.length,"OnlineState should not affect limbo documents."),i.snapshot&&n.push(i.snapshot)}),this.syncEngineListener.onOnlineStateChange(e),this.syncEngineListener.onWatchChange(n),this.onlineState=e,this.isPrimary&&this.sharedClientState.setOnlineState(e)}},e.prototype.rejectListen=function(e,t){return Ct.__awaiter(this,void 0,void 0,function(){var n,r,i,o,a,s,u=this;return Ct.__generator(this,function(c){switch(c.label){case 0:return this.assertSubscribed("rejectListens()"),this.sharedClientState.updateQueryState(e,"rejected",t),n=this.limboResolutionsByTarget[e],(r=n&&n.key)?(this.limboTargetsByKey=this.limboTargetsByKey.remove(r),delete this.limboResolutionsByTarget[e],i=new Yt(Ht.comparator),i=i.insert(r,new Gt(r,Rn.forDeletedDoc())),o=ae().add(r),a=new cr(Rn.MIN,{},new Jn(F),i,o),[2,this.applyRemoteEvent(a)]):[3,1];case 1:return s=this.queryViewsByTarget[e],l(!!s,"Unknown targetId: "+e),[4,this.localStore.releaseQuery(s.query,!1).then(function(){return u.removeAndCleanupQuery(s)}).catch(function(e){return u.ignoreIfPrimaryLeaseLoss(e)})];case 2:c.sent(),this.syncEngineListener.onWatchError(s.query,t),c.label=3;case 3:return[2]}})})},e.prototype.applyBatchState=function(e,t,n){return Ct.__awaiter(this,void 0,void 0,function(){var r;return Ct.__generator(this,function(i){switch(i.label){case 0:return this.assertSubscribed("applyBatchState()"),[4,this.localStore.lookupMutationDocuments(e)];case 1:return null===(r=i.sent())?(a("SyncEngine","Cannot apply mutation batch with id: "+e),[2]):"pending"!==t?[3,3]:[4,this.remoteStore.fillWritePipeline()];case 2:return i.sent(),[3,4];case 3:"acknowledged"===t||"rejected"===t?(this.processUserCallback(e,n||null),this.localStore.removeCachedMutationBatchMetadata(e)):c("Unknown batchState: "+t),i.label=4;case 4:return[4,this.emitNewSnapsAndNotifyLocalStore(r)];case 5:return i.sent(),[2]}})})},e.prototype.applySuccessfulWrite=function(e){var t=this;this.assertSubscribed("applySuccessfulWrite()");var n=e.batch.batchId;return this.processUserCallback(n,null),this.localStore.acknowledgeBatch(e).then(function(e){return t.sharedClientState.updateMutationState(n,"acknowledged"),t.emitNewSnapsAndNotifyLocalStore(e)}).catch(function(e){return t.ignoreIfPrimaryLeaseLoss(e)})},e.prototype.rejectFailedWrite=function(e,t){var n=this;return this.assertSubscribed("rejectFailedWrite()"),this.processUserCallback(e,t),this.localStore.rejectBatch(e).then(function(r){return n.sharedClientState.updateMutationState(e,"rejected",t),n.emitNewSnapsAndNotifyLocalStore(r)}).catch(function(e){return n.ignoreIfPrimaryLeaseLoss(e)})},e.prototype.addMutationCallback=function(e,t){var n=this.mutationUserCallbacks[this.currentUser.toKey()];n||(n=new Yt(F)),n=n.insert(e,t),this.mutationUserCallbacks[this.currentUser.toKey()]=n},e.prototype.processUserCallback=function(e,t){var n=this.mutationUserCallbacks[this.currentUser.toKey()];if(n){var r=n.get(e);r&&(l(e===n.minKey(),"Mutation callbacks processed out-of-order?"),t?r.reject(t):r.resolve(),n=n.remove(e)),this.mutationUserCallbacks[this.currentUser.toKey()]=n}},e.prototype.removeAndCleanupQuery=function(e){var t=this;if(this.sharedClientState.removeLocalQueryTarget(e.targetId),this.queryViewsByQuery.delete(e.query),delete this.queryViewsByTarget[e.targetId],this.isPrimary){var n=this.limboDocumentRefs.referencesForId(e.targetId);this.limboDocumentRefs.removeReferencesForId(e.targetId),n.forEach(function(e){t.limboDocumentRefs.containsKey(e)||t.removeLimboTarget(e)})}},e.prototype.removeLimboTarget=function(e){var t=this.limboTargetsByKey.get(e);null!==t&&(this.remoteStore.unlisten(t),this.limboTargetsByKey=this.limboTargetsByKey.remove(e),delete this.limboResolutionsByTarget[t])},e.prototype.updateTrackedLimbos=function(e,t){for(var n=0,r=t;n<r.length;n++){var i=r[n];i instanceof uo?(this.limboDocumentRefs.addReference(i.key,e),this.trackLimboChange(i)):i instanceof co?(a("SyncEngine","Document no longer in limbo: "+i.key),this.limboDocumentRefs.removeReference(i.key,e),this.limboDocumentRefs.containsKey(i.key)||this.removeLimboTarget(i.key)):c("Unknown limbo change: "+JSON.stringify(i))}},e.prototype.trackLimboChange=function(e){var t=e.key;if(!this.limboTargetsByKey.get(t)){a("SyncEngine","New document in limbo: "+t);var n=this.limboTargetIdGenerator.next(),r=En.atPath(t.path);this.limboResolutionsByTarget[n]=new po(t),this.remoteStore.listen(new Mn(r,n,nn.LimboResolution,Or.INVALID)),this.limboTargetsByKey=this.limboTargetsByKey.insert(t,n)}},e.prototype.currentLimboDocs=function(){return this.limboTargetsByKey},e.prototype.emitNewSnapsAndNotifyLocalStore=function(e,t){return Ct.__awaiter(this,void 0,void 0,function(){var n,r,i,o=this;return Ct.__generator(this,function(a){switch(a.label){case 0:return n=[],r=[],i=[],this.queryViewsByQuery.forEach(function(a,s){i.push(Promise.resolve().then(function(){var t=s.view.computeDocChanges(e);return t.needsRefill?o.localStore.executeQuery(s.query).then(function(e){return s.view.computeDocChanges(e,t)}):t}).then(function(e){var i=t&&t.targetChanges[s.targetId],a=s.view.applyChanges(e,!0===o.isPrimary,i);if(o.updateTrackedLimbos(s.targetId,a.limboChanges),a.snapshot){o.isPrimary&&o.sharedClientState.updateQueryState(s.targetId,a.snapshot.fromCache?"not-current":"current"),n.push(a.snapshot);var u=so.fromSnapshot(s.targetId,a.snapshot);r.push(u)}}))}),[4,Promise.all(i)];case 1:return a.sent(),this.syncEngineListener.onWatchChange(n),[4,this.localStore.notifyLocalViewChanges(r)];case 2:return a.sent(),[2]}})})},e.prototype.ignoreIfPrimaryLeaseLoss=function(e){return Ct.__awaiter(this,void 0,void 0,function(){return Ct.__generator(this,function(t){if(!Xe(e))throw e;return a("SyncEngine","Unexpectedly lost primary lease"),[2]})})},e.prototype.assertSubscribed=function(e){l(null!==this.syncEngineListener,"Trying to call "+e+" before calling subscribe().")},e.prototype.handleCredentialChange=function(e){return Ct.__awaiter(this,void 0,void 0,function(){var t,n;return Ct.__generator(this,function(r){switch(r.label){case 0:return t=!this.currentUser.isEqual(e),this.currentUser=e,t?[4,this.localStore.handleUserChange(e)]:[3,3];case 1:return n=r.sent(),this.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),[4,this.emitNewSnapsAndNotifyLocalStore(n.affectedDocuments)];case 2:r.sent(),r.label=3;case 3:return[4,this.remoteStore.handleCredentialChange()];case 4:return r.sent(),[2]}})})},e.prototype.applyPrimaryState=function(e){return Ct.__awaiter(this,void 0,void 0,function(){var t,n,r,i,o,a,s,u=this;return Ct.__generator(this,function(c){switch(c.label){case 0:return!0!==e||!0===this.isPrimary?[3,3]:(this.isPrimary=!0,[4,this.remoteStore.applyPrimaryState(!0)]);case 1:return c.sent(),t=this.sharedClientState.getAllActiveQueryTargets(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(t.toArray())];case 2:for(n=c.sent(),r=0,i=n;r<i.length;r++)o=i[r],this.remoteStore.listen(o);return[3,7];case 3:return!1!==e||!1===this.isPrimary?[3,7]:(this.isPrimary=!1,a=[],s=Promise.resolve(),m(this.queryViewsByTarget,function(e,t){u.sharedClientState.isLocalQueryTarget(e)?a.push(e):s=s.then(function(){return u.unlisten(t.query)}),u.remoteStore.unlisten(t.targetId)}),[4,s]);case 4:return c.sent(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(a)];case 5:return c.sent(),this.resetLimboDocuments(),[4,this.remoteStore.applyPrimaryState(!1)];case 6:c.sent(),c.label=7;case 7:return[2]}})})},e.prototype.resetLimboDocuments=function(){var e=this;m(this.limboResolutionsByTarget,function(t){e.remoteStore.unlisten(t)}),this.limboDocumentRefs.removeAllReferences(),this.limboResolutionsByTarget=[],this.limboTargetsByKey=new Yt(Ht.comparator)},e.prototype.synchronizeQueryViewsAndRaiseSnapshots=function(e){for(var t=this,n=Promise.resolve(),r=[],i=[],o=0,a=e;o<a.length;o++)!function(e){n=n.then(function(){return Ct.__awaiter(t,void 0,void 0,function(){var t,n,o,a;return Ct.__generator(this,function(s){switch(s.label){case 0:return(n=this.queryViewsByTarget[e])?[4,this.localStore.releaseQuery(n.query,!0)]:[3,4];case 1:return s.sent(),[4,this.localStore.allocateQuery(n.query)];case 2:return t=s.sent(),[4,this.synchronizeViewAndComputeSnapshot(n)];case 3:return(o=s.sent()).snapshot&&i.push(o.snapshot),[3,8];case 4:return l(!0===this.isPrimary,"A secondary tab should never have an active query without an active view."),[4,this.localStore.getQueryForTarget(e)];case 5:return a=s.sent(),l(!!a,"Query data for target "+e+" not found"),[4,this.localStore.allocateQuery(a)];case 6:return t=s.sent(),[4,this.initializeViewAndComputeSnapshot(t,!1)];case 7:s.sent(),s.label=8;case 8:return r.push(t),[2]}})})})}(a[o]);return n.then(function(){return t.syncEngineListener.onWatchChange(i),r})},e.prototype.getActiveClients=function(){return this.localStore.getActiveClients()},e.prototype.applyTargetState=function(e,t,n){return Ct.__awaiter(this,void 0,void 0,function(){var r,i,o=this;return Ct.__generator(this,function(s){switch(s.label){case 0:if(this.isPrimary)return a("SyncEngine","Ignoring unexpected query state notification."),[2];if(!this.queryViewsByTarget[e])return[3,5];switch(r=t){case"current":case"not-current":return[3,1];case"rejected":return[3,2]}return[3,4];case 1:return[2,this.localStore.getNewDocumentChanges().then(function(n){return Ct.__awaiter(o,void 0,void 0,function(){var r;return Ct.__generator(this,function(i){switch(i.label){case 0:return r=cr.createSynthesizedRemoteEventForCurrentChange(e,"current"===t),[4,this.emitNewSnapsAndNotifyLocalStore(n,r)];case 1:return i.sent(),[2]}})})},function(e){return Ct.__awaiter(o,void 0,void 0,function(){var t;return Ct.__generator(this,function(n){switch(n.label){case 0:return Te(e)?(t=[],m(this.queryViewsByTarget,function(e){return t.push(e)}),[4,this.synchronizeQueryViewsAndRaiseSnapshots(t)]):[3,2];case 1:return n.sent(),[3,3];case 2:throw e;case 3:return[2]}})})})];case 2:return i=this.queryViewsByTarget[e],this.removeAndCleanupQuery(i),[4,this.localStore.releaseQuery(i.query,!0)];case 3:return s.sent(),this.syncEngineListener.onWatchError(i.query,n),[3,5];case 4:c("Unexpected target state: "+t),s.label=5;case 5:return[2]}})})},e.prototype.applyActiveTargetsChange=function(e,t){return Ct.__awaiter(this,void 0,void 0,function(){var n,r,i,o,a,s,u,c,h,p=this;return Ct.__generator(this,function(f){switch(f.label){case 0:if(!this.isPrimary)return[2];n=0,r=e,f.label=1;case 1:return n<r.length?(h=r[n],l(!this.queryViewsByTarget[h],"Trying to add an already active target"),[4,this.localStore.getQueryForTarget(h)]):[3,6];case 2:return i=f.sent(),l(!!i,"Query data for active target "+h+" not found"),[4,this.localStore.allocateQuery(i)];case 3:return o=f.sent(),[4,this.initializeViewAndComputeSnapshot(o,!1)];case 4:f.sent(),this.remoteStore.listen(o),f.label=5;case 5:return n++,[3,1];case 6:a=function(e){var t;return Ct.__generator(this,function(n){switch(n.label){case 0:return(t=s.queryViewsByTarget[e])?[4,s.localStore.releaseQuery(t.query,!1).then(function(){p.remoteStore.unlisten(e),p.removeAndCleanupQuery(t)}).catch(function(e){return p.ignoreIfPrimaryLeaseLoss(e)})]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})},s=this,u=0,c=t,f.label=7;case 7:return u<c.length?(h=c[u],[5,a(h)]):[3,10];case 8:f.sent(),f.label=9;case 9:return u++,[3,7];case 10:return[2]}})})},e.prototype.enableNetwork=function(){return this.localStore.setNetworkEnabled(!0),this.remoteStore.enableNetwork()},e.prototype.disableNetwork=function(){return this.localStore.setNetworkEnabled(!1),this.remoteStore.disableNetwork()},e.prototype.getRemoteKeysForTarget=function(e){var t=this.limboResolutionsByTarget[e];return t&&t.receivedDocument?ae().add(t.key):this.queryViewsByTarget[e]?this.queryViewsByTarget[e].view.syncedDocuments:ae()},e}(),mo=function(){function e(e){this.uid=e}return e.prototype.isAuthenticated=function(){return null!=this.uid},e.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},e.prototype.isEqual=function(e){return e.uid===this.uid},e.UNAUTHENTICATED=new e(null),e.GOOGLE_CREDENTIALS=new e("google-credentials-uid"),e.FIRST_PARTY=new e("first-party-uid"),e}(),go="SharedClientState",yo="firestore_clients",vo="firestore_mutations",bo="firestore_targets",_o="firestore_online_state",wo="firestore_sequence_number",ko=function(){function e(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r,l(void 0!==r==("rejected"===n),"MutationMetadata must contain an error iff state is 'rejected'")}return e.fromWebStorageEntry=function(t,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),a=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(a=new Ot(i.error.code,i.error.message)),o?new e(t,n,i.state,a):(s(go,"Failed to parse mutation state for ID '"+n+"': "+r),null)},e.prototype.toWebStorageJSON=function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)},e}(),Eo=function(){function e(e,t,n){this.targetId=e,this.state=t,this.error=n,l(void 0!==n==("rejected"===t),"QueryTargetMetadata must contain an error iff state is 'rejected'")}return e.fromWebStorageEntry=function(t,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Ot(r.error.code,r.error.message)),i?new e(t,r.state,o):(s(go,"Failed to parse target state for ID '"+t+"': "+n),null)},e.prototype.toWebStorageJSON=function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)},e}(),To=function(){function e(e,t){this.clientId=e,this.activeTargetIds=t}return e.fromWebStorageEntry=function(t,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=se(),a=0;i&&a<r.activeTargetIds.length;++a)i=Y(r.activeTargetIds[a]),o=o.add(r.activeTargetIds[a]);return i?new e(t,o):(s(go,"Failed to parse client data for instance '"+t+"': "+n),null)},e}(),So=function(){function e(e,t){this.clientId=e,this.onlineState=t}return e.fromWebStorageEntry=function(t){var n=JSON.parse(t);return"object"==typeof n&&void 0!==Hi[n.onlineState]&&"string"==typeof n.clientId?new e(n.clientId,Hi[n.onlineState]):(s(go,"Failed to parse online state: "+t),null)},e}(),Co=function(){function e(){this.activeTargetIds=se()}return e.prototype.addQueryTarget=function(e){l(!this.activeTargetIds.has(e),"Target with ID '"+e+"' already active."),this.activeTargetIds=this.activeTargetIds.add(e)},e.prototype.removeQueryTarget=function(e){this.activeTargetIds=this.activeTargetIds.delete(e)},e.prototype.toWebStorageJSON=function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)},e}(),Io=function(){function e(t,n,r,i,o){if(this.queue=t,this.platform=n,this.persistenceKey=r,this.localClientId=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.activeClients={},this.storageListener=this.handleWebStorageEvent.bind(this),this.started=!1,this.earlyEvents=[],!e.isAvailable(this.platform))throw new Ot(xt.UNIMPLEMENTED,"LocalStorage is not available on this platform.");var a=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.platform.window.localStorage,this.currentUser=o,this.localClientStorageKey=this.toWebStorageClientStateKey(this.localClientId),this.sequenceNumberKey=wo+"_"+r,this.activeClients[this.localClientId]=new Co,this.clientStateKeyRe=new RegExp("^"+yo+"_"+a+"_([^_]*)$"),this.mutationBatchKeyRe=new RegExp("^"+vo+"_"+a+"_(\\d+)(?:_(.*))?$"),this.queryTargetKeyRe=new RegExp("^"+bo+"_"+a+"_(\\d+)$"),this.onlineStateKey=_o+"_"+r,this.platform.window.addEventListener("storage",this.storageListener)}return e.isAvailable=function(e){return!(!e.window||null==e.window.localStorage)},e.prototype.start=function(){return Ct.__awaiter(this,void 0,void 0,function(){var e,t,n,r,i,o,a,s,u,c,h,p=this;return Ct.__generator(this,function(f){switch(f.label){case 0:return l(!this.started,"WebStorageSharedClientState already started"),l(null!==this.syncEngine,"syncEngine property must be set before calling start()"),l(null!==this.onlineStateHandler,"onlineStateHandler property must be set before calling start()"),[4,this.syncEngine.getActiveClients()];case 1:for(e=f.sent(),t=0,n=e;t<n.length;t++)(r=n[t])!==this.localClientId&&(i=this.getItem(this.toWebStorageClientStateKey(r)))&&(o=To.fromWebStorageEntry(r,i))&&(this.activeClients[o.clientId]=o);for(this.persistClientState(),(a=this.storage.getItem(this.onlineStateKey))&&(s=this.fromWebStorageOnlineState(a))&&this.handleOnlineStateEvent(s),u=0,c=this.earlyEvents;u<c.length;u++)h=c[u],this.handleWebStorageEvent(h);return this.earlyEvents=[],this.platform.window.addEventListener("unload",function(){return p.shutdown()}),this.started=!0,[2]}})})},e.prototype.writeSequenceNumber=function(e){this.setItem(this.sequenceNumberKey,JSON.stringify(e))},e.prototype.getAllActiveQueryTargets=function(){var e=se();return y(this.activeClients,function(t,n){e=e.unionWith(n.activeTargetIds)}),e},e.prototype.isActiveQueryTarget=function(e){for(var t in this.activeClients)if(this.activeClients.hasOwnProperty(t)&&this.activeClients[t].activeTargetIds.has(e))return!0;return!1},e.prototype.addPendingMutation=function(e){this.persistMutationState(e,"pending")},e.prototype.updateMutationState=function(e,t,n){this.persistMutationState(e,t,n),this.removeMutationState(e)},e.prototype.addLocalQueryTarget=function(e){var t="not-current";if(this.isActiveQueryTarget(e)){var n=this.storage.getItem(this.toWebStorageQueryTargetMetadataKey(e));if(n){var r=Eo.fromWebStorageEntry(e,n);r&&(t=r.state)}}return this.localClientState.addQueryTarget(e),this.persistClientState(),t},e.prototype.removeLocalQueryTarget=function(e){this.localClientState.removeQueryTarget(e),this.persistClientState()},e.prototype.isLocalQueryTarget=function(e){return this.localClientState.activeTargetIds.has(e)},e.prototype.clearQueryState=function(e){this.removeItem(this.toWebStorageQueryTargetMetadataKey(e))},e.prototype.updateQueryState=function(e,t,n){this.persistQueryTargetState(e,t,n)},e.prototype.handleUserChange=function(e,t,n){var r=this;t.forEach(function(e){r.removeMutationState(e)}),this.currentUser=e,n.forEach(function(e){r.addPendingMutation(e)})},e.prototype.setOnlineState=function(e){this.persistOnlineState(e)},e.prototype.shutdown=function(){this.started&&(this.platform.window.removeEventListener("storage",this.storageListener),this.removeItem(this.localClientStorageKey),this.started=!1)},e.prototype.getItem=function(e){var t=this.storage.getItem(e);return a(go,"READ",e,t),t},e.prototype.setItem=function(e,t){a(go,"SET",e,t),this.storage.setItem(e,t)},e.prototype.removeItem=function(e){a(go,"REMOVE",e),this.storage.removeItem(e)},e.prototype.handleWebStorageEvent=function(e){var t=this;if(e.storageArea===this.storage){if(a(go,"EVENT",e.key,e.newValue),e.key===this.localClientStorageKey)return void s("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.queue.enqueueAndForget(function(){return Ct.__awaiter(t,void 0,void 0,function(){var t,n,r,i,o,a;return Ct.__generator(this,function(s){if(!this.started)return this.earlyEvents.push(e),[2];if(null===e.key)return[2];if(this.clientStateKeyRe.test(e.key)){if(null==e.newValue)return n=this.fromWebStorageClientStateKey(e.key),[2,this.handleClientStateEvent(n,null)];if(t=this.fromWebStorageClientState(e.key,e.newValue))return[2,this.handleClientStateEvent(t.clientId,t)]}else if(this.mutationBatchKeyRe.test(e.key)){if(null!==e.newValue&&(r=this.fromWebStorageMutationMetadata(e.key,e.newValue)))return[2,this.handleMutationBatchEvent(r)]}else if(this.queryTargetKeyRe.test(e.key)){if(null!==e.newValue&&(i=this.fromWebStorageQueryTargetMetadata(e.key,e.newValue)))return[2,this.handleQueryTargetEvent(i)]}else if(e.key===this.onlineStateKey){if(null!==e.newValue&&(o=this.fromWebStorageOnlineState(e.newValue)))return[2,this.handleOnlineStateEvent(o)]}else e.key===this.sequenceNumberKey&&(l(!!this.sequenceNumberHandler,"Missing sequenceNumberHandler"),(a=rt(e.newValue))!==Or.INVALID&&this.sequenceNumberHandler(a));return[2]})})})}},Object.defineProperty(e.prototype,"localClientState",{get:function(){return this.activeClients[this.localClientId]},enumerable:!0,configurable:!0}),e.prototype.persistClientState=function(){this.setItem(this.localClientStorageKey,this.localClientState.toWebStorageJSON())},e.prototype.persistMutationState=function(e,t,n){var r=new ko(this.currentUser,e,t,n),i=this.toWebStorageMutationBatchKey(e);this.setItem(i,r.toWebStorageJSON())},e.prototype.removeMutationState=function(e){var t=this.toWebStorageMutationBatchKey(e);this.removeItem(t)},e.prototype.persistOnlineState=function(e){var t={clientId:this.localClientId,onlineState:Hi[e]};this.storage.setItem(this.onlineStateKey,JSON.stringify(t))},e.prototype.persistQueryTargetState=function(e,t,n){var r=this.toWebStorageQueryTargetMetadataKey(e),i=new Eo(e,t,n);this.setItem(r,i.toWebStorageJSON())},e.prototype.toWebStorageClientStateKey=function(e){return l(-1===e.indexOf("_"),"Client key cannot contain '_', but was '"+e+"'"),yo+"_"+this.persistenceKey+"_"+e},e.prototype.toWebStorageQueryTargetMetadataKey=function(e){return bo+"_"+this.persistenceKey+"_"+e},e.prototype.toWebStorageMutationBatchKey=function(e){var t=vo+"_"+this.persistenceKey+"_"+e;return this.currentUser.isAuthenticated()&&(t+="_"+this.currentUser.uid),t},e.prototype.fromWebStorageClientStateKey=function(e){var t=this.clientStateKeyRe.exec(e);return t?t[1]:null},e.prototype.fromWebStorageClientState=function(e,t){var n=this.fromWebStorageClientStateKey(e);return l(null!==n,"Cannot parse client state key '"+e+"'"),To.fromWebStorageEntry(n,t)},e.prototype.fromWebStorageMutationMetadata=function(e,t){var n=this.mutationBatchKeyRe.exec(e);l(null!==n,"Cannot parse mutation batch key '"+e+"'");var r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return ko.fromWebStorageEntry(new mo(i),r,t)},e.prototype.fromWebStorageQueryTargetMetadata=function(e,t){var n=this.queryTargetKeyRe.exec(e);l(null!==n,"Cannot parse query target key '"+e+"'");var r=Number(n[1]);return Eo.fromWebStorageEntry(r,t)},e.prototype.fromWebStorageOnlineState=function(e){return So.fromWebStorageEntry(e)},e.prototype.handleMutationBatchEvent=function(e){return Ct.__awaiter(this,void 0,void 0,function(){return Ct.__generator(this,function(t){return e.user.uid!==this.currentUser.uid?(a(go,"Ignoring mutation for non-active user "+e.user.uid),[2]):[2,this.syncEngine.applyBatchState(e.batchId,e.state,e.error)]})})},e.prototype.handleQueryTargetEvent=function(e){return this.syncEngine.applyTargetState(e.targetId,e.state,e.error)},e.prototype.handleClientStateEvent=function(e,t){var n=this,r=this.getAllActiveQueryTargets();t?this.activeClients[e]=t:delete this.activeClients[e];var i=this.getAllActiveQueryTargets(),o=[],a=[];return i.forEach(function(e){return Ct.__awaiter(n,void 0,void 0,function(){return Ct.__generator(this,function(t){return r.has(e)||o.push(e),[2]})})}),r.forEach(function(e){return Ct.__awaiter(n,void 0,void 0,function(){return Ct.__generator(this,function(t){return i.has(e)||a.push(e),[2]})})}),this.syncEngine.applyActiveTargetsChange(o,a)},e.prototype.handleOnlineStateEvent=function(e){this.activeClients[e.clientId]&&this.onlineStateHandler(e.onlineState)},e}(),No=function(){function e(){this.localState=new Co,this.queryState={},this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null}return e.prototype.addPendingMutation=function(e){},e.prototype.updateMutationState=function(e,t,n){},e.prototype.addLocalQueryTarget=function(e){return this.localState.addQueryTarget(e),this.queryState[e]||"not-current"},e.prototype.updateQueryState=function(e,t,n){this.queryState[e]=t},e.prototype.removeLocalQueryTarget=function(e){this.localState.removeQueryTarget(e)},e.prototype.isLocalQueryTarget=function(e){return this.localState.activeTargetIds.has(e)},e.prototype.clearQueryState=function(e){delete this.queryState[e]},e.prototype.getAllActiveQueryTargets=function(){return this.localState.activeTargetIds},e.prototype.isActiveQueryTarget=function(e){return this.localState.activeTargetIds.has(e)},e.prototype.start=function(){return this.localState=new Co,Promise.resolve()},e.prototype.handleUserChange=function(e,t,n){},e.prototype.setOnlineState=function(e){},e.prototype.shutdown=function(){},e.prototype.writeSequenceNumber=function(e){},e}(),Do=function(){function e(e,t,n,r){this.platform=e,this.databaseInfo=t,this.credentials=n,this.asyncQueue=r,this.clientId=Pt.newId()}return e.prototype.start=function(e){var t=this,n=new Pr,r=new Pr,i=!1;return this.credentials.setChangeListener(function(o){i?t.asyncQueue.enqueueAndForget(function(){return t.handleCredentialChange(o)}):(i=!0,t.initializePersistence(e,r,o).then(function(){return t.initializeRest(o)}).then(n.resolve,n.reject))}),this.asyncQueue.enqueueAndForget(function(){return n.promise}),r.promise},e.prototype.enableNetwork=function(){var e=this;return this.asyncQueue.enqueue(function(){return e.syncEngine.enableNetwork()})},e.prototype.initializePersistence=function(e,t,n){var r=this;return e.enabled?this.startIndexedDbPersistence(n,e).then(t.resolve).catch(function(e){return t.reject(e),r.canFallback(e)?(console.warn("Error enabling offline storage. Falling back to storage disabled: "+e),r.startMemoryPersistence()):Promise.reject(e)}):(t.resolve(),this.startMemoryPersistence())},e.prototype.canFallback=function(e){return e instanceof Ot?e.code===xt.FAILED_PRECONDITION||e.code===xt.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code},e.prototype.startIndexedDbPersistence=function(e,t){var n=this;l(t.enabled,"Should only start IndexedDb persitence with offline persistence enabled.");var r=Ai.buildStoragePrefix(this.databaseInfo),i=new br(this.databaseInfo.databaseId,{useProto3Json:!0});return Promise.resolve().then(function(){return Ct.__awaiter(n,void 0,void 0,function(){var n,o;return Ct.__generator(this,function(a){switch(a.label){case 0:if(t.experimentalTabSynchronization&&!Io.isAvailable(this.platform))throw new Ot(xt.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");return t.experimentalTabSynchronization?(this.sharedClientState=new Io(this.asyncQueue,this.platform,r,this.clientId,e),n=this,[4,Ai.createMultiClientIndexedDbPersistence(r,this.clientId,this.platform,this.asyncQueue,i,{sequenceNumberSyncer:this.sharedClientState})]):[3,2];case 1:return n.persistence=a.sent(),[3,4];case 2:return this.sharedClientState=new No,o=this,[4,Ai.createIndexedDbPersistence(r,this.clientId,this.platform,this.asyncQueue,i)];case 3:o.persistence=a.sent(),a.label=4;case 4:return[2]}})})})},e.prototype.startMemoryPersistence=function(){var e=new br(this.databaseInfo.databaseId,{useProto3Json:!0});return this.persistence=qi.createEagerPersistence(this.clientId,e),this.sharedClientState=new No,Promise.resolve()},e.prototype.initializeRest=function(e){var t=this;return a("FirestoreClient","Initializing. user=",e.uid),this.platform.loadConnection(this.databaseInfo).then(function(n){return Ct.__awaiter(t,void 0,void 0,function(){var t,r,i,o,a=this;return Ct.__generator(this,function(s){switch(s.label){case 0:return this.localStore=new Li(this.persistence,e),t=this.platform.newSerializer(this.databaseInfo.databaseId),r=new Ji(this.asyncQueue,n,this.credentials,t),i=function(e){return a.syncEngine.applyOnlineStateChange(e,eo.RemoteStore)},o=function(e){return a.syncEngine.applyOnlineStateChange(e,eo.SharedClientState)},this.remoteStore=new ro(this.localStore,r,this.asyncQueue,i),this.syncEngine=new fo(this.localStore,this.remoteStore,this.sharedClientState,e),this.sharedClientState.onlineStateHandler=o,this.remoteStore.syncEngine=this.syncEngine,this.sharedClientState.syncEngine=this.syncEngine,this.eventMgr=new oo(this.syncEngine),[4,this.sharedClientState.start()];case 1:return s.sent(),[4,this.remoteStore.start()];case 2:return s.sent(),[4,this.persistence.setPrimaryStateListener(function(e){return a.syncEngine.applyPrimaryState(e)})];case 3:return s.sent(),[2]}})})})},e.prototype.handleCredentialChange=function(e){return this.asyncQueue.verifyOperationInProgress(),a("FirestoreClient","Credential Changed. Current user: "+e.uid),this.syncEngine.handleCredentialChange(e)},e.prototype.disableNetwork=function(){var e=this;return this.asyncQueue.enqueue(function(){return e.syncEngine.disableNetwork()})},e.prototype.shutdown=function(e){var t=this;return this.asyncQueue.enqueue(function(){return Ct.__awaiter(t,void 0,void 0,function(){return Ct.__generator(this,function(t){switch(t.label){case 0:return[4,this.remoteStore.shutdown()];case 1:return t.sent(),[4,this.sharedClientState.shutdown()];case 2:return t.sent(),[4,this.persistence.shutdown(e&&e.purgePersistenceWithDataLoss)];case 3:return t.sent(),this.credentials.removeChangeListener(),[2]}})})})},e.prototype.listen=function(e,t,n){var r=this,i=new ao(e,t,n);return this.asyncQueue.enqueueAndForget(function(){return r.eventMgr.listen(i)}),i},e.prototype.unlisten=function(e){var t=this;this.asyncQueue.enqueueAndForget(function(){return t.eventMgr.unlisten(e)})},e.prototype.getDocumentFromLocalCache=function(e){var t=this;return this.asyncQueue.enqueue(function(){return t.localStore.readDocument(e)}).then(function(e){if(e instanceof Qt)return e;if(e instanceof Gt)return null;throw new Ot(xt.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")})},e.prototype.getDocumentsFromLocalCache=function(e){var t=this;return this.asyncQueue.enqueue(function(){return t.localStore.executeQuery(e)}).then(function(t){var n=ae(),r=new lo(e,n),i=r.computeDocChanges(t);return r.applyChanges(i,!1).snapshot})},e.prototype.write=function(e){var t=this,n=new Pr;return this.asyncQueue.enqueueAndForget(function(){return t.syncEngine.write(e,n)}),n.promise},e.prototype.databaseId=function(){return this.databaseInfo.databaseId},e.prototype.transaction=function(e){var t=this;return this.asyncQueue.enqueue(function(){return Ct.__awaiter(t,void 0,void 0,function(){return Ct.__generator(this,function(e){return[2]})})}).then(function(){return t.syncEngine.runTransaction(e)})},e}(),Ao=function(){function e(e){this.observer=e,this.muted=!1}return e.prototype.next=function(e){this.scheduleEvent(this.observer.next,e)},e.prototype.error=function(e){this.scheduleEvent(this.observer.error,e)},e.prototype.mute=function(){this.muted=!0},e.prototype.scheduleEvent=function(e,t){var n=this;this.muted||setTimeout(function(){n.muted||e(t)},0)},e}(),xo=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];E("FieldPath",e,"fieldNames",1);for(var n=0;n<e.length;++n)if(T("FieldPath","string",n,e[n]),0===e[n].length)throw new Ot(xt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Wt(e)}return e.documentId=function(){return e._DOCUMENT_ID},e.prototype.isEqual=function(t){if(!(t instanceof e))throw j("isEqual","FieldPath",1,t);return this._internalPath.isEqual(t._internalPath)},e._DOCUMENT_ID=new e(Wt.keyField().canonicalString()),e}(),Oo=new RegExp("[~\\*/\\[\\]]"),Po=function(e,t){this.user=t,this.type="OAuth",this.authHeaders={Authorization:"Bearer "+e}},Ro=function(){function e(){this.changeListener=null}return e.prototype.getToken=function(){return Promise.resolve(null)},e.prototype.invalidateToken=function(){},e.prototype.setChangeListener=function(e){l(!this.changeListener,"Can only call setChangeListener() once."),this.changeListener=e,e(mo.UNAUTHENTICATED)},e.prototype.removeChangeListener=function(){l(null!==this.changeListener,"removeChangeListener() when no listener registered"),this.changeListener=null},e}(),Lo=function(){function e(e){var t=this;this.app=e,this.tokenListener=null,this.tokenCounter=0,this.changeListener=null,this.forceRefresh=!1,this.tokenListener=function(){t.tokenCounter++,t.currentUser=t.getUser(),t.changeListener&&t.changeListener(t.currentUser)},this.tokenCounter=0,this.app.INTERNAL.addAuthTokenListener(this.tokenListener)}return e.prototype.getToken=function(){var e=this;l(null!=this.tokenListener,"getToken cannot be called after listener removed.");var t=this.tokenCounter,n=this.forceRefresh;return this.forceRefresh=!1,this.app.INTERNAL.getToken(n).then(function(n){if(e.tokenCounter!==t)throw new Ot(xt.ABORTED,"getToken aborted due to token change.");return n?(l("string"==typeof n.accessToken,"Invalid tokenData returned from getToken():"+n),new Po(n.accessToken,e.currentUser)):null})},e.prototype.invalidateToken=function(){this.forceRefresh=!0},e.prototype.setChangeListener=function(e){l(!this.changeListener,"Can only call setChangeListener() once."),this.changeListener=e,this.currentUser&&e(this.currentUser)},e.prototype.removeChangeListener=function(){l(null!=this.tokenListener,"removeChangeListener() called twice"),l(null!==this.changeListener,"removeChangeListener() called when no listener registered"),this.app.INTERNAL.removeAuthTokenListener(this.tokenListener),this.tokenListener=null,this.changeListener=null},e.prototype.getUser=function(){var e=this.app.INTERNAL.getUid();return l(null===e||"string"==typeof e,"Received invalid UID: "+e),new mo(e)},e}(),Mo=function(){function e(e,t){this.gapi=e,this.sessionIndex=t,this.type="FirstParty",this.user=mo.FIRST_PARTY,l(this.gapi&&this.gapi.auth&&this.gapi.auth.getAuthHeaderValueForFirstParty,"unexpected gapi interface")}return Object.defineProperty(e.prototype,"authHeaders",{get:function(){return{Authorization:this.gapi.auth.getAuthHeaderValueForFirstParty([]),"X-Goog-AuthUser":this.sessionIndex}},enumerable:!0,configurable:!0}),e}(),Vo=function(){function e(e,t){this.gapi=e,this.sessionIndex=t,l(this.gapi&&this.gapi.auth&&this.gapi.auth.getAuthHeaderValueForFirstParty,"unexpected gapi interface")}return e.prototype.getToken=function(){return Promise.resolve(new Mo(this.gapi,this.sessionIndex))},e.prototype.setChangeListener=function(e){e(mo.FIRST_PARTY)},e.prototype.removeChangeListener=function(){},e.prototype.invalidateToken=function(){},e}(),jo=function(){function e(e){this._methodName=e}return e.delete=function(){return Uo.instance},e.serverTimestamp=function(){return qo.instance},e.arrayUnion=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return w("FieldValue.arrayUnion",arguments,1),new Fo(e)},e.arrayRemove=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return w("FieldValue.arrayRemove",arguments,1),new Bo(e)},e.prototype.isEqual=function(e){return this===e},e}(),Uo=function(e){function t(){return e.call(this,"FieldValue.delete")||this}return Ct.__extends(t,e),t.instance=new t,t}(jo),qo=function(e){function t(){return e.call(this,"FieldValue.serverTimestamp")||this}return Ct.__extends(t,e),t.instance=new t,t}(jo),Fo=function(e){function t(t){var n=e.call(this,"FieldValue.arrayUnion")||this;return n._elements=t,n}return Ct.__extends(t,e),t}(jo),Bo=function(e){function t(t){var n=e.call(this,"FieldValue.arrayRemove")||this;return n._elements=t,n}return Ct.__extends(t,e),t}(jo),Ko=p(jo,"Use FieldValue.<field>() instead."),Wo=/^__.*__$/,Ho=function(){function e(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}return e.prototype.toMutations=function(e,t){var n=[];return null!==this.fieldMask?n.push(new Wn(e,this.data,this.fieldMask,t)):n.push(new Kn(e,this.data,t)),this.fieldTransforms.length>0&&n.push(new Hn(e,this.fieldTransforms)),n},e}(),zo=function(){function e(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}return e.prototype.toMutations=function(e,t){var n=[new Wn(e,this.data,this.fieldMask,t)];return this.fieldTransforms.length>0&&n.push(new Hn(e,this.fieldTransforms)),n},e}();!function(e){e[e.Set=0]="Set",e[e.Update=1]="Update",e[e.MergeSet=2]="MergeSet",e[e.Argument=3]="Argument"}(to||(to={}));var Qo=function(){function e(e,t,n,r,i,o){this.dataSource=e,this.methodName=t,this.path=n,this.arrayElement=r,void 0===i&&this.validatePath(),this.arrayElement=void 0!==r&&r,this.fieldTransforms=i||[],this.fieldMask=o||[]}return e.prototype.childContextForField=function(t){var n=null==this.path?null:this.path.child(t),r=new e(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePathSegment(t),r},e.prototype.childContextForFieldPath=function(t){var n=null==this.path?null:this.path.child(t),r=new e(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePath(),r},e.prototype.childContextForArray=function(t){return new e(this.dataSource,this.methodName,null,!0,this.fieldTransforms,this.fieldMask)},e.prototype.createError=function(e){var t=null===this.path||this.path.isEmpty()?"":" (found in field "+this.path.toString()+")";return new Ot(xt.INVALID_ARGUMENT,"Function "+this.methodName+"() called with invalid data. "+e+t)},e.prototype.contains=function(e){return void 0!==this.fieldMask.find(function(t){return e.isPrefixOf(t)})||void 0!==this.fieldTransforms.find(function(t){return e.isPrefixOf(t.field)})},e.prototype.validatePath=function(){if(null!==this.path)for(var e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))},e.prototype.validatePathSegment=function(e){if(ut(this.dataSource)&&Wo.test(e))throw this.createError("Document fields cannot begin and end with __")},e}(),Go=function(e,t){this.databaseId=e,this.key=t},Xo=function(){function e(e){this.preConverter=e}return e.prototype.parseSetData=function(e,t){var n=new Qo(to.Set,e,Wt.EMPTY_PATH);lt("Data must be an object, but it was:",n,t);var r=this.parseData(t,n);return new Ho(r,null,n.fieldTransforms)},e.prototype.parseMergeData=function(e,t,n){var r=new Qo(to.MergeSet,e,Wt.EMPTY_PATH);lt("Data must be an object, but it was:",r,t);var i,o,a=this.parseData(t,r);if(n){for(var s=[],u=0,l=n;u<l.length;u++){var h=l[u],p=void 0;if(h instanceof xo)p=h._internalPath;else{if("string"!=typeof h)throw c("Expected stringOrFieldPath to be a string or a FieldPath");p=pt(e,h)}if(!r.contains(p))throw new Ot(xt.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");s.push(p)}i=new Vn(s),o=r.fieldTransforms.filter(function(e){return i.covers(e.field)})}else i=new Vn(r.fieldMask),o=r.fieldTransforms;return new Ho(a,i,o)},e.prototype.parseUpdateData=function(e,t){var n=this,r=new Qo(to.Update,e,Wt.EMPTY_PATH);lt("Data must be an object, but it was:",r,t);var i=[],o=yn.EMPTY;y(t,function(t,a){var s=pt(e,t),u=r.childContextForFieldPath(s);if((a=n.runPreConverter(a,u))instanceof Uo)i.push(s);else{var c=n.parseData(a,u);null!=c&&(i.push(s),o=o.set(s,c))}});var a=new Vn(i);return new zo(o,a,r.fieldTransforms)},e.prototype.parseUpdateVarargs=function(e,t,n,r){var i=new Qo(to.Update,e,Wt.EMPTY_PATH),o=[ht(e,t)],a=[n];if(r.length%2!=0)throw new Ot(xt.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(c=0;c<r.length;c+=2)o.push(ht(e,r[c])),a.push(r[c+1]);for(var s=[],u=yn.EMPTY,c=0;c<o.length;++c){var l=o[c],h=i.childContextForFieldPath(l),p=this.runPreConverter(a[c],h);if(p instanceof Uo)s.push(l);else{var f=this.parseData(p,h);null!=f&&(s.push(l),u=u.set(l,f))}}var d=new Vn(s);return new zo(u,d,i.fieldTransforms)},e.prototype.parseQueryValue=function(e,t){var n=new Qo(to.Argument,e,Wt.EMPTY_PATH),r=this.parseData(t,n);return l(null!=r,"Parsed data should not be null."),l(0===n.fieldTransforms.length,"Field transforms should have been disallowed."),r},e.prototype.runPreConverter=function(e,t){try{return this.preConverter(e)}catch(e){var n=ft(e);throw t.createError(n)}},e.prototype.parseData=function(e,t){if(e=this.runPreConverter(e,t),ct(e))return lt("Unsupported field value:",t,e),this.parseObject(e,t);if(e instanceof jo)return this.parseSentinelFieldValue(e,t),null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.arrayElement)throw t.createError("Nested arrays are not supported");return this.parseArray(e,t)}return this.parseScalarValue(e,t)},e.prototype.parseObject=function(e,t){var n=this,r=new Yt(F);return v(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):y(e,function(e,i){var o=n.parseData(i,t.childContextForField(e));null!=o&&(r=r.insert(e,o))}),new yn(r)},e.prototype.parseArray=function(e,t){for(var n=[],r=0,i=0,o=e;i<o.length;i++){var a=o[i],s=this.parseData(a,t.childContextForArray(r));null==s&&(s=an.INSTANCE),n.push(s),r++}return new vn(n)},e.prototype.parseSentinelFieldValue=function(e,t){if(!ut(t.dataSource))throw t.createError(e._methodName+"() can only be used with update() and set()");if(null===t.path)throw t.createError(e._methodName+"() is not currently supported inside arrays");if(e instanceof Uo){if(t.dataSource!==to.MergeSet)throw t.dataSource===to.Update?(l(t.path.length>0,"FieldValue.delete() at the top level should have already been handled."),t.createError("FieldValue.delete() can only appear at the top level of your update data")):t.createError("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");t.fieldMask.push(t.path)}else if(e instanceof qo)t.fieldTransforms.push(new jn(t.path,Qn.instance));else if(e instanceof Fo){var n=this.parseArrayTransformElements(e._methodName,e._elements),r=new Gn(n);t.fieldTransforms.push(new jn(t.path,r))}else if(e instanceof Bo){var n=this.parseArrayTransformElements(e._methodName,e._elements),i=new Xn(n);t.fieldTransforms.push(new jn(t.path,i))}else c("Unknown FieldValue type: "+e)},e.prototype.parseScalarValue=function(e,t){if(null===e)return an.INSTANCE;if("number"==typeof e)return Y(e)?new cn(e):new ln(e);if("boolean"==typeof e)return sn.of(e);if("string"==typeof e)return new hn(e);if(e instanceof Date)return new pn(Vt.fromDate(e));if(e instanceof Vt)return new pn(new Vt(e.seconds,1e3*Math.floor(e.nanoseconds/1e3)));if(e instanceof Mt)return new gn(e);if(e instanceof Rt)return new dn(e);if(e instanceof Go)return new mn(e.databaseId,e.key);throw t.createError("Unsupported field value: "+R(e))},e.prototype.parseArrayTransformElements=function(e,t){var n=this;return t.map(function(t,r){var i=new Qo(to.Argument,e,Wt.EMPTY_PATH);return n.parseData(t,i.childContextForArray(r))})},e}(),Yo="firestore.googleapis.com",$o=!0,Jo=!1,Zo=!1,ea=function(){function e(e){if(void 0===e.host){if(void 0!==e.ssl)throw new Ot(xt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Yo,this.ssl=$o}else C("settings","non-empty string","host",e.host),this.host=e.host,I("settings","boolean","ssl",e.ssl),this.ssl=d(e.ssl,$o);V("settings",e,["host","ssl","credentials","timestampsInSnapshots"]),I("settings","object","credentials",e.credentials),this.credentials=e.credentials,I("settings","boolean","timestampsInSnapshots",e.timestampsInSnapshots),this.timestampsInSnapshots=d(e.timestampsInSnapshots,Jo)}return e.prototype.isEqual=function(e){return this.host===e.host&&this.ssl===e.ssl&&this.timestampsInSnapshots===e.timestampsInSnapshots&&this.credentials===e.credentials},e}(),ta=function(){},na=function(){function e(e,t){this.enabled=e,l(e||!t,"Can only provide PersistenceSettings with persistence enabled"),t=t||{},this.experimentalTabSynchronization=d(t.experimentalTabSynchronization,Zo)}return e.prototype.isEqual=function(e){return this.enabled===e.enabled&&this.experimentalTabSynchronization===e.experimentalTabSynchronization},e}(),ra=function(){function e(t){var n=this;this._queue=new Mr,this.INTERNAL={delete:function(e){return Ct.__awaiter(n,void 0,void 0,function(){return Ct.__generator(this,function(t){return this._firestoreClient?[2,this._firestoreClient.shutdown(e)]:[2]})})}};var r=new ta;if("object"==typeof t.options){var i=t;r.firebaseApp=i,r.databaseId=e.databaseIdFromApp(i),r.persistenceKey=r.firebaseApp.name,r.credentials=new Lo(i)}else{var o=t;if(!o.projectId)throw new Ot(xt.INVALID_ARGUMENT,"Must provide projectId");r.databaseId=new qt(o.projectId,o.database),r.persistenceKey="[DEFAULT]",r.credentials=new Ro}r.settings=new ea({}),this._config=r,this._databaseId=r.databaseId}return e.prototype.settings=function(e){if(_("Firestore.settings",arguments,1),T("Firestore.settings","object",1,e),f(e,"persistence"))throw new Ot(xt.INVALID_ARGUMENT,'"persistence" is now specified with a separate call to firestore.enablePersistence().');var t=new ea(e);if(this._firestoreClient&&!this._config.settings.isEqual(t))throw new Ot(xt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");this._config.settings=t,void 0!==t.credentials&&(this._config.credentials=ot(t.credentials))},e.prototype.enableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.enableNetwork()},e.prototype.disableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.disableNetwork()},e.prototype.enablePersistence=function(e){if(this._firestoreClient)throw new Ot(xt.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");return this.configureClient(new na(!0,e))},e.prototype.ensureClientConfigured=function(){return this._firestoreClient||this.configureClient(new na(!1)),this._firestoreClient},e.prototype.configureClient=function(e){var t=this;l(!!this._config.settings.host,"FirestoreSettings.host cannot be falsey"),this._config.settings.timestampsInSnapshots||s("\nThe behavior for Date objects stored in Firestore is going to change\nAND YOUR APP MAY BREAK.\nTo hide this warning and ensure your app does not break, you need to add the\nfollowing code to your app before calling any other Cloud Firestore methods:\n\n  const firestore = firebase.firestore();\n  const settings = {/* your settings... */ timestampsInSnapshots: true};\n  firestore.settings(settings);\n\nWith this change, timestamps stored in Cloud Firestore will be read back as\nFirebase Timestamp objects instead of as system Date objects. So you will also\nneed to update code expecting a Date to instead expect a Timestamp. For example:\n\n  // Old:\n  const date = snapshot.get('created_at');\n  // New:\n  const timestamp = snapshot.get('created_at');\n  const date = timestamp.toDate();\n\nPlease audit all existing usages of Date when you enable the new behavior. In a\nfuture release, the behavior will change to the new behavior, so if you do not\nfollow these steps, YOUR APP MAY BREAK."),l(!this._firestoreClient,"configureClient() called multiple times");var n=new jt(this._config.databaseId,this._config.persistenceKey,this._config.settings.host,this._config.settings.ssl);return this._dataConverter=new Xo(function(e){if(e instanceof aa){var n=t._config.databaseId,r=e.firestore._config.databaseId;if(!r.isEqual(n))throw new Ot(xt.INVALID_ARGUMENT,"Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return new Go(t._config.databaseId,e._key)}return e}),this._firestoreClient=new Do(At.getPlatform(),n,this._config.credentials,this._queue),this._firestoreClient.start(e)},e.databaseIdFromApp=function(e){var t=e.options;if(!f(t,"projectId"))throw new Ot(xt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var n=t.projectId;if(!n||"string"!=typeof n)throw new Ot(xt.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new qt(n)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this._config.firebaseApp)throw new Ot(xt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._config.firebaseApp},enumerable:!0,configurable:!0}),e.prototype.collection=function(e){if(_("Firestore.collection",arguments,1),T("Firestore.collection","non-empty string",1,e),!e)throw new Ot(xt.INVALID_ARGUMENT,"Must provide a non-empty collection path to collection()");return this.ensureClientConfigured(),new pa(Bt.fromString(e),this)},e.prototype.doc=function(e){if(_("Firestore.doc",arguments,1),T("Firestore.doc","non-empty string",1,e),!e)throw new Ot(xt.INVALID_ARGUMENT,"Must provide a non-empty document path to doc()");return this.ensureClientConfigured(),aa.forPath(Bt.fromString(e),this)},e.prototype.runTransaction=function(e){var t=this;return _("Firestore.runTransaction",arguments,1),T("Firestore.runTransaction","function",1,e),this.ensureClientConfigured().transaction(function(n){return e(new ia(t,n))})},e.prototype.batch=function(){return this.ensureClientConfigured(),new oa(this)},Object.defineProperty(e,"logLevel",{get:function(){switch(i()){case Et.DEBUG:return"debug";case Et.ERROR:return"error";case Et.SILENT:return"silent";default:return c("Unknown log level: "+i())}},enumerable:!0,configurable:!0}),e.setLogLevel=function(e){switch(_("Firestore.setLogLevel",arguments,1),T("Firestore.setLogLevel","non-empty string",1,e),e){case"debug":o(Et.DEBUG);break;case"error":o(Et.ERROR);break;case"silent":o(Et.SILENT);break;default:throw new Ot(xt.INVALID_ARGUMENT,"Invalid log level: "+e)}},e.prototype._areTimestampsInSnapshotsEnabled=function(){return this._config.settings.timestampsInSnapshots},e}(),ia=function(){function e(e,t){this._firestore=e,this._transaction=t}return e.prototype.get=function(e){var t=this;_("Transaction.get",arguments,1);var n=vt("Transaction.get",e,this._firestore);return this._transaction.lookup([n._key]).then(function(e){if(!e||1!==e.length)return c("Mismatch in docs returned from document lookup.");var r=e[0];if(r instanceof Gt)return new ua(t._firestore,n._key,null,!1,!1);if(r instanceof Qt)return new ua(t._firestore,n._key,r,!1,!1);throw c("BatchGetDocumentsRequest returned unexpected document type: "+r.constructor.name)})},e.prototype.set=function(e,t,n){k("Transaction.set",arguments,2,3);var r=vt("Transaction.set",e,this._firestore),i=(n=mt("Transaction.set",n)).merge||n.mergeFields?this._firestore._dataConverter.parseMergeData("Transaction.set",t,n.mergeFields):this._firestore._dataConverter.parseSetData("Transaction.set",t);return this._transaction.set(r._key,i),this},e.prototype.update=function(e,t,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,a;return"string"==typeof t||t instanceof xo?(w("Transaction.update",arguments,3),o=vt("Transaction.update",e,this._firestore),a=this._firestore._dataConverter.parseUpdateVarargs("Transaction.update",t,n,r)):(_("Transaction.update",arguments,2),o=vt("Transaction.update",e,this._firestore),a=this._firestore._dataConverter.parseUpdateData("Transaction.update",t)),this._transaction.update(o._key,a),this},e.prototype.delete=function(e){_("Transaction.delete",arguments,1);var t=vt("Transaction.delete",e,this._firestore);return this._transaction.delete(t._key),this},e}(),oa=function(){function e(e){this._firestore=e,this._mutations=[],this._committed=!1}return e.prototype.set=function(e,t,n){k("WriteBatch.set",arguments,2,3),this.verifyNotCommitted();var r=vt("WriteBatch.set",e,this._firestore),i=(n=mt("WriteBatch.set",n)).merge||n.mergeFields?this._firestore._dataConverter.parseMergeData("WriteBatch.set",t,n.mergeFields):this._firestore._dataConverter.parseSetData("WriteBatch.set",t);return this._mutations=this._mutations.concat(i.toMutations(r._key,Fn.NONE)),this},e.prototype.update=function(e,t,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.verifyNotCommitted();var o,a;return"string"==typeof t||t instanceof xo?(w("WriteBatch.update",arguments,3),o=vt("WriteBatch.update",e,this._firestore),a=this._firestore._dataConverter.parseUpdateVarargs("WriteBatch.update",t,n,r)):(_("WriteBatch.update",arguments,2),o=vt("WriteBatch.update",e,this._firestore),a=this._firestore._dataConverter.parseUpdateData("WriteBatch.update",t)),this._mutations=this._mutations.concat(a.toMutations(o._key,Fn.exists(!0))),this},e.prototype.delete=function(e){_("WriteBatch.delete",arguments,1),this.verifyNotCommitted();var t=vt("WriteBatch.delete",e,this._firestore);return this._mutations=this._mutations.concat(new zn(t._key,Fn.NONE)),this},e.prototype.commit=function(){return Ct.__awaiter(this,void 0,void 0,function(){return Ct.__generator(this,function(e){return this.verifyNotCommitted(),this._committed=!0,this._mutations.length>0?[2,this._firestore.ensureClientConfigured().write(this._mutations)]:[2]})})},e.prototype.verifyNotCommitted=function(){if(this._committed)throw new Ot(xt.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},e}(),aa=function(){function e(e,t){this._key=e,this.firestore=t,this._firestoreClient=this.firestore.ensureClientConfigured()}return e.forPath=function(t,n){if(t.length%2!=0)throw new Ot(xt.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.canonicalString()+" has "+t.length);return new e(new Ht(t),n)},Object.defineProperty(e.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new pa(this._key.path.popLast(),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!0,configurable:!0}),e.prototype.collection=function(e){if(_("DocumentReference.collection",arguments,1),T("DocumentReference.collection","non-empty string",1,e),!e)throw new Ot(xt.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var t=Bt.fromString(e);return new pa(this._key.path.child(t),this.firestore)},e.prototype.isEqual=function(t){if(!(t instanceof e))throw j("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this._key.isEqual(t._key)},e.prototype.set=function(e,t){k("DocumentReference.set",arguments,1,2);var n=(t=mt("DocumentReference.set",t)).merge||t.mergeFields?this.firestore._dataConverter.parseMergeData("DocumentReference.set",e,t.mergeFields):this.firestore._dataConverter.parseSetData("DocumentReference.set",e);return this._firestoreClient.write(n.toMutations(this._key,Fn.NONE))},e.prototype.update=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i;return"string"==typeof e||e instanceof xo?(w("DocumentReference.update",arguments,2),i=this.firestore._dataConverter.parseUpdateVarargs("DocumentReference.update",e,t,n)):(_("DocumentReference.update",arguments,1),i=this.firestore._dataConverter.parseUpdateData("DocumentReference.update",e)),this._firestoreClient.write(i.toMutations(this._key,Fn.exists(!0)))},e.prototype.delete=function(){return _("DocumentReference.delete",arguments,0),this._firestoreClient.write([new zn(this._key,Fn.NONE)])},e.prototype.onSnapshot=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];k("DocumentReference.onSnapshot",arguments,1,4);var n,r={includeMetadataChanges:!1},i=0;"object"!=typeof e[i]||at(e[i])||(V("DocumentReference.onSnapshot",r=e[i],["includeMetadataChanges"]),I("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};return at(e[i])?n=e[i]:(T("DocumentReference.onSnapshot","function",i,e[i]),S("DocumentReference.onSnapshot","function",i+1,e[i+1]),S("DocumentReference.onSnapshot","function",i+2,e[i+2]),n={next:e[i],error:e[i+1],complete:e[i+2]}),this.onSnapshotInternal(o,n)},e.prototype.onSnapshotInternal=function(e,t){var n=this,r=function(e){console.error("Uncaught Error in onSnapshot:",e)};t.error&&(r=t.error.bind(t));var i=new Ao({next:function(e){if(t.next){l(e.docs.size<=1,"Too many documents returned on a document query");var r=e.docs.get(n._key);t.next(new ua(n.firestore,n._key,r,e.fromCache,e.hasPendingWrites))}},error:r}),o=this._firestoreClient.listen(En.atPath(this._key.path),i,e);return function(){i.mute(),n._firestoreClient.unlisten(o)}},e.prototype.get=function(e){var t=this;return k("DocumentReference.get",arguments,0,1),yt("DocumentReference.get",e),new Promise(function(n,r){e&&"cache"===e.source?t.firestore.ensureClientConfigured().getDocumentFromLocalCache(t._key).then(function(e){n(new ua(t.firestore,t._key,e,!0,e instanceof Qt&&e.hasLocalMutations))},r):t.getViaSnapshotListener(n,r,e)})},e.prototype.getViaSnapshotListener=function(e,t,n){var r=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){r(),!i.exists&&i.metadata.fromCache?t(new Ot(xt.UNAVAILABLE,"Failed to get document because the client is offline.")):i.exists&&i.metadata.fromCache&&n&&"server"===n.source?t(new Ot(xt.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):e(i)},error:t})},e}(),sa=function(){function e(e,t){this.hasPendingWrites=e,this.fromCache=t}return e.prototype.isEqual=function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache},e}(),ua=function(){function e(e,t,n,r,i){this._firestore=e,this._key=t,this._document=n,this._fromCache=r,this._hasPendingWrites=i}return e.prototype.data=function(e){return k("DocumentSnapshot.data",arguments,0,1),e=gt("DocumentSnapshot.data",e),this._document?this.convertObject(this._document.data,rn.fromSnapshotOptions(e,this._firestore._areTimestampsInSnapshotsEnabled())):void 0},e.prototype.get=function(e,t){if(k("DocumentSnapshot.get",arguments,1,2),t=gt("DocumentSnapshot.get",t),this._document){var n=this._document.data.field(ht("DocumentSnapshot.get",e));if(void 0!==n)return this.convertValue(n,rn.fromSnapshotOptions(t,this._firestore._areTimestampsInSnapshotsEnabled()))}},Object.defineProperty(e.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ref",{get:function(){return new aa(this._key,this._firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return null!==this._document},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return new sa(this._hasPendingWrites,this._fromCache)},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){if(!(t instanceof e))throw j("isEqual","DocumentSnapshot",1,t);return this._firestore===t._firestore&&this._fromCache===t._fromCache&&this._key.isEqual(t._key)&&(null===this._document?null===t._document:this._document.isEqual(t._document))},e.prototype.convertObject=function(e,t){var n=this,r={};return e.forEach(function(e,i){r[e]=n.convertValue(i,t)}),r},e.prototype.convertValue=function(e,t){if(e instanceof yn)return this.convertObject(e,t);if(e instanceof vn)return this.convertArray(e,t);if(e instanceof mn){var n=e.value(t),r=this._firestore.ensureClientConfigured().databaseId();return e.databaseId.isEqual(r)||s("Document "+this._key.path+" contains a document reference within a different database ("+e.databaseId.projectId+"/"+e.databaseId.database+") which is not supported. It will be treated as a reference in the current database ("+r.projectId+"/"+r.database+") instead."),new aa(n,this._firestore)}return e.value(t)},e.prototype.convertArray=function(e,t){var n=this;return e.internalValue.map(function(e){return n.convertValue(e,t)})},e}(),ca=function(e){function t(t,n,r,i,o){return e.call(this,t,n,r,i,o)||this}return Ct.__extends(t,e),t.prototype.data=function(t){var n=e.prototype.data.call(this,t);return l("object"==typeof n,"Document in a QueryDocumentSnapshot should exist"),n},t}(ua),la=function(){function e(e,t){this._query=e,this.firestore=t}return e.prototype.where=function(t,n,r){_("Query.where",arguments,3),T("Query.where","non-empty string",2,n),M("Query.where",3,r);var i,o=ht("Query.where",t),a=Sn.fromString(n);if(o.isKeyField()){if(a===Sn.ARRAY_CONTAINS)throw new Ot(xt.INVALID_ARGUMENT,"Invalid Query. You can't perform array-contains queries on FieldPath.documentId() since document IDs are not arrays.");if("string"==typeof r){if(-1!==r.indexOf("/"))throw new Ot(xt.INVALID_ARGUMENT,"Function Query.where() requires its third parameter to be a valid document ID if the first parameter is FieldPath.documentId(), but it contains a slash.");if(""===r)throw new Ot(xt.INVALID_ARGUMENT,"Function Query.where() requires its third parameter to be a valid document ID if the first parameter is FieldPath.documentId(), but it was an empty string.");var s=this._query.path.child(new Bt([r]));l(s.length%2==0,"Path should be a document key"),i=new mn(this.firestore._databaseId,new Ht(s))}else{if(!(r instanceof aa))throw new Ot(xt.INVALID_ARGUMENT,"Function Query.where() requires its third parameter to be a string or a DocumentReference if the first parameter is FieldPath.documentId(), but it was: "+R(r)+".");var u=r;i=new mn(this.firestore._databaseId,u._key)}}else i=this.firestore._dataConverter.parseQueryValue("Query.where",r);var c=Tn.create(o,a,i);return this.validateNewFilter(c),new e(this._query.addFilter(c),this.firestore)},e.prototype.orderBy=function(t,n){k("Query.orderBy",arguments,1,2),S("Query.orderBy","non-empty string",2,n);var r;if(void 0===n||"asc"===n)r=Dn.ASCENDING;else{if("desc"!==n)throw new Ot(xt.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r=Dn.DESCENDING}if(null!==this._query.startAt)throw new Ot(xt.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this._query.endAt)throw new Ot(xt.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var i=ht("Query.orderBy",t),o=new xn(i,r);return this.validateNewOrderBy(o),new e(this._query.addOrderBy(o),this.firestore)},e.prototype.limit=function(t){if(_("Query.limit",arguments,1),T("Query.limit","number",1,t),t<=0)throw new Ot(xt.INVALID_ARGUMENT,"Invalid Query. Query limit ("+t+") is invalid. Limit must be positive.");return new e(this._query.withLimit(t),this.firestore)},e.prototype.startAt=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];w("Query.startAt",arguments,1);var i=this.boundFromDocOrFields("Query.startAt",t,n,!0);return new e(this._query.withStartAt(i),this.firestore)},e.prototype.startAfter=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];w("Query.startAfter",arguments,1);var i=this.boundFromDocOrFields("Query.startAfter",t,n,!1);return new e(this._query.withStartAt(i),this.firestore)},e.prototype.endBefore=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];w("Query.endBefore",arguments,1);var i=this.boundFromDocOrFields("Query.endBefore",t,n,!0);return new e(this._query.withEndAt(i),this.firestore)},e.prototype.endAt=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];w("Query.endAt",arguments,1);var i=this.boundFromDocOrFields("Query.endAt",t,n,!1);return new e(this._query.withEndAt(i),this.firestore)},e.prototype.isEqual=function(t){if(!(t instanceof e))throw j("isEqual","Query",1,t);return this.firestore===t.firestore&&this._query.isEqual(t._query)},e.prototype.boundFromDocOrFields=function(e,t,n,r){if(M(e,1,t),t instanceof ua){if(n.length>0)throw new Ot(xt.INVALID_ARGUMENT,"Too many arguments provided to "+e+"().");var i=t;if(!i.exists)throw new Ot(xt.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+e+"().");return this.boundFromDocument(e,i._document,r)}var o=[t].concat(n);return this.boundFromFields(e,o,r)},e.prototype.boundFromDocument=function(e,t,n){for(var r=[],i=0,o=this._query.orderBy;i<o.length;i++){var a=o[i];if(a.field.isKeyField())r.push(new mn(this.firestore._databaseId,t.key));else{var s=t.field(a.field);if(void 0===s){var u=a.field.canonicalString();throw new Ot(xt.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}r.push(s)}}return new An(r,n)},e.prototype.boundFromFields=function(e,t,n){var r=this._query.explicitOrderBy;if(t.length>r.length)throw new Ot(xt.INVALID_ARGUMENT,"Too many arguments provided to "+e+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],o=0;o<t.length;o++){var a=t[o];if(r[o].field.isKeyField()){if("string"!=typeof a)throw new Ot(xt.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+e+"(), but got a "+typeof a);if(-1!==a.indexOf("/"))throw new Ot(xt.INVALID_ARGUMENT,"Invalid query. Document ID '"+a+"' contains a slash in "+e+"()");var s=new Ht(this._query.path.child(a));i.push(new mn(this.firestore._databaseId,s))}else{var u=this.firestore._dataConverter.parseQueryValue(e,a);i.push(u)}}return new An(i,n)},e.prototype.onSnapshot=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];k("Query.onSnapshot",arguments,1,4);var n,r={},i=0;return"object"!=typeof e[i]||at(e[i])||(V("Query.onSnapshot",r=e[i],["includeMetadataChanges"]),I("Query.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++),at(e[i])?n=e[i]:(T("Query.onSnapshot","function",i,e[i]),S("Query.onSnapshot","function",i+1,e[i+1]),S("Query.onSnapshot","function",i+2,e[i+2]),n={next:e[i],error:e[i+1],complete:e[i+2]}),this.onSnapshotInternal(r,n)},e.prototype.onSnapshotInternal=function(e,t){var n=this,r=function(e){console.error("Uncaught Error in onSnapshot:",e)};t.error&&(r=t.error.bind(t));var i=new Ao({next:function(e){t.next&&t.next(new ha(n.firestore,n._query,e))},error:r}),o=this.firestore.ensureClientConfigured(),a=o.listen(this._query,i,e);return function(){i.mute(),o.unlisten(a)}},e.prototype.get=function(e){var t=this;return k("Query.get",arguments,0,1),yt("Query.get",e),new Promise(function(n,r){e&&"cache"===e.source?t.firestore.ensureClientConfigured().getDocumentsFromLocalCache(t._query).then(function(e){n(new ha(t.firestore,t._query,e))},r):t.getViaSnapshotListener(n,r,e)})},e.prototype.getViaSnapshotListener=function(e,t,n){var r=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){r(),i.metadata.fromCache&&n&&"server"===n.source?t(new Ot(xt.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):e(i)},error:t})},e.prototype.validateNewFilter=function(e){if(e instanceof Cn)if(e.isInequality()){var t=this._query.getInequalityFilterField();if(null!==t&&!t.isEqual(e.field))throw new Ot(xt.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+t.toString()+"' and '"+e.field.toString()+"'");var n=this._query.getFirstOrderByField();null!==n&&this.validateOrderByAndInequalityMatch(e.field,n)}else if(e.op===Sn.ARRAY_CONTAINS&&this._query.hasArrayContainsFilter())throw new Ot(xt.INVALID_ARGUMENT,"Invalid query. Queries only support a single array-contains filter.")},e.prototype.validateNewOrderBy=function(e){if(null===this._query.getFirstOrderByField()){var t=this._query.getInequalityFilterField();null!==t&&this.validateOrderByAndInequalityMatch(t,e.field)}},e.prototype.validateOrderByAndInequalityMatch=function(e,t){if(!t.isEqual(e))throw new Ot(xt.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+t.toString()+"' instead.")},e}(),ha=function(){function e(e,t,n){this._firestore=e,this._originalQuery=t,this._snapshot=n,this._cachedChanges=null,this._cachedChangesIncludeMetadataChanges=null,this.metadata=new sa(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(e.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this._snapshot.docs.isEmpty()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!0,configurable:!0}),e.prototype.forEach=function(e,t){var n=this;k("QuerySnapshot.forEach",arguments,1,2),T("QuerySnapshot.forEach","function",1,e),this._snapshot.docs.forEach(function(r){e.call(t,n.convertToDocumentImpl(r))})},Object.defineProperty(e.prototype,"query",{get:function(){return new la(this._originalQuery,this._firestore)},enumerable:!0,configurable:!0}),e.prototype.docChanges=function(e){e&&(V("QuerySnapshot.docChanges",e,["includeMetadataChanges"]),I("QuerySnapshot.docChanges","boolean","includeMetadataChanges",e.includeMetadataChanges));var t=!(!e||!e.includeMetadataChanges);if(t&&this._snapshot.excludesMetadataChanges)throw new Ot(xt.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=bt(this._firestore,t,this._snapshot),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges},e.prototype.isEqual=function(t){if(!(t instanceof e))throw j("isEqual","QuerySnapshot",1,t);return this._firestore===t._firestore&&this._originalQuery.isEqual(t._originalQuery)&&this._snapshot.isEqual(t._snapshot)},e.prototype.convertToDocumentImpl=function(e){return new ca(this._firestore,e.key,e,this.metadata.fromCache,this._snapshot.mutatedKeys.has(e.key))},e}();["length","forEach","map"].concat("undefined"!=typeof Symbol?[Symbol.iterator]:[]).forEach(function(e){try{Object.defineProperty(ha.prototype.docChanges,e,{get:function(){return dt()}})}catch(e){}});var pa=function(e){function t(t,n){var r=e.call(this,En.atPath(t),n)||this;if(t.length%2!=1)throw new Ot(xt.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.canonicalString()+" has "+t.length);return r}return Ct.__extends(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=this._query.path.popLast();return e.isEmpty()?null:new aa(new Ht(e),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!0,configurable:!0}),t.prototype.doc=function(e){if(k("CollectionReference.doc",arguments,0,1),0===arguments.length&&(e=Pt.newId()),T("CollectionReference.doc","non-empty string",1,e),""===e)throw new Ot(xt.INVALID_ARGUMENT,"Document path must be a non-empty string");var t=Bt.fromString(e);return aa.forPath(this._query.path.child(t),this.firestore)},t.prototype.add=function(e){_("CollectionReference.add",arguments,1),T("CollectionReference.add","object",1,e);var t=this.doc();return t.set(e).then(function(){return t})},t}(la),fa=p(ra,"Use firebase.firestore() instead."),da=p(ia,"Use firebase.firestore().runTransaction() instead."),ma=p(oa,"Use firebase.firestore().batch() instead."),ga=p(aa,"Use firebase.firestore().doc() instead."),ya=p(ua),va=p(ca),ba=p(la),_a=p(ha),wa=p(pa,"Use firebase.firestore().collection() instead."),ka={Firestore:fa,GeoPoint:Mt,Timestamp:Vt,Blob:Lt,Transaction:da,WriteBatch:ma,DocumentReference:ga,DocumentSnapshot:ya,Query:ba,QueryDocumentSnapshot:va,QuerySnapshot:_a,CollectionReference:wa,FieldPath:xo,FieldValue:Ko,setLogLevel:ra.setLogLevel};kt(Tt),n.registerFirestore=kt}(0,e,t)}),define("@firebase/functions@0.3.3#dist/index.cjs",["require","exports","module","tslib","@firebase/app"],function(e,t,n){"use strict";function r(e){if(e>=200&&e<300)return"ok";switch(e){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function i(e,t,n){var i=r(e),o=i,a=void 0;try{var s=t.error;if(s){var u=s.status;if("string"==typeof u){if(!l[u])return new h("internal","internal");i=l[u]}o=u;var c=s.message;"string"==typeof c&&(o=c),void 0!==(a=s.details)&&(a=n.decode(a))}}catch(e){}return"ok"===i?null:new h(i,o,a)}function o(e,t){var n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]=t(e[r]));return n}function a(e,t,n){return new d(e,n)}function s(e){var t={Functions:d};e.INTERNAL.registerService(m,a,t,void 0,!0)}Object.defineProperty(t,"__esModule",{value:!0});var u=e("tslib"),c=function(e){return e&&"object"==typeof e&&"default"in e?e.default:e}(e("@firebase/app")),l={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},h=function(e){function t(n,r,i){var o=e.call(this,r)||this;return Object.setPrototypeOf(o,t.prototype),o.code=n,o.details=i,o}return u.__extends(t,e),t}(Error),p=function(){function e(e){this.app=e}return e.prototype.getAuthToken=function(){return u.__awaiter(this,void 0,void 0,function(){var e,t;return u.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.app.INTERNAL.getToken()];case 1:return(e=n.sent())?[2,e.accessToken]:[2,void 0];case 2:return t=n.sent(),[2,void 0];case 3:return[2]}})})},e.prototype.getInstanceIdToken=function(){return u.__awaiter(this,void 0,void 0,function(){var e,t,n;return u.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),this.app.messaging?(e=this.app.messaging(),[4,e.getToken()]):[2,void 0];case 1:return(t=r.sent())?[2,t]:[2,void 0];case 2:return n=r.sent(),[2,void 0];case 3:return[2]}})})},e.prototype.getContext=function(){return u.__awaiter(this,void 0,void 0,function(){var e,t;return u.__generator(this,function(n){switch(n.label){case 0:return[4,this.getAuthToken()];case 1:return e=n.sent(),[4,this.getInstanceIdToken()];case 2:return t=n.sent(),[2,{authToken:e,instanceIdToken:t}]}})})},e}(),f=function(){function e(){}return e.prototype.encode=function(e){var t=this;if(null===e||void 0===e)return null;if(e instanceof Number&&(e=e.valueOf()),"number"==typeof e&&isFinite(e))return e;if(!0===e||!1===e)return e;if("[object String]"===Object.prototype.toString.call(e))return e;if(Array.isArray(e))return e.map(function(e){return t.encode(e)});if("function"==typeof e||"object"==typeof e)return o(e,function(e){return t.encode(e)});throw new Error("Data cannot be encoded in JSON: "+e)},e.prototype.decode=function(e){var t=this;if(null===e)return e;if(e["@type"])switch(e["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":var n=parseFloat(e.value);if(isNaN(n))throw new Error("Data cannot be decoded from JSON: "+e);return n;default:throw new Error("Data cannot be decoded from JSON: "+e)}return Array.isArray(e)?e.map(function(e){return t.decode(e)}):"function"==typeof e||"object"==typeof e?o(e,function(e){return t.decode(e)}):e},e}(),d=function(){function e(e,t){void 0===t&&(t="us-central1"),this.app_=e,this.region_=t,this.serializer=new f,this.emulatorOrigin=null,this.contextProvider=new p(e)}return Object.defineProperty(e.prototype,"app",{get:function(){return this.app_},enumerable:!0,configurable:!0}),e.prototype._url=function(e){var t=this.app_.options.projectId,n=this.region_;return null!==this.emulatorOrigin?this.emulatorOrigin+"/"+t+"/"+n+"/"+e:"https://"+n+"-"+t+".cloudfunctions.net/"+e},e.prototype.useFunctionsEmulator=function(e){this.emulatorOrigin=e},e.prototype.httpsCallable=function(e){var t=this;return function(n){return t.call(e,n)}},e.prototype.postJSON=function(e,t,n){return u.__awaiter(this,void 0,void 0,function(){var r,i,o,a;return u.__generator(this,function(s){switch(s.label){case 0:n.append("Content-Type","application/json"),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,fetch(e,{method:"POST",body:JSON.stringify(t),headers:n})];case 2:return r=s.sent(),[3,4];case 3:return i=s.sent(),[2,{status:0,json:null}];case 4:o=null,s.label=5;case 5:return s.trys.push([5,7,,8]),[4,r.json()];case 6:return o=s.sent(),[3,8];case 7:return a=s.sent(),[3,8];case 8:return[2,{status:r.status,json:o}]}})})},e.prototype.call=function(e,t){return u.__awaiter(this,void 0,void 0,function(){var n,r,o,a,s,c,l,p;return u.__generator(this,function(u){switch(u.label){case 0:return n=this._url(e),t=this.serializer.encode(t),r={data:t},o=new Headers,[4,this.contextProvider.getContext()];case 1:return(a=u.sent()).authToken&&o.append("Authorization","Bearer "+a.authToken),a.instanceIdToken&&o.append("Firebase-Instance-ID-Token",a.instanceIdToken),[4,this.postJSON(n,r,o)];case 2:if(s=u.sent(),c=i(s.status,s.json,this.serializer))throw c;if(!s.json)throw new h("internal","Response is not valid JSON object.");if(void 0===(l=s.json.data)&&(l=s.json.result),void 0===l)throw new h("internal","Response is missing data field.");return p=this.serializer.decode(l),[2,{data:p}]}})})},e}(),m="functions";s(c),t.registerFunctions=s}),define("@firebase/messaging@0.3.7#dist/index.cjs",["require","exports","module","@firebase/util","tslib","@firebase/app"],function(e,t,n){"use strict";function r(e,t){if(null==e||null==t)return!1;if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(var n=new DataView(e),r=new DataView(t),i=0;i<e.byteLength;i++)if(n.getUint8(i)!==r.getUint8(i))return!1;return!0}function i(e){var t=new Uint8Array(e);return btoa(String.fromCharCode.apply(null,t))}function o(e){return i(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function a(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}function s(e){if(e.objectStoreNames.contains(O)){var t=e.transaction(O).objectStore(O),n=new A,r=t.openCursor();r.onerror=function(e){console.warn("Unable to cleanup old IDB.",e)},r.onsuccess=function(){var t=r.result;if(t){var i=t.value;n.deleteToken(i.fcmSenderId,i.fcmToken,i.fcmPushSet),t.continue()}else e.close(),indexedDB.deleteDatabase(x)}}}function u(){var e=indexedDB.open(x);e.onerror=function(e){},e.onsuccess=function(t){s(e.result)}}function c(e){return new Promise(function(t,n){e.onsuccess=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function l(e){if(e.fcmToken&&("string"!=typeof e.fcmToken||0===e.fcmToken.length))throw C.create(T.BAD_TOKEN);if(e.swScope&&("string"!=typeof e.swScope||0===e.swScope.length))throw C.create(T.BAD_SCOPE);if(e.vapidKey&&(!(e.vapidKey instanceof Uint8Array)||65!==e.vapidKey.length))throw C.create(T.BAD_VAPID_KEY);if(e.endpoint&&("string"!=typeof e.endpoint||0===e.endpoint.length))throw C.create(T.BAD_SUBSCRIPTION);if(e.auth&&!(e.auth instanceof ArrayBuffer))throw C.create(T.BAD_SUBSCRIPTION);if(e.p256dh&&!(e.p256dh instanceof ArrayBuffer))throw C.create(T.BAD_SUBSCRIPTION);if(e.fcmSenderId&&("string"!=typeof e.fcmSenderId||0===e.fcmSenderId.length))throw C.create(T.BAD_SENDER_ID);if(e.fcmPushSet&&("string"!=typeof e.fcmPushSet||0===e.fcmPushSet.length))throw C.create(T.BAD_PUSH_SET)}function h(e,t,n){if(!n.vapidKey||!r(t.buffer,n.vapidKey.buffer))return!1;var i=e.endpoint===n.endpoint,o=r(e.getKey("auth"),n.auth),a=r(e.getKey("p256dh"),n.p256dh);return i&&o&&a}function p(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function f(e,t){return n={},n[_.TYPE_OF_MSG]=e,n[_.DATA]=t,n;var n}function d(){return k.__awaiter(this,void 0,void 0,function(){var e,t,n,r;return k.__generator(this,function(i){switch(i.label){case 0:if(!(e=document.querySelector('link[rel="manifest"]')))return[2];i.label=1;case 1:return i.trys.push([1,4,,5]),[4,fetch(e.href)];case 2:return n=i.sent(),[4,n.json()];case 3:return t=i.sent(),[3,5];case 4:return r=i.sent(),[2];case 5:if(!t||!t.gcm_sender_id)return[2];if("103953800507"!==t.gcm_sender_id)throw C.create(T.INCORRECT_GCM_SENDER_ID);return[2]}})})}function m(e){var t={isSupported:g};e.INTERNAL.registerService("messaging",function(e){if(!g())throw C.create(T.UNSUPPORTED_BROWSER);return self&&"ServiceWorkerGlobalScope"in self?new j(e):new U(e)},t)}function g(){return self&&"ServiceWorkerGlobalScope"in self?v():y()}function y(){return navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}function v(){return"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}Object.defineProperty(t,"__esModule",{value:!0});var b,_,w=e("@firebase/util"),k=e("tslib"),E=function(e){return e&&"object"==typeof e&&"default"in e?e.default:e}(e("@firebase/app")),T={AVAILABLE_IN_WINDOW:"only-available-in-window",AVAILABLE_IN_SW:"only-available-in-sw",SHOULD_BE_INHERITED:"should-be-overriden",BAD_SENDER_ID:"bad-sender-id",INCORRECT_GCM_SENDER_ID:"incorrect-gcm-sender-id",PERMISSION_DEFAULT:"permission-default",PERMISSION_BLOCKED:"permission-blocked",UNSUPPORTED_BROWSER:"unsupported-browser",NOTIFICATIONS_BLOCKED:"notifications-blocked",FAILED_DEFAULT_REGISTRATION:"failed-serviceworker-registration",SW_REGISTRATION_EXPECTED:"sw-registration-expected",GET_SUBSCRIPTION_FAILED:"get-subscription-failed",INVALID_SAVED_TOKEN:"invalid-saved-token",SW_REG_REDUNDANT:"sw-reg-redundant",TOKEN_SUBSCRIBE_FAILED:"token-subscribe-failed",TOKEN_SUBSCRIBE_NO_TOKEN:"token-subscribe-no-token",TOKEN_SUBSCRIBE_NO_PUSH_SET:"token-subscribe-no-push-set",TOKEN_UNSUBSCRIBE_FAILED:"token-unsubscribe-failed",TOKEN_UPDATE_FAILED:"token-update-failed",TOKEN_UPDATE_NO_TOKEN:"token-update-no-token",USE_SW_BEFORE_GET_TOKEN:"use-sw-before-get-token",INVALID_DELETE_TOKEN:"invalid-delete-token",DELETE_TOKEN_NOT_FOUND:"delete-token-not-found",DELETE_SCOPE_NOT_FOUND:"delete-scope-not-found",BG_HANDLER_FUNCTION_EXPECTED:"bg-handler-function-expected",NO_WINDOW_CLIENT_TO_MSG:"no-window-client-to-msg",UNABLE_TO_RESUBSCRIBE:"unable-to-resubscribe",NO_FCM_TOKEN_FOR_RESUBSCRIBE:"no-fcm-token-for-resubscribe",FAILED_TO_DELETE_TOKEN:"failed-to-delete-token",NO_SW_IN_REG:"no-sw-in-reg",BAD_SCOPE:"bad-scope",BAD_VAPID_KEY:"bad-vapid-key",BAD_SUBSCRIPTION:"bad-subscription",BAD_TOKEN:"bad-token",BAD_PUSH_SET:"bad-push-set",FAILED_DELETE_VAPID_KEY:"failed-delete-vapid-key",INVALID_PUBLIC_VAPID_KEY:"invalid-public-vapid-key",USE_PUBLIC_KEY_BEFORE_GET_TOKEN:"use-public-key-before-get-token",PUBLIC_KEY_DECRYPTION_FAILED:"public-vapid-key-decryption-failed"},S=(b={},b[T.AVAILABLE_IN_WINDOW]="This method is available in a Window context.",b[T.AVAILABLE_IN_SW]="This method is available in a service worker context.",b[T.SHOULD_BE_INHERITED]="This method should be overriden by extended classes.",b[T.BAD_SENDER_ID]="Please ensure that 'messagingSenderId' is set correctly in the options passed into firebase.initializeApp().",b[T.PERMISSION_DEFAULT]="The required permissions were not granted and dismissed instead.",b[T.PERMISSION_BLOCKED]="The required permissions were not granted and blocked instead.",b[T.UNSUPPORTED_BROWSER]="This browser doesn't support the API's required to use the firebase SDK.",b[T.NOTIFICATIONS_BLOCKED]="Notifications have been blocked.",b[T.FAILED_DEFAULT_REGISTRATION]="We are unable to register the default service worker. {$browserErrorMessage}",b[T.SW_REGISTRATION_EXPECTED]="A service worker registration was the expected input.",b[T.GET_SUBSCRIPTION_FAILED]="There was an error when trying to get any existing Push Subscriptions.",b[T.INVALID_SAVED_TOKEN]="Unable to access details of the saved token.",b[T.SW_REG_REDUNDANT]="The service worker being used for push was made redundant.",b[T.TOKEN_SUBSCRIBE_FAILED]="A problem occured while subscribing the user to FCM: {$message}",b[T.TOKEN_SUBSCRIBE_NO_TOKEN]="FCM returned no token when subscribing the user to push.",b[T.TOKEN_SUBSCRIBE_NO_PUSH_SET]="FCM returned an invalid response when getting an FCM token.",b[T.TOKEN_UNSUBSCRIBE_FAILED]="A problem occured while unsubscribing the user from FCM: {$message}",b[T.TOKEN_UPDATE_FAILED]="A problem occured while updating the user from FCM: {$message}",b[T.TOKEN_UPDATE_NO_TOKEN]="FCM returned no token when updating the user to push.",b[T.USE_SW_BEFORE_GET_TOKEN]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",b[T.INVALID_DELETE_TOKEN]="You must pass a valid token into deleteToken(), i.e. the token from getToken().",b[T.DELETE_TOKEN_NOT_FOUND]="The deletion attempt for token could not be performed as the token was not found.",b[T.DELETE_SCOPE_NOT_FOUND]="The deletion attempt for service worker scope could not be performed as the scope was not found.",b[T.BG_HANDLER_FUNCTION_EXPECTED]="The input to setBackgroundMessageHandler() must be a function.",b[T.NO_WINDOW_CLIENT_TO_MSG]="An attempt was made to message a non-existant window client.",b[T.UNABLE_TO_RESUBSCRIBE]="There was an error while re-subscribing the FCM token for push messaging. Will have to resubscribe the user on next visit. {$message}",b[T.NO_FCM_TOKEN_FOR_RESUBSCRIBE]="Could not find an FCM token and as a result, unable to resubscribe. Will have to resubscribe the user on next visit.",b[T.FAILED_TO_DELETE_TOKEN]="Unable to delete the currently saved token.",b[T.NO_SW_IN_REG]="Even though the service worker registration was successful, there was a problem accessing the service worker itself.",b[T.INCORRECT_GCM_SENDER_ID]="Please change your web app manifest's 'gcm_sender_id' value to '103953800507' to use Firebase messaging.",b[T.BAD_SCOPE]="The service worker scope must be a string with at least one character.",b[T.BAD_VAPID_KEY]="The public VAPID key is not a Uint8Array with 65 bytes.",b[T.BAD_SUBSCRIPTION]="The subscription must be a valid PushSubscription.",b[T.BAD_TOKEN]="The FCM Token used for storage / lookup was not a valid token string.",b[T.BAD_PUSH_SET]="The FCM push set used for storage / lookup was not not a valid push set string.",b[T.FAILED_DELETE_VAPID_KEY]="The VAPID key could not be deleted.",b[T.INVALID_PUBLIC_VAPID_KEY]="The public VAPID key must be a string.",b[T.PUBLIC_KEY_DECRYPTION_FAILED]="The public VAPID key did not equal 65 bytes when decrypted.",b),C=new w.ErrorFactory("messaging","Messaging",S),I=new Uint8Array([4,51,148,247,223,161,235,177,220,3,162,94,21,113,219,72,211,46,237,237,178,52,219,183,71,58,12,143,196,204,225,111,60,140,132,223,171,182,102,62,242,12,212,139,254,227,249,118,47,20,28,99,8,106,111,45,177,26,149,176,206,55,192,156,110]),N="https://fcm.googleapis.com";!function(e){e.TYPE_OF_MSG="firebase-messaging-msg-type",e.DATA="firebase-messaging-msg-data"}(_||(_={}));var D;!function(e){e.PUSH_MSG_RECEIVED="push-msg-received",e.NOTIFICATION_CLICKED="notification-clicked"}(D||(D={}));var A=function(){function e(){}return e.prototype.getToken=function(e,t,n){return k.__awaiter(this,void 0,void 0,function(){var i,a,s,u,c,l,h,p,f,d;return k.__generator(this,function(m){switch(m.label){case 0:i=o(t.getKey("p256dh")),a=o(t.getKey("auth")),s="authorized_entity="+e+"&endpoint="+t.endpoint+"&encryption_key="+i+"&encryption_auth="+a,r(n.buffer,I.buffer)||(u=o(n),s+="&application_pub_key="+u),(c=new Headers).append("Content-Type","application/x-www-form-urlencoded"),l={method:"POST",headers:c,body:s},m.label=1;case 1:return m.trys.push([1,4,,5]),[4,fetch(N+"/fcm/connect/subscribe",l)];case 2:return p=m.sent(),[4,p.json()];case 3:return h=m.sent(),[3,5];case 4:throw f=m.sent(),C.create(T.TOKEN_SUBSCRIBE_FAILED);case 5:if(h.error)throw d=h.error.message,C.create(T.TOKEN_SUBSCRIBE_FAILED,{message:d});if(!h.token)throw C.create(T.TOKEN_SUBSCRIBE_NO_TOKEN);if(!h.pushSet)throw C.create(T.TOKEN_SUBSCRIBE_NO_PUSH_SET);return[2,{token:h.token,pushSet:h.pushSet}]}})})},e.prototype.updateToken=function(e,t,n,i,a){return k.__awaiter(this,void 0,void 0,function(){var s,u,c,l,h,p,f,d,m,g;return k.__generator(this,function(y){switch(y.label){case 0:s=o(i.getKey("p256dh")),u=o(i.getKey("auth")),c="push_set="+n+"&token="+t+"&authorized_entity="+e+"&endpoint="+i.endpoint+"&encryption_key="+s+"&encryption_auth="+u,r(a.buffer,I.buffer)||(l=o(a),c+="&application_pub_key="+l),(h=new Headers).append("Content-Type","application/x-www-form-urlencoded"),p={method:"POST",headers:h,body:c},y.label=1;case 1:return y.trys.push([1,4,,5]),[4,fetch(N+"/fcm/connect/subscribe",p)];case 2:return d=y.sent(),[4,d.json()];case 3:return f=y.sent(),[3,5];case 4:throw m=y.sent(),C.create(T.TOKEN_UPDATE_FAILED);case 5:if(f.error)throw g=f.error.message,C.create(T.TOKEN_UPDATE_FAILED,{message:g});if(!f.token)throw C.create(T.TOKEN_UPDATE_NO_TOKEN);return[2,f.token]}})})},e.prototype.deleteToken=function(e,t,n){return k.__awaiter(this,void 0,void 0,function(){var r,i,o,a,s,u,c;return k.__generator(this,function(l){switch(l.label){case 0:r="authorized_entity="+e+"&token="+t+"&pushSet="+n,(i=new Headers).append("Content-Type","application/x-www-form-urlencoded"),o={method:"POST",headers:i,body:r},l.label=1;case 1:return l.trys.push([1,4,,5]),[4,fetch(N+"/fcm/connect/unsubscribe",o)];case 2:return a=l.sent(),[4,a.json()];case 3:if((s=l.sent()).error)throw u=s.error.message,C.create(T.TOKEN_UNSUBSCRIBE_FAILED,{message:u});return[3,5];case 4:throw c=l.sent(),C.create(T.TOKEN_UNSUBSCRIBE_FAILED);case 5:return[2]}})})},e}(),x="undefined",O="fcm_token_object_Store",P=function(){function e(){this.dbPromise=null}return e.prototype.get=function(e){return this.createTransaction(function(t){return t.get(e)})},e.prototype.getIndex=function(e,t){return this.createTransaction(function(n){return n.index(e).get(t)})},e.prototype.put=function(e){return this.createTransaction(function(t){return t.put(e)},"readwrite")},e.prototype.delete=function(e){return this.createTransaction(function(t){return t.delete(e)},"readwrite")},e.prototype.closeDatabase=function(){return k.__awaiter(this,void 0,void 0,function(){var e;return k.__generator(this,function(t){switch(t.label){case 0:return this.dbPromise?[4,this.dbPromise]:[3,2];case 1:(e=t.sent()).close(),this.dbPromise=null,t.label=2;case 2:return[2]}})})},e.prototype.createTransaction=function(e,t){return void 0===t&&(t="readonly"),k.__awaiter(this,void 0,void 0,function(){var n,r,i,o;return k.__generator(this,function(a){switch(a.label){case 0:return[4,this.getDb()];case 1:return n=a.sent(),r=n.transaction(this.objectStoreName,t),i=r.objectStore(this.objectStoreName),[4,c(e(i))];case 2:return o=a.sent(),[2,new Promise(function(e,t){r.oncomplete=function(){e(o)},r.onerror=function(){t(r.error)}})]}})})},e.prototype.getDb=function(){var e=this;return this.dbPromise||(this.dbPromise=new Promise(function(t,n){var r=indexedDB.open(e.dbName,e.dbVersion);r.onsuccess=function(){t(r.result)},r.onerror=function(){e.dbPromise=null,n(r.error)},r.onupgradeneeded=function(t){return e.onDbUpgrade(r,t)}})),this.dbPromise},e}(),R=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dbName="fcm_token_details_db",t.dbVersion=3,t.objectStoreName="fcm_token_object_Store",t}return k.__extends(t,e),t.prototype.onDbUpgrade=function(e,t){var n=e.result;switch(t.oldVersion){case 0:(r=n.createObjectStore(this.objectStoreName,{keyPath:"swScope"})).createIndex("fcmSenderId","fcmSenderId",{unique:!1}),r.createIndex("fcmToken","fcmToken",{unique:!0});case 1:u();case 2:var r=e.transaction.objectStore(this.objectStoreName),i=r.openCursor();i.onsuccess=function(){var e=i.result;if(e){var t=e.value,n=k.__assign({},t);t.createTime||(n.createTime=Date.now()),"string"==typeof t.vapidKey&&(n.vapidKey=a(t.vapidKey)),"string"==typeof t.auth&&(n.auth=a(t.auth).buffer),"string"==typeof t.auth&&(n.p256dh=a(t.p256dh).buffer),e.update(n),e.continue()}}}},t.prototype.getTokenDetailsFromToken=function(e){return k.__awaiter(this,void 0,void 0,function(){return k.__generator(this,function(t){if(!e)throw C.create(T.BAD_TOKEN);return l({fcmToken:e}),[2,this.getIndex("fcmToken",e)]})})},t.prototype.getTokenDetailsFromSWScope=function(e){return k.__awaiter(this,void 0,void 0,function(){return k.__generator(this,function(t){if(!e)throw C.create(T.BAD_SCOPE);return l({swScope:e}),[2,this.get(e)]})})},t.prototype.saveTokenDetails=function(e){return k.__awaiter(this,void 0,void 0,function(){return k.__generator(this,function(t){if(!e.swScope)throw C.create(T.BAD_SCOPE);if(!e.vapidKey)throw C.create(T.BAD_VAPID_KEY);if(!e.endpoint||!e.auth||!e.p256dh)throw C.create(T.BAD_SUBSCRIPTION);if(!e.fcmSenderId)throw C.create(T.BAD_SENDER_ID);if(!e.fcmToken)throw C.create(T.BAD_TOKEN);if(!e.fcmPushSet)throw C.create(T.BAD_PUSH_SET);return l(e),[2,this.put(e)]})})},t.prototype.deleteToken=function(e){return k.__awaiter(this,void 0,void 0,function(){var t;return k.__generator(this,function(n){switch(n.label){case 0:return"string"!=typeof e||0===e.length?[2,Promise.reject(C.create(T.INVALID_DELETE_TOKEN))]:[4,this.getTokenDetailsFromToken(e)];case 1:if(!(t=n.sent()))throw C.create(T.DELETE_TOKEN_NOT_FOUND);return[4,this.delete(t.swScope)];case 2:return n.sent(),[2,t]}})})},t}(P),L=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dbName="fcm_vapid_details_db",t.dbVersion=1,t.objectStoreName="fcm_vapid_object_Store",t}return k.__extends(t,e),t.prototype.onDbUpgrade=function(e){e.result.createObjectStore(this.objectStoreName,{keyPath:"swScope"})},t.prototype.getVapidFromSWScope=function(e){return k.__awaiter(this,void 0,void 0,function(){var t;return k.__generator(this,function(n){switch(n.label){case 0:if("string"!=typeof e||0===e.length)throw C.create(T.BAD_SCOPE);return[4,this.get(e)];case 1:return t=n.sent(),[2,t?t.vapidKey:void 0]}})})},t.prototype.saveVapidDetails=function(e,t){return k.__awaiter(this,void 0,void 0,function(){var n;return k.__generator(this,function(r){if("string"!=typeof e||0===e.length)throw C.create(T.BAD_SCOPE);if(null===t||65!==t.length)throw C.create(T.BAD_VAPID_KEY);return n={swScope:e,vapidKey:t},[2,this.put(n)]})})},t.prototype.deleteVapidDetails=function(e){return k.__awaiter(this,void 0,void 0,function(){var t;return k.__generator(this,function(n){switch(n.label){case 0:return[4,this.getVapidFromSWScope(e)];case 1:if(!(t=n.sent()))throw C.create(T.DELETE_SCOPE_NOT_FOUND);return[4,this.delete(e)];case 2:return n.sent(),[2,t]}})})},t}(P),M="messagingSenderId",V=function(){function e(e){var t=this;if(!e.options[M]||"string"!=typeof e.options[M])throw C.create(T.BAD_SENDER_ID);this.messagingSenderId=e.options[M],this.tokenDetailsModel=new R,this.vapidDetailsModel=new L,this.iidModel=new A,this.app=e,this.INTERNAL={delete:function(){return t.delete()}}}return e.prototype.getToken=function(){return k.__awaiter(this,void 0,void 0,function(){var e,t,n,r,i;return k.__generator(this,function(o){switch(o.label){case 0:if("denied"===(e=this.getNotificationPermission_()))throw C.create(T.NOTIFICATIONS_BLOCKED);return"granted"!==e?[2,null]:[4,this.getSWRegistration_()];case 1:return t=o.sent(),[4,this.getPublicVapidKey_()];case 2:return n=o.sent(),[4,this.getPushSubscription(t,n)];case 3:return r=o.sent(),[4,this.tokenDetailsModel.getTokenDetailsFromSWScope(t.scope)];case 4:return(i=o.sent())?[2,this.manageExistingToken(t,r,n,i)]:[2,this.getNewToken(t,r,n)]}})})},e.prototype.manageExistingToken=function(e,t,n,r){return k.__awaiter(this,void 0,void 0,function(){var i,o;return k.__generator(this,function(a){switch(a.label){case 0:return(i=h(t,n,r))?(o=Date.now())<r.createTime+6048e5?[2,r.fcmToken]:[2,this.updateToken(e,t,n,r)]:[4,this.deleteTokenFromDB(r.fcmToken)];case 1:return a.sent(),[2,this.getNewToken(e,t,n)]}})})},e.prototype.updateToken=function(e,t,n,r){return k.__awaiter(this,void 0,void 0,function(){var i,o,a;return k.__generator(this,function(s){switch(s.label){case 0:return s.trys.push([0,4,,6]),[4,this.iidModel.updateToken(this.messagingSenderId,r.fcmToken,r.fcmPushSet,t,n)];case 1:return i=s.sent(),o={swScope:e.scope,vapidKey:n,fcmSenderId:this.messagingSenderId,fcmToken:i,fcmPushSet:r.fcmPushSet,createTime:Date.now(),endpoint:t.endpoint,auth:t.getKey("auth"),p256dh:t.getKey("p256dh")},[4,this.tokenDetailsModel.saveTokenDetails(o)];case 2:return s.sent(),[4,this.vapidDetailsModel.saveVapidDetails(e.scope,n)];case 3:return s.sent(),[2,i];case 4:return a=s.sent(),[4,this.deleteToken(r.fcmToken)];case 5:throw s.sent(),a;case 6:return[2]}})})},e.prototype.getNewToken=function(e,t,n){return k.__awaiter(this,void 0,void 0,function(){var r,i;return k.__generator(this,function(o){switch(o.label){case 0:return[4,this.iidModel.getToken(this.messagingSenderId,t,n)];case 1:return r=o.sent(),i={swScope:e.scope,vapidKey:n,fcmSenderId:this.messagingSenderId,fcmToken:r.token,fcmPushSet:r.pushSet,createTime:Date.now(),endpoint:t.endpoint,auth:t.getKey("auth"),p256dh:t.getKey("p256dh")},[4,this.tokenDetailsModel.saveTokenDetails(i)];case 2:return o.sent(),[4,this.vapidDetailsModel.saveVapidDetails(e.scope,n)];case 3:return o.sent(),[2,r.token]}})})},e.prototype.deleteToken=function(e){return k.__awaiter(this,void 0,void 0,function(){var t,n;return k.__generator(this,function(r){switch(r.label){case 0:return[4,this.deleteTokenFromDB(e)];case 1:return r.sent(),[4,this.getSWRegistration_()];case 2:return(t=r.sent())?[4,t.pushManager.getSubscription()]:[3,4];case 3:if(n=r.sent())return[2,n.unsubscribe()];r.label=4;case 4:return[2,!0]}})})},e.prototype.deleteTokenFromDB=function(e){return k.__awaiter(this,void 0,void 0,function(){var t;return k.__generator(this,function(n){switch(n.label){case 0:return[4,this.tokenDetailsModel.deleteToken(e)];case 1:return t=n.sent(),[4,this.iidModel.deleteToken(t.fcmSenderId,t.fcmToken,t.fcmPushSet)];case 2:return n.sent(),[2]}})})},e.prototype.getPushSubscription=function(e,t){return e.pushManager.getSubscription().then(function(n){return n||e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:t})})},e.prototype.requestPermission=function(){throw C.create(T.AVAILABLE_IN_WINDOW)},e.prototype.useServiceWorker=function(e){throw C.create(T.AVAILABLE_IN_WINDOW)},e.prototype.usePublicVapidKey=function(e){throw C.create(T.AVAILABLE_IN_WINDOW)},e.prototype.onMessage=function(e,t,n){throw C.create(T.AVAILABLE_IN_WINDOW)},e.prototype.onTokenRefresh=function(e,t,n){throw C.create(T.AVAILABLE_IN_WINDOW)},e.prototype.setBackgroundMessageHandler=function(e){throw C.create(T.AVAILABLE_IN_SW)},e.prototype.delete=function(){return k.__awaiter(this,void 0,void 0,function(){return k.__generator(this,function(e){switch(e.label){case 0:return[4,Promise.all([this.tokenDetailsModel.closeDatabase(),this.vapidDetailsModel.closeDatabase()])];case 1:return e.sent(),[2]}})})},e.prototype.getNotificationPermission_=function(){return Notification.permission},e.prototype.getTokenDetailsModel=function(){return this.tokenDetailsModel},e.prototype.getVapidDetailsModel=function(){return this.vapidDetailsModel},e.prototype.getIidModel=function(){return this.iidModel},e}(),j=function(e){function t(t){var n=e.call(this,t)||this;return n.bgMessageHandler=null,self.addEventListener("push",function(e){n.onPush(e)}),self.addEventListener("pushsubscriptionchange",function(e){n.onSubChange(e)}),self.addEventListener("notificationclick",function(e){n.onNotificationClick(e)}),n}return k.__extends(t,e),t.prototype.onPush=function(e){e.waitUntil(this.onPush_(e))},t.prototype.onSubChange=function(e){e.waitUntil(this.onSubChange_(e))},t.prototype.onNotificationClick=function(e){e.waitUntil(this.onNotificationClick_(e))},t.prototype.onPush_=function(e){return k.__awaiter(this,void 0,void 0,function(){var t,n,r,i,o,a,s;return k.__generator(this,function(u){switch(u.label){case 0:if(!e.data)return[2];try{t=e.data.json()}catch(e){return[2]}return[4,this.hasVisibleClients_()];case 1:return(n=u.sent())?[2,this.sendMessageToWindowClients_(t)]:(r=this.getNotificationData_(t))?(i=r.title||"",[4,this.getSWRegistration_()]):[3,3];case 2:return o=u.sent(),a=r.actions,s=Notification.maxActions,a&&s&&a.length>s&&console.warn("This browser only supports "+s+" actions.The remaining actions will not be displayed."),[2,o.showNotification(i,r)];case 3:return this.bgMessageHandler?[4,this.bgMessageHandler(t)]:[3,5];case 4:return u.sent(),[2];case 5:return[2]}})})},t.prototype.onSubChange_=function(e){return k.__awaiter(this,void 0,void 0,function(){var e,t,n,r,i;return k.__generator(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.getSWRegistration_()];case 1:return e=o.sent(),[3,3];case 2:throw t=o.sent(),C.create(T.UNABLE_TO_RESUBSCRIBE,{message:t});case 3:return o.trys.push([3,5,,8]),[4,e.pushManager.getSubscription()];case 4:return o.sent(),[3,8];case 5:return n=o.sent(),r=this.getTokenDetailsModel(),[4,r.getTokenDetailsFromSWScope(e.scope)];case 6:if(!(i=o.sent()))throw n;return[4,this.deleteToken(i.fcmToken)];case 7:throw o.sent(),n;case 8:return[2]}})})},t.prototype.onNotificationClick_=function(e){return k.__awaiter(this,void 0,void 0,function(){var t,n,r,i;return k.__generator(this,function(o){switch(o.label){case 0:return e.notification&&e.notification.data&&e.notification.data.FCM_MSG?e.action?[2]:(e.stopImmediatePropagation(),e.notification.close(),(t=e.notification.data.FCM_MSG).notification&&(n=t.fcmOptions&&t.fcmOptions.link||t.notification.click_action)?[4,this.getWindowClient_(n)]:[2]):[2];case 1:return(r=o.sent())?[3,3]:[4,self.clients.openWindow(n)];case 2:return r=o.sent(),[3,5];case 3:return[4,r.focus()];case 4:r=o.sent(),o.label=5;case 5:return r?(delete t.notification,delete t.fcmOptions,i=f(D.NOTIFICATION_CLICKED,t),[2,this.attemptToMessageClient_(r,i)]):[2]}})})},t.prototype.getNotificationData_=function(e){if(e&&"object"==typeof e.notification){var t=k.__assign({},e.notification);return t.data=k.__assign({},e.notification.data,(n={},n.FCM_MSG=e,n)),t;var n}},t.prototype.setBackgroundMessageHandler=function(e){if(!e||"function"!=typeof e)throw C.create(T.BG_HANDLER_FUNCTION_EXPECTED);this.bgMessageHandler=e},t.prototype.getWindowClient_=function(e){return k.__awaiter(this,void 0,void 0,function(){var t,n,r,i,o;return k.__generator(this,function(a){switch(a.label){case 0:return t=new URL(e,self.location.href).href,[4,p()];case 1:for(n=a.sent(),r=null,i=0;i<n.length;i++)if((o=new URL(n[i].url,self.location.href).href)===t){r=n[i];break}return[2,r]}})})},t.prototype.attemptToMessageClient_=function(e,t){return k.__awaiter(this,void 0,void 0,function(){return k.__generator(this,function(n){if(!e)throw C.create(T.NO_WINDOW_CLIENT_TO_MSG);return e.postMessage(t),[2]})})},t.prototype.hasVisibleClients_=function(){return k.__awaiter(this,void 0,void 0,function(){var e;return k.__generator(this,function(t){switch(t.label){case 0:return[4,p()];case 1:return e=t.sent(),[2,e.some(function(e){return"visible"===e.visibilityState})]}})})},t.prototype.sendMessageToWindowClients_=function(e){return k.__awaiter(this,void 0,void 0,function(){var t,n,r=this;return k.__generator(this,function(i){switch(i.label){case 0:return[4,p()];case 1:return t=i.sent(),n=f(D.PUSH_MSG_RECEIVED,e),[4,Promise.all(t.map(function(e){return r.attemptToMessageClient_(e,n)}))];case 2:return i.sent(),[2]}})})},t.prototype.getSWRegistration_=function(){return k.__awaiter(this,void 0,void 0,function(){return k.__generator(this,function(e){return[2,self.registration]})})},t.prototype.getPublicVapidKey_=function(){return k.__awaiter(this,void 0,void 0,function(){var e,t;return k.__generator(this,function(n){switch(n.label){case 0:return[4,this.getSWRegistration_()];case 1:if(!(e=n.sent()))throw C.create(T.SW_REGISTRATION_EXPECTED);return[4,this.getVapidDetailsModel().getVapidFromSWScope(e.scope)];case 2:return null==(t=n.sent())?[2,I]:[2,t]}})})},t}(V),U=function(e){function t(t){var n=e.call(this,t)||this;return n.registrationToUse=null,n.publicVapidKeyToUse=null,n.manifestCheckPromise=null,n.messageObserver=null,n.tokenRefreshObserver=null,n.onMessageInternal=w.createSubscribe(function(e){n.messageObserver=e}),n.onTokenRefreshInternal=w.createSubscribe(function(e){n.tokenRefreshObserver=e}),n.setupSWMessageListener_(),n}return k.__extends(t,e),t.prototype.getToken=function(){return k.__awaiter(this,void 0,void 0,function(){return k.__generator(this,function(t){switch(t.label){case 0:return this.manifestCheckPromise||(this.manifestCheckPromise=d()),[4,this.manifestCheckPromise];case 1:return t.sent(),[2,e.prototype.getToken.call(this)]}})})},t.prototype.requestPermission=function(){return k.__awaiter(this,void 0,void 0,function(){var e;return k.__generator(this,function(t){switch(t.label){case 0:return"granted"===this.getNotificationPermission_()?[2]:[4,Notification.requestPermission()];case 1:if("granted"===(e=t.sent()))return[2];throw"denied"===e?C.create(T.PERMISSION_BLOCKED):C.create(T.PERMISSION_DEFAULT)}})})},t.prototype.useServiceWorker=function(e){if(!(e instanceof ServiceWorkerRegistration))throw C.create(T.SW_REGISTRATION_EXPECTED);if(null!=this.registrationToUse)throw C.create(T.USE_SW_BEFORE_GET_TOKEN);this.registrationToUse=e},t.prototype.usePublicVapidKey=function(e){if("string"!=typeof e)throw C.create(T.INVALID_PUBLIC_VAPID_KEY);if(null!=this.publicVapidKeyToUse)throw C.create(T.USE_PUBLIC_KEY_BEFORE_GET_TOKEN);var t=a(e);if(65!==t.length)throw C.create(T.PUBLIC_KEY_DECRYPTION_FAILED);this.publicVapidKeyToUse=t},t.prototype.onMessage=function(e,t,n){return"function"==typeof e?this.onMessageInternal(e,t,n):this.onMessageInternal(e)},t.prototype.onTokenRefresh=function(e,t,n){return"function"==typeof e?this.onTokenRefreshInternal(e,t,n):this.onTokenRefreshInternal(e)},t.prototype.waitForRegistrationToActivate_=function(e){var t=e.installing||e.waiting||e.active;return new Promise(function(n,r){if(t)if("activated"!==t.state)if("redundant"!==t.state){var i=function(){if("activated"===t.state)n(e);else{if("redundant"!==t.state)return;r(C.create(T.SW_REG_REDUNDANT))}t.removeEventListener("statechange",i)};t.addEventListener("statechange",i)}else r(C.create(T.SW_REG_REDUNDANT));else n(e);else r(C.create(T.NO_SW_IN_REG))})},t.prototype.getSWRegistration_=function(){var e=this;return this.registrationToUse?this.waitForRegistrationToActivate_(this.registrationToUse):(this.registrationToUse=null,navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"}).catch(function(e){throw C.create(T.FAILED_DEFAULT_REGISTRATION,{browserErrorMessage:e.message})}).then(function(t){return e.waitForRegistrationToActivate_(t).then(function(){return e.registrationToUse=t,t.update(),t})}))},t.prototype.getPublicVapidKey_=function(){return k.__awaiter(this,void 0,void 0,function(){return k.__generator(this,function(e){return this.publicVapidKeyToUse?[2,this.publicVapidKeyToUse]:[2,I]})})},t.prototype.setupSWMessageListener_=function(){var e=this;navigator.serviceWorker.addEventListener("message",function(t){if(t.data&&t.data[_.TYPE_OF_MSG]){var n=t.data;switch(n[_.TYPE_OF_MSG]){case D.PUSH_MSG_RECEIVED:case D.NOTIFICATION_CLICKED:var r=n[_.DATA];e.messageObserver&&e.messageObserver.next(r)}}},!1)},t}(V);m(E),t.registerMessaging=m,t.isSupported=g}),define("@firebase/storage@0.2.4#dist/index.cjs",["require","exports","module","@firebase/app"],function(e,t,n){"use strict";function r(e){return"storage/"+e}function i(){return new rt(it.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function o(e){return new rt(it.OBJECT_NOT_FOUND,"Object '"+e+"' does not exist.")}function a(e){return new rt(it.QUOTA_EXCEEDED,"Quota for bucket '"+e+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function s(){return new rt(it.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again.")}function u(e){return new rt(it.UNAUTHORIZED,"User does not have permission to access '"+e+"'.")}function c(){return new rt(it.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function l(){return new rt(it.CANCELED,"User canceled the upload/download.")}function h(e){return new rt(it.INVALID_URL,"Invalid URL '"+e+"'.")}function p(e){return new rt(it.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}function f(){return new rt(it.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function d(){return new rt(it.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function m(){return new rt(it.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function g(e,t,n){return new rt(it.INVALID_ARGUMENT,"Invalid argument in `"+t+"` at index "+e+": "+n)}function y(e,t,n,r){var i,o;return e===t?(i=e,o=1===e?"argument":"arguments"):(i="between "+e+" and "+t,o="arguments"),new rt(it.INVALID_ARGUMENT_COUNT,"Invalid argument count in `"+n+"`: Expected "+i+" "+o+", received "+r+".")}function v(){return new rt(it.APP_DELETED,"The Firebase app was deleted.")}function b(e){return new rt(it.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function _(e,t){return new rt(it.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function w(e){throw new rt(it.INTERNAL_ERROR,"Internal error: "+e)}function k(e){switch(e){case ot.RAW:case ot.BASE64:case ot.BASE64URL:case ot.DATA_URL:return;default:throw"Expected one of the event types: ["+ot.RAW+", "+ot.BASE64+", "+ot.BASE64URL+", "+ot.DATA_URL+"]."}}function E(e,t){switch(e){case ot.RAW:return new at(T(t));case ot.BASE64:case ot.BASE64URL:return new at(C(e,t));case ot.DATA_URL:return new at(I(t),N(t))}throw i()}function T(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n);r<=127?t.push(r):r<=2047?t.push(192|r>>6,128|63&r):55296==(64512&r)?n<e.length-1&&56320==(64512&e.charCodeAt(n+1))?(r=65536|(1023&r)<<10|1023&e.charCodeAt(++n),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)):t.push(239,191,189):56320==(64512&r)?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(t)}function S(e){var t;try{t=decodeURIComponent(e)}catch(e){throw _(ot.DATA_URL,"Malformed data URL.")}return T(t)}function C(e,t){switch(e){case ot.BASE64:var n=-1!==t.indexOf("-"),r=-1!==t.indexOf("_");if(n||r)throw _(e,"Invalid character '"+(a=n?"-":"_")+"' found: is it base64url encoded?");break;case ot.BASE64URL:var i=-1!==t.indexOf("+"),o=-1!==t.indexOf("/");if(i||o){var a=i?"+":"/";throw _(e,"Invalid character '"+a+"' found: is it base64 encoded?")}t=t.replace(/-/g,"+").replace(/_/g,"/")}var s;try{s=atob(t)}catch(t){throw _(e,"Invalid character found")}for(var u=new Uint8Array(s.length),c=0;c<s.length;c++)u[c]=s.charCodeAt(c);return u}function I(e){var t=new st(e);return t.base64?C(ot.BASE64,t.rest):S(t.rest)}function N(e){return new st(e).contentType}function D(e,t){return!!(e.length>=t.length)&&e.substring(e.length-t.length)===t}function A(e){switch(e){case ct.RUNNING:case ct.PAUSING:case ct.CANCELING:return lt.RUNNING;case ct.PAUSED:return lt.PAUSED;case ct.SUCCESS:return lt.SUCCESS;case ct.CANCELED:return lt.CANCELED;case ct.ERROR:default:return lt.ERROR}}function x(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function O(e,t){for(var n in e)x(e,n)&&t(n,e[n])}function P(e){if(null==e)return{};var t={};return O(e,function(e,n){t[e]=n}),t}function R(e){return new Promise(e)}function L(e){return Promise.resolve(e)}function M(e){return Promise.reject(e)}function V(e){return null!=e}function j(e){return void 0!==e}function U(e){return"function"==typeof e}function q(e){return"object"==typeof e}function F(e){return q(e)&&null!==e}function B(e){return q(e)&&!Array.isArray(e)}function K(e){return"string"==typeof e||e instanceof String}function W(e){return"number"==typeof e||e instanceof Number}function H(e){return z()&&e instanceof Blob}function z(){return"undefined"!=typeof Blob}function Q(e){var t;try{t=JSON.parse(e)}catch(e){return null}return B(t)?t:null}function G(e){if(0==e.length)return null;var t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}function X(e,t){var n=t.split("/").filter(function(e){return e.length>0}).join("/");return 0===e.length?n:e+"/"+n}function Y(e){var t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function $(e){return Ye+Je+e}function J(e){return $e+Je+e}function Z(e){return Ye+Ze+e}function ee(e){var t=encodeURIComponent,n="?";return O(e,function(e,r){var i=t(e)+"="+t(r);n=n+i+"&"}),n=n.slice(0,-1)}function te(e,t){return t}function ne(e){return!K(e)||e.length<2?e:(e=e,Y(e))}function re(){if(mt)return mt;var e=[];e.push(new dt("bucket")),e.push(new dt("generation")),e.push(new dt("metageneration")),e.push(new dt("name","fullPath",!0));var t=new dt("name");t.xform=function(e,t){return ne(t)},e.push(t);var n=new dt("size");return n.xform=function(e,t){return V(t)?+t:t},e.push(n),e.push(new dt("timeCreated")),e.push(new dt("updated")),e.push(new dt("md5Hash",null,!0)),e.push(new dt("cacheControl",null,!0)),e.push(new dt("contentDisposition",null,!0)),e.push(new dt("contentEncoding",null,!0)),e.push(new dt("contentLanguage",null,!0)),e.push(new dt("contentType",null,!0)),e.push(new dt("metadata","customMetadata",!0)),mt=e}function ie(e,t){Object.defineProperty(e,"ref",{get:function(){var n=e.bucket,r=e.fullPath,i=new ft(n,r);return t.makeStorageReference(i)}})}function oe(e,t,n){var r={};r.type="file";for(var i=n.length,o=0;o<i;o++){var a=n[o];r[a.local]=a.xform(r,t[a.server])}return ie(r,e),r}function ae(e,t,n){var r=Q(t);return null===r?null:oe(e,r,n)}function se(e,t){var n=Q(t);if(null===n)return null;if(!K(n.downloadTokens))return null;var r=n.downloadTokens;if(0===r.length)return null;var i=encodeURIComponent;return r.split(",").map(function(t){var n=e.bucket,r=e.fullPath;return J("/b/"+i(n)+"/o/"+i(r))+ee({alt:"media",token:t})})[0]}function ue(e,t){for(var n={},r=t.length,i=0;i<r;i++){var o=t[i];o.writable&&(n[o.server]=e[o.local])}return JSON.stringify(n)}function ce(e){if(!e||!q(e))throw"Expected Metadata object.";for(var t in e){var n=e[t];if("customMetadata"===t){if(!q(n))throw"Expected object for 'customMetadata' mapping."}else if(F(n))throw"Mapping for '"+t+"' cannot be an object."}}function le(e,t,n){for(var r=t.length,i=t.length,o=0;o<t.length;o++)if(t[o].optional){r=o;break}if(!(r<=n.length&&n.length<=i))throw y(r,i,e,n.length);for(o=0;o<n.length;o++)try{t[o].validator(n[o])}catch(t){throw t instanceof Error?g(o,e,t.message):g(o,e,t)}}function he(e,t){return function(n){e(n),t(n)}}function pe(e,t){function n(e){if(!K(e))throw"Expected string."}var r;return r=e?he(n,e):n,new gt(r,t)}function fe(){return new gt(function(e){if(!(e instanceof Uint8Array||e instanceof ArrayBuffer||z()&&e instanceof Blob))throw"Expected Blob or File."})}function de(e){return new gt(ce,e)}function me(){return new gt(function(e){if(!(W(e)&&e>=0))throw"Expected a number 0 or greater."})}function ge(e,t){return new gt(function(t){if(!(null===t||V(t)&&t instanceof Object))throw"Expected an Object.";void 0!==e&&null!==e&&e(t)},t)}function ye(e){return new gt(function(e){if(null!==e&&!U(e))throw"Expected a Function."},e)}function ve(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function be(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=ve();if(void 0!==n){for(var r=new n,i=0;i<e.length;i++)r.append(e[i]);return r.getBlob()}if(z())return new Blob(e);throw Error("This browser doesn't seem to support creating Blobs")}function _e(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?e.slice(t,n):null}function we(e,t){return-1!==e.indexOf(t)}function ke(e){return Array.prototype.slice.call(e)}function Ee(e,t){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}function Te(e){if(!e)throw i()}function Se(e,t){return function(n,r){var i=ae(e,r,t);return Te(null!==i),i}}function Ce(e,t){return function(n,r){var i=ae(e,r,t);return Te(null!==i),se(i,r)}}function Ie(e){return function(t,n){var r;return(r=401===t.getStatus()?s():402===t.getStatus()?a(e.bucket):403===t.getStatus()?u(e.path):n).setServerResponseProp(n.serverResponseProp()),r}}function Ne(e){var t=Ie(e);return function(n,r){var i=t(n,r);return 404===n.getStatus()&&(i=o(e.path)),i.setServerResponseProp(r.serverResponseProp()),i}}function De(e,t,n){var r=$(t.fullServerUrl()),i=e.maxOperationRetryTime(),o=new vt(r,"GET",Se(e,n),i);return o.errorHandler=Ne(t),o}function Ae(e,t,n){var r=$(t.fullServerUrl()),i=e.maxOperationRetryTime(),o=new vt(r,"GET",Ce(e,n),i);return o.errorHandler=Ne(t),o}function xe(e,t,n,r){var i=$(t.fullServerUrl()),o=ue(n,r),a={"Content-Type":"application/json; charset=utf-8"},s=e.maxOperationRetryTime(),u=new vt(i,"PATCH",Se(e,r),s);return u.headers=a,u.body=o,u.errorHandler=Ne(t),u}function Oe(e,t){var n=$(t.fullServerUrl()),r=e.maxOperationRetryTime(),i=new vt(n,"DELETE",function(e,t){},r);return i.successCodes=[200,204],i.errorHandler=Ne(t),i}function Pe(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}function Re(e,t,n){var r=P(n);return r.fullPath=e.path,r.size=t.size(),r.contentType||(r.contentType=Pe(null,t)),r}function Le(e,t,n,r,i){var o=t.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"},s=function(){for(var e="",t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();a["Content-Type"]="multipart/related; boundary="+s;var u=Re(t,r,i),c="--"+s+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+ue(u,n)+"\r\n--"+s+"\r\nContent-Type: "+u.contentType+"\r\n\r\n",l="\r\n--"+s+"--",h=yt.getBlob(c,r,l);if(null===h)throw f();var p={name:u.fullPath},d=Z(o),m=e.maxUploadRetryTime(),g=new vt(d,"POST",Se(e,n),m);return g.urlParams=p,g.headers=a,g.body=h.uploadData(),g.errorHandler=Ie(t),g}function Me(e,t){var n;try{n=e.getResponseHeader("X-Goog-Upload-Status")}catch(e){Te(!1)}return Te(we(t||["active"],n)),n}function Ve(e,t,n,r,i){var o=t.bucketOnlyServerUrl(),a=Re(t,r,i),s={name:a.fullPath},u=Z(o),c={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":r.size(),"X-Goog-Upload-Header-Content-Type":a.contentType,"Content-Type":"application/json; charset=utf-8"},l=ue(a,n),h=e.maxUploadRetryTime(),p=new vt(u,"POST",function(e,t){Me(e);var n;try{n=e.getResponseHeader("X-Goog-Upload-URL")}catch(e){Te(!1)}return Te(K(n)),n},h);return p.urlParams=s,p.headers=c,p.body=l,p.errorHandler=Ie(t),p}function je(e,t,n,r){var i={"X-Goog-Upload-Command":"query"},o=e.maxUploadRetryTime(),a=new vt(n,"POST",function(e,t){var n,i=Me(e,["active","final"]);try{n=e.getResponseHeader("X-Goog-Upload-Size-Received")}catch(e){Te(!1)}var o=parseInt(n,10);return Te(!isNaN(o)),new bt(o,r.size(),"final"===i)},o);return a.headers=i,a.errorHandler=Ie(t),a}function Ue(e,t,n,r,i,o,a,s){var u=new bt(0,0);if(a?(u.current=a.current,u.total=a.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw d();var c=u.total-u.current,l=c;i>0&&(l=Math.min(l,i));var h=u.current,p=h+l,m={"X-Goog-Upload-Command":l===c?"upload, finalize":"upload","X-Goog-Upload-Offset":u.current},g=r.slice(h,p);if(null===g)throw f();var y=t.maxUploadRetryTime(),v=new vt(n,"POST",function(e,n){var i,a=Me(e,["active","final"]),s=u.current+l,c=r.size();return i="final"===a?Se(t,o)(e,n):null,new bt(s,c,"final"===a,i)},y);return v.headers=m,v.body=g.uploadData(),v.progressCallback=s||null,v.errorHandler=Ie(e),v}function qe(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];L(!0).then(function(){e.apply(null,t)})}}function Fe(e,t,n){function r(){return 2===h}function i(){p||(p=!0,t.apply(null,arguments))}function o(t){c=setTimeout(function(){c=null,e(a,r())},t)}function a(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!p)if(e)i.apply(null,arguments);else if(r()||l)i.apply(null,arguments);else{u<64&&(u*=2);var a;1===h?(h=2,a=0):a=1e3*(u+Math.random()),o(a)}}function s(e){f||(f=!0,p||(null!==c?(e||(h=2),clearTimeout(c),o(0)):e||(h=1)))}var u=1,c=null,l=!1,h=0,p=!1,f=!1;return o(0),setTimeout(function(){l=!0,s(!0)},n),s}function Be(e){e(!1)}function Ke(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}function We(e){var t=void 0!==Xe?Xe.SDK_VERSION:"AppManager";e["X-Firebase-Storage-Version"]="webjs/"+t}function He(e,t,n){var r=ee(e.urlParams),i=e.url+r,o=P(e.headers);return Ke(o,t),We(o),new It(i,e.method,o,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,n)}function ze(e,t,n){return new Dt(e,new pt,n)}function Qe(e){var t={TaskState:lt,TaskEvent:ut,StringFormat:ot,Storage:Dt,Reference:Et};e.INTERNAL.registerService(xt,ze,t,void 0,!0)}Object.defineProperty(t,"__esModule",{value:!0});var Ge,Xe=function(e){return e&&"object"==typeof e&&"default"in e?e.default:e}(e("@firebase/app")),Ye="https://firebasestorage.googleapis.com",$e="https://firebasestorage.googleapis.com",Je="/v0",Ze="/v0",et=12e4,tt=6e4,nt=-9007199254740991,rt=function(){function e(e,t){this.code_=r(e),this.message_="Firebase Storage: "+t,this.serverResponse_=null,this.name_="FirebaseError"}return e.prototype.codeProp=function(){return this.code},e.prototype.codeEquals=function(e){return r(e)===this.codeProp()},e.prototype.serverResponseProp=function(){return this.serverResponse_},e.prototype.setServerResponseProp=function(e){this.serverResponse_=e},Object.defineProperty(e.prototype,"name",{get:function(){return this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"code",{get:function(){return this.code_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"message",{get:function(){return this.message_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"serverResponse",{get:function(){return this.serverResponse_},enumerable:!0,configurable:!0}),e}(),it={UNKNOWN:"unknown",OBJECT_NOT_FOUND:"object-not-found",BUCKET_NOT_FOUND:"bucket-not-found",PROJECT_NOT_FOUND:"project-not-found",QUOTA_EXCEEDED:"quota-exceeded",UNAUTHENTICATED:"unauthenticated",UNAUTHORIZED:"unauthorized",RETRY_LIMIT_EXCEEDED:"retry-limit-exceeded",INVALID_CHECKSUM:"invalid-checksum",CANCELED:"canceled",INVALID_EVENT_NAME:"invalid-event-name",INVALID_URL:"invalid-url",INVALID_DEFAULT_BUCKET:"invalid-default-bucket",NO_DEFAULT_BUCKET:"no-default-bucket",CANNOT_SLICE_BLOB:"cannot-slice-blob",SERVER_FILE_WRONG_SIZE:"server-file-wrong-size",NO_DOWNLOAD_URL:"no-download-url",INVALID_ARGUMENT:"invalid-argument",INVALID_ARGUMENT_COUNT:"invalid-argument-count",APP_DELETED:"app-deleted",INVALID_ROOT_OPERATION:"invalid-root-operation",INVALID_FORMAT:"invalid-format",INTERNAL_ERROR:"internal-error"},ot={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},at=function(e,t){this.data=e,this.contentType=t||null},st=function(e){this.base64=!1,this.contentType=null;var t=e.match(/^data:([^,]+)?,/);if(null===t)throw _(ot.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var n=t[1]||null;null!=n&&(this.base64=D(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-";base64".length):n),this.rest=e.substring(e.indexOf(",")+1)},ut={STATE_CHANGED:"state_changed"},ct={RUNNING:"running",PAUSING:"pausing",PAUSED:"paused",SUCCESS:"success",CANCELING:"canceling",CANCELED:"canceled",ERROR:"error"},lt={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};!function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(Ge||(Ge={}));var ht=function(){function e(){var e=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=Ge.NO_ERROR,this.sendPromise_=R(function(t,n){e.xhr_.addEventListener("abort",function(n){e.errorCode_=Ge.ABORT,t(e)}),e.xhr_.addEventListener("error",function(n){e.errorCode_=Ge.NETWORK_ERROR,t(e)}),e.xhr_.addEventListener("load",function(n){t(e)})})}return e.prototype.send=function(e,t,n,r){var i=this;if(this.sent_)throw w("cannot .send() more than once");return this.sent_=!0,this.xhr_.open(t,e,!0),V(r)&&O(r,function(e,t){i.xhr_.setRequestHeader(e,t.toString())}),V(n)?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_},e.prototype.getErrorCode=function(){if(!this.sent_)throw w("cannot .getErrorCode() before sending");return this.errorCode_},e.prototype.getStatus=function(){if(!this.sent_)throw w("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}},e.prototype.getResponseText=function(){if(!this.sent_)throw w("cannot .getResponseText() before sending");return this.xhr_.responseText},e.prototype.abort=function(){this.xhr_.abort()},e.prototype.getResponseHeader=function(e){return this.xhr_.getResponseHeader(e)},e.prototype.addUploadProgressListener=function(e){V(this.xhr_.upload)&&this.xhr_.upload.addEventListener("progress",e)},e.prototype.removeUploadProgressListener=function(e){V(this.xhr_.upload)&&this.xhr_.upload.removeEventListener("progress",e)},e}(),pt=function(){function e(){}return e.prototype.createXhrIo=function(){return new ht},e}(),ft=function(){function e(e,t){this.bucket=e,this.path_=t}return Object.defineProperty(e.prototype,"path",{get:function(){return this.path_},enumerable:!0,configurable:!0}),e.prototype.fullServerUrl=function(){var e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)},e.prototype.bucketOnlyServerUrl=function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"},e.makeFromBucketSpec=function(t){var n;try{n=e.makeFromUrl(t)}catch(n){return new e(t,"")}if(""===n.path)return n;throw p(t)},e.makeFromUrl=function(t){for(var n=null,r=[{regex:new RegExp("^gs://([A-Za-z0-9.\\-_]+)(/(.*))?$","i"),indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp("^https?://firebasestorage\\.googleapis\\.com/v[A-Za-z0-9_]+/b/([A-Za-z0-9.\\-_]+)/o(/([^?#]*).*)?$","i"),indices:{bucket:1,path:3},postModify:function(e){e.path_=decodeURIComponent(e.path)}}],i=0;i<r.length;i++){var o=r[i],a=o.regex.exec(t);if(a){var s=a[o.indices.bucket],u=a[o.indices.path];u||(u=""),n=new e(s,u),o.postModify(n);break}}if(null==n)throw h(t);return n},e}(),dt=function(e,t,n,r){this.server=e,this.local=t||e,this.writable=!!n,this.xform=r||te},mt=null,gt=function(e,t){var n=this;this.validator=function(t){n.optional&&!j(t)||e(t)},this.optional=!!t},yt=function(){function e(e,t){var n=0,r="";H(e)?(this.data_=e,n=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=r}return e.prototype.size=function(){return this.size_},e.prototype.type=function(){return this.type_},e.prototype.slice=function(t,n){if(H(this.data_)){var r=_e(this.data_,t,n);return null===r?null:new e(r)}return new e(new Uint8Array(this.data_.buffer,t,n-t),!0)},e.getBlob=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(z()){var r=t.map(function(t){return t instanceof e?t.data_:t});return new e(be.apply(null,r))}var i=t.map(function(e){return K(e)?E(ot.RAW,e).data:e.data_}),o=0;i.forEach(function(e){o+=e.byteLength});var a=new Uint8Array(o),s=0;return i.forEach(function(e){for(var t=0;t<e.length;t++)a[s++]=e[t]}),new e(a,!0)},e.prototype.uploadData=function(){return this.data_},e}(),vt=function(e,t,n,r){this.url=e,this.method=t,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]},bt=function(e,t,n,r){this.current=e,this.total=t,this.finalized=!!n,this.metadata=r||null},_t=function(e,t,n){if(U(e)||V(t)||V(n))this.next=e,this.error=t||null,this.complete=n||null;else{var r=e;this.next=r.next||null,this.error=r.error||null,this.complete=r.complete||null}},wt=function(e,t,n,r,i,o){this.bytesTransferred=e,this.totalBytes=t,this.state=n,this.metadata=r,this.task=i,this.ref=o},kt=function(){function e(e,t,n,r,i,o){void 0===o&&(o=null);var a=this;this.transferred_=0,this.needToFetchStatus_=!1,this.needToFetchMetadata_=!1,this.observers_=[],this.error_=null,this.uploadUrl_=null,this.request_=null,this.chunkMultiplier_=1,this.resolve_=null,this.reject_=null,this.ref_=e,this.authWrapper_=t,this.location_=n,this.blob_=i,this.metadata_=o,this.mappings_=r,this.resumable_=this.shouldDoResumable_(this.blob_),this.state_=ct.RUNNING,this.errorHandler_=function(e){a.request_=null,a.chunkMultiplier_=1,e.codeEquals(it.CANCELED)?(a.needToFetchStatus_=!0,a.completeTransitions_()):(a.error_=e,a.transition_(ct.ERROR))},this.metadataErrorHandler_=function(e){a.request_=null,e.codeEquals(it.CANCELED)?a.completeTransitions_():(a.error_=e,a.transition_(ct.ERROR))},this.promise_=R(function(e,t){a.resolve_=e,a.reject_=t,a.start_()}),this.promise_.then(null,function(){})}return e.prototype.makeProgressCallback_=function(){var e=this,t=this.transferred_;return function(n,r){e.updateProgress_(t+n)}},e.prototype.shouldDoResumable_=function(e){return e.size()>262144},e.prototype.start_=function(){this.state_===ct.RUNNING&&null===this.request_&&(this.resumable_?null===this.uploadUrl_?this.createResumable_():this.needToFetchStatus_?this.fetchStatus_():this.needToFetchMetadata_?this.fetchMetadata_():this.continueUpload_():this.oneShotUpload_())},e.prototype.resolveToken_=function(e){var t=this;this.authWrapper_.getAuthToken().then(function(n){switch(t.state_){case ct.RUNNING:e(n);break;case ct.CANCELING:t.transition_(ct.CANCELED);break;case ct.PAUSING:t.transition_(ct.PAUSED)}})},e.prototype.createResumable_=function(){var e=this;this.resolveToken_(function(t){var n=Ve(e.authWrapper_,e.location_,e.mappings_,e.blob_,e.metadata_),r=e.authWrapper_.makeRequest(n,t);e.request_=r,r.getPromise().then(function(t){e.request_=null,e.uploadUrl_=t,e.needToFetchStatus_=!1,e.completeTransitions_()},e.errorHandler_)})},e.prototype.fetchStatus_=function(){var e=this,t=this.uploadUrl_;this.resolveToken_(function(n){var r=je(e.authWrapper_,e.location_,t,e.blob_),i=e.authWrapper_.makeRequest(r,n);e.request_=i,i.getPromise().then(function(t){t=t,e.request_=null,e.updateProgress_(t.current),e.needToFetchStatus_=!1,t.finalized&&(e.needToFetchMetadata_=!0),e.completeTransitions_()},e.errorHandler_)})},e.prototype.continueUpload_=function(){var e=this,t=262144*this.chunkMultiplier_,n=new bt(this.transferred_,this.blob_.size()),r=this.uploadUrl_;this.resolveToken_(function(i){var o;try{o=Ue(e.location_,e.authWrapper_,r,e.blob_,t,e.mappings_,n,e.makeProgressCallback_())}catch(t){return e.error_=t,void e.transition_(ct.ERROR)}var a=e.authWrapper_.makeRequest(o,i);e.request_=a,a.getPromise().then(function(t){e.increaseMultiplier_(),e.request_=null,e.updateProgress_(t.current),t.finalized?(e.metadata_=t.metadata,e.transition_(ct.SUCCESS)):e.completeTransitions_()},e.errorHandler_)})},e.prototype.increaseMultiplier_=function(){262144*this.chunkMultiplier_<33554432&&(this.chunkMultiplier_*=2)},e.prototype.fetchMetadata_=function(){var e=this;this.resolveToken_(function(t){var n=De(e.authWrapper_,e.location_,e.mappings_),r=e.authWrapper_.makeRequest(n,t);e.request_=r,r.getPromise().then(function(t){e.request_=null,e.metadata_=t,e.transition_(ct.SUCCESS)},e.metadataErrorHandler_)})},e.prototype.oneShotUpload_=function(){var e=this;this.resolveToken_(function(t){var n=Le(e.authWrapper_,e.location_,e.mappings_,e.blob_,e.metadata_),r=e.authWrapper_.makeRequest(n,t);e.request_=r,r.getPromise().then(function(t){e.request_=null,e.metadata_=t,e.updateProgress_(e.blob_.size()),e.transition_(ct.SUCCESS)},e.errorHandler_)})},e.prototype.updateProgress_=function(e){var t=this.transferred_;this.transferred_=e,this.transferred_!==t&&this.notifyObservers_()},e.prototype.transition_=function(e){if(this.state_!==e)switch(e){case ct.CANCELING:case ct.PAUSING:this.state_=e,null!==this.request_&&this.request_.cancel();break;case ct.RUNNING:var t=this.state_===ct.PAUSED;this.state_=e,t&&(this.notifyObservers_(),this.start_());break;case ct.PAUSED:this.state_=e,this.notifyObservers_();break;case ct.CANCELED:this.error_=l(),this.state_=e,this.notifyObservers_();break;case ct.ERROR:case ct.SUCCESS:this.state_=e,this.notifyObservers_()}},e.prototype.completeTransitions_=function(){switch(this.state_){case ct.PAUSING:this.transition_(ct.PAUSED);break;case ct.CANCELING:this.transition_(ct.CANCELED);break;case ct.RUNNING:this.start_()}},Object.defineProperty(e.prototype,"snapshot",{get:function(){var e=A(this.state_);return new wt(this.transferred_,this.blob_.size(),e,this.metadata_,this,this.ref_)},enumerable:!0,configurable:!0}),e.prototype.on=function(e,t,n,r){function i(e){try{return void s(e)}catch(e){}try{if(u(e),!(j(e.next)||j(e.error)||j(e.complete)))throw"";return}catch(e){throw a}}function o(e){return function(t,n,i){null!==e&&le("on",e,arguments);var o=new _t(t,n,r);return c.addObserver_(o),function(){c.removeObserver_(o)}}}void 0===t&&(t=void 0),void 0===n&&(n=void 0),void 0===r&&(r=void 0);var a="Expected a function or an Object with one of `next`, `error`, `complete` properties.",s=ye(!0).validator,u=ge(null,!0).validator;le("on",[pe(function(t){if(e!==ut.STATE_CHANGED)throw"Expected one of the event types: ["+ut.STATE_CHANGED+"]."}),ge(i,!0),ye(!0),ye(!0)],arguments);var c=this,l=[ge(function(e){if(null===e)throw a;i(e)}),ye(!0),ye(!0)];return j(t)||j(n)||j(r)?o(null)(t,n,r):o(l)},e.prototype.then=function(e,t){return this.promise_.then(e,t)},e.prototype.catch=function(e){return this.then(null,e)},e.prototype.addObserver_=function(e){this.observers_.push(e),this.notifyObserver_(e)},e.prototype.removeObserver_=function(e){Ee(this.observers_,e)},e.prototype.notifyObservers_=function(){var e=this;this.finishPromise_(),ke(this.observers_).forEach(function(t){e.notifyObserver_(t)})},e.prototype.finishPromise_=function(){if(null!==this.resolve_){var e=!0;switch(A(this.state_)){case lt.SUCCESS:qe(this.resolve_.bind(null,this.snapshot))();break;case lt.CANCELED:case lt.ERROR:qe(this.reject_.bind(null,this.error_))();break;default:e=!1}e&&(this.resolve_=null,this.reject_=null)}},e.prototype.notifyObserver_=function(e){switch(A(this.state_)){case lt.RUNNING:case lt.PAUSED:null!==e.next&&qe(e.next.bind(e,this.snapshot))();break;case lt.SUCCESS:null!==e.complete&&qe(e.complete.bind(e))();break;case lt.CANCELED:case lt.ERROR:null!==e.error&&qe(e.error.bind(e,this.error_))();break;default:null!==e.error&&qe(e.error.bind(e,this.error_))()}},e.prototype.resume=function(){le("resume",[],arguments);var e=this.state_===ct.PAUSED||this.state_===ct.PAUSING;return e&&this.transition_(ct.RUNNING),e},e.prototype.pause=function(){le("pause",[],arguments);var e=this.state_===ct.RUNNING;return e&&this.transition_(ct.PAUSING),e},e.prototype.cancel=function(){le("cancel",[],arguments);var e=this.state_===ct.RUNNING||this.state_===ct.PAUSING;return e&&this.transition_(ct.CANCELING),e},e}(),Et=function(){function e(e,t){this.authWrapper=e,this.location=t instanceof ft?t:ft.makeFromUrl(t)}return e.prototype.toString=function(){return le("toString",[],arguments),"gs://"+this.location.bucket+"/"+this.location.path},e.prototype.newRef=function(t,n){return new e(t,n)},e.prototype.mappings=function(){return re()},e.prototype.child=function(e){le("child",[pe()],arguments);var t=X(this.location.path,e),n=new ft(this.location.bucket,t);return this.newRef(this.authWrapper,n)},Object.defineProperty(e.prototype,"parent",{get:function(){var e=G(this.location.path);if(null===e)return null;var t=new ft(this.location.bucket,e);return this.newRef(this.authWrapper,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){var e=new ft(this.location.bucket,"");return this.newRef(this.authWrapper,e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bucket",{get:function(){return this.location.bucket},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fullPath",{get:function(){return this.location.path},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return Y(this.location.path)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"storage",{get:function(){return this.authWrapper.service()},enumerable:!0,configurable:!0}),e.prototype.put=function(e,t){return void 0===t&&(t=null),le("put",[fe(),de(!0)],arguments),this.throwIfRoot_("put"),new kt(this,this.authWrapper,this.location,this.mappings(),new yt(e),t)},e.prototype.putString=function(e,t,n){void 0===t&&(t=ot.RAW),le("putString",[pe(),pe(k,!0),de(!0)],arguments),this.throwIfRoot_("putString");var r=E(t,e),i=P(n);return!V(i.contentType)&&V(r.contentType)&&(i.contentType=r.contentType),new kt(this,this.authWrapper,this.location,this.mappings(),new yt(r.data,!0),i)},e.prototype.delete=function(){le("delete",[],arguments),this.throwIfRoot_("delete");var e=this;return this.authWrapper.getAuthToken().then(function(t){var n=Oe(e.authWrapper,e.location);return e.authWrapper.makeRequest(n,t).getPromise()})},e.prototype.getMetadata=function(){le("getMetadata",[],arguments),this.throwIfRoot_("getMetadata");var e=this;return this.authWrapper.getAuthToken().then(function(t){var n=De(e.authWrapper,e.location,e.mappings());return e.authWrapper.makeRequest(n,t).getPromise()})},e.prototype.updateMetadata=function(e){le("updateMetadata",[de()],arguments),this.throwIfRoot_("updateMetadata");var t=this;return this.authWrapper.getAuthToken().then(function(n){var r=xe(t.authWrapper,t.location,e,t.mappings());return t.authWrapper.makeRequest(r,n).getPromise()})},e.prototype.getDownloadURL=function(){le("getDownloadURL",[],arguments),this.throwIfRoot_("getDownloadURL");var e=this;return this.authWrapper.getAuthToken().then(function(t){var n=Ae(e.authWrapper,e.location,e.mappings());return e.authWrapper.makeRequest(n,t).getPromise().then(function(e){if(null===e)throw m();return e})})},e.prototype.throwIfRoot_=function(e){if(""===this.location.path)throw b(e)},e}(),Tt=function(){function e(e){this.promise_=M(e)}return e.prototype.getPromise=function(){return this.promise_},e.prototype.cancel=function(e){void 0===e&&(e=!1)},e}(),St=function(){function e(){this.map_={},this.id_=nt}return e.prototype.addRequest=function(e){function t(){delete r.map_[n]}var n=this.id_;this.id_++,this.map_[n]=e;var r=this;e.getPromise().then(t,t)},e.prototype.clear=function(){O(this.map_,function(e,t){t&&t.cancel(!0)}),this.map_={}},e}(),Ct=function(){function e(t,n,r,i,o){if(this.bucket_=null,this.deleted_=!1,this.app_=t,null!==this.app_){var a=this.app_.options;V(a)&&(this.bucket_=e.extractBucket_(a))}this.storageRefMaker_=n,this.requestMaker_=r,this.pool_=o,this.service_=i,this.maxOperationRetryTime_=et,this.maxUploadRetryTime_=tt,this.requestMap_=new St}return e.extractBucket_=function(e){var t=e.storageBucket||null;return null==t?null:ft.makeFromBucketSpec(t).bucket},e.prototype.getAuthToken=function(){return null!==this.app_&&V(this.app_.INTERNAL)&&V(this.app_.INTERNAL.getToken)?this.app_.INTERNAL.getToken().then(function(e){return null!==e?e.accessToken:null},function(e){return null}):L(null)},e.prototype.bucket=function(){if(this.deleted_)throw v();return this.bucket_},e.prototype.service=function(){return this.service_},e.prototype.makeStorageReference=function(e){return this.storageRefMaker_(this,e)},e.prototype.makeRequest=function(e,t){if(this.deleted_)return new Tt(v());var n=this.requestMaker_(e,t,this.pool_);return this.requestMap_.addRequest(n),n},e.prototype.deleteApp=function(){this.deleted_=!0,this.app_=null,this.requestMap_.clear()},e.prototype.maxUploadRetryTime=function(){return this.maxUploadRetryTime_},e.prototype.setMaxUploadRetryTime=function(e){this.maxUploadRetryTime_=e},e.prototype.maxOperationRetryTime=function(){return this.maxOperationRetryTime_},e.prototype.setMaxOperationRetryTime=function(e){this.maxOperationRetryTime_=e},e}(),It=function(){function e(e,t,n,r,i,o,a,s,u,c,l){this.pendingXhr_=null,this.backoffId_=null,this.resolve_=null,this.reject_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=i.slice(),this.additionalRetryCodes_=o.slice(),this.callback_=a,this.errorCallback_=s,this.progressCallback_=c,this.timeout_=u,this.pool_=l;var h=this;this.promise_=R(function(e,t){h.resolve_=e,h.reject_=t,h.start_()})}return e.prototype.start_=function(){function e(e,n){var r=t.resolve_,o=t.reject_,a=n.xhr;if(n.wasSuccessCode)try{var s=t.callback_(a,a.getResponseText());j(s)?r(s):r()}catch(e){o(e)}else if(null!==a)(u=i()).setServerResponseProp(a.getResponseText()),o(t.errorCallback_?t.errorCallback_(a,u):u);else if(n.canceled)o(u=t.appDelete_?v():l());else{var u=c();o(u)}}var t=this;this.canceled_?e(0,new Nt(!1,null,!0)):this.backoffId_=Fe(function(e,n){function r(e){var n=e.loaded,r=e.lengthComputable?e.total:-1;null!==t.progressCallback_&&t.progressCallback_(n,r)}if(n)e(!1,new Nt(!1,null,!0));else{var i=t.pool_.createXhrIo();t.pendingXhr_=i,null!==t.progressCallback_&&i.addUploadProgressListener(r),i.send(t.url_,t.method_,t.body_,t.headers_).then(function(n){null!==t.progressCallback_&&n.removeUploadProgressListener(r),t.pendingXhr_=null;var i=(n=n).getErrorCode()===Ge.NO_ERROR,o=n.getStatus();if(i&&!t.isRetryStatusCode_(o)){var a=we(t.successCodes_,o);e(!0,new Nt(a,n))}else{var s=n.getErrorCode()===Ge.ABORT;e(!1,new Nt(!1,null,s))}})}},e,this.timeout_)},e.prototype.getPromise=function(){return this.promise_},e.prototype.cancel=function(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&Be(this.backoffId_),null!==this.pendingXhr_&&this.pendingXhr_.abort()},e.prototype.isRetryStatusCode_=function(e){var t=e>=500&&e<600,n=we([408,429],e),r=we(this.additionalRetryCodes_,e);return t||n||r},e}(),Nt=function(e,t,n){this.wasSuccessCode=e,this.xhr=t,this.canceled=!!n},Dt=function(){function e(e,t,n){if(this.bucket_=null,this.authWrapper_=new Ct(e,function(e,t){return new Et(e,t)},He,this,t),this.app_=e,null!=n)this.bucket_=ft.makeFromBucketSpec(n);else{var r=this.authWrapper_.bucket();null!=r&&(this.bucket_=new ft(r,""))}this.internals_=new At(this)}return e.prototype.ref=function(e){if(le("ref",[pe(function(e){if(/^[A-Za-z]+:\/\//.test(e))throw"Expected child path but got a URL, use refFromURL instead."},!0)],arguments),null==this.bucket_)throw new Error("No Storage Bucket defined in Firebase Options.");var t=new Et(this.authWrapper_,this.bucket_);return null!=e?t.child(e):t},e.prototype.refFromURL=function(e){return le("refFromURL",[pe(function(e){if(!/^[A-Za-z]+:\/\//.test(e))throw"Expected full URL but got a child path, use ref instead.";try{ft.makeFromUrl(e)}catch(e){throw"Expected valid full URL but got an invalid one."}},!1)],arguments),new Et(this.authWrapper_,e)},Object.defineProperty(e.prototype,"maxUploadRetryTime",{get:function(){return this.authWrapper_.maxUploadRetryTime()},enumerable:!0,configurable:!0}),e.prototype.setMaxUploadRetryTime=function(e){le("setMaxUploadRetryTime",[me()],arguments),this.authWrapper_.setMaxUploadRetryTime(e)},Object.defineProperty(e.prototype,"maxOperationRetryTime",{get:function(){return this.authWrapper_.maxOperationRetryTime()},enumerable:!0,configurable:!0}),e.prototype.setMaxOperationRetryTime=function(e){le("setMaxOperationRetryTime",[me()],arguments),this.authWrapper_.setMaxOperationRetryTime(e)},Object.defineProperty(e.prototype,"app",{get:function(){return this.app_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"INTERNAL",{get:function(){return this.internals_},enumerable:!0,configurable:!0}),e}(),At=function(){function e(e){this.service_=e}return e.prototype.delete=function(){return this.service_.authWrapper_.deleteApp(),L(void 0)},e}(),xt="storage";Qe(Xe),t.registerStorage=Qe}),define("firebase@5.6.0#dist/index.cjs",["require","exports","module","@firebase/polyfill","@firebase/app","@firebase/auth","@firebase/database","@firebase/firestore","@firebase/functions","@firebase/messaging","@firebase/storage"],function(e,t,n){"use strict";e("@firebase/polyfill");var r=function(e){return e&&"object"==typeof e&&"default"in e?e.default:e}(e("@firebase/app"));e("@firebase/auth"),e("@firebase/database"),e("@firebase/firestore"),e("@firebase/functions"),e("@firebase/messaging"),e("@firebase/storage"),console.warn("\nIt looks like you're using the development build of the Firebase JS SDK.\nWhen deploying Firebase apps to production, it is advisable to only import\nthe individual SDK components you intend to use.\n\nFor the module builds, these are available in the following manner\n(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):\n\nCommonJS Modules:\nconst firebase = require('firebase/app');\nrequire('firebase/<PACKAGE>');\n\nES Modules:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n\nTypescript:\nimport * as firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n"),n.exports=r}),define("devjournal@0.0.0#env/firebase.json",[],function(){return{hosting:{firebase:"devjournal-firebase-1",public:"./dist",headers:[{source:"/**",headers:[{key:"Access-Control-Allow-Origin",value:"*"}]}]}}}),define("devjournal@0.0.0#firebase-initialize",["exports","firebase","./env/firebase.json"],function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}Object.defineProperty(e,"__esModule",{value:!0}),e.provider=e.config=e.firebase=void 0;var i=r(t),o=r(n);i.initializeApp(o);var a=new i.auth.GithubAuthProvider;e.firebase=i,e.config=o,e.provider=a}),define("devjournal@0.0.0#markdown-editor/markdown-editor",["exports","can-component","can-define/map/","./markdown-editor.stache","showdown","~/firebase-initialize","./markdown-editor.less"],function(e,t,n,r,i,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(e,"__esModule",{value:!0}),e.ViewModel=void 0;var s=a(t),u=a(n),c=a(r),l=a(i),h="### edit me\n*i'm markdown*\n- make a list\n1. maybe it's numbered",p=e.ViewModel=u.default.extend({htmloutput:{get:function(){return(new l.default.Converter).makeHtml(this.markdown)}},markdown:{default:function(){return h}},date:{},currentUser:{},init:function(){var e=this;o.firebase.auth().onAuthStateChanged(function(t){t?(e.currentUser=t,e.loadMarkdownFromFirebase()):(e.currentUser=null,e.loadDefaultMarkdown())})},loadDefaultMarkdown:function(){this.markdown=h,this.htmloutput=(new l.default.Converter).makeHtml(h)},loadMarkdownFromFirebase:function(){var e=this;o.firebase.database().ref("posts/"+this.currentUser.uid+"/"+this.date).once("value").then(function(t){t.val()?e.markdown=t.val().entry:e.loadDefaultMarkdown()})},markdownChanged:function(){this.markdown=document.querySelector("#markdown-editor-textarea").value,this.saveToFirebase()},saveToFirebase:function(){this.currentUser&&o.firebase.database().ref("posts/"+this.currentUser.uid+"/"+this.date).set({entry:this.markdown})}});e.default=s.default.extend({tag:"markdown-editor",ViewModel:p,view:c.default})}),define("devjournal@0.0.0#components/html-preview/html-preview.stache!steal-stache@4.1.2#steal-stache",["module","can-stache","can-stache/src/mustache_core","can-view-import@4.2.0#can-view-import","can-stache-bindings@4.6.4#can-stache-bindings"],function(e,t,n){var r=t("components/html-preview/html-preview.stache",[{tokenType:"start",args:["p",!1,1]},{tokenType:"end",args:["p",!1,1]},{tokenType:"special",args:["{htmloutput",1]},{tokenType:"close",args:["p",1]},{tokenType:"done",args:[1]}]);return function(t,n,i){var o=Object.assign({},n);return o.helpers?o.helpers=Object.assign({module:e},o.helpers):o.module=e,r(t,o,i)}}),define("devjournal@0.0.0#components/html-preview/html-preview",["exports","can-component","can-define/map/","./html-preview.stache","showdown","./html-preview.less"],function(e,t,n,r,i){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(e,"__esModule",{value:!0}),e.ViewModel=void 0;var a=o(t),s=o(n),u=o(r),c=(o(i),e.ViewModel=s.default.extend({message:{default:"This is the html-preview component"},htmloutput:{}}));e.default=a.default.extend({tag:"html-preview",ViewModel:c,view:u.default})}),define("devjournal@0.0.0#components/login-button/login-button.stache!steal-stache@4.1.2#steal-stache",["module","can-stache","can-stache/src/mustache_core","can-view-import@4.2.0#can-view-import","can-stache-bindings@4.6.4#can-stache-bindings"],function(e,t,n){var r=t("components/login-button/login-button.stache",[{tokenType:"special",args:["#if ./currentUser",1]},{tokenType:"chars",args:["\n\t",1]},{tokenType:"start",args:["a",!1,2]},{tokenType:"attrStart",args:["class",2]},{tokenType:"attrValue",args:["profile-button",2]},{tokenType:"attrEnd",args:["class",2]},{tokenType:"attrStart",args:["on:click",2]},{tokenType:"attrValue",args:["./toggleDropdown()",2]},{tokenType:"attrEnd",args:["on:click",2]},{tokenType:"end",args:["a",!1,2]},{tokenType:"chars",args:["\n\t\t",2]},{tokenType:"start",args:["img",!0,3]},{tokenType:"attrStart",args:["class",3]},{tokenType:"attrValue",args:["avatar",3]},{tokenType:"attrEnd",args:["class",3]},{tokenType:"attrStart",args:["src",3]},{tokenType:"special",args:["./currentUser.photoURL",3]},{tokenType:"attrEnd",args:["src",3]},{tokenType:"end",args:["img",!0,3]},{tokenType:"chars",args:["\n\t\t",3]},{tokenType:"start",args:["span",!1,4]},{tokenType:"attrStart",args:["class",4]},{tokenType:"attrValue",args:["name",4]},{tokenType:"attrEnd",args:["class",4]},{tokenType:"end",args:["span",!1,4]},{tokenType:"special",args:["./currentUser.displayName",4]},{tokenType:"close",args:["span",4]},{tokenType:"chars",args:["\n\t\t",4]},{tokenType:"start",args:["span",!1,5]},{tokenType:"attrStart",args:["class",5]},{tokenType:"attrValue",args:["chevron ",5]},{tokenType:"special",args:["#if ./dropdownOpen",5]},{tokenType:"attrValue",args:["top",5]},{tokenType:"special",args:["else",5]},{tokenType:"attrValue",args:["bottom",5]},{tokenType:"special",args:["/if",5]},{tokenType:"attrEnd",args:["class",5]},{tokenType:"end",args:["span",!1,5]},{tokenType:"close",args:["span",5]},{tokenType:"chars",args:["\n\t",5]},{tokenType:"close",args:["a",6]},{tokenType:"chars",args:["\n\t",6]},{tokenType:"special",args:["#if ./dropdownOpen",7]},{tokenType:"chars",args:["\n\t",7]},{tokenType:"start",args:["div",!1,8]},{tokenType:"attrStart",args:["class",8]},{tokenType:"attrValue",args:["profile-dropdown",8]},{tokenType:"attrEnd",args:["class",8]},{tokenType:"end",args:["div",!1,8]},{tokenType:"chars",args:["\n\t\t",8]},{tokenType:"start",args:["a",!1,9]},{tokenType:"attrStart",args:["href",9]},{tokenType:"special",args:[" routeUrl(page='logs') ",9]},{tokenType:"attrEnd",args:["href",9]},{tokenType:"end",args:["a",!1,9]},{tokenType:"chars",args:["View journal log entries",9]},{tokenType:"close",args:["a",9]},{tokenType:"chars",args:["\n\t\t",9]},{tokenType:"start",args:["a",!1,10]},{tokenType:"attrStart",args:["href",10]},{tokenType:"special",args:[" routeUrl(page='profile'",10]},{tokenType:"attrEnd",args:["href",10]},{tokenType:"end",args:["a",!1,10]},{tokenType:"chars",args:["View profile",10]},{tokenType:"close",args:["a",10]},{tokenType:"chars",args:["\n\t\t",10]},{tokenType:"start",args:["a",!1,11]},{tokenType:"attrStart",args:["on:click",11]},{tokenType:"attrValue",args:["./signOut()",11]},{tokenType:"attrEnd",args:["on:click",11]},{tokenType:"end",args:["a",!1,11]},{tokenType:"chars",args:["Log out",11]},{tokenType:"close",args:["a",11]},{tokenType:"chars",args:["\n\t",11]},{tokenType:"close",args:["div",12]},{tokenType:"chars",args:["\n\t",12]},{tokenType:"special",args:["/if",13]},{tokenType:"chars",args:["\n",13]},{tokenType:"special",args:["else",14]},{tokenType:"chars",args:["\n\t",14]},{tokenType:"start",args:["a",!1,15]},{tokenType:"attrStart",args:["class",15]},{tokenType:"attrValue",args:["profile-button",15]},{tokenType:"attrEnd",args:["class",15]},{tokenType:"attrStart",args:["on:click",15]},{tokenType:"attrValue",args:["./toggleDropdown()",15]},{tokenType:"attrEnd",args:["on:click",15]},{tokenType:"end",args:["a",!1,15]},{tokenType:"chars",args:["\n\t\t",15]},{tokenType:"start",args:["img",!0,16]},{tokenType:"attrStart",args:["class",16]},{tokenType:"attrValue",args:["avatar",16]},{tokenType:"attrEnd",args:["class",16]},{tokenType:"attrStart",args:["src",16]},{tokenType:"attrValue",args:["/src/assets/anonymous.jpg",16]},{tokenType:"attrEnd",args:["src",16]},{tokenType:"end",args:["img",!0,16]},{tokenType:"chars",args:["\n\t\t",16]},{tokenType:"start",args:["span",!1,17]},{tokenType:"attrStart",args:["class",17]},{tokenType:"attrValue",args:["name",17]},{tokenType:"attrEnd",args:["class",17]},{tokenType:"end",args:["span",!1,17]},{tokenType:"chars",args:["Anonymous User",17]},{tokenType:"close",args:["span",17]},{tokenType:"chars",args:["\n\t\t",17]},{tokenType:"start",args:["span",!1,18]},{tokenType:"attrStart",args:["class",18]},{tokenType:"attrValue",args:["chevron ",18]},{tokenType:"special",args:["#if ./dropdownOpen",18]},{tokenType:"attrValue",args:["top",18]},{tokenType:"special",args:["else",18]},{tokenType:"attrValue",args:["bottom",18]},{tokenType:"special",args:["/if",18]},{tokenType:"attrEnd",args:["class",18]},{tokenType:"end",args:["span",!1,18]},{tokenType:"close",args:["span",18]},{tokenType:"chars",args:["\n\t",18]},{tokenType:"close",args:["a",19]},{tokenType:"chars",args:["\n\t",19]},{tokenType:"special",args:["#if ./dropdownOpen",20]},{tokenType:"chars",args:["\n\t\t",20]},{tokenType:"start",args:["div",!1,21]},{tokenType:"attrStart",args:["class",21]},{tokenType:"attrValue",args:["profile-dropdown",21]},{tokenType:"attrEnd",args:["class",21]},{tokenType:"end",args:["div",!1,21]},{tokenType:"chars",args:["\n\t\t\t",21]},{tokenType:"start",args:["a",!1,22]},{tokenType:"attrStart",args:["on:click",22]},{tokenType:"attrValue",args:["./signIn()",22]},{tokenType:"attrEnd",args:["on:click",22]},{tokenType:"end",args:["a",!1,22]},{tokenType:"chars",args:["Sign in with GitHub",22]},{tokenType:"close",args:["a",22]},{tokenType:"chars",args:["\n\t\t",22]},{tokenType:"close",args:["div",23]},{tokenType:"chars",args:["\n\t",23]},{tokenType:"special",args:["/if",24]},{tokenType:"chars",args:["\n",24]},{tokenType:"special",args:["/if",25]},{tokenType:"done",args:[25]}]);return function(t,n,i){var o=Object.assign({},n);return o.helpers?o.helpers=Object.assign({module:e},o.helpers):o.module=e,r(t,o,i)}}),define("devjournal@0.0.0#components/login-button/login-button",["exports","can-component","can-define/map/","./login-button.stache","~/firebase-initialize","./login-button.less"],function(e,t,n,r,i){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(e,"__esModule",{value:!0}),e.ViewModel=void 0;var a=o(t),s=o(n),u=o(r),c=e.ViewModel=s.default.extend({anchor:{default:"Log in"},currentUser:{},dropdownOpen:{},toggleDropdown:function(){this.dropdownOpen=!this.dropdownOpen},init:function(){var e=this;i.firebase.auth().onAuthStateChanged(function(t){e.currentUser=t||null})},signOut:function(){i.firebase.auth().signOut()},signIn:function(){i.firebase.auth().signInWithPopup(i.provider).then(function(e){this.anchor=e.user.displayName}).catch(function(e){var t=e.code;e.message,e.email,e.credential,console.log(t)})}});e.default=a.default.extend({tag:"login-button",ViewModel:c,view:u.default})}),define("devjournal@0.0.0#components/view-logs/view-logs.stache!steal-stache@4.1.2#steal-stache",["module","can-stache","can-stache/src/mustache_core","can-view-import@4.2.0#can-view-import","can-stache-bindings@4.6.4#can-stache-bindings"],function(e,t,n){var r=t("components/view-logs/view-logs.stache",[{tokenType:"special",args:["#each ./posts",1]},{tokenType:"chars",args:["\n\t",1]},{tokenType:"start",args:["a",!1,2]},{tokenType:"attrStart",args:["href",2]},{tokenType:"attrValue",args:["logs/",2]},{tokenType:"special",args:["scope.key",2]},{tokenType:"attrEnd",args:["href",2]},{tokenType:"end",args:["a",!1,2]},{tokenType:"special",args:["scope.key",2]},{tokenType:"close",args:["a",2]},{tokenType:"chars",args:["\n\t",2]},{tokenType:"start",args:["p",!1,3]},{tokenType:"end",args:["p",!1,3]},{tokenType:"special",args:["./entry",3]},{tokenType:"close",args:["p",3]},{tokenType:"chars",args:["\n",3]},{tokenType:"special",args:["/each",4]},{tokenType:"done",args:[4]}]);return function(t,n,i){var o=Object.assign({},n);return o.helpers?o.helpers=Object.assign({module:e},o.helpers):o.module=e,r(t,o,i)}}),define("devjournal@0.0.0#components/view-logs/view-logs",["exports","can-component","can-define/map/","./view-logs.stache","~/firebase-initialize","./view-logs.less"],function(e,t,n,r,i){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(e,"__esModule",{value:!0}),e.ViewModel=void 0;var a=o(t),s=o(n),u=o(r),c=function(e){return Object.keys(e).sort().reverse().reduce(function(t,n){return t[n]=e[n],t},{})},l=e.ViewModel=s.default.extend({message:{default:"This is the view-logs component"},currentUser:{},init:function(){var e=this;i.firebase.auth().onAuthStateChanged(function(t){t?(e.currentUser=t,e.loadMarkdownFromFirebase()):e.currentUser=null})},posts:{},loadMarkdownFromFirebase:function(){var e=this;i.firebase.database().ref("posts/"+this.currentUser.uid+"/").orderByKey().on("value",function(t){t.val()?(e.posts=c(t.val()),console.log(e.posts)):e.loadDefaultMarkdown()})}});e.default=a.default.extend({tag:"view-logs",ViewModel:l,view:u.default})}),define("done-autorender@2.5.0#src/template",[],function(){return{}}),define("done-autorender@2.5.0#src/parse",[],function(){return{}}),define("done-autorender@2.5.0#src/init",[],function(){return{}}),define("done-autorender@2.5.0#src/autorender",[],function(){return{}}),define("devjournal@0.0.0#index.stache!done-autorender@2.5.0#src/autorender",["@steal","@loader","module","can-log@1.0.0#dev/dev","can-symbol@1.6.1#can-symbol","full-url@1.0.0#index","can-namespace@1.0.0#can-namespace","can-reflect@1.17.7#can-reflect","can-stache-bindings@4.6.4#can-stache-bindings","can-view-import@4.2.0#can-view-import","can-util@3.14.0#js/is-empty-object/is-empty-object","can-dom-mutate@1.3.5#node","can-dom-mutate@1.3.5#can-dom-mutate","can-util@3.14.0#dom/child-nodes/child-nodes","can-route@4.4.6#can-route","can-stache@4.15.9#can-stache","can-view-scope@4.12.0#can-view-scope","can-zone@0.6.23#xhr","can-zone@0.6.23#lib/zone","~/app","~/styles.less","~/markdown-editor/","~/components/html-preview/","~/components/login-button/","~/components/view-logs/"],function(e,t,n,r,i,o,a,s,u,c,l,h,p,f,d,m,g,y,v,b){function _(e,t){var r={module:n};return t=t&&t.add?t.add(r):r,F(new g(e,null,{viewModel:!0}),t)}function w(){var e=V(this),t=e.ViewModel;if(t){M(e,t);var n=e.state=new t;return s.setKeyValue(document.documentElement,i.for("can.viewModel"),n),A(d,n),d.start(),n}console.error("done-autorender cannot start without a ViewModel. Please ensure your template contains an export for your application's ViewModel. https://github.com/donejs/autorender#viewmodel")}function k(){return w(),O.call(this)}function E(){new v({plugins:[y]}).run(function(){var e=P(w());""===document.documentElement.dataset.incrementallyRendered?x(e):e.promise.then(x)})}function T(e){return e.dataset&&""===e.dataset.keep}function S(e){return 8===e.nodeType&&0===e.nodeValue.indexOf("autorender-keep")}function C(e){return T(e)||S(e)}function I(e,t){for(var n,r=Array.prototype.slice.call(f(e)),i=0,o=r.length;i<o&&(n=r[i],z[n.nodeName]||C(n)||!1!==t(n));i++);}function N(e){h.removeChild.call(e.parentNode,e)}function D(e){return function(t){h.appendChild.call(e,t)}}function A(e,t){if(B){var n=s.getKeyValue(t,B);n.constructor?(e.data=new n.constructor,s.setKeyValue(t,B,e.data)):e.data=n}else e.data=t}function x(e){var t=V(this).ownerDocument,n=e.fragment,r=e.viewModel;if(!t.documentElement.hasAttribute("data-attached")){var i=t.head,o=t.body;if(I(i,N),I(n.querySelector("head"),D(i)),I(o,N),I(n.querySelector("body"),D(o)),t.documentElement.setAttribute("data-attached",""),r&&r.connectedCallback){var a=r.connectedCallback(t.documentElement);"function"==typeof a&&p.onNodeRemoval(t.documentElement,a)}}}function O(){var e=x.bind(this),t=Q.state;return q?P(t).promise.then(e):R(t).then(e)}function P(e){function t(){var e=Function.prototype.bind.call(console.warn,console),t=r.data;t.debugInfo&&t.debugInfo.forEach(function(t){e(t.task,t.stack)})}var n,r=new v({plugins:function(){var e=[y];if(U.useDebug){var t=U.timeout,n={break:U.debugBrk};e.push(debugZone(t,n))}return e}()});return{promise:r.run(function(){n=_(e,{})}).then(function(t){return{fragment:n,zoneData:t,viewModel:e}}).then(null,function(e){throw e.timeout?(t(),new Error("Timeout of "+e.timeout+" exceeded")):e}),fragment:n,zoneData:r.data}}function R(e){var t=_(e,{});return Promise.resolve({fragment:t})}function L(e,t){var n=_(t,{}),r=n.firstChild,i=e.documentElement;r&&"HTML"===r.nodeName?h.replaceChild.call(e,r,i):h.appendChild.call(i,n),e.documentElement.setAttribute("data-can-automount","false")}function M(e,t){var n=i.for("autorender.props");if(!s.getKeyValue(e,n)&&s.isConstructorLike(t)){var r=t.prototype;G.forEach(function(e){s.hasOwnKey(r,e)||s.defineInstanceKey(t,e,{enumerable:!1})}),s.setKeyValue(e,n,!0)}}function V(e){return Q.isPrototypeOf(e)?e:Q}function j(e){var t=V(this),n=t.ownerDocument,r=t.ViewModel;if(!r)throw new Error("done-autorender cannot render your application without a viewModel defined. See the guide for information. http://donejs.com/Guide.html#section_Createatemplateandmainfile");M(t,r);var i;if(e[":authority"]){var a=e;i=new URL(a[":scheme"]+":"+a[":authority"]+a[":path"])}else i=new URL(o(e));var u=i.pathname.substr(1)+i.search,c=!!d.rule(u),h=d.deparam(u),p={env:Object.assign({},process.env),request:e};B||(p=Object.assign(h,p));var f=new r(p);s.getKeyValue(f,"statusCode")||l(d.routes)||(c?s.setKeyValue(f,"statusCode",200):(s.setKeyValue(f,"statusCode",404),s.setKeyValue(f,"statusMessage","Not found"))),A(d,f),B&&s.update(d.data,h),d.start(),L(n,f)}var U={useZones:!0,useDebug:!1,timeout:5e3,debugBrk:!1},q=U.useZones,F=m("index.stache",[{tokenType:"start",args:["html",!1,1]},{tokenType:"end",args:["html",!1,1]},{tokenType:"start",args:["head",!1,1]},{tokenType:"end",args:["head",!1,1]},{tokenType:"chars",args:["\n    ",1]},{tokenType:"start",args:["title",!1,2]},{tokenType:"end",args:["title",!1,2]},{tokenType:"special",args:["title",2]},{tokenType:"close",args:["title",2]},{tokenType:"chars",args:["\n  ",2]},{tokenType:"close",args:["head",3]},{tokenType:"chars",args:["\n  ",3]},{tokenType:"start",args:["body",!1,4]},{tokenType:"end",args:["body",!1,4]},{tokenType:"chars",args:["\n    ",4]},{tokenType:"start",args:["can-import",!0,5]},{tokenType:"attrStart",args:["from",5]},{tokenType:"attrValue",args:["~/styles.less",5]},{tokenType:"attrEnd",args:["from",5]},{tokenType:"end",args:["can-import",!0,5]},{tokenType:"chars",args:["\n    ",5]},{tokenType:"start",args:["can-import",!0,6]},{tokenType:"attrStart",args:["from",6]},{tokenType:"attrValue",args:["~/app",6]},{tokenType:"attrEnd",args:["from",6]},{tokenType:"attrStart",args:["export-as",6]},{tokenType:"attrValue",args:["viewModel",6]},{tokenType:"attrEnd",args:["export-as",6]},{tokenType:"end",args:["can-import",!0,6]},{tokenType:"chars",args:["\n\n    ",6]},{tokenType:"start",args:["can-import",!0,8]},{tokenType:"attrStart",args:["from",8]},{tokenType:"attrValue",args:["~/markdown-editor/",8]},{tokenType:"attrEnd",args:["from",8]},{tokenType:"end",args:["can-import",!0,8]},{tokenType:"chars",args:["\n    ",8]},{tokenType:"start",args:["can-import",!0,9]},{tokenType:"attrStart",args:["from",9]},{tokenType:"attrValue",args:["~/components/html-preview/",9]},{tokenType:"attrEnd",args:["from",9]},{tokenType:"end",args:["can-import",!0,9]},{tokenType:"chars",args:["\n    ",9]},{tokenType:"start",args:["can-import",!0,10]},{tokenType:"attrStart",args:["from",10]},{tokenType:"attrValue",args:["~/components/login-button/",10]},{tokenType:"attrEnd",args:["from",10]},{tokenType:"end",args:["can-import",!0,10]},{tokenType:"chars",args:["\n    ",10]},{tokenType:"start",args:["can-import",!0,11]},{tokenType:"attrStart",args:["from",11]},{tokenType:"attrValue",args:["~/components/view-logs/",11]},{tokenType:"attrEnd",args:["from",11]},{tokenType:"end",args:["can-import",!0,11]},{tokenType:"chars",args:["\n\n    ",11]},{tokenType:"special",args:["#switch(page)",13]},{tokenType:"chars",args:["\n\n        ",13]},{tokenType:"special",args:['#case("today")',15]},{tokenType:"chars",args:["\n            ",15]},{tokenType:"start",args:["header",!1,16]},{tokenType:"end",args:["header",!1,16]},{tokenType:"chars",args:["\n              ",16]},{tokenType:"start",args:["h1",!1,17]},{tokenType:"attrStart",args:["class",17]},{tokenType:"attrValue",args:["date",17]},{tokenType:"attrEnd",args:["class",17]},{tokenType:"end",args:["h1",!1,17]},{tokenType:"special",args:["date",17]},{tokenType:"close",args:["h1",17]},{tokenType:"chars",args:["\n              ",17]},{tokenType:"start",args:["login-button",!0,18]},{tokenType:"end",args:["login-button",!0,18]},{tokenType:"chars",args:["\n            ",18]},{tokenType:"close",args:["header",19]},{tokenType:"chars",args:["\n\n            ",19]},{tokenType:"start",args:["div",!1,21]},{tokenType:"attrStart",args:["class",21]},{tokenType:"attrValue",args:["view-container",21]},{tokenType:"attrEnd",args:["class",21]},{tokenType:"end",args:["div",!1,21]},{tokenType:"chars",args:["\n              ",21]},{tokenType:"start",args:["markdown-editor",!0,22]},{tokenType:"attrStart",args:["date:from",22]},{tokenType:"attrValue",args:["./date",22]},{tokenType:"attrEnd",args:["date:from",22]},{tokenType:"attrStart",args:["htmloutput:to",22]},{tokenType:"attrValue",args:["./htmloutput",22]},{tokenType:"attrEnd",args:["htmloutput:to",22]},{tokenType:"end",args:["markdown-editor",!0,25]},{tokenType:"chars",args:["\n              ",25]},{tokenType:"start",args:["html-preview",!0,26]},{tokenType:"attrStart",args:["htmloutput:from",26]},{tokenType:"attrValue",args:["./htmloutput",26]},{tokenType:"attrEnd",args:["htmloutput:from",26]},{tokenType:"end",args:["html-preview",!0,28]},{tokenType:"chars",args:["\n            ",28]},{tokenType:"close",args:["div",29]},{tokenType:"chars",args:["\n        ",29]},{tokenType:"special",args:["/case",30]},{tokenType:"chars",args:["\n\n        ",30]},{tokenType:"special",args:['#case("logs")',32]},{tokenType:"chars",args:["\n            ",32]},{tokenType:"start",args:["h1",!1,33]},{tokenType:"end",args:["h1",!1,33]},{tokenType:"chars",args:["logs",33]},{tokenType:"close",args:["h1",33]},{tokenType:"chars",args:["\n            ",33]},{tokenType:"start",args:["view-logs",!0,34]},{tokenType:"end",args:["view-logs",!0,34]},{tokenType:"chars",args:["\n        ",34]},{tokenType:"special",args:["/case",35]},{tokenType:"chars",args:["\n\n        ",35]},{tokenType:"special",args:['#case("logview")',37]},{tokenType:"chars",args:["\n            ",37]},{tokenType:"start",args:["h1",!1,38]},{tokenType:"end",args:["h1",!1,38]},{tokenType:"chars",args:["viewing a single log",38]},{tokenType:"close",args:["h1",38]},{tokenType:"chars",args:["\n        ",38]},{tokenType:"special",args:["/case",39]},{tokenType:"chars",args:["\n\n        ",39]},{tokenType:"special",args:['#case("profile")',41]},{tokenType:"chars",args:["\n            ",41]},{tokenType:"start",args:["h1",!1,42]},{tokenType:"end",args:["h1",!1,42]},{tokenType:"chars",args:["profile",42]},{tokenType:"close",args:["h1",42]},{tokenType:"chars",args:["\n        ",42]},{tokenType:"special",args:["/case",43]},{tokenType:"chars",args:["\n\n        ",43]},{tokenType:"special",args:["#default()",45]},{tokenType:"chars",args:["\n            ",45]},{tokenType:"start",args:["h1",!1,46]},{tokenType:"end",args:["h1",!1,46]},{tokenType:"chars",args:["Page Not Found",46]},{tokenType:"close",args:["h1",46]},{tokenType:"chars",args:["\n        ",46]},{tokenType:"special",args:["/default",47]},{tokenType:"chars",args:["\n\n    ",47]},{tokenType:"special",args:["/switch",49]},{tokenType:"chars",args:["\n\n\n\n\n\n    ",49]},{tokenType:"special",args:["#switch env.NODE_ENV",55]},{tokenType:"chars",args:["\n      ",55]},{tokenType:"special",args:['#case "production"',56]},{tokenType:"chars",args:["\n        ",56]},{tokenType:"start",args:["script",!1,57]},{tokenType:"attrStart",args:["src",57]},{tokenType:"special",args:["joinBase('steal.production.js')",57]},{tokenType:"attrEnd",args:["src",57]},{tokenType:"end",args:["script",!1,57]},{tokenType:"chars",args:["",57]},{tokenType:"close",args:["script",57]},{tokenType:"chars",args:["\n      ",57]},{tokenType:"special",args:["/case",58]},{tokenType:"chars",args:["\n      ",58]},{tokenType:"special",args:["#default",59]},{tokenType:"chars",args:["\n        ",59]},{tokenType:"start",args:["script",!1,60]},{tokenType:"attrStart",args:["src",60]},{tokenType:"attrValue",args:["/node_modules/steal/steal.js",60]},{tokenType:"attrEnd",args:["src",60]},{tokenType:"end",args:["script",!1,60]},{tokenType:"chars",args:["",60]},{tokenType:"close",args:["script",60]},{tokenType:"chars",args:["\n      ",60]},{tokenType:"special",args:["/default",61]},{tokenType:"chars",args:["\n    ",61]},{tokenType:"special",args:["/switch",62]},{tokenType:"chars",args:["\n  ",62]},{tokenType:"close",args:["body",63]},{tokenType:"close",args:["html",63]},{tokenType:"chars",args:["\n",63]},{tokenType:"done",args:[64]}]),B="",K="object"==typeof process&&"[object process]"==={}.toString.call(process),W=function(){try{var e=t._nodeRequire;return e&&"undefined"!==e("nw.gui")}catch(e){return!1}}(),H=K&&!!process.versions.electron,z={SCRIPT:!0,STYLE:!0,LINK:!0,BASE:!0};void 0===e||!W&&!H&&K||e.done().then(function(){!1!==e.loader.autorenderAutostart&&(q?E():k())});var Q=Object.create(Function.prototype,{viewModel:{enumerable:!0,configurable:!0,writable:!0,value:b.default||b},connectViewModelAndAttach:{value:k},ownerDocument:{get:function(){return document}},renderAndAttach:{value:O},renderInZone:{value:P},teardownRouting:{value:function(){d.stop()}},ViewModel:{get:function(){return this.viewModel}}}),G=["env","request","statusCode","statusMessage"];return Object.setPrototypeOf(j,Q),j});